!function n(e,t,r){function a(o,l){if(!t[o]){if(!e[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=t[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return a(n?n:t)},u,u.exports,n,e,t,r)}return t[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t){t.exports=e("./lib/heap")},{"./lib/heap":2}],2:[function(e,t){(function(){var e,n,r,a,i,o,l,s,u,d,c,p,f,h,v;r=Math.floor,d=Math.min,n=function(e,t){return t>e?-1:e>t?1:0},u=function(e,t,a,i,o){var l;if(null==a&&(a=0),null==o&&(o=n),0>a)throw new Error("lo must be non-negative");for(null==i&&(i=e.length);i>a;)l=r((a+i)/2),o(t,e[l])<0?i=l:a=l+1;return[].splice.apply(e,[a,a-a].concat(t)),t},o=function(e,t,r){return null==r&&(r=n),e.push(t),h(e,0,e.length-1,r)},i=function(e,t){var r,a;return null==t&&(t=n),r=e.pop(),e.length?(a=e[0],e[0]=r,v(e,0,t)):a=r,a},s=function(e,t,r){var a;return null==r&&(r=n),a=e[0],e[0]=t,v(e,0,r),a},l=function(e,t,r){var a;return null==r&&(r=n),e.length&&r(e[0],t)<0&&(a=[e[0],t],t=a[0],e[0]=a[1],v(e,0,r)),t},a=function(e,t){var a,i,o,l,s,u;for(null==t&&(t=n),l=function(){u=[];for(var t=0,n=r(e.length/2);n>=0?n>t:t>n;n>=0?t++:t--)u.push(t);return u}.apply(this).reverse(),s=[],i=0,o=l.length;o>i;i++)a=l[i],s.push(v(e,a,t));return s},f=function(e,t,r){var a;return null==r&&(r=n),a=e.indexOf(t),-1!==a?(h(e,0,a,r),v(e,a,r)):void 0},c=function(e,t,r){var i,o,s,u,d;if(null==r&&(r=n),o=e.slice(0,t),!o.length)return o;for(a(o,r),d=e.slice(t),s=0,u=d.length;u>s;s++)i=d[s],l(o,i,r);return o.sort(r).reverse()},p=function(e,t,r){var o,l,s,c,p,f,h,v,g,m;if(null==r&&(r=n),10*t<=e.length){if(c=e.slice(0,t).sort(r),!c.length)return c;for(s=c[c.length-1],v=e.slice(t),p=0,h=v.length;h>p;p++)o=v[p],r(o,s)<0&&(u(c,o,0,null,r),c.pop(),s=c[c.length-1]);return c}for(a(e,r),m=[],l=f=0,g=d(t,e.length);g>=0?g>f:f>g;l=g>=0?++f:--f)m.push(i(e,r));return m},h=function(e,t,r,a){var i,o,l;for(null==a&&(a=n),i=e[r];r>t&&(l=r-1>>1,o=e[l],a(i,o)<0);)e[r]=o,r=l;return e[r]=i},v=function(e,t,r){var a,i,o,l,s;for(null==r&&(r=n),i=e.length,s=t,o=e[t],a=2*t+1;i>a;)l=a+1,i>l&&!(r(e[a],e[l])<0)&&(a=l),e[t]=e[a],t=a,a=2*t+1;return e[t]=o,h(e,s,t,r)},e=function(){function e(e){this.cmp=null!=e?e:n,this.nodes=[]}return e.push=o,e.pop=i,e.replace=s,e.pushpop=l,e.heapify=a,e.nlargest=c,e.nsmallest=p,e.prototype.push=function(e){return o(this.nodes,e,this.cmp)},e.prototype.pop=function(){return i(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return s(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return l(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return a(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return f(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),("undefined"!=typeof t&&null!==t?t.exports:void 0)?t.exports=e:window.Heap=e}).call(this)},{}],3:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var n,r,a,i;for("undefined"==typeof t&&(t=15),a=.5,n=new Date;;){for(a*=2,i=a;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;if(r=new Date,r-n>t)break}for(i=a;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;return r=new Date,1e3*(3*a-1)/(r-n)},numeric._myIndexOf=function(e){var t,n=this.length;for(t=0;n>t;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(0>e)return"-"+t(-e);if(isFinite(e)){var n=Math.floor(Math.log(e)/Math.log(10)),r=e/Math.pow(10,n),a=r.toPrecision(numeric.precision);return 10===parseFloat(a)&&(n++,r=1,a=r.toPrecision(numeric.precision)),parseFloat(a).toString()+"e"+n.toString()}return"Infinity"}function n(e){var a;if("undefined"==typeof e)return r.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return r.push('"'+e+'"'),!1;if("boolean"==typeof e)return r.push(e.toString()),!1;if("number"==typeof e){var i=t(e),o=e.toPrecision(numeric.precision),l=parseFloat(e.toString()).toString(),s=[i,o,l,parseFloat(o).toString(),parseFloat(l).toString()];for(a=1;a<s.length;a++)s[a].length<i.length&&(i=s[a]);return r.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===e)return r.push("null"),!1;if("function"==typeof e){r.push(e.toString());var u=!1;for(a in e)e.hasOwnProperty(a)&&(r.push(u?",\n":"\n{"),u=!0,r.push(a),r.push(": \n"),n(e[a]));return u&&r.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return r.push("...Large Array..."),!0;var u=!1;for(r.push("["),a=0;a<e.length;a++)a>0&&(r.push(","),u&&r.push("\n ")),u=n(e[a]);return r.push("]"),!0}r.push("{");var u=!1;for(a in e)e.hasOwnProperty(a)&&(u&&r.push(",\n"),u=!0,r.push(a),r.push(": \n"),n(e[a]));return r.push("}"),!0}var r=[];return n(e),r.join("")},numeric.parseDate=function(e){function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}return t(e)},numeric.parseFloat=function(e){function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}return t(e)},numeric.parseCSV=function(e){var t,n,r=e.split("\n"),a=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=function(e){return e.substr(0,e.length-1)},s=0;for(n=0;n<r.length;n++){var u,d=(r[n]+",").match(i);if(d.length>0){for(a[s]=[],t=0;t<d.length;t++)u=l(d[t]),a[s][t]=o.test(u)?parseFloat(u):u;s++}}return a},numeric.toCSV=function(e){var t,n,r,a,i,o,l=numeric.dim(e);for(r=l[0],a=l[1],o=[],t=0;r>t;t++){for(i=[],n=0;r>n;n++)i[n]=e[t][n].toString();o[t]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e){var t,n,r,a,i,o,l,s,u=e.length,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(t=0;u>t;t+=3)n=e[t],r=e[t+1],a=e[t+2],i=n>>2,o=((3&n)<<4)+(r>>4),l=((15&r)<<2)+(a>>6),s=63&a,t+1>=u?l=s=64:t+2>=u&&(s=64),c+=d.charAt(i)+d.charAt(o)+d.charAt(l)+d.charAt(s);return c}function n(e,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=e.length);{var r,a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,o=0;e.length}for(r=t;n>r;r++)o=255&(i^e[r]),i=i>>>8^a[o];return-1^i}var r,a,i,o,l,s,u,d,c,p,f=e[0].length,h=e[0][0].length,v=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,f>>24&255,f>>16&255,f>>8&255,255&f,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(p=n(v,12,29),v[29]=p>>24&255,v[30]=p>>16&255,v[31]=p>>8&255,v[32]=255&p,r=1,a=0,u=0;f>u;u++){for(v.push(f-1>u?0:1),l=3*h+1+(0===u)&255,s=3*h+1+(0===u)>>8&255,v.push(l),v.push(s),v.push(255&~l),v.push(255&~s),0===u&&v.push(0),d=0;h>d;d++)for(i=0;3>i;i++)l=e[i][u][d],l=l>255?255:0>l?0:Math.round(l),r=(r+l)%65521,a=(a+r)%65521,v.push(l);v.push(0)}return c=(a<<16)+r,v.push(c>>24&255),v.push(c>>16&255),v.push(c>>8&255),v.push(255&c),o=v.length-41,v[33]=o>>24&255,v[34]=o>>16&255,v[35]=o>>8&255,v[36]=255&o,p=n(v,37),v.push(p>>24&255),v.push(p>>16&255),v.push(p>>8&255),v.push(255&p),v.push(0),v.push(0),v.push(0),v.push(0),v.push(73),v.push(69),v.push(78),v.push(68),v.push(174),v.push(66),v.push(96),v.push(130),"data:image/png;base64,"+t(v)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t,n;return"object"==typeof e?(t=e[0],"object"==typeof t?(n=t[0],"object"==typeof n?numeric._dim(e):[e.length,t.length]):[e.length]):[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,n){var r,a;if(!(t instanceof Array&&n instanceof Array))return!1;if(a=t.length,a!==n.length)return!1;for(r=0;a>r;r++)if(t[r]!==n[r]){if("object"!=typeof t[r])return!1;if(!e(t[r],n[r]))return!1}return!0},numeric.rep=function(e,t,n){"undefined"==typeof n&&(n=0);var r,a=e[n],i=Array(a);if(n===e.length-1){for(r=a-2;r>=0;r-=2)i[r+1]=t,i[r]=t;return-1===r&&(i[0]=t),i}for(r=a-1;r>=0;r--)i[r]=numeric.rep(e,t,n+1);return i},numeric.dotMMsmall=function(e,t){var n,r,a,i,o,l,s,u,d,c,p;for(i=e.length,o=t.length,l=t[0].length,s=Array(i),n=i-1;n>=0;n--){for(u=Array(l),d=e[n],a=l-1;a>=0;a--){for(c=d[o-1]*t[o-1][a],r=o-2;r>=1;r-=2)p=r-1,c+=d[r]*t[r][a]+d[p]*t[p][a];0===r&&(c+=d[0]*t[0][a]),u[a]=c}s[n]=u}return s},numeric._getCol=function(e,t,n){var r,a=e.length;for(r=a-1;r>0;--r)n[r]=e[r][t],--r,n[r]=e[r][t];0===r&&(n[0]=e[0][t])},numeric.dotMMbig=function(e,t){var n,r,a,i,o=numeric._getCol,l=t.length,s=Array(l),u=e.length,d=t[0].length,c=new Array(u),p=numeric.dotVV;for(--l,--u,r=u;-1!==r;--r)c[r]=Array(d);for(--d,r=d;-1!==r;--r)for(o(t,r,s),a=u;-1!==a;--a)i=0,n=e[a],c[a][r]=p(n,s);return c},numeric.dotMV=function(e,t){var n,r=e.length,a=(t.length,Array(r)),i=numeric.dotVV;for(n=r-1;n>=0;n--)a[n]=i(e[n],t);return a},numeric.dotVM=function(e,t){var n,r,a,i,o,l,s;for(a=e.length,i=t[0].length,o=Array(i),r=i-1;r>=0;r--){for(l=e[a-1]*t[a-1][r],n=a-2;n>=1;n-=2)s=n-1,l+=e[n]*t[n][r]+e[s]*t[s][r];0===n&&(l+=e[0]*t[0][r]),o[r]=l}return o},numeric.dotVV=function(e,t){var n,r,a=e.length,i=e[a-1]*t[a-1];for(n=a-2;n>=1;n-=2)r=n-1,i+=e[n]*t[n]+e[r]*t[r];return 0===n&&(i+=e[0]*t[0]),i},numeric.dot=function(e,t){var n=numeric.dim;switch(1e3*n(e).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,n,r,a,i=e.length,o=Array(i);for(t=i-1;t>=0;t--){for(a=Array(i),n=t+2,r=i-1;r>=n;r-=2)a[r]=0,a[r-1]=0;for(r>t&&(a[r]=0),a[t]=e[t],r=t-1;r>=1;r-=2)a[r]=0,a[r-1]=0;0===r&&(a[0]=0),o[t]=a}return o},numeric.getDiag=function(e){var t,n=Math.min(e.length,e[0].length),r=Array(n);for(t=n-1;t>=1;--t)r[t]=e[t][t],--t,r[t]=e[t][t];return 0===t&&(r[0]=e[0][0]),r},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,n){"undefined"==typeof n&&(n="");var r,a,i=[],o=/\[i\]$/,l="",s=!1;for(r=0;r<e.length;r++)o.test(e[r])?(a=e[r].substring(0,e[r].length-3),l=a):a=e[r],"ret"===a&&(s=!0),i.push(a);return i[e.length]="_s",i[e.length+1]="_k",i[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+l+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(s?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(e,t,n){"undefined"==typeof n&&(n="");var r,a,i=[],o=/\[i\]$/,l="",s=!1;for(r=0;r<e.length;r++)o.test(e[r])?(a=e[r].substring(0,e[r].length-3),l=a):a=e[r],"ret"===a&&(s=!0),i.push(a);return i[e.length]="var _n = "+l+".length;\nvar i"+(s?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function t(e,n,r,a,i){if(a===r.length-1)return void i(e,n);var o,l=r[a];for(o=l-1;o>=0;o--)t("object"==typeof e?e[o]:e,"object"==typeof n?n[o]:n,r,a+1,i)},numeric._biforeach2=function n(e,t,r,a,i){if(a===r.length-1)return i(e,t);var o,l=r[a],s=Array(l);for(o=l-1;o>=0;--o)s[o]=n("object"==typeof e?e[o]:e,"object"==typeof t?t[o]:t,r,a+1,i);return s},numeric._foreach=function r(e,t,n,a){if(n===t.length-1)return void a(e);var i,o=t[n];for(i=o-1;i>=0;i--)r(e[i],t,n+1,a)},numeric._foreach2=function a(e,t,n,r){if(n===t.length-1)return r(e);var i,o=t[n],l=Array(o);for(i=o-1;i>=0;i--)l[i]=a(e[i],t,n+1,r);return l},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,r,a="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(a="var "+t+" = Math."+t+";\n",n=function(e,n,r){return e+" = "+t+"("+n+","+r+")"},r=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,r){return e+" = "+n+" "+t+" "+r},r=numeric.opseq.hasOwnProperty(e+"eq")?function(e,n){return e+" "+t+"= "+n}:function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),a),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),a),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),a),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),a),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),a),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(a="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(a="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",a),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",a),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,n,r,a,i,o,l,e,s=numeric.dim(e),u=Math.abs,d=s[0],c=s[1],p=numeric.clone(e),f=numeric.identity(d);for(o=0;c>o;++o){var h=-1,v=-1;for(i=o;i!==d;++i)l=u(p[i][o]),l>v&&(h=i,v=l);for(n=p[h],p[h]=p[o],p[o]=n,a=f[h],f[h]=f[o],f[o]=a,e=n[o],l=o;l!==c;++l)n[l]/=e;for(l=c-1;-1!==l;--l)a[l]/=e;for(i=d-1;-1!==i;--i)if(i!==o){for(t=p[i],r=f[i],e=t[o],l=o+1;l!==c;++l)t[l]-=n[l]*e;for(l=c-1;l>0;--l)r[l]-=a[l]*e,--l,r[l]-=a[l]*e;0===l&&(r[0]-=a[0]*e)}}return f},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,r,a,i,o,l,s,u,d=t[0],c=1,p=numeric.clone(e);for(r=0;d-1>r;r++){for(a=r,n=r+1;d>n;n++)Math.abs(p[n][r])>Math.abs(p[a][r])&&(a=n);for(a!==r&&(s=p[a],p[a]=p[r],p[r]=s,c*=-1),i=p[r],n=r+1;d>n;n++){for(o=p[n],l=o[r]/i[r],a=r+1;d-1>a;a+=2)u=a+1,o[a]-=i[a]*l,o[u]-=i[u]*l;a!==d&&(o[a]-=i[a]*l)}if(0===i[r])return 0;c*=i[r]}return c*p[r][r]},numeric.transpose=function(e){var t,n,r,a,i,o=e.length,l=e[0].length,s=Array(l);for(n=0;l>n;n++)s[n]=Array(o);for(t=o-1;t>=1;t-=2){for(a=e[t],r=e[t-1],n=l-1;n>=1;--n)i=s[n],i[t]=a[n],i[t-1]=r[n],--n,i=s[n],i[t]=a[n],i[t-1]=r[n];0===n&&(i=s[0],i[t]=a[0],i[t-1]=r[0])}if(0===t){for(r=e[0],n=l-1;n>=1;--n)s[n][0]=r[n],--n,s[n][0]=r[n];0===n&&(s[0][0]=r[0])}return s},numeric.negtranspose=function(e){var t,n,r,a,i,o=e.length,l=e[0].length,s=Array(l);for(n=0;l>n;n++)s[n]=Array(o);for(t=o-1;t>=1;t-=2){for(a=e[t],r=e[t-1],n=l-1;n>=1;--n)i=s[n],i[t]=-a[n],i[t-1]=-r[n],--n,i=s[n],i[t]=-a[n],i[t-1]=-r[n];0===n&&(i=s[0],i[t]=-a[0],i[t-1]=-r[0])}if(0===t){for(r=e[0],n=l-1;n>=1;--n)s[n][0]=-r[n],--n,s[n][0]=-r[n];0===n&&(s[0][0]=-r[0])}return s},numeric._random=function i(e,t){var n,r,a=e[t],o=Array(a);if(t===e.length-1){for(r=Math.random,n=a-1;n>=1;n-=2)o[n]=r(),o[n-1]=r();return 0===n&&(o[0]=r()),o}for(n=a-1;n>=0;n--)o[n]=i(e,t+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,n){if("undefined"==typeof n&&(n=Math.max(Math.round(t-e)+1,1)),2>n)return 1===n?[e]:[];var r,a=Array(n);for(n--,r=n;r>=0;r--)a[r]=(r*t+(n-r)*e)/n;return a},numeric.getBlock=function(e,t,n){function r(e,i){var o,l=t[i],s=n[i]-l,u=Array(s);if(i===a.length-1){for(o=s;o>=0;o--)u[o]=e[o+l];return u}for(o=s;o>=0;o--)u[o]=r(e[o+l],i+1);return u}var a=numeric.dim(e);return r(e,0)},numeric.setBlock=function(e,t,n,r){function a(e,r,o){var l,s=t[o],u=n[o]-s;if(o===i.length-1)for(l=u;l>=0;l--)e[l+s]=r[l];for(l=u;l>=0;l--)a(e[l+s],r[l],o+1)}var i=numeric.dim(e);return a(e,r,0),e},numeric.getRange=function(e,t,n){var r,a,i,o,l=t.length,s=n.length,u=Array(l);for(r=l-1;-1!==r;--r)for(u[r]=Array(s),i=u[r],o=e[t[r]],a=s-1;-1!==a;--a)i[a]=o[n[a]];return u},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var n,r,a,i,o,l=t[0],s=t[1];for(n=0,r=0,a=0;l>a;++a)n+=e[a][0].length;for(i=0;s>i;++i)r+=e[0][i][0].length;var u=Array(n);for(a=0;n>a;++a)u[a]=Array(r);var d,c,p,f,h,v=0;for(a=0;l>a;++a){for(d=r,i=s-1;-1!==i;--i)for(o=e[a][i],d-=o[0].length,p=o.length-1;-1!==p;--p)for(h=o[p],c=u[v+p],f=h.length-1;-1!==f;--f)c[d+f]=h[f];v+=e[a][0].length}return u},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var n=numeric.dim(e),r=numeric.dim(t);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var a,i,o,l,s=n[0],u=r[0],d=Array(s);for(i=s-1;i>=0;i--){for(a=Array(u),l=e[i],o=u-1;o>=3;--o)a[o]=l*t[o],--o,a[o]=l*t[o],--o,a[o]=l*t[o],--o,a[o]=l*t[o];for(;o>=0;)a[o]=l*t[o],--o;d[i]=a}return d},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,n,r,a){numeric.indexOf;if("string"!=typeof a){var i;a="";for(i in numeric)numeric.hasOwnProperty(i)&&(e.indexOf(i)>=0||t.indexOf(i)>=0||n.indexOf(i)>=0||r.indexOf(i)>=0)&&i.length>1&&(a+="var "+i+" = numeric."+i+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+a+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function o(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var o=numeric.div;return this.y?new numeric.T(o(this.x,e.x),o(this.y,e.x)):new numeric.T(o(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),numeric.negtranspose(n)):new numeric.T(e(t))},numeric.Tunop=function(e,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if("undefined"==typeof e.y)return new numeric.T(numeric.inv(e.x));var t,n,r,a,i,o,l,s,u,d,c,t,n,r,p,f,h,v,g,m,y,x=e.x.length,b=numeric.identity(x),w=numeric.rep([x,x],0),_=numeric.clone(e.x),k=numeric.clone(e.y);for(t=0;x>t;t++){for(h=_[t][t],v=k[t][t],p=h*h+v*v,r=t,n=t+1;x>n;n++)h=_[n][t],v=k[n][t],f=h*h+v*v,f>p&&(r=n,p=f);for(r!==t&&(y=_[t],_[t]=_[r],_[r]=y,y=k[t],k[t]=k[r],k[r]=y,y=b[t],b[t]=b[r],b[r]=y,y=w[t],w[t]=w[r],w[r]=y),a=_[t],i=k[t],s=b[t],u=w[t],h=a[t],v=i[t],n=t+1;x>n;n++)g=a[n],m=i[n],a[n]=(g*h+m*v)/p,i[n]=(m*h-g*v)/p;for(n=0;x>n;n++)g=s[n],m=u[n],s[n]=(g*h+m*v)/p,u[n]=(m*h-g*v)/p;for(n=t+1;x>n;n++){for(o=_[n],l=k[n],d=b[n],c=w[n],h=o[t],v=l[t],r=t+1;x>r;r++)g=a[r],m=i[r],o[r]-=g*h-m*v,l[r]-=m*h+g*v;for(r=0;x>r;r++)g=s[r],m=u[r],d[r]-=g*h-m*v,c[r]-=m*h+g*v}}for(t=x-1;t>0;t--)for(s=b[t],u=w[t],n=t-1;n>=0;n--)for(d=b[n],c=w[n],h=_[n][t],v=k[n][t],r=x-1;r>=0;r--)g=s[r],m=u[r],d[r]-=h*g-v*m,c[r]-=h*m+v*g;return new numeric.T(b,w)},numeric.T.prototype.get=function(e){var t,n=this.x,r=this.y,a=0,i=e.length;if(r){for(;i>a;)t=e[a],n=n[t],r=r[t],a++;return new numeric.T(n,r)}for(;i>a;)t=e[a],n=n[t],a++;return new numeric.T(n)},numeric.T.prototype.set=function(e,t){var n,r=this.x,a=this.y,i=0,o=e.length,l=t.x,s=t.y;if(0===o)return s?this.y=s:a&&(this.y=void 0),this.x=r,this;if(s){for(a||(a=numeric.rep(numeric.dim(r),0),this.y=a);o-1>i;)n=e[i],r=r[n],a=a[n],i++;return n=e[i],r[n]=l,a[n]=s,this}if(a){for(;o-1>i;)n=e[i],r=r[n],a=a[n],i++;return n=e[i],r[n]=l,a[n]=l instanceof Array?numeric.rep(numeric.dim(l),0):0,this}for(;o-1>i;)n=e[i],r=r[n],i++;return n=e[i],r[n]=l,this},numeric.T.prototype.getRows=function(e,t){var n,r,a=t-e+1,i=Array(a),o=this.x,l=this.y;for(n=e;t>=n;n++)i[n-e]=o[n];if(l){for(r=Array(a),n=e;t>=n;n++)r[n-e]=l[n];return new numeric.T(i,r)}return new numeric.T(i)},numeric.T.prototype.setRows=function(e,t,n){var r,a=this.x,i=this.y,o=n.x,l=n.y;for(r=e;t>=r;r++)a[r]=o[r-e];if(l)for(i||(i=numeric.rep(numeric.dim(a),0),this.y=i),r=e;t>=r;r++)i[r]=l[r-e];else if(i)for(r=e;t>=r;r++)i[r]=numeric.rep([o[r-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,n=this.y;return n?new numeric.T(t[e],n[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var n=this.x,r=this.y,a=t.x,i=t.y;return n[e]=a,i?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[e]=i):r&&(r=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var n=this.x,r=this.y,a=numeric.getBlock;return r?new numeric.T(a(n,e,t),a(r,e,t)):new numeric.T(a(n,e,t))},numeric.T.prototype.setBlock=function(e,t,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,a=this.y,i=numeric.setBlock,o=n.x,l=n.y;return l?(a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),i(r,e,t,o),i(a,e,t,l),this):(i(r,e,t,o),void(a&&i(a,e,t,numeric.rep(numeric.dim(o),0))))},numeric.T.rep=function(e,t){var n=numeric.T;t instanceof n||(t=new n(t));var r=t.x,a=t.y,i=numeric.rep;return a?new n(i(e,r),i(e,a)):new n(i(e,r))},numeric.T.diag=function l(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,l=numeric.diag;return n?new numeric.T(l(t),l(n)):new numeric.T(l(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,n=this.y;return n?new e.T(e.getDiag(t),e.getDiag(n)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),n=e[0]>=0?1:-1,r=n*numeric.norm2(e);t[0]+=r;var a=numeric.norm2(t);if(0===a)throw new Error("eig: internal error");return numeric.div(t,a)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,a,i,o,l,s,u,d,c,p=t[0],f=numeric.clone(e),h=numeric.identity(p);for(r=0;p-2>r;r++){for(i=Array(p-r-1),n=r+1;p>n;n++)i[n-r-1]=f[n][r];if(numeric.norm2(i)>0){for(o=numeric.house(i),l=numeric.getBlock(f,[r+1,r],[p-1,p-1]),s=numeric.tensor(o,numeric.dot(o,l)),n=r+1;p>n;n++)for(u=f[n],d=s[n-r-1],a=r;p>a;a++)u[a]-=2*d[a-r];
for(l=numeric.getBlock(f,[0,r+1],[p-1,p-1]),s=numeric.tensor(numeric.dot(l,o),o),n=0;p>n;n++)for(u=f[n],d=s[n],a=r+1;p>a;a++)u[a]-=2*d[a-r-1];for(l=Array(p-r-1),n=r+1;p>n;n++)l[n-r-1]=h[n];for(s=numeric.tensor(o,numeric.dot(o,l)),n=r+1;p>n;n++)for(c=h[n],d=s[n-r-1],a=0;p>a;a++)c[a]-=2*d[a]}}return{H:f,Q:h}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,t){"undefined"==typeof t&&(t=1e4),e=numeric.clone(e);var n,r,a,i,o,l,s,u,d,c,p,f,h,v,g,m,y,x,b=(numeric.clone(e),numeric.dim(e)),w=b[0],_=numeric.identity(w);if(3>w)return{Q:_,B:[[0,w-1]]};var k=numeric.epsilon;for(x=0;t>x;x++){for(m=0;w-1>m;m++)if(Math.abs(e[m+1][m])<k*(Math.abs(e[m][m])+Math.abs(e[m+1][m+1]))){var z=numeric.QRFrancis(numeric.getBlock(e,[0,0],[m,m]),t),A=numeric.QRFrancis(numeric.getBlock(e,[m+1,m+1],[w-1,w-1]),t);for(f=Array(m+1),g=0;m>=g;g++)f[g]=_[g];for(h=numeric.dot(z.Q,f),g=0;m>=g;g++)_[g]=h[g];for(f=Array(w-m-1),g=m+1;w>g;g++)f[g-m-1]=_[g];for(h=numeric.dot(A.Q,f),g=m+1;w>g;g++)_[g]=h[g-m-1];return{Q:_,B:z.B.concat(numeric.add(A.B,m+1))}}if(a=e[w-2][w-2],i=e[w-2][w-1],o=e[w-1][w-2],l=e[w-1][w-1],u=a+l,s=a*l-i*o,d=numeric.getBlock(e,[0,0],[2,2]),u*u>=4*s){var j,M;j=.5*(u+Math.sqrt(u*u-4*s)),M=.5*(u-Math.sqrt(u*u-4*s)),d=numeric.add(numeric.sub(numeric.dot(d,d),numeric.mul(d,j+M)),numeric.diag(numeric.rep([3],j*M)))}else d=numeric.add(numeric.sub(numeric.dot(d,d),numeric.mul(d,u)),numeric.diag(numeric.rep([3],s)));for(n=[d[0][0],d[1][0],d[2][0]],r=numeric.house(n),f=[e[0],e[1],e[2]],h=numeric.tensor(r,numeric.dot(r,f)),g=0;3>g;g++)for(p=e[g],v=h[g],y=0;w>y;y++)p[y]-=2*v[y];for(f=numeric.getBlock(e,[0,0],[w-1,2]),h=numeric.tensor(numeric.dot(f,r),r),g=0;w>g;g++)for(p=e[g],v=h[g],y=0;3>y;y++)p[y]-=2*v[y];for(f=[_[0],_[1],_[2]],h=numeric.tensor(r,numeric.dot(r,f)),g=0;3>g;g++)for(c=_[g],v=h[g],y=0;w>y;y++)c[y]-=2*v[y];var E;for(m=0;w-2>m;m++){for(y=m;m+1>=y;y++)if(Math.abs(e[y+1][y])<k*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){var z=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),A=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[w-1,w-1]),t);for(f=Array(y+1),g=0;y>=g;g++)f[g]=_[g];for(h=numeric.dot(z.Q,f),g=0;y>=g;g++)_[g]=h[g];for(f=Array(w-y-1),g=y+1;w>g;g++)f[g-y-1]=_[g];for(h=numeric.dot(A.Q,f),g=y+1;w>g;g++)_[g]=h[g-y-1];return{Q:_,B:z.B.concat(numeric.add(A.B,y+1))}}for(E=Math.min(w-1,m+3),n=Array(E-m),g=m+1;E>=g;g++)n[g-m-1]=e[g][m];for(r=numeric.house(n),f=numeric.getBlock(e,[m+1,m],[E,w-1]),h=numeric.tensor(r,numeric.dot(r,f)),g=m+1;E>=g;g++)for(p=e[g],v=h[g-m-1],y=m;w>y;y++)p[y]-=2*v[y-m];for(f=numeric.getBlock(e,[0,m+1],[w-1,E]),h=numeric.tensor(numeric.dot(f,r),r),g=0;w>g;g++)for(p=e[g],v=h[g],y=m+1;E>=y;y++)p[y]-=2*v[y-m-1];for(f=Array(E-m),g=m+1;E>=g;g++)f[g-m-1]=_[g];for(h=numeric.tensor(r,numeric.dot(r,f)),g=m+1;E>=g;g++)for(c=_[g],v=h[g-m-1],y=0;w>y;y++)c[y]-=2*v[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var n,r,a,i,o,l,s,u,d,c,p,f,h,v,g,m,y,x=numeric.toUpperHessenberg(e),b=numeric.QRFrancis(x.H,t),w=numeric.T,_=e.length,k=b.B,z=numeric.dot(b.Q,numeric.dot(x.H,numeric.transpose(b.Q))),A=new w(numeric.dot(b.Q,x.Q)),j=k.length,M=Math.sqrt;for(r=0;j>r;r++)if(n=k[r][0],n===k[r][1]);else{if(i=n+1,o=z[n][n],l=z[n][i],s=z[i][n],u=z[i][i],0===l&&0===s)continue;d=-o-u,c=o*u-l*s,p=d*d-4*c,p>=0?(f=0>d?-.5*(d-M(p)):-.5*(d+M(p)),m=(o-f)*(o-f)+l*l,y=s*s+(u-f)*(u-f),m>y?(m=M(m),v=(o-f)/m,g=l/m):(y=M(y),v=s/y,g=(u-f)/y),a=new w([[g,-v],[v,g]]),A.setRows(n,i,a.dot(A.getRows(n,i)))):(f=-.5*d,h=.5*M(-p),m=(o-f)*(o-f)+l*l,y=s*s+(u-f)*(u-f),m>y?(m=M(m+h*h),v=(o-f)/m,g=l/m,f=0,h/=m):(y=M(y+h*h),v=s/y,g=(u-f)/y,f=h/y,h=0),a=new w([[g,-v],[v,g]],[[f,h],[h,-f]]),A.setRows(n,i,a.dot(A.getRows(n,i))))}var E=A.dot(e).dot(A.transjugate()),_=e.length,S=numeric.T.identity(_);for(i=0;_>i;i++)if(i>0)for(r=i-1;r>=0;r--){var T=E.get([r,r]),O=E.get([i,i]);numeric.neq(T.x,O.x)||numeric.neq(T.y,O.y)?(f=E.getRow(r).getBlock([r],[i-1]),h=S.getRow(i).getBlock([r],[i-1]),S.set([i,r],E.get([r,i]).neg().sub(f.dot(h)).div(T.sub(O)))):S.setRow(i,S.getRow(r))}for(i=0;_>i;i++)f=S.getRow(i),S.setRow(i,f.div(f.norm2()));return S=S.transpose(),S=A.transjugate().dot(S),{lambda:E.getDiag(),E:S}},numeric.ccsSparse=function(e){var t,n,r,a,i=e.length,o=[];for(r=i-1;-1!==r;--r){n=e[r];for(a in n){for(a=parseInt(a);a>=o.length;)o[o.length]=0;0!==n[a]&&o[a]++}}var t=o.length,l=Array(t+1);for(l[0]=0,r=0;t>r;++r)l[r+1]=l[r]+o[r];var s=Array(l[t]),u=Array(l[t]);for(r=i-1;-1!==r;--r){n=e[r];for(a in n)0!==n[a]&&(o[a]--,s[l[a]+o[a]]=r,u[l[a]+o[a]]=n[a])}return[l,s,u]},numeric.ccsFull=function(e){var t,n,r,a,i=e[0],o=e[1],l=e[2],s=numeric.ccsDim(e),u=s[0],d=s[1],c=numeric.rep([u,d],0);for(t=0;d>t;t++)for(r=i[t],a=i[t+1],n=r;a>n;++n)c[o[n]][t]=l[n];return c},numeric.ccsTSolve=function(e,t,n,r,a){function i(e){var t;if(0===n[e]){for(n[e]=1,t=o[e];t<o[e+1];++t)i(l[t]);a[c]=e,++c}}var o=e[0],l=e[1],s=e[2],u=o.length-1,d=Math.max,c=0;"undefined"==typeof r&&(n=numeric.rep([u],0)),"undefined"==typeof r&&(r=numeric.linspace(0,n.length-1)),"undefined"==typeof a&&(a=[]);var p,f,h,v,g,m,y;for(p=r.length-1;-1!==p;--p)i(r[p]);for(a.length=c,p=a.length-1;-1!==p;--p)n[a[p]]=0;for(p=r.length-1;-1!==p;--p)f=r[p],n[f]=t[f];for(p=a.length-1;-1!==p;--p){for(f=a[p],h=o[f],v=d(o[f+1],h),g=h;g!==v;++g)if(l[g]===f){n[f]/=s[g];break}for(y=n[f],g=h;g!==v;++g)m=l[g],m!==f&&(n[m]-=y*s[g])}return n},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,n,r,a,i){var o,l,s,u=0,d=a.length,c=this.k,p=this.k1,f=this.j;if(0===r[e])for(r[e]=1,f[0]=e,c[0]=l=t[e],p[0]=s=t[e+1];;)if(l>=s){if(a[d]=f[u],0===u)return;++d,--u,l=c[u],s=p[u]}else o=i[n[l]],0===r[o]?(r[o]=1,c[u]=l,++u,f[u]=o,l=t[o],p[u]=s=t[o+1]):++l},numeric.ccsLPSolve=function(e,t,n,r,a,i,o){var l,s,u,d,c,p,f,h,v,g=e[0],m=e[1],y=e[2],x=(g.length-1,t[0]),b=t[1],w=t[2];for(s=x[a],u=x[a+1],r.length=0,l=s;u>l;++l)o.dfs(i[b[l]],g,m,n,r,i);for(l=r.length-1;-1!==l;--l)n[r[l]]=0;for(l=s;l!==u;++l)d=i[b[l]],n[d]=w[l];for(l=r.length-1;-1!==l;--l){for(d=r[l],c=g[d],p=g[d+1],f=c;p>f;++f)if(i[m[f]]===d){n[d]/=y[f];break}for(v=n[d],f=c;p>f;++f)h=i[m[f]],h!==d&&(n[h]-=v*y[f])}return n},numeric.ccsLUP1=function(e,t){var n,r,a,i,o,l,s,u=e[0].length-1,d=[numeric.rep([u+1],0),[],[]],c=[numeric.rep([u+1],0),[],[]],p=d[0],f=d[1],h=d[2],v=c[0],g=c[1],m=c[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),k=numeric.linspace(0,u-1),z=new numeric.ccsDFS(u);for("undefined"==typeof t&&(t=1),n=0;u>n;++n){for(b(d,e,y,x,n,k,z),i=-1,o=-1,r=x.length-1;-1!==r;--r)a=x[r],n>=a||(l=w(y[a]),l>i&&(o=a,i=l));for(w(y[n])<t*i&&(r=_[n],i=_[o],_[n]=i,k[i]=n,_[o]=r,k[r]=o,i=y[n],y[n]=y[o],y[o]=i),i=p[n],o=v[n],s=y[n],f[i]=_[n],h[i]=1,++i,r=x.length-1;-1!==r;--r)a=x[r],l=y[a],x[r]=0,y[a]=0,n>=a?(g[o]=a,m[o]=l,++o):(f[i]=_[a],h[i]=l/s,++i);p[n+1]=i,v[n+1]=o}for(r=f.length-1;-1!==r;--r)f[r]=k[f[r]];return{L:d,U:c,P:_,Pinv:k}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,n,r,a,i){var o,l,s,u=0,d=a.length,c=this.k,p=this.k1,f=this.j;if(0===r[e])for(r[e]=1,f[0]=e,c[0]=l=t[i[e]],p[0]=s=t[i[e]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=s){if(a[d]=i[f[u]],0===u)return;++d,--u,l=c[u],s=p[u]}else o=n[l],0===r[o]?(r[o]=1,c[u]=l,++u,f[u]=o,o=i[o],l=t[o],p[u]=s=t[o+1]):++l}},numeric.ccsLPSolve0=function(e,t,n,r,a,i,o,l){var s,u,d,c,p,f,h,v,g,m=e[0],y=e[1],x=e[2],b=(m.length-1,t[0]),w=t[1],_=t[2];for(u=b[a],d=b[a+1],r.length=0,s=u;d>s;++s)l.dfs(w[s],m,y,n,r,i,o);for(s=r.length-1;-1!==s;--s)c=r[s],n[o[c]]=0;for(s=u;s!==d;++s)c=w[s],n[c]=_[s];for(s=r.length-1;-1!==s;--s){for(c=r[s],v=o[c],p=m[c],f=m[c+1],h=p;f>h;++h)if(y[h]===v){n[v]/=x[h];break}for(g=n[v],h=p;f>h;++h)n[y[h]]-=g*x[h];n[v]=g}},numeric.ccsLUP0=function(e,t){var n,r,a,i,o,l,s,u=e[0].length-1,d=[numeric.rep([u+1],0),[],[]],c=[numeric.rep([u+1],0),[],[]],p=d[0],f=d[1],h=d[2],v=c[0],g=c[1],m=c[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve0,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),k=numeric.linspace(0,u-1),z=new numeric.ccsDFS0(u);for("undefined"==typeof t&&(t=1),n=0;u>n;++n){for(b(d,e,y,x,n,k,_,z),i=-1,o=-1,r=x.length-1;-1!==r;--r)a=x[r],n>=a||(l=w(y[_[a]]),l>i&&(o=a,i=l));for(w(y[_[n]])<t*i&&(r=_[n],i=_[o],_[n]=i,k[i]=n,_[o]=r,k[r]=o),i=p[n],o=v[n],s=y[_[n]],f[i]=_[n],h[i]=1,++i,r=x.length-1;-1!==r;--r)a=x[r],l=y[_[a]],x[r]=0,y[_[a]]=0,n>=a?(g[o]=a,m[o]=l,++o):(f[i]=_[a],h[i]=l/s,++i);p[n+1]=i,v[n+1]=o}for(r=f.length-1;-1!==r;--r)f[r]=k[f[r]];return{L:d,U:c,P:_,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,n){var r=numeric.ccsDim(e),a=r[0],i=r[1];"undefined"==typeof t?t=numeric.linspace(0,a-1):"number"==typeof t&&(t=[t]),"undefined"==typeof n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]);var o,l,s,u,d,c=t.length,p=n.length,f=numeric.rep([i],0),h=[],v=[],g=[f,h,v],m=e[0],y=e[1],x=e[2],b=numeric.rep([a],0),w=0,_=numeric.rep([a],0);for(l=0;p>l;++l){u=n[l];var k=m[u],z=m[u+1];for(o=k;z>o;++o)s=y[o],_[s]=1,b[s]=x[o];for(o=0;c>o;++o)d=t[o],_[d]&&(h[w]=o,v[w]=b[t[o]],++w);for(o=k;z>o;++o)s=y[o],_[s]=0;f[l+1]=w}return g},numeric.ccsDot=function(e,t){var n,r,a,i,o,l,s,u,d,c,p,f=e[0],h=e[1],v=e[2],g=t[0],m=t[1],y=t[2],x=numeric.ccsDim(e),b=numeric.ccsDim(t),w=x[0],_=(x[1],b[1]),k=numeric.rep([w],0),z=numeric.rep([w],0),A=Array(w),j=numeric.rep([_],0),M=[],E=[],S=[j,M,E];for(a=0;a!==_;++a){for(i=g[a],o=g[a+1],d=0,r=i;o>r;++r)for(c=m[r],p=y[r],l=f[c],s=f[c+1],n=l;s>n;++n)u=h[n],0===z[u]&&(A[d]=u,z[u]=1,d+=1),k[u]=k[u]+v[n]*p;for(i=j[a],o=i+d,j[a+1]=o,r=d-1;-1!==r;--r)p=i+r,n=A[r],M[p]=n,E[p]=k[n],z[n]=0,k[n]=0;j[a+1]=j[a]+d}return S},numeric.ccsLUPSolve=function(e,t){var n=e.L,r=e.U,a=(e.P,t[0]),i=!1;"object"!=typeof a&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],a=t[0],i=!0);var o,l,s,u,d,c,p=t[1],f=t[2],h=n[0].length-1,v=a.length-1,g=numeric.rep([h],0),m=Array(h),y=numeric.rep([h],0),x=Array(h),b=numeric.rep([v+1],0),w=[],_=[],k=numeric.ccsTSolve,z=0;for(o=0;v>o;++o){for(d=0,s=a[o],u=a[o+1],l=s;u>l;++l)c=e.Pinv[p[l]],x[d]=c,y[c]=f[l],++d;for(x.length=d,k(n,y,g,x,m),l=x.length-1;-1!==l;--l)y[x[l]]=0;if(k(r,g,y,m,x),i)return y;for(l=m.length-1;-1!==l;--l)g[m[l]]=0;for(l=x.length-1;-1!==l;--l)c=x[l],w[z]=c,_[z]=y[c],y[c]=0,++z;b[o+1]=z}return[b,w,_]},numeric.ccsbinop=function(e,t){return"undefined"==typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,n=e[0],r=e[1],a=e[2],i=numeric.sup(r)+1,o=n.length,l=numeric.rep([i],0),s=Array(o),u=Array(o),d=numeric.rep([i],0);for(t=0;o>t;++t)d[r[t]]++;for(t=0;i>t;++t)l[t+1]=l[t]+d[t];var c,p,f=l.slice(0);for(t=0;o>t;++t)p=r[t],c=f[p],s[c]=n[t],u[c]=a[t],f[p]=f[p]+1;return[l,s,u]},numeric.ccsGather=function(e){var t,n,r,a,i,o=e[0],l=e[1],s=e[2],u=o.length-1,d=l.length,c=Array(d),p=Array(d),f=Array(d);for(i=0,t=0;u>t;++t)for(r=o[t],a=o[t+1],n=r;n!==a;++n)p[i]=t,c[i]=l[n],f[i]=s[n],++i;return[c,p,f]},numeric.sdim=function s(e,t,n){if("undefined"==typeof t&&(t=[]),"object"!=typeof e)return t;"undefined"==typeof n&&(n=0),n in t||(t[n]=0),e.length>t[n]&&(t[n]=e.length);var r;for(r in e)e.hasOwnProperty(r)&&s(e[r],t,n+1);return t},numeric.sclone=function u(e,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=numeric.sdim(e).length);var r,a=Array(e.length);if(t===n-1){for(r in e)e.hasOwnProperty(r)&&(a[r]=e[r]);return a}for(r in e)e.hasOwnProperty(r)&&(a[r]=u(e[r],t+1,n));return a},numeric.sdiag=function(e){var t,n,r=e.length,a=Array(r);for(t=r-1;t>=1;t-=2)n=t-1,a[t]=[],a[t][t]=e[t],a[n]=[],a[n][n]=e[n];return 0===t&&(a[0]=[],a[0][0]=e[t]),a},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){{var t,n,r,a=[];e.length}for(t in e)if(e.hasOwnProperty(t)){r=e[t];for(n in r)r.hasOwnProperty(n)&&("object"!=typeof a[n]&&(a[n]=[]),a[n][t]=r[n])}return a},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var n,r,a,i,o,l,s,u=e.length,d=(t.length,numeric.stranspose(t)),c=d.length,p=Array(u);for(a=u-1;a>=0;a--){for(s=[],n=e[a],o=c-1;o>=0;o--){l=0,r=d[o];for(i in n)n.hasOwnProperty(i)&&i in r&&(l+=n[i]*r[i]);l&&(s[o]=l)}p[a]=s}return p},numeric.sdotMV=function(e,t){var n,r,a,i,o=e.length,l=Array(o);for(r=o-1;r>=0;r--){n=e[r],i=0;for(a in n)n.hasOwnProperty(a)&&t[a]&&(i+=n[a]*t[a]);i&&(l[r]=i)}return l},numeric.sdotVM=function(e,t){var n,r,a,i,o=[];for(n in e)if(e.hasOwnProperty(n)){a=t[n],i=e[n];for(r in a)a.hasOwnProperty(r)&&(o[r]||(o[r]=0),o[r]+=i*a[r])}return o},numeric.sdotVV=function(e,t){var n,r=0;for(n in e)e[n]&&t[n]&&(r+=e[n]*t[n]);return r},numeric.sdot=function(e,t){var n=numeric.sdim(e).length,r=numeric.sdim(t).length,a=1e3*n+r;switch(a){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(e){var t,n,r,a,i=e[0].length,o=e.length,l=[];for(n=i-1;n>=0;--n)if(e[o-1][n]){for(a=l,r=0;o-2>r;r++)t=e[r][n],a[t]||(a[t]=[]),a=a[t];a[e[r][n]]=e[r+1][n]}return l},numeric.sgather=function d(e,t,n){"undefined"==typeof t&&(t=[]),"undefined"==typeof n&&(n=[]);var r,a,i;r=n.length;for(a in e)if(e.hasOwnProperty(a))if(n[r]=parseInt(a),i=e[a],"number"==typeof i){if(i){if(0===t.length)for(a=r+1;a>=0;--a)t[a]=[];for(a=r;a>=0;--a)t[a].push(n[a]);t[r+1].push(i)}}else d(i,t,n);return n.length>r&&n.pop(),t},numeric.cLU=function(e){var t,n,r,a,i,o,l=e[0],s=e[1],u=e[2],d=l.length,c=0;for(t=0;d>t;t++)l[t]>c&&(c=l[t]);c++;var p,f,h,v=Array(c),g=Array(c),m=numeric.rep([c],1/0),y=numeric.rep([c],-1/0);for(r=0;d>r;r++)t=l[r],n=s[r],n<m[t]&&(m[t]=n),n>y[t]&&(y[t]=n);for(t=0;c-1>t;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=c-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);var x=0,b=0;for(t=0;c>t;t++)g[t]=numeric.rep([y[t]-m[t]+1],0),v[t]=numeric.rep([t-m[t]],0),x+=t-m[t]+1,b+=y[t]-t+1;for(r=0;d>r;r++)t=l[r],g[t][s[r]-m[t]]=u[r];for(t=0;c-1>t;t++)for(a=t-m[t],p=g[t],n=t+1;m[n]<=t&&c>n;n++)if(i=t-m[n],o=y[t]-t,f=g[n],h=f[i]/p[a]){for(r=1;o>=r;r++)f[r+i]-=h*p[r+a];v[n][t-m[n]]=h}var d,w,_,p=[],f=[],k=[],z=[],A=[],j=[];for(d=0,w=0,t=0;c>t;t++){for(a=m[t],i=y[t],_=g[t],n=t;i>=n;n++)_[n-a]&&(p[d]=t,f[d]=n,k[d]=_[n-a],d++);for(_=v[t],n=a;t>n;n++)_[n-a]&&(z[w]=t,A[w]=n,j[w]=_[n-a],w++);z[w]=t,A[w]=t,j[w]=1,w++}return{U:[p,f,k],L:[z,A,j]}},numeric.cLUsolve=function(e,t){var n,r,a=e.L,i=e.U,o=numeric.clone(t),l=a[0],s=a[1],u=a[2],d=i[0],c=i[1],p=i[2],f=d.length,h=(l.length,o.length);for(r=0,n=0;h>n;n++){for(;s[r]<n;)o[n]-=u[r]*o[s[r]],r++;r++}for(r=f-1,n=h-1;n>=0;n--){for(;c[r]>n;)o[n]-=p[r]*o[c[r]],r--;o[n]/=p[r],r--}return o},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var n,r,a,i=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=e[0]/2||n<e[1]/2};break;default:t=function(){return!0}}for(a=0,n=1;n<e[0]-1;n++)for(r=1;r<e[1]-1;r++)t(n,r)&&(i[n][r]=a,a++);return i},numeric.cdelsq=function(e){var t,n,r,a,i,o=[[-1,0],[0,-1],[0,1],[1,0]],l=numeric.dim(e),s=l[0],u=l[1],d=[],c=[],p=[];for(t=1;s-1>t;t++)for(n=1;u-1>n;n++)if(!(e[t][n]<0)){for(r=0;4>r;r++)a=t+o[r][0],i=n+o[r][1],e[a][i]<0||(d.push(e[t][n]),c.push(e[a][i]),p.push(-1));d.push(e[t][n]),c.push(e[t][n]),p.push(4)}return[d,c,p]},numeric.cdotMV=function(e,t){var n,r,a,i=e[0],o=e[1],l=e[2],s=i.length;for(a=0,r=0;s>r;r++)i[r]>a&&(a=i[r]);for(a++,n=numeric.rep([a],0),r=0;s>r;r++)n[i[r]]+=l[r]*t[o[r]];return n},numeric.Spline=function(e,t,n,r,a){this.x=e,this.yl=t,this.yr=n,this.kl=r,this.kr=a},numeric.Spline.prototype._at=function(e,t){var e,n,r,a,i=this.x,o=this.yl,l=this.yr,s=this.kl,u=this.kr,d=numeric.add,c=numeric.sub,p=numeric.mul;n=c(p(s[t],i[t+1]-i[t]),c(l[t+1],o[t])),r=d(p(u[t+1],i[t]-i[t+1]),c(l[t+1],o[t])),a=(e-i[t])/(i[t+1]-i[t]);var f=a*(1-a);return d(d(d(p(1-a,o[t]),p(a,l[t+1])),p(n,f*(1-a))),p(r,f*a))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,n,r,a=this.x,i=a.length,o=Math.floor;for(t=0,n=i-1;n-t>1;)r=o((t+n)/2),a[r]<=e?t=r:n=r;return this._at(e,t)}var l,i=e.length,s=Array(i);for(l=i-1;-1!==l;--l)s[l]=this.at(e[l]);return s},numeric.Spline.prototype.diff=function(){var e,t,n,r=this.x,a=this.yl,i=this.yr,o=this.kl,l=this.kr,s=a.length,u=o,d=l,c=Array(s),p=Array(s),f=numeric.add,h=numeric.mul,v=numeric.div,g=numeric.sub;for(e=s-1;-1!==e;--e)t=r[e+1]-r[e],n=g(i[e+1],a[e]),c[e]=v(f(h(n,6),h(o[e],-4*t),h(l[e+1],-2*t)),t*t),p[e+1]=v(f(h(n,-6),h(o[e],2*t),h(l[e+1],4*t)),t*t);return new numeric.Spline(r,u,d,c,p)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],n=this.x,r=this.yl,a=this.yr,i=this.kl,o=this.kr;"number"==typeof r[0]&&(r=[r],a=[a],i=[i],o=[o]);var l,s,u,d,c,p,f,h,v,g,m,y,x,b,w,_,k,z,A,j,M,E,S,T,O=r.length,F=n.length-1,t=Array(O),V=Math.sqrt;for(l=0;l!==O;++l){for(d=r[l],c=a[l],p=i[l],f=o[l],h=[],s=0;s!==F;s++){for(s>0&&c[s]*d[s]<0&&h.push(n[s]),_=n[s+1]-n[s],k=n[s],m=d[s],y=c[s+1],v=p[s]/_,g=f[s+1]/_,w=e(v-g+3*(m-y))+12*g*m,x=g+3*m+2*v-3*y,b=3*(g+v+2*(m-y)),0>=w?(A=x/b,z=A>n[s]&&A<n[s+1]?[n[s],A,n[s+1]]:[n[s],n[s+1]]):(A=(x-V(w))/b,j=(x+V(w))/b,z=[n[s]],A>n[s]&&A<n[s+1]&&z.push(A),j>n[s]&&j<n[s+1]&&z.push(j),z.push(n[s+1])),E=z[0],A=this._at(E,s),u=0;u<z.length-1;u++)if(S=z[u+1],j=this._at(S,s),0!==A)if(0===j||A*j>0)E=S,A=j;else{for(var N=0;;){if(T=(A*S-j*E)/(A-j),E>=T||T>=S)break;if(M=this._at(T,s),M*j>0)S=T,j=M,-1===N&&(A*=.5),N=-1;else{if(!(M*A>0))break;E=T,A=M,1===N&&(j*=.5),N=1}}h.push(T),E=z[u+1],A=this._at(E,s)}else h.push(E),E=S,A=j;0===j&&h.push(S)}t[l]=h}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,n,r){var a,i=e.length,o=[],l=[],s=[],u=numeric.sub,d=numeric.mul,c=numeric.add;for(a=i-2;a>=0;a--)l[a]=e[a+1]-e[a],s[a]=u(t[a+1],t[a]);("string"==typeof n||"string"==typeof r)&&(n=r="periodic");var p=[[],[],[]];switch(typeof n){case"undefined":o[0]=d(3/(l[0]*l[0]),s[0]),p[0].push(0,0),p[1].push(0,1),p[2].push(2/l[0],1/l[0]);break;case"string":o[0]=c(d(3/(l[i-2]*l[i-2]),s[i-2]),d(3/(l[0]*l[0]),s[0])),p[0].push(0,0,0),p[1].push(i-2,0,1),p[2].push(1/l[i-2],2/l[i-2]+2/l[0],1/l[0]);break;default:o[0]=n,p[0].push(0),p[1].push(0),p[2].push(1)}for(a=1;i-1>a;a++)o[a]=c(d(3/(l[a-1]*l[a-1]),s[a-1]),d(3/(l[a]*l[a]),s[a])),p[0].push(a,a,a),p[1].push(a-1,a,a+1),p[2].push(1/l[a-1],2/l[a-1]+2/l[a],1/l[a]);switch(typeof r){case"undefined":o[i-1]=d(3/(l[i-2]*l[i-2]),s[i-2]),p[0].push(i-1,i-1),p[1].push(i-2,i-1),p[2].push(1/l[i-2],2/l[i-2]);break;case"string":p[1][p[1].length-1]=0;break;default:o[i-1]=r,p[0].push(i-1),p[1].push(i-1),p[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var f=Array(o.length);if("string"==typeof n)for(a=f.length-1;-1!==a;--a)f[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(p)),o[a]),f[a][i-1]=f[a][0];else for(a=f.length-1;-1!==a;--a)f[a]=numeric.cLUsolve(numeric.cLU(p),o[a]);return f="number"==typeof t[0]?f[0]:numeric.transpose(f),new numeric.Spline(e,t,t,f,f)},numeric.fftpow2=function c(e,t){var n=e.length;if(1!==n){var r,a,i=Math.cos,o=Math.sin,l=Array(n/2),s=Array(n/2),u=Array(n/2),d=Array(n/2);for(a=n/2,r=n-1;-1!==r;--r)--a,u[a]=e[r],d[a]=t[r],--r,l[a]=e[r],s[a]=t[r];c(l,s),c(u,d),a=n/2;var p,f,h,v=-6.283185307179586/n;for(r=n-1;-1!==r;--r)--a,-1===a&&(a=n/2-1),p=v*r,f=i(p),h=o(p),e[r]=l[a]+f*u[a]-h*d[a],t[r]=s[a]+f*d[a]+h*u[a]}},numeric._ifftpow2=function p(e,t){var n=e.length;if(1!==n){var r,a,i=Math.cos,o=Math.sin,l=Array(n/2),s=Array(n/2),u=Array(n/2),d=Array(n/2);for(a=n/2,r=n-1;-1!==r;--r)--a,u[a]=e[r],d[a]=t[r],--r,l[a]=e[r],s[a]=t[r];p(l,s),p(u,d),a=n/2;var c,f,h,v=6.283185307179586/n;for(r=n-1;-1!==r;--r)--a,-1===a&&(a=n/2-1),c=v*r,f=i(c),h=o(c),e[r]=l[a]+f*u[a]-h*d[a],t[r]=s[a]+f*d[a]+h*u[a]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,n,r){numeric.fftpow2(e,t),numeric.fftpow2(n,r);var a,i,o,l,s,u=e.length;for(a=u-1;-1!==a;--a)i=e[a],l=t[a],o=n[a],s=r[a],e[a]=i*o-l*s,t[a]=i*s+l*o;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){{var e,t,n=this.x,r=this.y,a=n.length,i=Math.log,o=i(2),l=Math.ceil(i(2*a-1)/o),s=Math.pow(2,l),u=numeric.rep([s],0),d=numeric.rep([s],0),c=Math.cos,p=Math.sin,f=-3.141592653589793/a,h=numeric.rep([s],0),v=numeric.rep([s],0);Math.floor(a/2)}for(e=0;a>e;e++)h[e]=n[e];if("undefined"!=typeof r)for(e=0;a>e;e++)v[e]=r[e];for(u[0]=1,e=1;s/2>=e;e++)t=f*e*e,u[e]=c(t),d[e]=p(t),u[s-e]=c(t),d[s-e]=p(t);var g=new numeric.T(h,v),m=new numeric.T(u,d);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),g=g.mul(m),g.x.length=a,g.y.length=a,g},numeric.T.prototype.ifft=function(){{var e,t,n=this.x,r=this.y,a=n.length,i=Math.log,o=i(2),l=Math.ceil(i(2*a-1)/o),s=Math.pow(2,l),u=numeric.rep([s],0),d=numeric.rep([s],0),c=Math.cos,p=Math.sin,f=3.141592653589793/a,h=numeric.rep([s],0),v=numeric.rep([s],0);Math.floor(a/2)}for(e=0;a>e;e++)h[e]=n[e];if("undefined"!=typeof r)for(e=0;a>e;e++)v[e]=r[e];for(u[0]=1,e=1;s/2>=e;e++)t=f*e*e,u[e]=c(t),d[e]=p(t),u[s-e]=c(t),d[s-e]=p(t);var g=new numeric.T(h,v),m=new numeric.T(u,d);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),g=g.mul(m),g.x.length=a,g.y.length=a,g.div(a)},numeric.gradient=function(e,t){var n=t.length,r=e(t);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var a,i,o,l,s,u,d,c,p,f,h=Math.max,v=numeric.clone(t),g=Array(n),h=(numeric.div,numeric.sub,Math.max),m=.001,y=Math.abs,x=Math.min,b=0;for(a=0;n>a;a++)for(var w=h(1e-6*r,1e-8);;){if(++b,b>20)throw new Error("Numerical gradient fails");if(v[a]=t[a]+w,i=e(v),v[a]=t[a]-w,o=e(v),v[a]=t[a],isNaN(i)||isNaN(o))w/=16;else{if(g[a]=(i-o)/(2*w),s=t[a]-w,u=t[a],d=t[a]+w,c=(i-r)/w,p=(r-o)/w,f=h(y(g[a]),y(r),y(i),y(o),y(s),y(u),y(d),1e-8),l=x(h(y(c-g[a]),y(p-g[a]),y(c-p))/f,w/f),!(l>m))break;w/=16}}return g},numeric.uncmin=function(e,t,n,r,a,i,o){var l=numeric.gradient;"undefined"==typeof o&&(o={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof r&&(r=function(t){return l(e,t)}),"undefined"==typeof a&&(a=1e3),t=numeric.clone(t);var s,u,d=t.length,c=e(t);if(isNaN(c))throw new Error("uncmin: f(x0) is a NaN!");var p=Math.max,f=numeric.norm2;n=p(n,numeric.epsilon);var h,v,g,m,y,x,b,w,_,k,z=o.Hinv||numeric.identity(d),A=numeric.dot,j=(numeric.inv,numeric.sub),M=numeric.add,E=numeric.tensor,S=numeric.div,T=numeric.mul,O=numeric.all,F=numeric.isFinite,V=numeric.neg,N=0,B="";for(v=r(t);a>N;){if("function"==typeof i&&i(N,t,c,v,z)){B="Callback returned true";break}if(!O(F(v))){B="Gradient has Infinity or NaN";break}if(h=V(A(z,v)),!O(F(h))){B="Search direction has Infinity or NaN";break}if(k=f(h),n>k){B="Newton step smaller than tol";break}for(_=1,u=A(v,h),y=t;a>N&&!(n>_*k)&&(m=T(h,_),y=M(t,m),s=e(y),s-c>=.1*_*u||isNaN(s));)_*=.5,++N;if(n>_*k){B="Line search step size smaller than tol";break}if(N===a){B="maxit reached during line search";break}g=r(y),x=j(g,v),w=A(x,m),b=A(z,x),z=j(M(z,T((w+A(x,b))/(w*w),E(m,m))),S(M(E(b,m),E(m,b)),w)),t=y,c=s,v=g,++N}return{solution:t,f:c,gradient:v,invHessian:z,iterations:N,message:B}},numeric.Dopri=function(e,t,n,r,a,i,o){this.x=e,this.y=t,this.f=n,this.ymid=r,this.iterations=a,this.events=o,this.message=i},numeric.Dopri.prototype._at=function(e,t){function n(e){return e*e}var r,a,i,o,l,s,e,u,d,c,p,f=this,h=f.x,v=f.y,g=f.f,m=f.ymid,y=(h.length,Math.floor,.5),x=numeric.add,b=numeric.mul,w=numeric.sub;return r=h[t],a=h[t+1],o=v[t],l=v[t+1],u=a-r,i=r+y*u,s=m[t],d=w(g[t],b(o,1/(r-i)+2/(r-a))),c=w(g[t+1],b(l,1/(a-i)+2/(a-r))),p=[n(e-a)*(e-i)/n(r-a)/(r-i),n(e-r)*n(e-a)/n(r-i)/n(a-i),n(e-r)*(e-i)/n(a-r)/(a-i),(e-r)*n(e-a)*(e-i)/n(r-a)/(r-i),(e-a)*n(e-r)*(e-i)/n(r-a)/(a-i)],x(x(x(x(b(o,p[0]),b(s,p[1])),b(l,p[2])),b(d,p[3])),b(c,p[4]))},numeric.Dopri.prototype.at=function(e){var t,n,r,a=Math.floor;if("number"!=typeof e){var i=e.length,o=Array(i);for(t=i-1;-1!==t;--t)o[t]=this.at(e[t]);return o}var l=this.x;for(t=0,n=l.length-1;n-t>1;)r=a(.5*(t+n)),l[r]<=e?t=r:n=r;return this._at(e,t)},numeric.dopri=function(e,t,n,r,a,i,o){"undefined"==typeof a&&(a=1e-6),"undefined"==typeof i&&(i=1e3);var l,s,u,d,c,p,f,h,v,g,m,y,x,b=[e],w=[n],_=[r(e,n)],k=[],z=.2,A=[.075,.225],j=[44/45,-56/15,32/9],M=[19372/6561,-25360/2187,64448/6561,-212/729],E=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],T=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],O=[.2,.3,.8,8/9,1,1],F=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],V=0,N=(t-e)/10,B=0,I=numeric.add,q=numeric.mul,C=(Math.max,Math.min),P=Math.abs,L=numeric.norminf,U=Math.pow,D=numeric.any,R=numeric.lt,H=numeric.and,Y=(numeric.sub,new numeric.Dopri(b,w,_,k,-1,""));for("function"==typeof o&&(m=o(e,n));t>e&&i>B;)if(++B,e+N>t&&(N=t-e),l=r(e+O[0]*N,I(n,q(z*N,_[V]))),s=r(e+O[1]*N,I(I(n,q(A[0]*N,_[V])),q(A[1]*N,l))),u=r(e+O[2]*N,I(I(I(n,q(j[0]*N,_[V])),q(j[1]*N,l)),q(j[2]*N,s))),d=r(e+O[3]*N,I(I(I(I(n,q(M[0]*N,_[V])),q(M[1]*N,l)),q(M[2]*N,s)),q(M[3]*N,u))),c=r(e+O[4]*N,I(I(I(I(I(n,q(E[0]*N,_[V])),q(E[1]*N,l)),q(E[2]*N,s)),q(E[3]*N,u)),q(E[4]*N,d))),v=I(I(I(I(I(n,q(_[V],N*S[0])),q(s,N*S[2])),q(u,N*S[3])),q(d,N*S[4])),q(c,N*S[5])),p=r(e+N,v),f=I(I(I(I(I(q(_[V],N*F[0]),q(s,N*F[2])),q(u,N*F[3])),q(d,N*F[4])),q(c,N*F[5])),q(p,N*F[6])),g="number"==typeof f?P(f):L(f),g>a){if(N=.2*N*U(a/g,.25),e+N===e){Y.msg="Step size became too small";break}}else{if(k[V]=I(I(I(I(I(I(n,q(_[V],N*T[0])),q(s,N*T[2])),q(u,N*T[3])),q(d,N*T[4])),q(c,N*T[5])),q(p,N*T[6])),++V,b[V]=e+N,w[V]=v,_[V]=p,"function"==typeof o){var X,G,W=e,Q=e+.5*N;if(y=o(Q,k[V-1]),x=H(R(m,0),R(0,y)),D(x)||(W=Q,Q=e+N,m=y,y=o(Q,v),x=H(R(m,0),R(0,y))),D(x)){for(var J,Z,K=0,$=1,et=1;;){if("number"==typeof m)G=(et*y*W-$*m*Q)/(et*y-$*m);else for(G=Q,h=m.length-1;-1!==h;--h)m[h]<0&&y[h]>0&&(G=C(G,(et*y[h]*W-$*m[h]*Q)/(et*y[h]-$*m[h])));if(W>=G||G>=Q)break;X=Y._at(G,V-1),Z=o(G,X),J=H(R(m,0),R(0,Z)),D(J)?(Q=G,y=Z,x=J,et=1,-1===K?$*=.5:$=1,K=-1):(W=G,m=Z,$=1,1===K?et*=.5:et=1,K=1)}return v=Y._at(.5*(e+G),V-1),Y.f[V]=r(G,X),Y.x[V]=G,Y.y[V]=X,Y.ymid[V-1]=v,Y.events=x,Y.iterations=B,Y}}e+=N,n=v,m=y,N=C(.8*N*U(a/g,.25),4*N)}return Y.iterations=B,Y},numeric.LU=function(e,t){t=t||!1;var n,r,a,i,o,l,s,u,d,c=Math.abs,p=e.length,f=p-1,h=new Array(p);for(t||(e=numeric.clone(e)),a=0;p>a;++a){for(s=a,l=e[a],d=c(l[a]),r=a+1;p>r;++r)i=c(e[r][a]),i>d&&(d=i,s=r);for(h[a]=s,s!=a&&(e[a]=e[s],e[s]=l,l=e[a]),o=l[a],n=a+1;p>n;++n)e[n][a]/=o;for(n=a+1;p>n;++n){for(u=e[n],r=a+1;f>r;++r)u[r]-=u[a]*l[r],++r,u[r]-=u[a]*l[r];r===f&&(u[r]-=u[a]*l[r])}}return{LU:e,P:h}},numeric.LUsolve=function(e,t){var n,r,a,i,o,l=e.LU,s=l.length,u=numeric.clone(t),d=e.P;for(n=s-1;-1!==n;--n)u[n]=t[n];for(n=0;s>n;++n)for(a=d[n],d[n]!==n&&(o=u[n],u[n]=u[a],u[a]=o),i=l[n],r=0;n>r;++r)u[n]-=u[r]*i[r];for(n=s-1;n>=0;--n){for(i=l[n],r=n+1;s>r;++r)u[n]-=u[r]*i[r];u[n]/=i[n]}return u},numeric.solve=function(e,t,n){return numeric.LUsolve(numeric.LU(e,n),t)},numeric.echelonize=function(e){var t,n,r,a,i,o,l,s,u=numeric.dim(e),d=u[0],c=u[1],p=numeric.identity(d),f=Array(d),h=Math.abs,v=numeric.diveq;for(e=numeric.clone(e),t=0;d>t;++t){for(r=0,i=e[t],o=p[t],n=1;c>n;++n)h(i[r])<h(i[n])&&(r=n);for(f[t]=r,v(o,i[r]),v(i,i[r]),n=0;d>n;++n)if(n!==t){for(l=e[n],s=l[r],a=c-1;-1!==a;--a)l[a]-=i[a]*s;for(l=p[n],a=d-1;-1!==a;--a)l[a]-=o[a]*s}}return{I:p,A:e,P:f}},numeric.__solveLP=function(e,t,n,r,a,i,o){var l,s,u,d,c=numeric.sum,p=(numeric.log,numeric.mul),f=numeric.sub,h=numeric.dot,v=numeric.div,g=numeric.add,m=e.length,y=n.length,x=!1,b=0,w=1,_=(numeric.transpose(t),numeric.svd,numeric.transpose),k=(numeric.leq,Math.sqrt),z=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),j=numeric.all,M=numeric.gt,E=Array(m),S=Array(y),T=(numeric.rep([y],1),numeric.solve),O=f(n,h(t,i)),F=h(e,e);for(u=b;a>u;++u){var V,N;for(V=y-1;-1!==V;--V)S[V]=v(t[V],O[V]);var B=_(S);for(V=m-1;-1!==V;--V)E[V]=c(B[V]);w=.25*z(F/h(e,E));var I=100*k(F/h(E,E));for((!isFinite(w)||w>I)&&(w=I),d=g(e,p(w,E)),s=h(B,S),V=m-1;-1!==V;--V)s[V][V]+=1;N=T(s,v(d,w),!0);var q=v(O,h(t,N)),C=1;for(V=y-1;-1!==V;--V)q[V]<0&&(C=A(C,-.999*q[V]));if(l=f(i,p(N,C)),O=f(n,h(t,l)),!j(M(O,0)))return{solution:i,message:"",iterations:u};if(i=l,r>w)return{solution:l,message:"",iterations:u};if(o){var P=h(e,d),L=h(t,d);for(x=!0,V=y-1;-1!==V;--V)if(P*L[V]<0){x=!1;break}}else x=i[m-1]>=0?!1:!0;if(x)return{solution:l,message:"Unbounded",iterations:u}}return{solution:i,message:"maximum iteration count exceeded",iterations:u}},numeric._solveLP=function(e,t,n,r,a){var i,o=e.length,l=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,d=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([l,1],-1),p=numeric.blockMatrix([[t,c]]),f=n,i=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),h=numeric.__solveLP(d,p,f,r,a,i,!1),v=numeric.clone(h.solution);v.length=o;var g=numeric.inf(s(n,u(t,v)));if(0>g)return{solution:0/0,message:"Infeasible",iterations:h.iterations};var m=numeric.__solveLP(e,t,n,r,a-h.iterations,v,!0);return m.iterations+=h.iterations,m},numeric.solveLP=function(e,t,n,r,a,i,o){if("undefined"==typeof o&&(o=1e3),"undefined"==typeof i&&(i=numeric.epsilon),"undefined"==typeof r)return numeric._solveLP(e,t,n,i,o);var l,s=r.length,u=r[0].length,d=t.length,c=numeric.echelonize(r),p=numeric.rep([u],0),f=c.P,h=[];for(l=f.length-1;-1!==l;--l)p[f[l]]=1;for(l=u-1;-1!==l;--l)0===p[l]&&h.push(l);var v=numeric.getRange,g=numeric.linspace(0,s-1),m=numeric.linspace(0,d-1),y=v(r,g,h),x=v(t,m,f),b=v(t,m,h),w=numeric.dot,_=numeric.sub,k=w(x,c.I),z=_(b,w(k,y)),A=_(n,w(k,a)),j=Array(f.length),M=Array(h.length);for(l=f.length-1;-1!==l;--l)j[l]=e[f[l]];for(l=h.length-1;-1!==l;--l)M[l]=e[h[l]];var E=_(M,w(j,w(c.I,y))),S=numeric._solveLP(E,z,A,i,o),T=S.solution;if(T!==T)return S;var O=w(c.I,_(a,w(y,T))),F=Array(e.length);for(l=f.length-1;-1!==l;--l)F[f[l]]=O[l];for(l=h.length-1;-1!==l;--l)F[h[l]]=T[l];return{solution:F,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(e){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+n+": "+e[n]+"\nCurrent state: "+l[o]+"\n")}e instanceof String&&e.split("\n");var n,r,a,i,o=0,l=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=e.length,u=0,d={},c=[],p=0,f={},h=0,v=[],g=[],m=[];for(n=0;s>n;++n){a=e[n];var y=a.match(/\S*/g),x=[];
for(r=0;r<y.length;++r)""!==y[r]&&x.push(y[r]);if(0!==x.length){for(r=0;r<l.length&&a.substr(0,l[r].length)!==l[r];++r);if(r<l.length){if(o=r,1===r&&(i=x[1]),6===r)return{name:i,c:v,A:numeric.transpose(g),b:m,rows:d,vars:f}}else switch(o){case 0:case 1:t("Unexpected line");case 2:switch(x[0]){case"N":0===u?u=x[1]:t("Two or more N rows");break;case"L":d[x[1]]=p,c[p]=1,m[p]=0,++p;break;case"G":d[x[1]]=p,c[p]=-1,m[p]=0,++p;break;case"E":d[x[1]]=p,c[p]=0,m[p]=0,++p;break;default:t("Parse error "+numeric.prettyPrint(x))}break;case 3:f.hasOwnProperty(x[0])||(f[x[0]]=h,v[h]=0,g[h]=numeric.rep([p],0),++h);var b=f[x[0]];for(r=1;r<x.length;r+=2)if(x[r]!==u){var w=d[x[r]];g[b][w]=(c[w]<0?-1:1)*parseFloat(x[r+1])}else v[b]=parseFloat(x[r+1]);break;case 4:for(r=1;r<x.length;r+=2)m[d[x[r]]]=(c[d[x[r]]]<0?-1:1)*parseFloat(x[r+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,r,a,i,o){function l(e){var t,r,a=this,i=e.length,o=0,l=a.i=a.j=a.m=0;for(a.S=[],a.c=[],i||(e=[i++]);n>o;)a.S[o]=o++;for(o=0;n>o;o++)t=a.S[o],l=d(l+t+e[o%i]),r=a.S[l],a.S[o]=r,a.S[l]=t;a.g=function(e){var t=a.S,r=d(a.i+1),i=t[r],o=d(a.j+i),l=t[o];t[r]=l,t[o]=i;for(var s=t[d(i+l)];--e;)r=d(r+1),i=t[r],o=d(o+i),l=t[o],t[r]=l,t[o]=i,s=s*n+t[d(i+l)];return a.i=r,a.j=o,s},a.g(n)}function s(e,t,n,r,a){if(n=[],a=typeof e,t&&"object"==a)for(r in e)if(r.indexOf("S")<5)try{n.push(s(e[r],t-1))}catch(i){}return n.length?n:e+("string"!=a?"\x00":"")}function u(e,t,n,r){for(e+="",n=0,r=0;r<e.length;r++)t[d(r)]=d((n^=19*t[d(r)])+e.charCodeAt(r));e="";for(r in t)e+=String.fromCharCode(t[r]);return e}function d(e){return e&n-1}t.seedrandom=function(d,c){var p,f=[];return d=u(s(c?[d,e]:arguments.length?d:[(new Date).getTime(),e,window],3),f),p=new l(f),u(p.S,e),t.random=function(){for(var e=p.g(r),t=o,l=0;a>e;)e=(e+l)*n,t*=n,l=p.g(1);for(;e>=i;)e/=2,t/=2,l>>>=1;return(e+l)/t},d},o=t.pow(n,r),a=t.pow(2,a),i=2*a,u(t.random(),e)}([],numeric.seedrandom,256,6,52),function(e){function t(e){if("object"!=typeof e)return e;var n,r=[],a=e.length;for(n=0;a>n;n++)r[n+1]=t(e[n]);return r}function n(e){if("object"!=typeof e)return e;var t,r=[],a=e.length;for(t=1;a>t;t++)r[t-1]=n(e[t]);return r}function r(e,t,n){var r,a,i,o,l;for(i=1;n>=i;i+=1){for(e[i][i]=1/e[i][i],l=-e[i][i],r=1;i>r;r+=1)e[r][i]=l*e[r][i];if(o=i+1,o>n)break;for(a=o;n>=a;a+=1)for(l=e[i][a],e[i][a]=0,r=1;i>=r;r+=1)e[r][a]=e[r][a]+l*e[r][i]}}function a(e,t,n,r){var a,i,o,l;for(i=1;n>=i;i+=1){for(l=0,a=1;i>a;a+=1)l+=e[a][i]*r[a];r[i]=(r[i]-l)/e[i][i]}for(o=1;n>=o;o+=1)for(i=n+1-o,r[i]=r[i]/e[i][i],l=-r[i],a=1;i>a;a+=1)r[a]=r[a]+l*e[a][i]}function i(e,t,n,r){var a,i,o,l,s,u;for(i=1;n>=i;i+=1){if(r[1]=i,u=0,o=i-1,1>o){if(u=e[i][i]-u,0>=u)break;e[i][i]=Math.sqrt(u)}else{for(l=1;o>=l;l+=1){for(s=e[l][i],a=1;l>a;a+=1)s-=e[a][i]*e[a][l];s/=e[l][l],e[l][i]=s,u+=s*s}if(u=e[i][i]-u,0>=u)break;e[i][i]=Math.sqrt(u)}r[1]=0}}function o(e,t,n,o,l,s,u,d,c,p,f,h,v,g,m,y){function x(){for(g[1]=g[1]+1,j=V,z=1;p>=z;z+=1){for(j+=1,P=-d[z],A=1;o>=A;A+=1)P+=u[A][z]*l[A];if(Math.abs(P)<G&&(P=0),z>f)m[j]=P;else if(m[j]=-Math.abs(P),P>0){for(A=1;o>=A;A+=1)u[A][z]=-u[A][z];d[z]=-d[z]}}for(z=1;v>=z;z+=1)m[V+h[z]]=0;for(B=0,C=0,z=1;p>=z;z+=1)m[V+z]<C*m[q+z]&&(B=z,C=m[V+z]/m[q+z]);return 0===B?999:0}function b(){for(z=1;o>=z;z+=1){for(P=0,A=1;o>=A;A+=1)P+=e[A][z]*u[A][B];m[z]=P}for(M=T,z=1;o>=z;z+=1)m[M+z]=0;for(A=v+1;o>=A;A+=1)for(z=1;o>=z;z+=1)m[M+z]=m[M+z]+e[z][A]*m[A];for(Y=!0,z=v;z>=1;z-=1){for(P=m[z],j=F+z*(z+3)/2,M=j-z,A=z+1;v>=A;A+=1)P-=m[j]*m[O+A],j+=A;if(P/=m[M],m[O+z]=P,h[z]<f)break;if(0>P)break;Y=!1,S=z}if(!Y)for(L=m[N+S]/m[O+S],z=1;v>=z&&!(h[z]<f)&&!(m[O+z]<0);z+=1)C=m[N+z]/m[O+z],L>C&&(L=C,S=z);for(P=0,z=T+1;T+o>=z;z+=1)P+=m[z]*m[z];if(Math.abs(P)<=G){if(Y)return y[1]=1,999;for(z=1;v>=z;z+=1)m[N+z]=m[N+z]-L*m[O+z];return m[N+v+1]=m[N+v+1]+L,700}for(P=0,z=1;o>=z;z+=1)P+=m[T+z]*u[z][B];for(U=-m[V+B]/P,X=!0,Y||U>L&&(U=L,X=!1),z=1;o>=z;z+=1)l[z]=l[z]+U*m[T+z],Math.abs(l[z])<G&&(l[z]=0);for(s[1]=s[1]+U*P*(U/2+m[N+v+1]),z=1;v>=z;z+=1)m[N+z]=m[N+z]-U*m[O+z];if(m[N+v+1]=m[N+v+1]+U,!X){for(P=-d[B],A=1;o>=A;A+=1)P+=l[A]*u[A][B];if(B>f)m[V+B]=P;else if(m[V+B]=-Math.abs(P),P>0){for(A=1;o>=A;A+=1)u[A][B]=-u[A][B];d[B]=-d[B]}return 700}for(v+=1,h[v]=B,j=F+(v-1)*v/2+1,z=1;v-1>=z;z+=1)m[j]=m[z],j+=1;if(v===o)m[j]=m[o];else{for(z=o;z>=v+1&&0!==m[z]&&(D=Math.max(Math.abs(m[z-1]),Math.abs(m[z])),R=Math.min(Math.abs(m[z-1]),Math.abs(m[z])),C=m[z-1]>=0?Math.abs(D*Math.sqrt(1+R*R/(D*D))):-Math.abs(D*Math.sqrt(1+R*R/(D*D))),D=m[z-1]/C,R=m[z]/C,1!==D);z-=1)if(0===D)for(m[z-1]=R*C,A=1;o>=A;A+=1)C=e[A][z-1],e[A][z-1]=e[A][z],e[A][z]=C;else for(m[z-1]=C,H=R/(1+D),A=1;o>=A;A+=1)C=D*e[A][z-1]+R*e[A][z],e[A][z]=H*(e[A][z-1]+C)-e[A][z],e[A][z-1]=C;m[j]=m[v]}return 0}function w(){if(j=F+S*(S+1)/2+1,M=j+S,0===m[M])return 798;if(D=Math.max(Math.abs(m[M-1]),Math.abs(m[M])),R=Math.min(Math.abs(m[M-1]),Math.abs(m[M])),C=m[M-1]>=0?Math.abs(D*Math.sqrt(1+R*R/(D*D))):-Math.abs(D*Math.sqrt(1+R*R/(D*D))),D=m[M-1]/C,R=m[M]/C,1===D)return 798;if(0===D){for(z=S+1;v>=z;z+=1)C=m[M-1],m[M-1]=m[M],m[M]=C,M+=z;for(z=1;o>=z;z+=1)C=e[z][S],e[z][S]=e[z][S+1],e[z][S+1]=C}else{for(H=R/(1+D),z=S+1;v>=z;z+=1)C=D*m[M-1]+R*m[M],m[M]=H*(m[M-1]+C)-m[M],m[M-1]=C,M+=z;for(z=1;o>=z;z+=1)C=D*e[z][S]+R*e[z][S+1],e[z][S+1]=H*(e[z][S]+C)-e[z][S+1],e[z][S]=C}return 0}function _(){for(M=j-S,z=1;S>=z;z+=1)m[M]=m[j],j+=1,M+=1;return m[N+S]=m[N+S+1],h[S]=h[S+1],S+=1,v>S?797:0}function k(){return m[N+v]=m[N+v+1],m[N+v+1]=0,h[v]=0,v-=1,g[2]=g[2]+1,0}var z,A,j,M,E,S,T,O,F,V,N,B,I,q,C,P,L,U,D,R,H,Y,X,G,W,Q,J;I=Math.min(o,p),j=2*o+I*(I+5)/2+2*p+1,G=1e-60;do G+=G,W=1+.1*G,Q=1+.2*G;while(1>=W||1>=Q);for(z=1;o>=z;z+=1)m[z]=t[z];for(z=o+1;j>=z;z+=1)m[z]=0;for(z=1;p>=z;z+=1)h[z]=0;if(E=[],0===y[1]){if(i(e,n,o,E),0!==E[1])return void(y[1]=2);a(e,n,o,t),r(e,n,o)}else{for(A=1;o>=A;A+=1)for(l[A]=0,z=1;A>=z;z+=1)l[A]=l[A]+e[z][A]*t[z];for(A=1;o>=A;A+=1)for(t[A]=0,z=A;o>=z;z+=1)t[A]=t[A]+e[A][z]*l[z]}for(s[1]=0,A=1;o>=A;A+=1)for(l[A]=t[A],s[1]=s[1]+m[A]*l[A],m[A]=0,z=A+1;o>=z;z+=1)e[z][A]=0;for(s[1]=-s[1]/2,y[1]=0,T=o,O=T+o,N=O+I,F=N+I+1,V=F+I*(I+1)/2,q=V+p,z=1;p>=z;z+=1){for(P=0,A=1;o>=A;A+=1)P+=u[A][z]*u[A][z];m[q+z]=Math.sqrt(P)}for(v=0,g[1]=0,g[2]=0,J=0;;){if(J=x(),999===J)return;for(;;){if(J=b(),0===J)break;if(999===J)return;if(700===J)if(S===v)k();else{for(;;)if(w(),J=_(),797!==J)break;k()}}}}function l(e,r,a,i,l,s){e=t(e),r=t(r),a=t(a);var u,d,c,p,f,h,v=[],g=[],m=[],y=[],x=[];if(l=l||0,s=s?t(s):[void 0,0],i=i?t(i):[],d=e.length-1,c=a[1].length-1,!i)for(u=1;c>=u;u+=1)i[u]=0;for(u=1;c>=u;u+=1)g[u]=0;for(p=0,f=Math.min(d,c),u=1;d>=u;u+=1)m[u]=0;for(v[1]=0,u=1;2*d+f*(f+5)/2+2*c+1>=u;u+=1)y[u]=0;for(u=1;2>=u;u+=1)x[u]=0;return o(e,r,d,d,m,v,a,i,d,c,l,g,p,x,y,s),h="",1===s[1]&&(h="constraints are inconsistent, no solution!"),2===s[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:n(m),value:n(v),unconstrained_solution:n(r),iterations:n(x),iact:n(g),message:h}}e.solveQP=l}(numeric),numeric.svd=function(e){function t(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var n,r=numeric.epsilon,a=1e-64/r,i=50,o=0,l=0,s=0,u=0,d=0,c=numeric.clone(e),p=c.length,f=c[0].length;if(f>p)throw"Need more rows than columns";var h=new Array(f),v=new Array(f);for(l=0;f>l;l++)h[l]=v[l]=0;var g=numeric.rep([f,f],0),m=0,y=0,x=0,b=0,w=0,_=0,k=0;for(l=0;f>l;l++){for(h[l]=y,k=0,d=l+1,s=l;p>s;s++)k+=c[s][l]*c[s][l];if(a>=k)y=0;else for(m=c[l][l],y=Math.sqrt(k),m>=0&&(y=-y),x=m*y-k,c[l][l]=m-y,s=d;f>s;s++){for(k=0,u=l;p>u;u++)k+=c[u][l]*c[u][s];for(m=k/x,u=l;p>u;u++)c[u][s]+=m*c[u][l]}for(v[l]=y,k=0,s=d;f>s;s++)k+=c[l][s]*c[l][s];if(a>=k)y=0;else{for(m=c[l][l+1],y=Math.sqrt(k),m>=0&&(y=-y),x=m*y-k,c[l][l+1]=m-y,s=d;f>s;s++)h[s]=c[l][s]/x;for(s=d;p>s;s++){for(k=0,u=d;f>u;u++)k+=c[s][u]*c[l][u];for(u=d;f>u;u++)c[s][u]+=k*h[u]}}w=Math.abs(v[l])+Math.abs(h[l]),w>b&&(b=w)}for(l=f-1;-1!=l;l+=-1){if(0!=y){for(x=y*c[l][l+1],s=d;f>s;s++)g[s][l]=c[l][s]/x;for(s=d;f>s;s++){for(k=0,u=d;f>u;u++)k+=c[l][u]*g[u][s];for(u=d;f>u;u++)g[u][s]+=k*g[u][l]}}for(s=d;f>s;s++)g[l][s]=0,g[s][l]=0;g[l][l]=1,y=h[l],d=l}for(l=f-1;-1!=l;l+=-1){for(d=l+1,y=v[l],s=d;f>s;s++)c[l][s]=0;if(0!=y){for(x=c[l][l]*y,s=d;f>s;s++){for(k=0,u=d;p>u;u++)k+=c[u][l]*c[u][s];for(m=k/x,u=l;p>u;u++)c[u][s]+=m*c[u][l]}for(s=l;p>s;s++)c[s][l]=c[s][l]/y}else for(s=l;p>s;s++)c[s][l]=0;c[l][l]+=1}for(r*=b,u=f-1;-1!=u;u+=-1)for(var z=0;i>z;z++){var A=!1;for(d=u;-1!=d;d+=-1){if(Math.abs(h[d])<=r){A=!0;break}if(Math.abs(v[d-1])<=r)break}if(!A){o=0,k=1;var j=d-1;for(l=d;u+1>l&&(m=k*h[l],h[l]=o*h[l],!(Math.abs(m)<=r));l++)for(y=v[l],x=t(m,y),v[l]=x,o=y/x,k=-m/x,s=0;p>s;s++)w=c[s][j],_=c[s][l],c[s][j]=w*o+_*k,c[s][l]=-w*k+_*o}if(_=v[u],d==u){if(0>_)for(v[u]=-_,s=0;f>s;s++)g[s][u]=-g[s][u];break}if(z>=i-1)throw"Error: no convergence.";for(b=v[d],w=v[u-1],y=h[u-1],x=h[u],m=((w-_)*(w+_)+(y-x)*(y+x))/(2*x*w),y=t(m,1),m=0>m?((b-_)*(b+_)+x*(w/(m-y)-x))/b:((b-_)*(b+_)+x*(w/(m+y)-x))/b,o=1,k=1,l=d+1;u+1>l;l++){for(y=h[l],w=v[l],x=k*y,y=o*y,_=t(m,x),h[l-1]=_,o=m/_,k=x/_,m=b*o+y*k,y=-b*k+y*o,x=w*k,w*=o,s=0;f>s;s++)b=g[s][l-1],_=g[s][l],g[s][l-1]=b*o+_*k,g[s][l]=-b*k+_*o;for(_=t(m,x),v[l-1]=_,o=m/_,k=x/_,m=o*y+k*w,b=-k*y+o*w,s=0;p>s;s++)w=c[s][l-1],_=c[s][l],c[s][l-1]=w*o+_*k,c[s][l]=-w*k+_*o}h[d]=0,h[u]=m,v[u]=b}for(l=0;l<v.length;l++)v[l]<r&&(v[l]=0);for(l=0;f>l;l++)for(s=l-1;s>=0;s--)if(v[s]<v[l]){for(o=v[s],v[s]=v[l],v[l]=o,u=0;u<c.length;u++)n=c[u][l],c[u][l]=c[u][s],c[u][s]=n;for(u=0;u<g.length;u++)n=g[u][l],g[u][l]=g[u][s],g[u][s]=n;l=s}return{U:c,S:v,V:g}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t){!function(){"use strict";function e(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function n(e,t,n){var r=t.x,a=t.y,i=n.x-r,o=n.y-a;if(0!==i||0!==o){var l=((e.x-r)*i+(e.y-a)*o)/(i*i+o*o);l>1?(r=n.x,a=n.y):l>0&&(r+=i*l,a+=o*l)}return i=e.x-r,o=e.y-a,i*i+o*o}function r(t,n){for(var r,a=t[0],i=[a],o=1,l=t.length;l>o;o++)r=t[o],e(r,a)>n&&(i.push(r),a=r);return a!==r&&i.push(r),i}function a(e,t){var r,a,i,o,l=e.length,s="undefined"!=typeof Uint8Array?Uint8Array:Array,u=new s(l),d=0,c=l-1,p=[],f=[];for(u[d]=u[c]=1;c;){for(a=0,r=d+1;c>r;r++)i=n(e[r],e[d],e[c]),i>a&&(o=r,a=i);a>t&&(u[o]=1,p.push(d,o,o,c)),c=p.pop(),d=p.pop()}for(r=0;l>r;r++)u[r]&&f.push(e[r]);return f}function i(e,t,n){var i=void 0!==t?t*t:1;return e=n?e:r(e,i),e=a(e,i)}"function"==typeof define&&define.amd?define(function(){return i}):"undefined"!=typeof t?t.exports=i:"undefined"!=typeof self?self.simplify=i:window.simplify=i}()},{}],5:[function(e,t){"use strict";function n(e,t,n,r){this.points=e,this.ids=t,this.dimension=r,this.length=n}function r(e){var t,r,a;if(Array.isArray(e)){if(t=e.length,0===t)return new n(null,null,0,0);r=e[0].length,a=i(d.mallocDouble(t*(r+1)),[t,r+1]),l(e,a.hi(t,r))}else{t=e.shape[0],r=e.shape[1];var f=e.dtype;f="int8"===f||"int16"===f||"int32"===f?"int32":"uint8"===f||"uint8_clamped"===f||"buffer"===f||"uint16"===f||"uint32"===f?"uint32":"float32"===f?"float32":"float64",a=i(d.malloc(t*(r+1)),[t,r+1]),s.assign(a.hi(t,r),e)}for(var h=0;t>h;++h)a.set(h,r,h);for(var v=u.malloc([t,r],e.dtype),g=d.mallocInt32(t),m=0,y=v.data,x=a.data,b=(p.log2(p.nextPow2(t)),o.compile(a.order,!0,a.dtype)),w=[a];t>m;){var _=w.shift(),k=_,z=0|k.shape[0];if(z>1){var A,j=p.log2(m+1)%r,M=c.root(z);A=b(k,M,function(e,t){return e.get(j)-t.get(j)});for(var E=v.index(m,0),S=A.offset,h=0;r>h;++h)y[E++]=x[S++];g[m]=x[S],m+=1,w.push(k.hi(M)),z>2&&w.push(k.lo(M+1))}else{for(var S=k.offset,E=v.index(m,0),h=0;r>h;++h)y[E+h]=x[S++];g[m]=x[S],m+=1}}return d.free(a.data),new n(v,g,t,r)}function a(e){var t=e.p,r=e.i;if(t){for(var a=t.length,o=d.mallocFloat64(a),l=0;a>l;++l)o[l]=t[l];for(var s=r.length,u=d.mallocInt32(s),l=0;s>l;++l)u[l]=r[l];var c=a/s|0;return new n(i(o,[s,c]),u,s,c)}return new n(null,null,0,e.d)}t.exports=r,t.exports.deserialize=a;var i=e("ndarray"),o=e("ndarray-select"),l=e("ndarray-pack"),s=e("ndarray-ops"),u=e("ndarray-scratch"),d=e("typedarray-pool"),c=e("inorder-tree-layout"),p=e("bit-twiddle"),f=e("./lib/heap.js"),h=n.prototype;h.serialize=function(){return this.length>0?{p:Array.prototype.slice.call(this.points.data,0,this.length*this.dimension),i:Array.prototype.slice.call(this.ids,0,this.length)}:{d:this.dimension}},h.range=function(e,t,n){var r=this.length;if(!(1>r)){for(var a=this.dimension,i=0;a>i;++i)if(t[i]<e[i])return;var o,s=this.points,c=this.ids,f=u.malloc([r,2,a]),h=d.mallocInt32(r),v=f.data,g=s.data,m=1,y=0;for(h[0]=0,l(e,f.pick(0,0)),l(t,f.pick(0,1));m>y;){for(var x=h[y],b=p.log2(x+1)%a,w=f.index(y,0,0),_=f.index(y,1,0),k=s.index(x,0),z=!0,i=0;a>i;++i){var A=g[k+i];if(A<v[w+i]||v[_+i]<A){z=!1;break}}if(z&&(o=n(c[x]),void 0!==o))break;var j=g[k+b],M=v[_+b],E=v[w+b];if(j>=E){var S=2*x+1;if(r>S){h[m]=S;for(var T=f.index(m,0,0),i=0;a>i;++i)v[T+i]=v[w+i];for(var O=f.index(m,1,0),i=0;a>i;++i)v[O+i]=v[_+i];v[O+b]=Math.min(M,j),m+=1}}if(M>=j){var F=2*(x+1);if(r>F){h[m]=F;for(var T=f.index(m,0,0),i=0;a>i;++i)v[T+i]=v[w+i];for(var O=f.index(m,1,0),i=0;a>i;++i)v[O+i]=v[_+i];v[T+b]=Math.max(E,j),m+=1}}y+=1}return u.free(f),d.free(h),o}},h.rnn=function(e,t,n){if(!(0>t)){var r=this.length;if(!(1>r)){var a,i=this.dimension,o=this.points,l=this.ids,s=u.malloc([r,i]),c=d.mallocInt32(r),f=s.data,h=o.data,v=1,g=0,m=t*t;c[0]=0;for(var y=0;i>y;++y)s.set(0,y,0);for(;v>g;){for(var x=c[g],b=o.index(x,0),w=0,y=0;i>y;++y)w+=Math.pow(e[y]-h[b+y],2);if(m>=w&&(a=n(l[x]),void 0!==a))break;for(var _=p.log2(x+1)%i,k=0,z=s.index(g,0),y=0;i>y;++y)y!==_&&(k+=f[z+y]);var A=e[_],j=h[b+_],M=f[z+_],E=M,S=M;j>A?S=Math.max(M,Math.pow(j-A,2)):E=Math.max(M,Math.pow(j-A,2));var T=E+k,O=S+k;if(m>=T){var F=2*x+1;if(r>F){c[v]=F;for(var V=s.index(v,0),y=0;i>y;++y)f[V+y]=f[z+y];f[V+_]=E,v+=1}}if(m>=O){var N=2*(x+1);if(r>N){c[v]=N;for(var V=s.index(v,0),y=0;i>y;++y)f[V+y]=f[z+y];f[V+_]=S,v+=1}}g+=1}return u.free(s),d.free(c),a}}},h.nn=function(e,t){var n=this.length;if(1>n)return-1;if("number"==typeof t){if(0>t)return-1}else t=1/0;var r=this.dimension,a=this.points,i=a.data,o=d.mallocFloat64(r),l=new f(n,r+1),s=l.index,u=l.data;s[0]=0;for(var c=0;r>=c;++c)u[c]=0;l.count+=1;for(var h=-1,v=t;l.count>0&&!(u[0]>=v);){for(var g=s[0],m=a.index(g,0),y=0,c=0;r>c;++c)y+=Math.pow(e[c]-i[m+c],2);v>y&&(v=y,h=g);for(var x=p.log2(g+1)%r,b=0,c=0;r>c;++c){var w=u[c+1];c!==x&&(b+=w),o[c]=w}var _=e[x],k=i[m+x],z=o[x],A=z,j=z;k>_?j=Math.max(z,Math.pow(k-_,2)):A=Math.max(z,Math.pow(k-_,2));var M=A+b,E=j+b;if(l.pop(),v>M){var S=2*g+1;if(n>S){var T=l.count;s[T]=S;var O=T*(r+1);u[O]=M;for(var c=1;r>=c;++c)u[O+c]=o[c-1];u[O+x+1]=A,l.push()}}if(v>E){var F=2*(g+1);if(n>F){var T=l.count;s[T]=F;var O=T*(r+1);u[O]=E;for(var c=1;r>=c;++c)u[O+c]=o[c-1];u[O+x+1]=j,l.push()}}}return d.freeFloat64(o),l.dispose(),0>h?-1:this.ids[h]},h.knn=function(e,t,n){if("number"==typeof n){if(0>n)return[]}else n=1/0;var r=this.length;if(1>r)return[];if("number"==typeof t){if(0>=t)return[];t=0|Math.min(t,r)}else t=r;var a=this.ids,i=this.dimension,o=this.points,l=o.data,s=d.mallocFloat64(i),u=new f(t,1),c=u.index,h=u.data,v=new f(r,i+1),g=v.index,m=v.data;g[0]=0;for(var y=0;i>=y;++y)m[y]=0;v.count+=1;for(var x=n;v.count>0&&!(m[0]>=x);){for(var b=g[0],w=o.index(b,0),_=0,y=0;i>y;++y)_+=Math.pow(e[y]-l[w+y],2);if(x>_){u.count>=t&&u.pop();var k=u.count;c[k]=b,h[k]=-_,u.push(),u.count>=t&&(x=-h[0])}for(var z=p.log2(b+1)%i,A=0,y=0;i>y;++y){var j=m[y+1];y!==z&&(A+=j),s[y]=j}var M=e[z],E=l[w+z],S=s[z],T=S,O=S;E>M?O=Math.max(S,Math.pow(E-M,2)):T=Math.max(S,Math.pow(E-M,2));var F=T+A,V=O+A;if(v.pop(),x>F){var N=2*b+1;if(r>N){var B=v.count;g[B]=N;var I=B*(i+1);m[I]=F;for(var y=1;i>=y;++y)m[I+y]=s[y-1];m[I+z+1]=T,v.push()}}if(x>V){var q=2*(b+1);if(r>q){var B=v.count;g[B]=q;var I=B*(i+1);m[I]=V;for(var y=1;i>=y;++y)m[I+y]=s[y-1];m[I+z+1]=O,v.push()}}}d.freeFloat64(s),v.dispose();for(var C=new Array(u.count),a=this.ids,y=u.count-1;y>=0;--y)C[y]=a[c[0]],u.pop();return u.dispose(),C},h.dispose=function(){d.free(this.points.data),d.freeInt32(this.ids),this.points=null,this.ids=null,this.length=0}},{"./lib/heap.js":6,"bit-twiddle":7,"inorder-tree-layout":8,ndarray:23,"ndarray-ops":10,"ndarray-pack":15,"ndarray-scratch":21,"ndarray-select":22,"typedarray-pool":26}],6:[function(e,t){"use strict";function n(e){return 1&e?e-1>>1:(e>>1)-1}function r(e,t){this.count=0,this.dataSize=t,this.index=a.mallocInt32(e),this.data=a.mallocFloat64(e*t)}t.exports=r;var a=e("typedarray-pool"),i=r.prototype;i.heapSwap=function(e,t){var n=this.data,r=this.index,a=this.dataSize,i=r[e];r[e]=r[t],r[t]=i;for(var o=a*e,l=a*t,s=0;a>s;++s){var u=n[o];n[o]=n[l],n[l]=u,o+=1,l+=1}},i.heapUp=function(e){for(var t=this.dataSize,r=(this.index,this.data),a=r[t*e];e>0;){var i=n(e);if(i>=0){var o=r[t*i];if(o>a){this.heapSwap(e,i),e=i;continue}}break}},i.heapDown=function(e){for(var t=this.dataSize,n=(this.index,this.data),r=this.count,a=n[t*e];;){var i=a,o=2*e+1,l=2*(e+1),s=e;if(r>o){var u=n[t*o];i>u&&(s=o,i=u)}if(r>l){var d=n[t*l];i>d&&(s=l)}if(s===e)break;this.heapSwap(e,s),e=s}},i.pop=function(){this.count-=1,this.heapSwap(0,this.count),this.heapDown(0)},i.push=function(){this.heapUp(this.count),this.count+=1},i.dispose=function(){a.freeInt32(this.index),a.freeFloat64(this.data)}},{"typedarray-pool":26}],7:[function(e,t,n){"use strict";"use restrict";function r(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}var a=32;n.INT_BITS=a,n.INT_MAX=2147483647,n.INT_MIN=-1<<a-1,n.sign=function(e){return(e>0)-(0>e)},n.abs=function(e){var t=e>>a-1;return(e^t)-t},n.min=function(e,t){return t^(e^t)&-(t>e)},n.max=function(e,t){return e^(e^t)&-(t>e)},n.isPow2=function(e){return!(e&e-1||!e)},n.log2=function(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1},n.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},n.popCount=function(e){return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24},n.countTrailingZeros=r,n.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},n.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},n.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,27030>>>e&1};var i=new Array(256);!function(e){for(var t=0;256>t;++t){var n=t,r=t,a=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--a;e[t]=r<<a&255}}(i),n.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},n.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},n.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},n.interleave3=function(e,t,n){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),e|n<<2},n.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},n.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},{}],8:[function(e,t,n){"use strict";function r(e){var t=(v.nextPow2(e+1)>>>1)-1,n=e-t;return v.nextPow2(n)-1>=t?t:(t>>>1)+n}function a(){return 0}function i(e){return e-1}function o(e,t){if(0>=e)return 0;var n=r(e);return t>n?o(e-n-1,t-n-1):t===n?v.log2(e):o(n,t)}function l(e,t){return Math.max(t-1,0)}function s(e,t){return Math.min(t+1,e-1)}function u(e,t){if(0>=e)return-1;var n=r(e);if(t>n){var a=u(e-n-1,t-n-1);return 0>a?n:a+n+1}if(t===n)return-1;var a=u(n,t);return 0>a?n:a}function d(e,t){if(0>=e)return 0;var n=r(e);return t>n?d(e-n-1,t-n-1)+n+1:t===n?r(t):d(n,t)}function c(e,t){if(0>=e)return 0;var n=r(e);return t>n?c(e-n-1,t-n-1)+n+1:t===n?r(e-n-1)+n+1:c(n,t)}function p(e,t){return 0===o(e,t)}function f(e,t){e|=0,t|=0;for(var n=0;e>1;){var a=r(e);if(t>a)n+=a+1,e-=a+1,t-=a+1;else{if(t===a)break;e=a}}return n}function h(e,t){e|=0,t|=0;for(var n=0;e>1;){var a=r(e);if(t>a)n+=a+1,e-=a+1,t-=a+1;else{if(t===a){n+=e-1;break}e=a}}return n}var v=e("bit-twiddle");n.root=r,n.begin=a,n.end=i,n.height=o,n.prev=l,n.next=s,n.parent=u,n.left=d,n.right=c,n.leaf=p,n.lo=f,n.hi=h},{"bit-twiddle":9}],9:[function(e,t){t.exports=e(7)},{}],10:[function(e,t,n){"use strict";function r(e){if(!e)return l;for(var t=0;t<e.args.length;++t){var n=e.args[t];e.args[t]=0===t?{name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function a(e){return o({args:e.args,pre:r(e.pre),body:r(e.body),post:r(e.proc),funcName:e.funcName})}function i(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);var r=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return r(a(e))}var o=e("cwise-compiler"),l={body:"",args:[],thisVars:[],localVars:[]},s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var t=s[e];n[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),n[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var t=u[e];n[e]=i({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),n[e+"eq"]=i({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var d={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in d){var t=d[e];n[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),n[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<c.length;++e){var t=c[e];n[t]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),n[t+"eq"]=i({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var p=["max","min","atan2","pow"];!function(){for(var e=0;e<p.length;++e){var t=p[e];n[t]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),n[t+"s"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),n[t+"eq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),n[t+"seq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var f=["atan2","pow"];!function(){for(var e=0;e<f.length;++e){var t=f[e];n[t+"op"]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),n[t+"ops"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),n[t+"opeq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),n[t+"opseq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),n.any=o({args:["array"],pre:l,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),n.all=o({args:["array"],pre:l,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),n.sum=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),n.prod=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),n.norm2squared=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),n.norm2=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),n.norminf=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),n.norm1=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),n.sup=o({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.inf=o({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.argmin=o({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.argmax=o({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.random=i({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),n.assign=i({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),n.assigns=i({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),n.equals=o({args:["array","array"],pre:l,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":11}],11:[function(e,t){"use strict";function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function r(e){var t=new n;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var i=0;i<r.length;++i){var o=r[i];if("array"===o){if(t.arrayArgs.push(i),t.shimArgs.push("array"+i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(i),t.shimArgs.push("scalar"+i);else if("index"===o){if(t.indexArgs.push(i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(i),i<t.pre.args.length&&t.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<t.post.args.length&&t.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+r[i]);t.argTypes[i]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(i)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,a(t)
}var a=e("./lib/thunk.js");t.exports=r},{"./lib/thunk.js":13}],12:[function(e,t){"use strict";function n(e,t,n){var r,a,i=e.length,o=t.arrayArgs.length,l=t.indexArgs.length>0,s=[],u=[],d=0,c=0;for(r=0;i>r;++r)u.push(["i",r,"=0"].join(""));for(a=0;o>a;++a)for(r=0;i>r;++r)c=d,d=e[r],u.push(0===r?["d",a,"s",r,"=t",a,"p",d].join(""):["d",a,"s",r,"=(t",a,"p",d,"-s",c,"*t",a,"p",c,")"].join(""));for(s.push("var "+u.join(",")),r=i-1;r>=0;--r)d=e[r],s.push(["for(i",r,"=0;i",r,"<s",d,";++i",r,"){"].join(""));for(s.push(n),r=0;i>r;++r){for(c=d,d=e[r],a=0;o>a;++a)s.push(["p",a,"+=d",a,"s",r].join(""));l&&(r>0&&s.push(["index[",c,"]-=s",c].join("")),s.push(["++index[",d,"]"].join(""))),s.push("}")}return s.join("\n")}function r(e,t,r,a){for(var i=t.length,o=r.arrayArgs.length,l=r.blockSize,s=r.indexArgs.length>0,u=[],d=0;o>d;++d)u.push(["var offset",d,"=p",d].join(""));for(var d=e;i>d;++d)u.push(["for(var j"+d+"=SS[",t[d],"]|0;j",d,">0;){"].join("")),u.push(["if(j",d,"<",l,"){"].join("")),u.push(["s",t[d],"=j",d].join("")),u.push(["j",d,"=0"].join("")),u.push(["}else{s",t[d],"=",l].join("")),u.push(["j",d,"-=",l,"}"].join("")),s&&u.push(["index[",t[d],"]=j",d].join(""));for(var d=0;o>d;++d){for(var c=["offset"+d],p=e;i>p;++p)c.push(["j",p,"*t",d,"p",t[p]].join(""));u.push(["p",d,"=(",c.join("+"),")"].join(""))}u.push(n(t,r,a));for(var d=e;i>d;++d)u.push("}");return u.join("\n")}function a(e){for(var t=0,n=e[0].length;n>t;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function i(e,t,n){for(var r=e.body,a=[],i=[],o=0;o<e.args.length;++o){var l=e.args[o];if(!(l.count<=0)){var s=new RegExp(l.name,"g"),u="",d=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var c=t.offsetArgIndex.indexOf(o),p=t.offsetArgs[c];d=p.array,u="+q"+c;case"array":u="p"+d+u;var f="l"+o,h="a"+d;1===l.count?"generic"===n[d]?l.lvalue?(a.push(["var ",f,"=",h,".get(",u,")"].join("")),r=r.replace(s,f),i.push([h,".set(",u,",",f,")"].join(""))):r=r.replace(s,[h,".get(",u,")"].join("")):r=r.replace(s,[h,"[",u,"]"].join("")):"generic"===n[d]?(a.push(["var ",f,"=",h,".get(",u,")"].join("")),r=r.replace(s,f),l.lvalue&&i.push([h,".set(",u,",",f,")"].join(""))):(a.push(["var ",f,"=",h,"[",u,"]"].join("")),r=r.replace(s,f),l.lvalue&&i.push([h,"[",u,"]=",f].join("")));break;case"scalar":r=r.replace(s,"Y"+t.scalarArgs.indexOf(o));break;case"index":r=r.replace(s,"index");break;case"shape":r=r.replace(s,"shape")}}}return[a.join("\n"),r,i.join("\n")].join("\n").trim()}function o(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var a=e[r],i=a.match(/\d+/);i=i?i[0]:"",t[r]=0===a.charAt(0)?"u"+a.charAt(1)+i:a.charAt(0)+i,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function l(e,t){for(var l=0|t[1].length,u=new Array(e.arrayArgs.length),d=new Array(e.arrayArgs.length),c=["SS"],p=["'use strict'"],f=[],h=0;l>h;++h)f.push(["s",h,"=SS[",h,"]"].join(""));for(var v=0;v<e.arrayArgs.length;++v){c.push("a"+v),c.push("t"+v),c.push("p"+v),d[v]=t[2*v],u[v]=t[2*v+1];for(var h=0;l>h;++h)f.push(["t",v,"p",h,"=t",v,"[",h,"]"].join(""))}for(var v=0;v<e.scalarArgs.length;++v)c.push("Y"+v);if(e.shapeArgs.length>0&&f.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var g=new Array(l),v=0;l>v;++v)g[v]="0";f.push(["index=[",g.join(","),"]"].join(""))}for(var v=0;v<e.offsetArgs.length;++v){for(var m=e.offsetArgs[v],y=[],h=0;h<m.offset.length;++h)0!==m.offset[h]&&y.push(1===m.offset[h]?["t",m.array,"p",h].join(""):[m.offset[h],"*t",m.array,"p",h].join(""));f.push(0===y.length?"q"+v+"=0":["q",v,"=",y.join("+")].join(""))}var x=s([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));f=f.concat(x),p.push("var "+f.join(","));for(var v=0;v<e.arrayArgs.length;++v)p.push("p"+v+"|=0");e.pre.body.length>3&&p.push(i(e.pre,e,d));var b=i(e.body,e,d),w=a(u);p.push(l>w?r(w,u[0],e,b):n(u[0],e,b)),e.post.body.length>3&&p.push(i(e.post,e,d)),e.debug&&console.log("Generated cwise routine for ",t,":\n\n",p.join("\n"));var _=[e.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",w,o(d)].join(""),k=new Function(["function ",_,"(",c.join(","),"){",p.join("\n"),"} return ",_].join(""));return k()}var s=e("uniq");t.exports=l},{uniq:14}],13:[function(e,t){"use strict";function n(e){var t=["'use strict'","var CACHED={}"],n=[],a=e.funcName+"_cwise_thunk";t.push(["return function ",a,"(",e.shimArgs.join(","),"){"].join(""));for(var i=[],o=[],l=[["array",e.arrayArgs[0],".shape"].join("")],s=0;s<e.arrayArgs.length;++s){var u=e.arrayArgs[s];n.push(["t",u,"=array",u,".dtype,","r",u,"=array",u,".order"].join("")),i.push("t"+u),i.push("r"+u),o.push("t"+u),o.push("r"+u+".join()"),l.push("array"+u+".data"),l.push("array"+u+".stride"),l.push("array"+u+".offset|0")}for(var s=0;s<e.scalarArgs.length;++s)l.push("scalar"+e.scalarArgs[s]);n.push(["type=[",o.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",l.join(","),")}"].join("")),e.debug&&console.log("Generated thunk:",t.join("\n"));var d=new Function("compile",t.join("\n"));return d(r.bind(void 0,e))}var r=e("./compile.js");t.exports=n},{"./compile.js":12}],14:[function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,a=e[0],i=e[0],o=1;r>o;++o)if(i=a,a=e[o],t(a,i)){if(o===n){n++;continue}e[n++]=a}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],a=e[0],i=1;n>i;++i,a=r)if(a=r,r=e[i],r!==a){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}function a(e,t,a){return 0===e.length?e:t?(a||e.sort(t),n(e,t)):(a||e.sort(),r(e))}t.exports=a},{}],15:[function(e,t){"use strict";var n=e("ndarray"),r=e("./doConvert.js");t.exports=function(e,t){for(var a=[],i=e,o=1;i instanceof Array;)a.push(i.length),o*=i.length,i=i[0];return 0===a.length?n():(t||(t=n(new Float64Array(o),a)),r(t,e),t)}},{"./doConvert.js":16,ndarray:23}],16:[function(e,t){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":17}],17:[function(e,t){"use strict";function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function r(e){var t=new n;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r.slice(0);for(var i=0;i<r.length;++i){var o=r[i];if("array"===o){if(t.arrayArgs.push(i),t.shimArgs.push("array"+i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(i),t.shimArgs.push("scalar"+i);else if("index"===o){if(t.indexArgs.push(i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(i),i<t.pre.args.length&&t.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<t.post.args.length&&t.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+r[i]);t.argTypes[i]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(i)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,a(t)}var a=e("./lib/thunk.js");t.exports=r},{"./lib/thunk.js":19}],18:[function(e,t){"use strict";function n(e,t,n){var r,a,i=e.length,o=t.arrayArgs.length,l=t.indexArgs.length>0,s=[],u=[],d=0,c=0;for(r=0;i>r;++r)u.push(["i",r,"=0"].join(""));for(a=0;o>a;++a)for(r=0;i>r;++r)c=d,d=e[r],u.push(0===r?["d",a,"s",r,"=t",a,"[",d,"]"].join(""):["d",a,"s",r,"=(t",a,"[",d,"]-s",c,"*t",a,"[",c,"])"].join(""));for(s.push("var "+u.join(",")),r=i-1;r>=0;--r)d=e[r],s.push(["for(i",r,"=0;i",r,"<s",d,";++i",r,"){"].join(""));for(s.push(n),r=0;i>r;++r){for(c=d,d=e[r],a=0;o>a;++a)s.push(["p",a,"+=d",a,"s",r].join(""));l&&(r>0&&s.push(["index[",c,"]-=s",c].join("")),s.push(["++index[",d,"]"].join(""))),s.push("}")}return s.join("\n")}function r(e,t,r,a){for(var i=t.length,o=r.arrayArgs.length,l=r.blockSize,s=r.indexArgs.length>0,u=[],d=0;o>d;++d)u.push(["var offset",d,"=p",d].join(""));for(var d=e;i>d;++d)u.push(["for(var j"+d+"=SS[",t[d],"]|0;j",d,">0;){"].join("")),u.push(["if(j",d,"<",l,"){"].join("")),u.push(["s",t[d],"=j",d].join("")),u.push(["j",d,"=0"].join("")),u.push(["}else{s",t[d],"=",l].join("")),u.push(["j",d,"-=",l,"}"].join("")),s&&u.push(["index[",t[d],"]=j",d].join(""));for(var d=0;o>d;++d){for(var c=["offset"+d],p=e;i>p;++p)c.push(["j",p,"*t",d,"[",t[p],"]"].join(""));u.push(["p",d,"=(",c.join("+"),")"].join(""))}u.push(n(t,r,a));for(var d=e;i>d;++d)u.push("}");return u.join("\n")}function a(e){for(var t=0,n=e[0].length;n>t;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function i(e,t,n){for(var r=e.body,a=[],i=[],o=0;o<e.args.length;++o){var l=e.args[o];if(!(l.count<=0)){var s=new RegExp(l.name,"g"),u="",d=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var c=t.offsetArgIndex.indexOf(o),p=t.offsetArgs[c];d=p.array,u="+q"+c;case"array":u="p"+d+u;var f="l"+o,h="a"+d;1===l.count?"generic"===n[d]?l.lvalue?(a.push(["var ",f,"=",h,".get(",u,")"].join("")),r=r.replace(s,f),i.push([h,".set(",u,",",f,")"].join(""))):r=r.replace(s,[h,".get(",u,")"].join("")):r=r.replace(s,[h,"[",u,"]"].join("")):"generic"===n[d]?(a.push(["var ",f,"=",h,".get(",u,")"].join("")),r=r.replace(s,f),l.lvalue&&i.push([h,".set(",u,",",f,")"].join(""))):(a.push(["var ",f,"=",h,"[",u,"]"].join("")),r=r.replace(s,f),l.lvalue&&i.push([h,"[",u,"]=",f].join("")));break;case"scalar":r=r.replace(s,"Y"+t.scalarArgs.indexOf(o));break;case"index":r=r.replace(s,"index");break;case"shape":r=r.replace(s,"shape")}}}return[a.join("\n"),r,i.join("\n")].join("\n").trim()}function o(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var a=e[r],i=a.match(/\d+/);i=i?i[0]:"",t[r]=0===a.charAt(0)?"u"+a.charAt(1)+i:a.charAt(0)+i,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function l(e,t){for(var l=0|t[1].length,u=new Array(e.arrayArgs.length),d=new Array(e.arrayArgs.length),c=["SS"],p=["'use strict'"],f=[],h=0;l>h;++h)f.push(["s",h,"=SS[",h,"]"].join(""));for(var v=0;v<e.arrayArgs.length;++v)c.push("a"+v),c.push("t"+v),c.push("p"+v),d[v]=t[2*v],u[v]=t[2*v+1];for(var v=0;v<e.scalarArgs.length;++v)c.push("Y"+v);if(e.shapeArgs.length>0&&f.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var g=new Array(l),v=0;l>v;++v)g[v]="0";f.push(["index=[",g.join(","),"]"].join(""))}for(var v=0;v<e.offsetArgs.length;++v){for(var m=e.offsetArgs[v],y=[],h=0;h<m.offset.length;++h)0!==m.offset[h]&&y.push(1===m.offset[h]?["t",m.array,"[",h,"]"].join(""):[m.offset[h],"*t",m.array,"[",h,"]"].join(""));f.push(0===y.length?"q"+v+"=0":["q",v,"=(",y.join("+"),")|0"].join(""))}var x=s([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));f=f.concat(x),p.push("var "+f.join(","));for(var v=0;v<e.arrayArgs.length;++v)p.push("p"+v+"|=0");e.pre.body.length>3&&p.push(i(e.pre,e,d));var b=i(e.body,e,d),w=a(u);p.push(l>w?r(w,u[0],e,b):n(u[0],e,b)),e.post.body.length>3&&p.push(i(e.post,e,d)),e.debug&&console.log("Generated cwise routine for ",t,":\n\n",p.join("\n"));var _=[e.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",w,o(d)].join(""),k=new Function(["function ",_,"(",c.join(","),"){",p.join("\n"),"} return ",_].join(""));return k()}var s=e("uniq");t.exports=l},{uniq:20}],19:[function(e,t,n){arguments[4][13][0].apply(n,arguments)},{"./compile.js":18}],20:[function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,a=e[0],i=e[0],o=1;r>o;++o)if(i=a,a=e[o],t(a,i)){if(o===n){n++;continue}e[n++]=a}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],a=e[0],i=1;n>i;++i,a=r)if(a=r,r=e[i],r!==a){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}function a(e,t,a){return 0===e.length?[]:t?(a||e.sort(t),n(e,t)):(a||e.sort(),r(e))}t.exports=a},{}],21:[function(e,t,n){"use strict";function r(e){var t=e.dtype;("generic"===t||"array"===t)&&(t="double");var n=u.malloc(e.size,t),r=l(n,e.shape);return s.assign(r,e),r}function a(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];return l(u.malloc(n,t),e,r,0)}function i(e){"generic"!==e.dtype&&"array"!==e.dtype&&u.free(e.data)}function o(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];for(var i=u.malloc(n,t),a=0;n>a;++a)i[a]=0;return l(i,e,r,0)}var l=e("ndarray"),s=e("ndarray-ops"),u=e("typedarray-pool");n.clone=r,n.malloc=a,n.free=i,n.zeros=o},{ndarray:23,"ndarray-ops":10,"typedarray-pool":26}],22:[function(e,t){"use strict";function n(e){return"s"+e}function r(e){return"t"+e}function a(e){return"u"+e}function i(e){return"v"+e}function o(e){return"i"+e}function l(e){return"p"+e}function s(e){return"x"+e}function u(e){var t=e.slice();return t.splice(e.indexOf(0),1),t.unshift(0),t}function d(e,t,d){function c(a,u,d){if(t)j.push(l(0),".offset=",m,"+",r(e[0]),"*(",u,");",l(1),".offset=",m,"+",r(e[0]),"*(",d,");",a,"=",v,"(",l(0),",",l(1),");");else{j.push(s(0),"=",m,"+",r(0),"*(",u,");",s(1),"=",m,"+",r(0),"*(",d,");"),k>1&&j.push("_cmp:");for(var c=k-1;c>0;--c)j.push("for(",o(c),"=0;",o(c),"<",n(c),";",o(c),"++){");z?j.push(a,"=",g,".get(",s(0),")-",g,".get(",s(1),");"):j.push(a,"=",g,"[",s(0),"]-",g,"[",s(1),"];"),k>1&&j.push("if(",a,")break _cmp;");for(var c=1;k>c;++c)j.push(s(0),"+=",i(c),";",s(1),"+=",i(c),"}")}}function p(t,i){j.push(s(0),"=",m,"+",r(e[0]),"*(",t,");",s(1),"=",m,"+",r(e[0]),"*(",i,");");for(var l=k-1;l>0;--l)j.push("for(",o(e[l]),"=0;",o(e[l]),"<",n(e[l]),";",o(e[l]),"++){");z?j.push(x,"=",g,".get(",s(0),");",g,".set(",s(0),",",g,".get(",s(1),"));",g,".set(",s(1),",",x,");"):j.push(x,"=",g,"[",s(0),"];",g,"[",s(0),"]=",g,"[",s(1),"];",g,"[",s(1),"]=",x,";");for(var l=1;k>l;++l)j.push(s(0),"+=",a(e[l]),";",s(1),"+=",a(e[l]),"}")}e=u(e);var k=e.length,z="generic"===d,A="ndSelect"+d+e.join("_")+"_"+(t?"cmp":"lex"),j=[],M=[f,h];t&&M.push(v);for(var E=[g+"="+f+".data",m+"="+f+".offset|0",y+"=Math.random",x],S=0;2>S;++S)E.push(s(S)+"=0");for(var S=0;k>S;++S)E.push(n(S)+"="+f+".shape["+S+"]|0",r(S)+"="+f+".stride["+S+"]|0",o(S)+"=0");for(var S=1;k>S;++S)k-1>S?E.push(i(S)+"=("+r(S)+"-"+n(S+1)+"*"+r(S+1)+")|0",a(e[S])+"=("+r(e[S])+"-"+n(e[S+1])+"*"+r(e[S+1])+")|0"):E.push(i(S)+"="+r(S),a(e[S])+"="+r(e[S]));if(t)for(var S=0;2>S;++S)E.push(l(S)+"="+f+".pick(0)");E.push(_+"=0",b+"=0",w+"="+n(e[0])+"-1"),j.push("while(",b,"<",w,"){",_,"=(",y,"()*(",w,"-",b,"+1)+",b,")|0;"),p(_,w),j.push(_,"=",b,";","for(",o(0),"=",b,";",o(0),"<",w,";",o(0),"++){"),c(x,o(0),w),j.push("if(",x,"<0){"),p(_,o(0)),j.push(_,"++;"),j.push("}}"),p(_,w),j.push("if(",_,"===",h,"){",b,"=",_,";","break;","}else if(",h,"<",_,"){",w,"=",_,"-1;","}else{",b,"=",_,"+1;","}","}"),t?j.push(l(0),".offset=",m,"+",b,"*",r(0),";","return ",l(0),";"):j.push("return ",f,".pick(",b,");");var T=["'use strict';function ",A,"(",M,"){","var ",E.join(),";",j.join(""),"};return ",A].join(""),O=new Function(T);return O()}function c(e,t,n){var r=e.join()+t+n,a=k[r];return a?a:k[r]=d(e,t,n)}function p(e,t,n){if(t|=0,0===e.dimension||e.shape[0]<=t||0>t)return null;var r=!!n,a=c(e.order,r,e.dtype);return r?a(e,t,n):a(e,t)}t.exports=p,t.exports.compile=c;var f="a",h="K",v="C",g="d",m="o",y="R",x="T",b="L",w="H",_="X",k={}},{}],23:[function(e,t){(function(n){function r(e,t){return e[0]-t[0]}function a(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(r);var a=new Array(n.length);for(e=0;e<a.length;++e)a[e]=n[e][1];return a}function i(e,t){var n=["View",t,"d",e].join("");0>t&&(n="View_Nil"+e);var r="generic"===e;if(-1===t){var i="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}",o=new Function(i);return o()}if(0===t){var i="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",o=new Function("TrivialArray",i);return o(p[e][0])}var i=["'use strict'"],l=s(t),d=l.map(function(e){return"i"+e}),c="this.offset+"+l.map(function(e){return"this._stride"+e+"*i"+e}).join("+");i.push("function "+n+"(a,"+l.map(function(e){return"b"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",d){this.data=a");for(var f=0;t>f;++f)i.push("this._shape"+f+"=b"+f+"|0");for(var f=0;t>f;++f)i.push("this._stride"+f+"=c"+f+"|0");i.push("this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t);var h="VStride"+t+"d"+e,v="VShape"+t+"d"+e,g={stride:h,shape:v};for(var m in g){var y=g[m];i.push("function "+y+"(v) {this._v=v} var aproto="+y+".prototype","aproto.length="+t);for(var x=[],f=0;t>f;++f)x.push(["this._v._",m,f].join(""));i.push("aproto.toJSON=function "+y+"_toJSON(){return ["+x.join(",")+"]}","aproto.valueOf=aproto.toString=function "+y+"_toString(){return ["+x.join(",")+"].join()}");for(var f=0;t>f;++f)i.push("Object.defineProperty(aproto,"+f+",{get:function(){return this._v._"+m+f+"},set:function(v){return this._v._"+m+f+"=v|0},enumerable:true})");for(var f=0;f<u.length;++f)u[f]in Array.prototype&&i.push("aproto."+u[f]+"=Array.prototype."+u[f]);i.push(["Object.defineProperty(proto,'",m,"',{get:function ",y,"_get(){return new ",y,"(this)},set: function ",y,"_set(v){"].join(""));for(var f=0;t>f;++f)i.push("this._"+m+f+"=v["+f+"]|0");i.push("return v}})")}i.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+l.map(function(e){return"this._shape"+e}).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),4>t?(i.push("function "+n+"_order(){"),2===t?i.push("return (Math.abs(this._stride0)>Math.abs(this._stride1))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this._stride0),s1=Math.abs(this._stride1),s2=Math.abs(this._stride2);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+n+"_set("+d.join(",")+",v){"),i.push(r?"return this.data.set("+c+",v)}":"return this.data["+c+"]=v}"),i.push("proto.get=function "+n+"_get("+d.join(",")+"){"),i.push(r?"return this.data.get("+c+")}":"return this.data["+c+"]}"),i.push("proto.index=function "+n+"_index(",d.join(),"){return "+c+"}"),i.push("proto.hi=function "+n+"_hi("+d.join(",")+"){return new "+n+"(this.data,"+l.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this._shape",e,":i",e,"|0"].join("")}).join(",")+","+l.map(function(e){return"this._stride"+e}).join(",")+",this.offset)}");var b=l.map(function(e){return"a"+e+"=this._shape"+e}),w=l.map(function(e){return"c"+e+"=this._stride"+e});i.push("proto.lo=function "+n+"_lo("+d.join(",")+"){var b=this.offset,d=0,"+b.join(",")+","+w.join(","));for(var f=0;t>f;++f)i.push("if(typeof i"+f+"==='number'&&i"+f+">=0){d=i"+f+"|0;b+=c"+f+"*d;a"+f+"-=d}");i.push("return new "+n+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",b)}"),i.push("proto.step=function "+n+"_step("+d.join(",")+"){var "+l.map(function(e){return"a"+e+"=this._shape"+e}).join(",")+","+l.map(function(e){return"b"+e+"=this._stride"+e}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var f=0;t>f;++f)i.push("if(typeof i"+f+"==='number'){d=i"+f+"|0;if(d<0){c+=b"+f+"*(a"+f+"-1);a"+f+"=ceil(-a"+f+"/d)}else{a"+f+"=ceil(a"+f+"/d)}b"+f+"*=d}");i.push("return new "+n+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"b"+e}).join(",")+",c)}");for(var _=new Array(t),k=new Array(t),f=0;t>f;++f)_[f]="a[i"+f+"]",k[f]="b[i"+f+"]";i.push("proto.transpose=function "+n+"_transpose("+d+"){"+d.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+_.join(",")+","+k.join(",")+",this.offset)}"),i.push("proto.pick=function "+n+"_pick("+d+"){var a=[],b=[],c=this.offset");for(var f=0;t>f;++f)i.push("if(typeof i"+f+"==='number'&&i"+f+">=0){c=(c+this._stride"+f+"*i"+f+")|0}else{a.push(this._shape"+f+");b.push(this._stride"+f+")}");i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+l.map(function(e){return"shape["+e+"]"}).join(",")+","+l.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",i.join("\n"));return o(p[e],a)}function o(e){if(c&&n.isBuffer(e))return"buffer";if(d)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}function l(e,t,n,r){if(void 0===e){var a=p.array[0];return a([])}"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var l=t.length;if(void 0===n){n=new Array(l);for(var s=l-1,u=1;s>=0;--s)n[s]=u,u*=t[s]}if(void 0===r){r=0;for(var s=0;l>s;++s)n[s]<0&&(r-=(t[s]-1)*n[s])}for(var d=o(e),c=p[d];c.length<=l+1;)c.push(i(d,c.length-1));var a=c[l+1];return a(e,t,n,r)}var s=e("iota-array"),u=["concat","join","slice","toString","indexOf","lastIndexOf","forEach","every","some","filter","map","reduce","reduceRight"],d="undefined"!=typeof Float64Array,c="undefined"!=typeof n,p={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=l}).call(this,e("buffer").Buffer)},{buffer:28,"iota-array":24}],24:[function(e,t){"use strict";function n(e){for(var t=new Array(e),n=0;e>n;++n)t[n]=n;return t}t.exports=n},{}],25:[function(e,t){"use strict";function n(e,t,r){var a=0|e[r];if(0>=a)return[];var i,o=new Array(a);if(r===e.length-1)for(i=0;a>i;++i)o[i]=t;else for(i=0;a>i;++i)o[i]=n(e,t,r+1);return o}function r(e,t){var n,r;for(n=new Array(e),r=0;e>r;++r)n[r]=t;return n}function a(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(e>0)return r(0|e,t);break;case"object":if("number"==typeof e.length)return n(e,t,0)}return[]}t.exports=a},{}],26:[function(e,t,n){(function(t,r){var a=e("bit-twiddle"),i=e("dup");t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])});var o="undefined"!=typeof Uint8ClampedArray,l=t.__TYPEDARRAY_POOL;l.UINT8C||(l.UINT8C=i([32,0])),l.BUFFER||(l.BUFFER=i([32,0]));var s=l.UINT8,u=l.UINT16,d=l.UINT32,c=l.INT8,p=l.INT16,f=l.INT32,h=l.FLOAT,v=l.DOUBLE,g=l.DATA,m=l.UINT8C,y=l.BUFFER;n.free=function(e){var t=0|e.length,n=a.log2(t);if(r.isBuffer(e))y[n].push(e);else switch(Object.prototype.toString.call(e)){case"[object Uint8Array]":s[n].push(e);break;case"[object Uint16Array]":u[n].push(e);break;case"[object Uint32Array]":d[n].push(e);break;case"[object Int8Array]":c[n].push(e);break;case"[object Int16Array]":p[n].push(e);break;case"[object Int32Array]":f[n].push(e);break;case"[object Uint8ClampedArray]":m[n].push(e);break;case"[object Float32Array]":h[n].push(e);break;case"[object Float64Array]":v[n].push(e);break;case"[object ArrayBuffer]":g[n].push(e);break;default:throw new Error("typedarray-pool: Unspecified array type")}},n.freeUint8=function(e){s[a.log2(e.length)].push(e)},n.freeUint16=function(e){u[a.log2(e.length)].push(e)},n.freeUint32=function(e){d[a.log2(e.length)].push(e)},n.freeInt8=function(e){c[a.log2(e.length)].push(e)},n.freeInt16=function(e){p[a.log2(e.length)].push(e)},n.freeInt32=function(e){f[a.log2(e.length)].push(e)},n.freeFloat32=n.freeFloat=function(e){h[a.log2(e.length)].push(e)},n.freeFloat64=n.freeDouble=function(e){v[a.log2(e.length)].push(e)},n.freeArrayBuffer=function(e){g[a.log2(e.length)].push(e)},n.freeUint8Clamped=o?function(e){m[a.log2(e.length)].push(e)}:n.freeUint8,n.freeBuffer=function(e){y[a.log2(e.length)].push(e)},n.malloc=function(e,t){e=a.nextPow2(e);var n=a.log2(e);if(void 0===t||"arraybuffer"===t){var i=g[n];if(i.length>0){var l=i[i.length-1];return i.pop(),l}return new ArrayBuffer(e)}switch(t){case"uint8":var x=s[n];return x.length>0?x.pop():new Uint8Array(e);case"uint16":var b=u[n];return b.length>0?b.pop():new Uint16Array(e);case"uint32":var w=d[n];return w.length>0?w.pop():new Uint32Array(e);case"int8":var _=c[n];return _.length>0?_.pop():new Int8Array(e);case"int16":var k=p[n];return k.length>0?k.pop():new Int16Array(e);case"int32":var z=f[n];return z.length>0?z.pop():new Int32Array(e);case"float":case"float32":var A=h[n];return A.length>0?A.pop():new Float32Array(e);case"double":case"float64":var j=v[n];return j.length>0?j.pop():new Float64Array(e);case"uint8_clamped":if(o){var M=m[n];return M.length>0?M.pop():new Uint8ClampedArray(e)}var x=s[n];return x.length>0?x.pop():new Uint8Array(e);case"buffer":var E=y[n];return E.length>0?E.pop():new r(e);default:return null}return null},n.mallocUint8=function(e){e=a.nextPow2(e);var t=a.log2(e),n=s[t];return n.length>0?n.pop():new Uint8Array(e)},n.mallocUint16=function(e){e=a.nextPow2(e);var t=a.log2(e),n=u[t];return n.length>0?n.pop():new Uint16Array(e)},n.mallocUint32=function(e){e=a.nextPow2(e);var t=a.log2(e),n=d[t];return n.length>0?n.pop():new Uint32Array(e)},n.mallocInt8=function(e){e=a.nextPow2(e);var t=a.log2(e),n=c[t];return n.length>0?n.pop():new Int8Array(e)},n.mallocInt16=function(e){e=a.nextPow2(e);var t=a.log2(e),n=p[t];return n.length>0?n.pop():new Int16Array(e)},n.mallocInt32=function(e){e=a.nextPow2(e);var t=a.log2(e),n=f[t];return n.length>0?n.pop():new Int32Array(e)},n.mallocFloat32=n.mallocFloat=function(e){e=a.nextPow2(e);var t=a.log2(e),n=h[t];return n.length>0?n.pop():new Float32Array(e)},n.mallocFloat64=n.mallocDouble=function(e){e=a.nextPow2(e);var t=a.log2(e),n=v[t];return n.length>0?n.pop():new Float64Array(e)},n.mallocArrayBuffer=function(e){e=a.nextPow2(e);var t=a.log2(e),n=g[t];return n.length>0?n.pop():new ArrayBuffer(e)},n.mallocUint8Clamped=o?function(e){e=a.nextPow2(e);var t=a.log2(e),n=m[t];return n.length>0?n.pop():new Uint8ClampedArray(e)}:n.mallocUint8,n.mallocBuffer=function(e){e=a.nextPow2(e);var t=a.log2(e),n=y[t];return n.length>0?n.pop():new r(e)},n.clearCache=function(){for(var e=0;32>e;++e)s[e].length=0,u[e].length=0,d[e].length=0,c[e].length=0,p[e].length=0,f[e].length=0,h[e].length=0,v[e].length=0,g[e].length=0,m[e].length=0,y[e].length=0}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"bit-twiddle":7,buffer:28,dup:25}],27:[function(){},{}],28:[function(e,t,n){function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);var a=typeof e;if("base64"===t&&"string"===a)for(e=E(e);e.length%4!==0;)e+="=";var i;if("number"===a)i=T(e);else if("string"===a)i=r.byteLength(e,t);else{if("object"!==a)throw new Error("First argument needs to be a number, array or string.");i=T(e.length)}var o;r._useTypedArrays?o=r._augment(new Uint8Array(i)):(o=this,o.length=i,o._isBuffer=!0);var l;if(r._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else if(F(e))for(l=0;i>l;l++)o[l]=r.isBuffer(e)?e.readUInt8(l):e[l];else if("string"===a)o.write(e,0,t);else if("number"===a&&!r._useTypedArrays&&!n)for(l=0;i>l;l++)o[l]=0;return o}function a(e,t,n,a){n=Number(n)||0;var i=e.length-n;a?(a=Number(a),a>i&&(a=i)):a=i;var o=t.length;R(o%2===0,"Invalid hex string"),a>o/2&&(a=o/2);for(var l=0;a>l;l++){var s=parseInt(t.substr(2*l,2),16);R(!isNaN(s),"Invalid hex string"),e[n+l]=s}return r._charsWritten=2*l,l}function i(e,t,n,a){var i=r._charsWritten=C(N(t),e,n,a);return i}function o(e,t,n,a){var i=r._charsWritten=C(B(t),e,n,a);return i}function l(e,t,n,r){return o(e,t,n,r)}function s(e,t,n,a){var i=r._charsWritten=C(q(t),e,n,a);return i}function u(e,t,n,a){var i=r._charsWritten=C(I(t),e,n,a);return i}function d(e,t,n){return H.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function c(e,t,n){var r="",a="";n=Math.min(e.length,n);for(var i=t;n>i;i++)e[i]<=127?(r+=P(a)+String.fromCharCode(e[i]),a=""):a+="%"+e[i].toString(16);return r+P(a)}function p(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;n>a;a++)r+=String.fromCharCode(e[a]);return r}function f(e,t,n){return p(e,t,n)}function h(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var a="",i=t;n>i;i++)a+=V(e[i]);return a}function v(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function g(e,t,n,r){r||(R("boolean"==typeof n,"missing or invalid endian"),R(void 0!==t&&null!==t,"missing offset"),R(t+1<e.length,"Trying to read beyond buffer length"));var a=e.length;if(!(t>=a)){var i;return n?(i=e[t],a>t+1&&(i|=e[t+1]<<8)):(i=e[t]<<8,a>t+1&&(i|=e[t+1])),i}}function m(e,t,n,r){r||(R("boolean"==typeof n,"missing or invalid endian"),R(void 0!==t&&null!==t,"missing offset"),R(t+3<e.length,"Trying to read beyond buffer length"));var a=e.length;if(!(t>=a)){var i;return n?(a>t+2&&(i=e[t+2]<<16),a>t+1&&(i|=e[t+1]<<8),i|=e[t],a>t+3&&(i+=e[t+3]<<24>>>0)):(a>t+1&&(i=e[t+1]<<16),a>t+2&&(i|=e[t+2]<<8),a>t+3&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}}function y(e,t,n,r){r||(R("boolean"==typeof n,"missing or invalid endian"),R(void 0!==t&&null!==t,"missing offset"),R(t+1<e.length,"Trying to read beyond buffer length"));var a=e.length;if(!(t>=a)){var i=g(e,t,n,!0),o=32768&i;return o?-1*(65535-i+1):i}}function x(e,t,n,r){r||(R("boolean"==typeof n,"missing or invalid endian"),R(void 0!==t&&null!==t,"missing offset"),R(t+3<e.length,"Trying to read beyond buffer length"));
var a=e.length;if(!(t>=a)){var i=m(e,t,n,!0),o=2147483648&i;return o?-1*(4294967295-i+1):i}}function b(e,t,n,r){return r||(R("boolean"==typeof n,"missing or invalid endian"),R(t+3<e.length,"Trying to read beyond buffer length")),Y.read(e,t,n,23,4)}function w(e,t,n,r){return r||(R("boolean"==typeof n,"missing or invalid endian"),R(t+7<e.length,"Trying to read beyond buffer length")),Y.read(e,t,n,52,8)}function _(e,t,n,r,a){a||(R(void 0!==t&&null!==t,"missing value"),R("boolean"==typeof r,"missing or invalid endian"),R(void 0!==n&&null!==n,"missing offset"),R(n+1<e.length,"trying to write beyond buffer length"),L(t,65535));var i=e.length;if(!(n>=i))for(var o=0,l=Math.min(i-n,2);l>o;o++)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function k(e,t,n,r,a){a||(R(void 0!==t&&null!==t,"missing value"),R("boolean"==typeof r,"missing or invalid endian"),R(void 0!==n&&null!==n,"missing offset"),R(n+3<e.length,"trying to write beyond buffer length"),L(t,4294967295));var i=e.length;if(!(n>=i))for(var o=0,l=Math.min(i-n,4);l>o;o++)e[n+o]=t>>>8*(r?o:3-o)&255}function z(e,t,n,r,a){a||(R(void 0!==t&&null!==t,"missing value"),R("boolean"==typeof r,"missing or invalid endian"),R(void 0!==n&&null!==n,"missing offset"),R(n+1<e.length,"Trying to write beyond buffer length"),U(t,32767,-32768));var i=e.length;n>=i||(t>=0?_(e,t,n,r,a):_(e,65535+t+1,n,r,a))}function A(e,t,n,r,a){a||(R(void 0!==t&&null!==t,"missing value"),R("boolean"==typeof r,"missing or invalid endian"),R(void 0!==n&&null!==n,"missing offset"),R(n+3<e.length,"Trying to write beyond buffer length"),U(t,2147483647,-2147483648));var i=e.length;n>=i||(t>=0?k(e,t,n,r,a):k(e,4294967295+t+1,n,r,a))}function j(e,t,n,r,a){a||(R(void 0!==t&&null!==t,"missing value"),R("boolean"==typeof r,"missing or invalid endian"),R(void 0!==n&&null!==n,"missing offset"),R(n+3<e.length,"Trying to write beyond buffer length"),D(t,3.4028234663852886e38,-3.4028234663852886e38));var i=e.length;n>=i||Y.write(e,t,n,r,23,4)}function M(e,t,n,r,a){a||(R(void 0!==t&&null!==t,"missing value"),R("boolean"==typeof r,"missing or invalid endian"),R(void 0!==n&&null!==n,"missing offset"),R(n+7<e.length,"Trying to write beyond buffer length"),D(t,1.7976931348623157e308,-1.7976931348623157e308));var i=e.length;n>=i||Y.write(e,t,n,r,52,8)}function E(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function S(e,t,n){return"number"!=typeof e?n:(e=~~e,e>=t?t:e>=0?e:(e+=t,e>=0?e:0))}function T(e){return e=~~Math.ceil(+e),0>e?0:e}function O(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function F(e){return O(e)||r.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function V(e){return 16>e?"0"+e.toString(16):e.toString(16)}function N(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(127>=r)t.push(e.charCodeAt(n));else{var a=n;r>=55296&&57343>=r&&n++;for(var i=encodeURIComponent(e.slice(a,n+1)).substr(1).split("%"),o=0;o<i.length;o++)t.push(parseInt(i[o],16))}}return t}function B(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function I(e){for(var t,n,r,a=[],i=0;i<e.length;i++)t=e.charCodeAt(i),n=t>>8,r=t%256,a.push(r),a.push(n);return a}function q(e){return H.toByteArray(e)}function C(e,t,n,r){for(var a=0;r>a&&!(a+n>=t.length||a>=e.length);a++)t[a+n]=e[a];return a}function P(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function L(e,t){R("number"==typeof e,"cannot write a non-number as a number"),R(e>=0,"specified a negative value for writing an unsigned value"),R(t>=e,"value is larger than maximum value for type"),R(Math.floor(e)===e,"value has a fractional component")}function U(e,t,n){R("number"==typeof e,"cannot write a non-number as a number"),R(t>=e,"value larger than maximum allowed value"),R(e>=n,"value smaller than minimum allowed value"),R(Math.floor(e)===e,"value has a fractional component")}function D(e,t,n){R("number"==typeof e,"cannot write a non-number as a number"),R(t>=e,"value larger than maximum allowed value"),R(e>=n,"value smaller than minimum allowed value")}function R(e,t){if(!e)throw new Error(t||"Failed assertion")}var H=e("base64-js"),Y=e("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192,r._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(n){return!1}}(),r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(e){return!(null===e||void 0===e||!e._isBuffer)},r.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=N(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=q(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(e,t){if(R(O(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new r(0);if(1===e.length)return e[0];var n;if("number"!=typeof t)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var a=new r(t),i=0;for(n=0;n<e.length;n++){var o=e[n];o.copy(a,i),i+=o.length}return a},r.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var d=r;r=t,t=n,n=d}t=Number(t)||0;var c=this.length-t;n?(n=Number(n),n>c&&(n=c)):n=c,r=String(r||"utf8").toLowerCase();var p;switch(r){case"hex":p=a(this,e,t,n);break;case"utf8":case"utf-8":p=i(this,e,t,n);break;case"ascii":p=o(this,e,t,n);break;case"binary":p=l(this,e,t,n);break;case"base64":p=s(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":p=u(this,e,t,n);break;default:throw new Error("Unknown encoding")}return p},r.prototype.toString=function(e,t,n){var r=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,n=void 0!==n?Number(n):n=r.length,n===t)return"";var a;switch(e){case"hex":a=h(r,t,n);break;case"utf8":case"utf-8":a=c(r,t,n);break;case"ascii":a=p(r,t,n);break;case"binary":a=f(r,t,n);break;case"base64":a=d(r,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=v(r,t,n);break;default:throw new Error("Unknown encoding")}return a},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.copy=function(e,t,n,a){var i=this;if(n||(n=0),a||0===a||(a=this.length),t||(t=0),a!==n&&0!==e.length&&0!==i.length){R(a>=n,"sourceEnd < sourceStart"),R(t>=0&&t<e.length,"targetStart out of bounds"),R(n>=0&&n<i.length,"sourceStart out of bounds"),R(a>=0&&a<=i.length,"sourceEnd out of bounds"),a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);var o=a-n;if(100>o||!r._useTypedArrays)for(var l=0;o>l;l++)e[l+t]=this[l+n];else e._set(this.subarray(n,n+o),t)}},r.prototype.slice=function(e,t){var n=this.length;if(e=S(e,n,0),t=S(t,n,n),r._useTypedArrays)return r._augment(this.subarray(e,t));for(var a=t-e,i=new r(a,void 0,!0),o=0;a>o;o++)i[o]=this[o+e];return i},r.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},r.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},r.prototype.readUInt8=function(e,t){return t||(R(void 0!==e&&null!==e,"missing offset"),R(e<this.length,"Trying to read beyond buffer length")),e>=this.length?void 0:this[e]},r.prototype.readUInt16LE=function(e,t){return g(this,e,!0,t)},r.prototype.readUInt16BE=function(e,t){return g(this,e,!1,t)},r.prototype.readUInt32LE=function(e,t){return m(this,e,!0,t)},r.prototype.readUInt32BE=function(e,t){return m(this,e,!1,t)},r.prototype.readInt8=function(e,t){if(t||(R(void 0!==e&&null!==e,"missing offset"),R(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length)){var n=128&this[e];return n?-1*(255-this[e]+1):this[e]}},r.prototype.readInt16LE=function(e,t){return y(this,e,!0,t)},r.prototype.readInt16BE=function(e,t){return y(this,e,!1,t)},r.prototype.readInt32LE=function(e,t){return x(this,e,!0,t)},r.prototype.readInt32BE=function(e,t){return x(this,e,!1,t)},r.prototype.readFloatLE=function(e,t){return b(this,e,!0,t)},r.prototype.readFloatBE=function(e,t){return b(this,e,!1,t)},r.prototype.readDoubleLE=function(e,t){return w(this,e,!0,t)},r.prototype.readDoubleBE=function(e,t){return w(this,e,!1,t)},r.prototype.writeUInt8=function(e,t,n){n||(R(void 0!==e&&null!==e,"missing value"),R(void 0!==t&&null!==t,"missing offset"),R(t<this.length,"trying to write beyond buffer length"),L(e,255)),t>=this.length||(this[t]=e)},r.prototype.writeUInt16LE=function(e,t,n){_(this,e,t,!0,n)},r.prototype.writeUInt16BE=function(e,t,n){_(this,e,t,!1,n)},r.prototype.writeUInt32LE=function(e,t,n){k(this,e,t,!0,n)},r.prototype.writeUInt32BE=function(e,t,n){k(this,e,t,!1,n)},r.prototype.writeInt8=function(e,t,n){n||(R(void 0!==e&&null!==e,"missing value"),R(void 0!==t&&null!==t,"missing offset"),R(t<this.length,"Trying to write beyond buffer length"),U(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},r.prototype.writeInt16LE=function(e,t,n){z(this,e,t,!0,n)},r.prototype.writeInt16BE=function(e,t,n){z(this,e,t,!1,n)},r.prototype.writeInt32LE=function(e,t,n){A(this,e,t,!0,n)},r.prototype.writeInt32BE=function(e,t,n){A(this,e,t,!1,n)},r.prototype.writeFloatLE=function(e,t,n){j(this,e,t,!0,n)},r.prototype.writeFloatBE=function(e,t,n){j(this,e,t,!1,n)},r.prototype.writeDoubleLE=function(e,t,n){M(this,e,t,!0,n)},r.prototype.writeDoubleBE=function(e,t,n){M(this,e,t,!1,n)},r.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),R("number"==typeof e&&!isNaN(e),"value is not a number"),R(n>=t,"end < start"),n!==t&&0!==this.length){R(t>=0&&t<this.length,"start out of bounds"),R(n>=0&&n<=this.length,"end out of bounds");for(var r=t;n>r;r++)this[r]=e}},r.prototype.inspect=function(){for(var e=[],t=this.length,r=0;t>r;r++)if(e[r]=V(this[r]),r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r._useTypedArrays)return new r(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;n>t;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var X=r.prototype;r._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=X.get,e.set=X.set,e.write=X.write,e.toString=X.toString,e.toLocaleString=X.toString,e.toJSON=X.toJSON,e.copy=X.copy,e.slice=X.slice,e.readUInt8=X.readUInt8,e.readUInt16LE=X.readUInt16LE,e.readUInt16BE=X.readUInt16BE,e.readUInt32LE=X.readUInt32LE,e.readUInt32BE=X.readUInt32BE,e.readInt8=X.readInt8,e.readInt16LE=X.readInt16LE,e.readInt16BE=X.readInt16BE,e.readInt32LE=X.readInt32LE,e.readInt32BE=X.readInt32BE,e.readFloatLE=X.readFloatLE,e.readFloatBE=X.readFloatBE,e.readDoubleLE=X.readDoubleLE,e.readDoubleBE=X.readDoubleBE,e.writeUInt8=X.writeUInt8,e.writeUInt16LE=X.writeUInt16LE,e.writeUInt16BE=X.writeUInt16BE,e.writeUInt32LE=X.writeUInt32LE,e.writeUInt32BE=X.writeUInt32BE,e.writeInt8=X.writeInt8,e.writeInt16LE=X.writeInt16LE,e.writeInt16BE=X.writeInt16BE,e.writeInt32LE=X.writeInt32LE,e.writeInt32BE=X.writeInt32BE,e.writeFloatLE=X.writeFloatLE,e.writeFloatBE=X.writeFloatBE,e.writeDoubleLE=X.writeDoubleLE,e.writeDoubleBE=X.writeDoubleBE,e.fill=X.fill,e.inspect=X.inspect,e.toArrayBuffer=X.toArrayBuffer,e}},{"base64-js":29,ieee754:30}],29:[function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===o?62:t===l?63:s>t?-1:s+10>t?t-s+26+26:d+26>t?t-d:u+26>t?t-u+26:void 0}function n(e){function n(e){u[c++]=e}var r,a,o,l,s,u;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var d=e.length;s="="===e.charAt(d-2)?2:"="===e.charAt(d-1)?1:0,u=new i(3*e.length/4-s),o=s>0?e.length-4:e.length;var c=0;for(r=0,a=0;o>r;r+=4,a+=3)l=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&l)>>16),n((65280&l)>>8),n(255&l);return 2===s?(l=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&l)):1===s&&(l=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(l>>8&255),n(255&l)),u}function a(e){function t(e){return r.charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var a,i,o,l=e.length%3,s="";for(a=0,o=e.length-l;o>a;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],s+=n(i);switch(l){case 1:i=e[e.length-1],s+=t(i>>2),s+=t(i<<4&63),s+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],s+=t(i>>10),s+=t(i>>4&63),s+=t(i<<2&63),s+="="}return s}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="+".charCodeAt(0),l="/".charCodeAt(0),s="0".charCodeAt(0),u="a".charCodeAt(0),d="A".charCodeAt(0);e.toByteArray=n,e.fromByteArray=a}("undefined"==typeof n?this.base64js={}:n)},{}],30:[function(e,t,n){n.read=function(e,t,n,r,a){var i,o,l=8*a-r-1,s=(1<<l)-1,u=s>>1,d=-7,c=n?a-1:0,p=n?-1:1,f=e[t+c];for(c+=p,i=f&(1<<-d)-1,f>>=-d,d+=l;d>0;i=256*i+e[t+c],c+=p,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=r;d>0;o=256*o+e[t+c],c+=p,d-=8);if(0===i)i=1-u;else{if(i===s)return o?0/0:1/0*(f?-1:1);o+=Math.pow(2,r),i-=u}return(f?-1:1)*o*Math.pow(2,i-r)},n.write=function(e,t,n,r,a,i){var o,l,s,u=8*i-a-1,d=(1<<u)-1,c=d>>1,p=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,h=r?1:-1,v=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(l=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-o))<1&&(o--,s*=2),t+=o+c>=1?p/s:p*Math.pow(2,1-c),t*s>=2&&(o++,s/=2),o+c>=d?(l=0,o=d):o+c>=1?(l=(t*s-1)*Math.pow(2,a),o+=c):(l=t*Math.pow(2,c-1)*Math.pow(2,a),o=0));a>=8;e[n+f]=255&l,f+=h,l/=256,a-=8);for(o=o<<a|l,u+=a;u>0;e[n+f]=255&o,f+=h,o/=256,u-=8);e[n+f-h]|=128*v}},{}],31:[function(e){var t=e("../core/fetch/value.js"),n=e("../core/fetch/color.js"),r=e("../core/fetch/text.js");d3plus.array.sort=function(e,a,i,o,l){function s(e,s){for(var u=0,d=0;d<a.length;d++){var c=a[d];if(l){var p=e.d3plus?l.id.nesting[e.d3plus.depth]:void 0,f=e.d3plus?e.d3plus.depth:void 0;e=c===l.color.value?n(l,e,p):c===l.text.value?r(l,e,f):t(l,e,c,p);var p=s.d3plus?l.id.nesting[s.d3plus.depth]:void 0,f=s.d3plus?s.d3plus.depth:void 0;s=c===l.color.value?n(l,s,p):c===l.text.value?r(l,s,f):t(l,s,c,p)}else e=e[c],s=s[c];if(e=e instanceof Array?e=e[0]:"string"==typeof e?e=e.toLowerCase():e,s=s instanceof Array?s=s[0]:"string"==typeof s?s=s.toLowerCase():s,u=o.indexOf(c)>=0?d3plus.color.sort(e,s):s>e?-1:1,0!==u||d===a.length-1)break}return"asc"===i?u:-u}if(!e||e.length<=1||!a)return e||[];if(!i)var i="asc";if(a instanceof Array||(a=[a]),o)o instanceof Array||(o=[o]);else var o=["color"];return 2===e.length?s(e[0],e[1]):e.sort(s)}},{"../core/fetch/color.js":48,"../core/fetch/text.js":50,"../core/fetch/value.js":51}],32:[function(){d3plus.array.update=function(e,t){return e instanceof Array||(e=[]),t instanceof Array?e=t:e.indexOf(t)>=0?e.splice(e.indexOf(t),1):e.push(t),e}},{}],33:[function(){d3plus.color.legible=function(e){var t;return t=d3.hsl(e),t.l>.45&&(t.s>.8&&(t.s=.8),t.l=.45),t.toString()}},{}],34:[function(){d3plus.color.lighter=function(e,t){var n;return void 0===t&&(t=.5),n=d3.hsl(e),n.l+=(1-n.l)*t,n.toString()}},{}],35:[function(){d3plus.color.mix=function(e,t,n,r){var a,i,o;return n||(n=1),r||(r=1),e=d3.rgb(e),t=d3.rgb(t),o=(n*e.r+r*t.r-n*r*t.r)/(n+r-n*r),i=(n*e.g+r*t.g-n*r*t.g)/(n+r-n*r),a=(n*e.b+r*t.b-n*r*t.b)/(n+r-n*r),d3.rgb(o,i,a).toString()}},{}],36:[function(){d3plus.color.random=function(e,t){var n;return n=e||Math.floor(20*Math.random()),(t=t||d3plus.color.scale)(n)}},{}],37:[function(){d3plus.color.scale=d3.scale.ordinal().range(["#b22200","#EACE3F","#282F6B","#B35C1E","#224F20","#5F487C","#759143","#419391","#993F88","#e89c89","#ffee8d","#afd5e8","#f7ba77","#a5c697","#c5b5e5","#d1d392","#bbefd0","#e099cf"])},{}],38:[function(){d3plus.color.sort=function(e,t){var n,r;return n=d3.hsl(e),r=d3.hsl(t),e=0===n.s?361:n.h,t=0===r.s?361:r.h,e===t?n.l-r.l:e-t}},{}],39:[function(){d3plus.color.text=function(e){var t,n,r,a,i;return a=d3.rgb(e),r=a.r,n=a.g,t=a.b,i=(299*r+587*n+114*t)/1e3,i>=128?"#444444":"#f7f7f7"}},{}],40:[function(){d3plus.color.validate=function(e){var t,n,r;return e+="",e=e.replace(RegExp(" ","g"),""),0===e.indexOf("rgb")&&(e=e.split("(")[1].split(")")[0].split(",").slice(0,3).join(",")),0===e.indexOf("hsl")&&(e=e.split(",")[2].split(")")[0]),n=d3.rgb(e).toString(),t=["black","#000","#000000","0%","0,0,0"],r=t.indexOf(e)>=0,"#000000"!==n||r}},{}],41:[function(e,t){var n=e("../fetch/value.js");t.exports=function(e){e.dev.value&&d3plus.console.time("getting color data range");var t=[];if(e.data.pool.forEach(function(r){var a=parseFloat(n(e,r,e.color.value));"number"==typeof a&&!isNaN(a)&&t.indexOf(a)<0&&t.push(a)}),e.dev.value&&d3plus.console.timeEnd("getting color data range"),t.length>1){if(e.dev.value&&d3plus.console.time("calculating color scale"),t=d3.extent(t),t[0]<0&&t[1]>0){var r=e.color.range;3==r.length&&(t.push(t[1]),t[1]=0)}else if(t[1]>0&&t[0]>=0){var r=e.color.heatmap;t=d3plus.util.buckets(t,r.length)}else{var r=e.color.range.slice(0);t[0]<0?r.pop():r.shift()}e.color.valueScale=d3.scale.sqrt().domain(t).range(r).interpolate(d3.interpolateRgb),e.dev.value&&d3plus.console.timeEnd("calculating color scale")}else e.color.valueScale=null}},{"../fetch/value.js":51}],42:[function(e,t){var n=e("../fetch/value.js");t.exports=function(e,t){e.dev.value&&d3plus.console.time("filtering data");var r=d3.keys(e.data.keys||{});"attrs"in e&&(r=r.concat(d3.keys(e.attrs.keys||{}))),t=t.filter(function(t){return e.id.value in t}),e.data.filters.forEach(function(a){r.indexOf(e[a].value)>=0&&(t=t.filter(function(t){var r=n(e,t,e[a].value);return"size"===a?"number"==typeof r:null!==r}))});var a=e.data.solo.length?"solo":"mute";return e.data[a].forEach(function(r){function i(t){var n=e[r][a].value,i=!1;return n.forEach(function(e){"function"==typeof e?i=e(t):e===t&&(i=!0)}),i}function o(t){var o=!1;if(e[r].nesting){var l=e[r].nesting;d3plus.object.validate(l)&&(l=d3.keys(l)),l.forEach(function(r){o||(o=i(n(e,t,r)))})}else o=i(n(e,t,e[r].value));return"solo"===a?o:!o}t=t.filter(o),"id"===r&&("nodes"in e&&e.nodes.value&&(e.dev.value&&d3plus.console.log("Filtering Nodes"),e.nodes.restricted=e.nodes.value.filter(o)),"edges"in e&&e.edges.value&&(e.dev.value&&d3plus.console.log("Filtering Connections"),e.edges.restricted=e.edges.value.filter(function(t){var n=o(t[e.edges.source]),r=o(t[e.edges.target]);return n&&r})))}),e.dev.value&&d3plus.console.timeEnd("filtering data"),t}},{"../fetch/value.js":51}],43:[function(e,t){var n=e("./nest.js"),r=e("../fetch/value.js");t.exports=function(e){if(e.data.time={values:[]},e.time&&e.time.value){if(e.dev.value){var t="analyzing time periods";d3plus.console.time(t)}for(var a=d3plus.util.uniques(e.data.value,e.time.value),i=0;i<a.length;i++){var o=new Date(a[i].toString());"Invalid Date"!==o&&(o.setTime(o.getTime()+60*o.getTimezoneOffset()*1e3),e.data.time.values.push(o))}e.data.time.values.sort(function(e,t){return e-t});var l=[];e.data.time.values.forEach(function(t,n){if(0!=n){var r=e.data.time.values[n-1];l.push(t-r),n===e.data.time.values.length-1&&(e.data.time.total=t-e.data.time.values[0])}}),e.data.time.step=d3.min(l);var s=["Milliseconds","Seconds","Minutes","Hours","Date","Month","FullYear"],u=[1e3,60,60,24,30,12,1],d=function(t,n,r){return e.data.time.stepDivider||(e.data.time.stepDivider=u.slice(0,r).reduce(function(e,t){return e*t})),Math.round(Math.floor(n-t)/e.data.time.stepDivider)},l=e.data.time.step,c=e.data.time.total;s.forEach(function(t,n){if(!e.data.time.stepType&&(n===s.length-1||Math.round(l)<u[n])){e.data.time.stepType=t;var r=e.data.time.values[0],a=e.data.time.values[e.data.time.values.length-1];e.data.time.stepIntervals=d(r,a,n)}!e.data.time.totalType&&(n===s.length-1||Math.round(c)<u[n])&&(e.data.time.totalType=t),l/=u[n],c/=u[n]}),e.data.time.values.forEach(function(t,n){if(0!=n){var r=e.data.time.values[0];e.data.time.dataSteps.push(d(r,t,s.indexOf(e.data.time.stepType)))}else e.data.time.dataSteps=[0]});for(var p=e.data.time.stepType,f=e.data.time.totalType,h=e.format.locale.value,v=function(e,t,n){if(e===t)return n&&h.timeFormat[e+"Small"]?h.timeFormat[e+"Small"]:h.timeFormat[e];if(s.indexOf(e)>=4||s.indexOf(t)<=3)return h.timeFormat[t+"-"+e];if("Date"===t)var r=h.timeFormat[t];else var r=h.timeFormat[t+"-Date"];return"Hours"===e?r+" "+h.timeFormat[e]:r+" "+h.timeFormat["Hours-"+e]},g=[],m=[,function(e){return e.getMilliseconds()},function(e){return e.getSeconds()},function(e){return e.getMinutes()},function(e){return e.getHours()},function(e){return 1!=e.getDate()},function(e){return e.getMonth()},function(){return!0}],i=s.indexOf(p);i<=s.indexOf(f);i++){var y=i-1<s.indexOf(p)?s[i]:s[i-1],x=s[i]===y&&p!==f,b=v(y,s[i],x);g.push([b,m[i+1]])}e.data.time.format=d3.locale(h.format).timeFormat(v(p,f)),e.data.time.multiFormat=d3.locale(h.format).timeFormat.multi(g),e.data.time.ticks=[];for(var w=d3.min(e.data.time.values),i=0;i<=e.data.time.stepIntervals;i++){var o=new Date(w);o["set"+e.data.time.stepType](o["get"+e.data.time.stepType]()+i),e.data.time.ticks.push(o)}e.dev.value&&d3plus.console.timeEnd(t)}if(e.dev.value){var t="nesting data by time and depths";d3plus.console.time(t)}e.data.nested={},0===e.data.time.values.length?(e.data.nested.all={},e.id.nesting.forEach(function(t,r){var a=e.id.nesting.slice(0,r+1);e.data.nested.all[t]=n(e,e.data.value,a)})):e.data.time.values.forEach(function(t){var a=t.getTime();e.data.nested[a]={};var i=e.data.value.filter(function(t){var t=new Date(r(e,t,e.time.value).toString());return t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3),t.getTime()===a});e.id.nesting.forEach(function(t,r){var o=e.id.nesting.slice(0,r+1);e.data.nested[a][t]=n(e,i,o)})}),e.dev.value&&d3plus.console.timeEnd(t)}},{"../fetch/value.js":51,"./nest.js":46}],44:[function(e,t){t.exports=function(e,t){function n(r){if(r instanceof Array)r.forEach(function(e){n(e)});else if(d3plus.object.validate(r))for(var a in r)d3plus.object.validate(r[a])?n(r[a]):!(a in e[t].keys)&&a in r&&(e[t].keys[a]=typeof r[a])}if(e.dev.value){var r=t+" key analysis";console.time(r)}if(e[t].keys={},d3plus.object.validate(e[t].value))for(var a in e[t].value)n(e[t].value[a]);else n(e[t].value);e.dev.value&&console.time(r)}},{}],45:[function(e,t){t.exports=function(e,t,n){var r,a,i;return e.dev.value&&d3plus.console.time("loading "+t),i=e[t].url,e[t].filetype.value?r=e[t].filetype.value:(r=i.slice(i.length-5).split("."),r=r.length>1?r[1]:!1,r?("txt"===r&&(r="text"),e[t].filetype.accepted.indexOf(r)<0&&(r="json")):r="json"),(a="dsv"===r?d3.dsv(e[t].delimiter.value,"text/plain"):d3[r])(i,function(a,o){var l,s;if(!a&&o){if("function"==typeof e[t].callback){if(s=e[t].callback(o))if(d3plus.object.validate(s)&&t in s)for(l in s)l in e&&(e[l].value=s[l]);else e[t].value=s}else e[t].value=o;["json"].indexOf(r)<0&&e[t].value.forEach(function(e){var t;t=[];for(l in e)t.push(isNaN(e[l])?"false"===e[l].toLowerCase()?e[l]=!1:"true"===e[l].toLowerCase()?e[l]=!0:"null"===e[l].toLowerCase()?e[l]=null:"undefined"===e[l].toLowerCase()?e[l]=void 0:void 0:e[l]=parseFloat(e[l]));return t}),e[t].changed=!0,e[t].loaded=!0}else e.internal_error='Could not load data from: "'+i+'"';return e.dev.value&&d3plus.console.time("loading "+t),n()})}},{}],46:[function(e,t){var n=e("../fetch/value.js"),r=function(e,t,a,i){var o=d3.nest(),l=[],s="viz"===e.shell?["active","temp","total"]:[],i=i||e.types[e.type.value].requirements||[],u="viz"===e.shell?[e.time.value,e.icon.value]:[],d=function(){i&&i.length&&e.axes.values.forEach(function(t){var r=e[t].value;i.indexOf(t)>=0&&r&&"continuous"===e[t].scale.value&&(u.push(r),o.key(function(t){return n(e,t,r)}))})};i instanceof Array||(i=[i]),a.forEach(function(t){o.key(function(r){return"function"==typeof t?t(r):n(e,r,t)}),d()}),a.length||(o.key(function(){return!0}),d());var c=a.length?a.length-1:0;o.rollup(function(t){function i(e){for(var t=0;t<e.length;t++){var n=e[t];void 0!==n&&(n.constructor===Date?y.push(n):n.constructor===Array?i(n):(n=new Date(n.toString()),"Invalid Date"!==n&&(n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3),y.push(n))))}}function o(e){e instanceof Array?e.forEach(o):d3plus.object.validate(e)&&d in e&&(e[d]instanceof Array?e[d].forEach(o):x.push(e))}if(1===t.length&&"d3plus"in t[0])return l.push(t[0]),t[0];var u={d3plus:{depth:c}};"d3plus"in t[0]&&t.forEach(function(e){"d3plus"in e&&(e.d3plus.merged instanceof Array&&(u.d3plus.merged||(u.d3plus.merged=[]),u.d3plus.merged=u.d3plus.merged.concat(e.d3plus.merged)),e.d3plus.text&&(u.d3plus.text=e.d3plus.text))}),s.forEach(function(r){var a=e[r].value||r;u.d3plus[a]=d3.sum(t,function(t){if(e[r].value){var a=n(e,t,e[r].value);"number"!=typeof a&&(a=a?1:0)}else if("total"===r)var a=1;else var a=0;return a})});for(var d in e.data.keys){var p=e.aggs.value[d]||"sum",f=typeof p,h=e.data.keys[d],v=e.id.nesting.indexOf(d)>=0,g="time"in e&&d===e.time.value;if(d in u.d3plus)u[d]=u.d3plus[d];else if("function"===f)u[d]=e.aggs.value[d](t);else if(g){var m=d3plus.util.uniques(t,d),y=[];i(m),u[d]=1===y.length?y[0]:m.length?y:null}else if("number"!==h||"string"!==f||v){var x=[];o(t);var b=1===x.length?x[0][d]:d3plus.util.uniques(x,d);if(void 0!==b&&null!==b){if(b instanceof Array||(b=[b]),b.length)if(v&&e.id.nesting.indexOf(d)>c&&x.length>1){if("id"==d&&1==a.length&&x.length>t.length){var w=a.concat(d);x=r(e,x,w)}u[d]=1===x.length?x[0]:x}else u[d]=1===b.length?b[0]:b}else if(v){var _=e.id.nesting.indexOf(d)-1;_>=c&&(!("endPoint"in u.d3plus)||u.d3plus.endPoint>c)&&(u.d3plus.endPoint=c)}}else{var m=d3plus.util.uniques(t,d);u[d]=m.length?d3[p](m):null}}return l.push(u),u});var p=function(e){return e.values&&e.values.length?(e.children=e.values.map(function(e){return p(e)}),delete e.values,e):e.values?e.values:e},f=function(t,n,r){if(t.children){"number"==e.data.keys[a[n]]&&(t.key=parseFloat(t.key)),r[a[n]]=t.key,delete t.key;for(var i in r)t[i]=r[i];n++,t.children.forEach(function(e){f(e,n,r)})}};return o=o.entries(t).map(p).map(function(e){return f(e,0,{}),e}),l};t.exports=r},{"../fetch/value.js":51}],47:[function(e,t){var n=e("./nest.js"),r=e("../fetch/value.js"),a=(e("../fetch/color.js"),e("../fetch/text.js"));t.exports=function(e,t,i){if(e.size.threshold===!1)var o=0;else if("number"==typeof e.size.threshold)var o=e.size.threshold;else if("number"==typeof e.types[e.type.value].threshold)var o=e.types[e.type.value].threshold;else if("function"==typeof e.types[e.type.value].threshold)var o=e.types[e.type.value].threshold(e);else var o=.02;if("number"==typeof o&&o>0){var l=[],s=0==e.depth.value?0:{},u=[],d={},c=d3.nest();i&&c.key(function(t){return r(e,t,i)}),c.rollup(function(t){var n=t.length;e.aggs[e.size.value]?"function"==typeof e.aggs[e.size.value]?n=e.aggs[e.size.value](t):"string"==typeof e.aggs[e.size.value]&&(n=d3[e.aggs[e.size.value]](t,function(t){return r(e,t,e.size.value)})):n=d3.sum(t,function(t){return r(e,t,e.size.value)});var a=i?r(e,t[0],i):"all";return d[a]=n,n}).entries(t);var p=t.filter(function(t){var n=r(e,t,e.id.value),a=r(e,t,e.size.value),c=i?r(e,t,i):"all";if(l.indexOf(n)<0&&a/d[c]>=o&&l.push(n),l.indexOf(n)<0){if(0==e.depth.value)a>s&&(s=a);else{var p=t[e.id.nesting[e.depth.value-1]];p in s||(s[p]=0),a>s[p]&&(s[p]=a)}return u.push(t),!1}return!0});if(u.length>1){u=d3plus.array.sort(u,e.size.value,"desc",[],e);var f=e.id.nesting.slice(0,e.depth.value),h=n(e,u,f);h.forEach(function(t){var n=e.id.nesting[e.depth.value-1];if(e.id.nesting.forEach(function(n,r){if(e.depth.value==r){var a=t[e.id.nesting[r-1]];t[n]="string"==typeof a?"d3plus_other_"+a:"d3plus_other"}else r>e.depth.value&&delete t[n]}),e.color.value&&"string"===e.color.type&&(t[e.color.value]=0==e.depth.value?e.color.missing:r(e,t[n],e.color.value,n)),e.icon.value&&(t[e.icon.value]=r(e,t[n],e.icon.value,n)),t[n]&&(t.d3plus.depth=e.depth.value),0==e.depth.value){var i=e.format.value(e.format.locale.value.ui.values);i+=" < "+e.format.value(s)}else{var i=a(e,t,e.depth.value-1);i=i.length?i[0].split(" < ")[0]:e.format.value(e.format.locale.value.ui.values),i+=" < "+e.format.value(s[t[n]],e.size.value)}i+=" ("+e.format.value(100*o)+"%)",t.d3plus.threshold=s,n?(t.d3plus.merged=[],u.forEach(function(e){t[n]==e[n]&&t.d3plus.merged.push(e)})):t.d3plus.merged=u,e.text.value?t[e.text.value]=i:t.d3plus.text=i})}else h=u;return p.concat(h)}return t}},{"../fetch/color.js":48,"../fetch/text.js":50,"../fetch/value.js":51,"./nest.js":46}],48:[function(e,t){var n=e("./value.js");t.exports=function(e,t,r){function a(t){return d3plus.object.validate(t)&&(t=t[r]),t instanceof Array&&(t=t[0]),d3plus.color.random(t,e.color.scale.value)}if(!r)var r=e.id.value;if(e.color.value){for(var i=e.id.nesting.indexOf(r);i>=0;i--){var o=e.id.nesting[i],l=d3plus.object.validate(t)&&!(e.color.value in t)&&t[r]instanceof Array?t[r][0]:n(e,t,o),s=n(e,l,e.color.value,o);if(s)break}return s?e.color.valueScale?e.color.valueScale(s):d3plus.color.validate(s)?s:a(s):e.color.value||"function"==typeof e.color.valueScale?e.color.missing:a(t)}return a(t)}},{"./value.js":51}],49:[function(e,t){var n=e("../data/filter.js"),r=e("../data/nest.js");t.exports=function(e,t){if(!e.data.value)return[];if(!t&&"time"in e){var a=e.time.solo.value.length?"solo":"mute",t=[];if(e.time[a].value.length){var t=[];e.time[a].value.forEach(function(n){if("function"==typeof n)e.data.time.values.forEach(function(e){n(e.getTime())&&t.push(e.getTime())});else if(n.constructor===Date)t.push(new Date(n).getTime());else{var r=new Date(n.toString());"Invalid Date"!==r&&(r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3),t.push(r.getTime()))}}),"mute"===a&&(t=e.data.time.values.filter(function(e){return t.indexOf(e.getTime())<0}))}else t.push("all")}else t=["all"];if(t.indexOf("all")>=0&&e.data.time.values.length){t=e.data.time.values.slice(0);for(var i=0;i<t.length;i++)t[i]=t[i].getTime()}var o=[e.type.value,e.id.value,e.depth.value].concat(e.data.filters).concat(t),l=e.data.solo.length?"solo":"mute",s=d3.keys(e.data.cache),u="viz"===e.shell?e.types[e.type.value].filter:null;e.data[l].length&&e.data[l].forEach(function(t){var n=e[t][l].value.slice(0);n.unshift(t),o=o.concat(n)}),o=o.join("_");for(var i=0;i<s.length;i++){var d=s[i].split("_").slice(1).join("_");if(d===o){o=(new Date).getTime()+"_"+o,e.data.cache[o]=e.data.cache[s[i]],delete e.data.cache[s[i]];break}}if(e.data.cache[o]){e.dev.value&&d3plus.console.comment("data already cached");var c=e.data.cache[o];return"function"==typeof u&&(c=u(e,c)),c}var p=[],c=[];if(e.data.value&&e.data.value.length&&t.forEach(function(t){e.data.nested[t]?c=c.concat(e.data.nested[t][e.id.value]):p.push(t)}),0===c.length&&p.length&&!e.internal_error){var f=e.time.format.value||e.data.time.format;p.length>1&&(p=d3.extent(p)),p=p.map(function(e){return f(new Date(e))}),p=p.join(" - ");var h=e.format.locale.value.error.dataYear,v=e.format.locale.value.ui.and;p=d3plus.string.list(p,v),e.internal_error=d3plus.string.format(h,p),e.time.missing=!0}else{if(e.time&&(e.time.missing=!1),t.length>1){var g=!1;if(e.axes.values.forEach(function(t){e[t].value===e.time.value&&"continuous"===e[t].scale.value&&(g=!0)}),!g){var m=e.id.nesting.slice(0,e.depth.value+1);c=r(e,c,m)}}c=c?n(e,c):[];var s=d3.keys(e.data.cache);20===s.length&&(s.sort(),delete e.data.cache(s[0])),o=(new Date).getTime()+"_"+o,e.data.cache[o]=c,"function"==typeof u&&(c=u(e,c)),e.dev.value&&d3plus.console.comment("storing data in cache")}return c}},{"../data/filter.js":42,"../data/nest.js":46}],50:[function(e,t){var n=e("./value.js");t.exports=function(e,t,r){if("number"!=typeof r)var r=e.depth.value;var a=e.id.nesting[r];if(e.text.nesting&&d3plus.object.validate(e.text.nesting))if(e.text.nesting[a])var i=e.text.nesting[a];else var i=e.text.value;else{var i=[];e.text.value&&r===e.depth.value&&i.push(e.text.value),i.push(a)
}i instanceof Array||(i=[i]);var o=[];if(d3plus.object.validate(t)&&"d3plus"in t&&t.d3plus.text)o.push(t.d3plus.text.toString());else{var l=d3plus.object.validate(t)&&a in t?t[a]:n(e,t,a);l instanceof Array?d3plus.object.validate(l[0])&&(l=d3plus.util.uniques(l,a)):l=[l],i.forEach(function(t){var r=[];l.forEach(function(i){var o=n(e,i,t,a);o&&(o instanceof Array&&d3plus.object.validate(o[0])&&(o=d3plus.util.uniques(o,t)),r=r.concat(o))}),r.length&&(r=r.map(function(n){return n instanceof Array?n.map(function(n){return e.format.value(n.toString(),t)}):n?e.format.value(n.toString(),t):void 0}),1===r.length&&(r=r[0]),o.push(r))})}return o}},{"./value.js":51}],51:[function(e,t){t.exports=function(e,t,n,r){function a(e){if(t instanceof Array){var n=d3plus.util.uniques(t,r);return e.filter(function(e){return n.indexOf(e[r])>=0})}return e.filter(function(e){return e[r]===t})}function i(e){var t=d3plus.util.uniques(e,n);return 1===t.length?t[0]:void 0}if(n&&"function"==typeof n)return n(t);if(!n)return null;if(!r)if(d3plus.object.validate(n)){if(n[e.id.value])var r=e.id.value;else var r=d3.keys(n)[0];n=n[r]}else var r=e.id.value;if(n===r){if(d3plus.object.validate(t)&&n in t)return t[n];if(!(t instanceof Array))return t}if(d3plus.object.validate(t)&&n in t)return t[n];if(d3plus.object.validate(t)&&r in t){var o=i(t);if(o)return o;t=t[r]}if(t instanceof Array){var o=i(t);if(o)return o}if(e.data.app instanceof Array){var o=i(a(e.data.app));if(o)return o}if("attrs"in e&&e.attrs.value)if(e.attrs.value instanceof Array)var l=a(e.attrs.value);else if(r in e.attrs.value)if(e.attrs.value[r]instanceof Array)var l=a(e.attrs.value[r]);else var l=e.attrs.value[r];else var l=e.attrs.value;if(d3plus.object.validate(l)){var s=[];t instanceof Array?(d3plus.object.validate(t[0])&&(t=d3plus.util.uniques(t,r)),t.forEach(function(e){s.push(l[e])})):s.push(l[t]),l=s}if(l&&l.length){var u=d3plus.util.uniques(l,n);if(1===u.length)return u[0];if(u.length)return u}return null}},{}],52:[function(e,t){t.exports=function(e){var t,n;return["div","svg"].indexOf(e)<0&&(e="div"),t={position:"absolute",left:"-9999px",top:"-9999px",visibility:"hidden",display:"block"},n=d3.select("body").selectAll(e+".d3plus_tester").data(["d3plus_tester"]),n.enter().append(e).attr("class","d3plus_tester").style(t),n}},{}],53:[function(e,t){var n=function(e,t){e.changed&&(e.changed=!1),"draw"===t&&(e.frozen=!1,e.update=!0,e.first=!1);for(var r in e)d3plus.object.validate(e[r])&&n(e[r],r)};t.exports=n},{}],54:[function(e,t){t.exports=function(e){if(e.dev.value){var t="analyzing edges list";d3plus.console.time(t)}var n=e.types[e.type.value].requirements;n instanceof Array||(n=[n]);var r=n.indexOf("nodes")>=0&&!e.nodes.value;if(r){e.nodes.value=[];var a=[];e.nodes.changed=!0}e.edges.value.forEach(function(t){if("object"!=typeof t[e.edges.source]){var n={};n[e.id.value]=t[e.edges.source],t[e.edges.source]=n}if("object"!=typeof t[e.edges.target]){var n={};n[e.id.value]=t[e.edges.target],t[e.edges.target]=n}"keys"in e.data||(e.data.keys={}),e.id.value in e.data.keys||(e.data.keys[e.id.value]=typeof t[e.edges.source][e.id.value]),r&&(a.indexOf(t[e.edges.source][e.id.value])<0&&(a.push(t[e.edges.source][e.id.value]),e.nodes.value.push(t[e.edges.source])),a.indexOf(t[e.edges.target][e.id.value])<0&&(a.push(t[e.edges.target][e.id.value]),e.nodes.value.push(t[e.edges.target])))}),e.edges.value=e.edges.value.filter(function(t){var n=t[e.edges.source][e.id.value],r=t[e.edges.target][e.id.value];if(n===r){var a=e.format.locale.value.dev.sameEdge;return d3plus.console.warning(d3plus.string.format(a,'"'+n+'"'),"edges"),!1}return!0}),e.edges.linked=!0,e.dev.value&&d3plus.console.timeEnd(t)}},{}],55:[function(e,t){t.exports=function(e){function t(e,t){[].forEach.call(t.attributes,function(t){if(/^data-/.test(t.name)){var n=t.name.substr(5).replace(/-(.)/g,function(e,t){return t.toUpperCase()});e[n]=t.value}}),r.forEach(function(n){null!==t.getAttribute(n)&&(e[n]=t.getAttribute(n))})}function n(e){e.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}var r=[e.color.value,e.icon.value,e.keywords.value,e.alt.value,"style"];e.text.value||e.self.text("text"),r=r.concat(e.id.nesting),e.self.data({element:e.data.value});var a=e.data.element.value.node().tagName.toLowerCase(),i=e.data.element.value.attr("type"),o=[];if("select"===a){var l=e.data.element.value.node().id;l&&e.self.container({id:l}),e.data.element.value.selectAll("option").each(function(n,r){var a={};if(a.text=this.innerHTML,t(a,this),o.push(a),this.selected)for(var r=e.id.nesting.length-1;r>=0;r--){var i=e.id.nesting[r];if(i in a){e.self.focus(a[i]);break}}})}else if("input"===a&&"radio"===i){var s=e.data.element.value.node().getAttribute("name");s&&e.self.container({id:s}),e.data.element.value.each(function(){var r={};t(r,this);var a=r[e.id.value]||this.id||!1;if(a&&isNaN(parseFloat(a))){var i=d3.select("label[for="+a+"]");i.empty()||(r.text=i.html(),i.call(n))}o.push(r),this.checked&&(e.focus.value[0]=r[e.id.value])})}!e.focus.value.length&&o.length&&(e.data.element.value.node().selectedIndex=0,e.self.focus(o[0][e.id.value]));var u=d3.select("legend[for="+e.container.id+"]");u.empty()||(e.self.title(u.html()),u.call(n));var d=e.container.value?e.container.value.node().tagName.toLowerCase():!1;return(e.container.value===!1||"body"===d)&&(e.container.value=d3.select(e.data.element.value.node().parentNode)),o}},{}],56:[function(e,t){t.exports=function(e){if(e.dev.value){var t="analyzing node positions";d3plus.console.time(t)}var n=e.nodes.value.filter(function(e){return"number"==typeof e.x&&"number"==typeof e.y}).length;if(n==e.nodes.value.length)e.nodes.positions=!0;else{var r=d3.layout.force().size([e.width.viz,e.height.viz]).nodes(e.nodes.value).links(e.edges.value),a=50,i=.01;r.start();for(var o=a;o>0&&(r.tick(),!(r.alpha()<i));--o);r.stop(),e.nodes.positions=!0}e.dev.value&&d3plus.console.timeEnd(t)}},{}],57:[function(e){var t;t=e("numeric"),d3plus.data.bestRegress=function(e,n){var r,a,i,o,l,s,u,d,c,p,f,h,v,g,m,y,x,b,w,_,k,z,A,j,M;for(null==n&&(n={}),null==n.maxDegree&&(n.maxDegree=5),r=e.length,m=Number.MAX_VALUE,l=null,i=function(){var t,r,a;for(a=[],d=t=1,r=n.maxDegree+1;r>=1?r>t:t>r;d=r>=1?++t:--t)a.push(function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)g=e[t],r.push(Math.pow(g[0],d));return r}());return a}(),_=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)g=e[t],r.push(g[1]);return r}(),p=z=0,j=1<<n.maxDegree;j>=0?j>z:z>j;p=j>=0?++z:--z){for(o=[function(){var e,t;for(t=[],y=e=0;r>=0?r>e:e>r;y=r>=0?++e:--e)t.push(1);return t}()],c=[0],f=A=0,M=n.maxDegree;M>=0?M>A:A>M;f=M>=0?++A:--A)(p&1<<f)>0&&(o.push(i[f]),c.push(f+1));a=t.transpose(o),h=c.length,s=t.dot(t.dot(t.inv(t.dot(o,a)),o),_),k=t.dot(a,s),x=t.sub(_,k),w=t.dot(x,x),b=w/(r-h),v=-.5*r*Math.log(2*Math.PI)-.5*r*Math.log(b)-w/(2*b),u=-2*v+h*(Math.log(r)-Math.log(2*Math.PI)),m>u&&(m=u,l=[c,s,k])}return l}},{numeric:3}],58:[function(e){var t;t=e("static-kdtree"),d3plus.data.lof=function(e,n){var r,a,i,o,l,s,u,d,c,p,f,h;return null==n&&(n=10),h=t(e),u=function(){var t,r,a;for(a=[],t=0,r=e.length;r>t;t++)d=e[t],a.push(h.knn(d,n+1).slice(1));return a}(),f=function(t,n){var r,a,i,o,l,s;for(r=e[t],a=e[n],o=0,t=l=0,s=r.length;s>=0?s>l:l>s;t=s>=0?++l:--l)i=r[t]-a[t],o+=i*i;return o},o=function(){var t,r,i;for(i=[],a=t=0,r=e.length;r>=0?r>t:t>r;a=r>=0?++t:--t)i.push(f(a,u[a][n-1]));return i}(),c=function(e,t){return Math.max(f(e,t),o[t])},l=function(e){var t,r,a,i,o;for(r=0,o=u[e],a=0,i=o.length;i>a;a++)t=o[a],r+=c(e,t);return n/r},s=function(){var t,n,r;for(r=[],a=t=0,n=e.length;n>=0?n>t:t>n;a=n>=0?++t:--t)r.push(l(a));return r}(),p=function(){var t,o,l,d,c,p;for(p=[],a=t=0,d=e.length;d>=0?d>t:t>d;a=d>=0?++t:--t){for(r=0,c=u[a],o=0,l=c.length;l>o;o++)i=c[o],r+=s[i];r/=n,p.push([a,r/s[a]])}return p}(),p.sort(function(e,t){return t[1]-e[1]}),p}},{"static-kdtree":5}],59:[function(){d3plus.data.mad=function(e){var t,n,r;return n=d3.median(e),t=d3.median(e.map(function(e){return Math.abs(e-n)})),r=e.map(function(e,r){return[r,Math.abs(e-n)/t]}),r.sort(function(e,t){return t[1]-e[1]}),r}},{}],60:[function(e){var t;t=e("../style/sheet.coffee"),d3plus.font.awesome=t("font-awesome")},{"../style/sheet.coffee":198}],61:[function(e){var t;t=e("../core/font/tester.coffee"),d3plus.font.sizes=function(e,n,r){var a,i,o,l;return o=r||t("svg").append("text"),n=n||{},i=[],e instanceof Array||(e=[e]),l=o.selectAll("tspan.d3plus_testFontSize").data(e),a={x:0,y:0},l.enter().append("tspan").attr("class","d3plus_testFontSize").text(String).style(n).attr(a).each(function(e){return i.push({height:this.offsetHeight||this.getBoundingClientRect().height,text:e,width:this.getComputedTextLength()})}),l.remove(),o||o.remove(),i}},{"../core/font/tester.coffee":52}],62:[function(e){var t=e("../core/font/tester.coffee");d3plus.font.validate=function(e){function n(e){return o.append("span").style("font-family",e).style("font-size","32px").style("padding","0px").style("margin","0px").text("abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890")}function r(e,t){var n=e.node().offsetWidth,r=t.node().offsetWidth;return n!==r}e instanceof Array||(e=e.split(","));var a=e.join(", "),i=d3plus.font.validate.complete;if(a in i)return i[a];var o=t("div"),l=n("monospace"),s=n("sans-serif");for(var u in e){var d=e[u].trim(),c=n(d+",monospace"),p=r(c,l);if(c.remove(),!p){var c=n(d+",sans-serif");p=r(c,s),c.remove()}if(p){p=d;break}}return p||(p="sans-serif"),l.remove(),s.remove(),i[a]=p,p},d3plus.font.validate.complete={}},{"../core/font/tester.coffee":52}],63:[function(e){var t=e("../core/data/format.js"),n=e("../core/data/keys.js"),r=e("../core/data/load.coffee"),a=e("../core/fetch/data.js"),i=e("../core/method/reset.js");d3plus.form=function(){var o={types:{auto:e("./types/auto.js"),button:e("./types/button/button.js"),drop:e("./types/drop/drop.js"),toggle:e("./types/toggle.js")},shell:"form"};o.self=function(){function e(t,n){var n="number"!=typeof n?1===o.id.nesting.length?0:o.id.nesting.length-1:n,r=o.id.nesting[n];return n>0&&(!(r in t)||t[r]instanceof Array)?e(t,n-1):r}var l=o.data.value instanceof Array&&o.data.value.length>o.data.large;if(o.draw.timing=o.draw.first||l||d3plus.ie?0:o.timing.ui,o.data.value instanceof Array){if(o.dev.value&&d3plus.console.groupCollapsed('drawing "'+o.type.value+'"'),o.data.changed&&(o.data.cache={},n(o,"data"),t(o)),o.data.app=a(o),(o.data.changed||o.order.changed||o.order.sort.changed)&&d3plus.array.sort(o.data.app,o.order.value||o.text.value,o.order.sort.value,o.color.value,o),!o.focus.value.length){var s=o.data.element.value;if(s&&"select"===s.node().tagName.toLowerCase()){var u=s.property("selectedIndex");u=0>u?0:u;var d=s.selectAll("option")[0][u],c=d.getAttribute("data-"+o.id.value)||d.getAttribute(o.id.value);c&&(o.focus.value[0]=c)}!o.focus.value.length&&o.data.app.length&&(o.focus.value[0]=o.data.app[0][o.id.value]),o.dev.value&&o.focus.value.length&&d3plus.console.log('"value" set to "'+o.focus+'"')}if(o.data.changed){"auto"===o.search.value?o.data.app.length>10?(o.search.enabled=!0,o.dev.value&&d3plus.console.log("Search enabled.")):(o.search.enabled=!1,o.dev.value&&d3plus.console.log("Search disabled.")):o.search.enabled=o.search.value;var p=o.data.element.value?o.data.element.value.node().tagName.toLowerCase():"";if(o.data.element.value&&"select"===p){var f=[];for(var h in o.data.nested.all)f=f.concat(o.data.nested.all[h]);options=o.data.element.value.selectAll("option").data(f,function(t){var n=e(t);return t&&n in t?t[n]:!1}),options.exit().remove(),options.enter().append("option"),options.each(function(t){var n=e(t),r=n===o.id.value?o.text.value||o.id.value:o.text.nesting!==!0&&n in o.text.nesting?o.text.nesting[n]:n;for(var a in t)"object"!=typeof t[a]&&(a===r&&d3.select(this).html(t[a]),["alt","value"].indexOf(a)>=0?d3.select(this).attr(a,t[a]):d3.select(this).attr("data-"+a,t[a]));this.selected=t[n]===o.focus.value[0]?!0:!1})}}else if(o.focus.changed&&o.data.element.value){var p=o.data.element.value.node().tagName.toLowerCase();"select"===p&&o.data.element.value.selectAll("option").each(function(t){var n=e(t);this.selected=t[n]===o.focus.value[0]?!0:!1})}if("auto"!==o.type.value){if(!o.container.ui){o.container.ui=o.container.value.selectAll("div#d3plus_"+o.type.value+"_"+o.container.id).data(["container"]);var v=o.data.element.value?o.data.element.value[0][0]:null;if(v)if(v.id)v="#"+v.id;else{var g=v.getAttribute(o.id.value)?o.id.value:"data-"+o.id.value;v=v.getAttribute(g)?"["+g+"="+v.getAttribute(g)+"]":null}o.container.ui.enter().insert("div",v).attr("id","d3plus_"+o.type.value+"_"+o.container.id).style("position","relative").style("overflow","visible").style("vertical-align","top")}o.container.ui.style("display",o.ui.display.value),o.container.ui.transition().duration(o.draw.timing).style("margin",o.ui.margin+"px");var m=o.container.ui.selectAll("div.d3plus_title").data(o.title.value?[o.title.value]:[]);m.enter().insert("div","#d3plus_"+o.type.value+"_"+o.container.id).attr("class","d3plus_title").style("display","inline-block"),m.style("color",o.font.color).style("font-family",o.font.family.value).style("font-size",o.font.size+"px").style("font-weight",o.font.weight).style("padding",o.ui.padding+"px").style("border-color","transparent").style("border-style","solid").style("border-width",o.ui.border+"px").text(String).each(function(){o.margin.left=this.offsetWidth})}if(o.data.value.length){var y=o.format.locale.value.visualization[o.type.value];o.dev.value&&d3plus.console.time("drawing "+y),o.types[o.type.value](o),o.dev.value&&d3plus.console.timeEnd("drawing "+y)}else!o.data.url||o.data.loaded&&!o.data.stream||r(o,"data",o.self.draw);i(o),o.methodGroup=!1,o.dev.value&&d3plus.console.groupEnd()}};var l=["active","aggs","alt","color","container","depth","dev","data","draw","focus","format","height","history","hover","icon","id","keywords","margin","open","order","remove","search","select","selectAll","text","title","type","width"],s=["data","font","icon","timing","title","ui"];return d3plus.method(o,l,s),o.self}},{"../core/data/format.js":43,"../core/data/keys.js":44,"../core/data/load.coffee":45,"../core/fetch/data.js":49,"../core/method/reset.js":53,"./types/auto.js":64,"./types/button/button.js":65,"./types/drop/drop.js":70,"./types/toggle.js":87}],64:[function(e,t){t.exports=function(e){var t=e.data.value.length;1===t?e.self.type("button").draw():5>t?e.self.type("toggle").draw():e.self.type("drop").draw()}},{}],65:[function(e,t){t.exports=function(t){var n=e("./functions/color.js"),r=e("./functions/icons.js"),a=e("./functions/mouseevents.js"),i=e("./functions/style.js"),o=t.container.ui.selectAll("div.d3plus_node").data(t.data.app,function(e){return e[t.id.value]});if(t.dev.value&&d3plus.console.time("enter"),o.enter().append("div").attr("class","d3plus_node").call(n,t).call(i,t).call(r,t).call(a,t,n),t.dev.value&&d3plus.console.timeEnd("enter"),t.draw.update||t.draw.timing){t.dev.value&&d3plus.console.time("ordering"),o.order(),t.dev.value&&d3plus.console.timeEnd("ordering");var l=o}else var s=[t.focus.previous,t.focus.value[0],t.hover.previous,t.hover.value].filter(function(e){return e}),l=o.filter(function(e){return s.indexOf(e[t.id.value])>=0});t.dev.value&&d3plus.console.time("update"),t.draw.timing?l.transition().duration(t.draw.timing).call(n,t).call(i,t):l.call(n,t).call(i,t),l.call(r,t).call(a,t,n),t.dev.value&&d3plus.console.timeEnd("update"),o.exit().remove()}},{"./functions/color.js":66,"./functions/icons.js":67,"./functions/mouseevents.js":68,"./functions/style.js":69}],66:[function(e,t){t.exports=function(e,t){e.style("background-color",function(e){return t.focus.value[0]!==e[t.id.value]?t.hover.value===e[t.id.value]?d3plus.color.lighter(t.ui.color.secondary.value,.25):t.ui.color.secondary.value:t.hover.value===e[t.id.value]?d3.rgb(t.ui.color.primary.value).darker(.15).toString():t.ui.color.primary.value}).style("color",function(e){var n=e[t.icon.value]&&t.data.app.length<t.data.large;if(t.focus.value[0]===e[t.id.value])var r=1;else var r=.75;if(t.focus.value[0]===e[t.id.value]&&e[t.color.value]&&!n)var a=d3plus.color.legible(e[t.color.value]);else if(t.focus.value[0]===e[t.id.value])var a=d3plus.color.text(t.ui.color.primary.value);else var a=d3plus.color.text(t.ui.color.secondary.value);var a=d3.rgb(a);return"rgba("+a.r+","+a.g+","+a.b+","+r+")"}).style("border-color",t.ui.color.secondary.value)}},{}],67:[function(e,t){t.exports=function(e,t){var n="right"===t.font.align.value&&!d3plus.rtl||d3plus.rtl&&"right"===t.font.align.value;e.each(function(e){var r=["label"];e[t.icon.value]&&t.data.app.length<=t.data.large&&r.push("icon");var a=t.icon.button.value;e[t.id.value]===t.focus.value[0]&&t.icon.select.value?(a=t.icon.select.value,r.push("selected")):a&&e.d3plus.icon!==!1&&r.push("selected");var i=0,o=d3.select(this).selectAll("div.d3plus_button_element").data(r,function(e){return e});o.enter().append("div").style("display",function(e){return"label"===e?"block":"absolute"}),o.order().attr("class",function(e){var t="";return"selected"===e&&0===a.indexOf("fa-")&&(t=" fa "+a),"d3plus_button_element d3plus_button_"+e+t}).html(function(n){if("label"===n){var r=t.text.value&&t.text.value in e&&!(e[t.text.value]instanceof Array)?t.text.value:t.id.value;return t.format.value(e[r])}return"selected"===n&&a.indexOf("fa-")<0?a:""}).style("background-image",function(n){return"icon"===n?"url('"+e[t.icon.value]+"')":"none"}).style("background-color",function(n){return"icon"===n&&"knockout"===e.style?e[t.color.value]||t.ui.color.primary.value:"transparent"}).style("background-size","100%").style("text-align",function(e){return"label"===e?t.font.align.value:"center"}).style("position",function(e){return"label"==e?"static":"absolute"}).style("width",function(e){return"label"===e?"auto":(i=t.height.value?t.height.value-2*t.ui.padding-2*t.ui.border:t.font.size+t.ui.padding+t.ui.border,i+"px")}).style("height",function(e){return"icon"===e?i+"px":"auto"}).style("margin-top",function(e){if("label"===e)return"0px";if(this.offsetHeight||this.getBoundingClientRect().height)var n=this.offsetHeight||this.getBoundingClientRect().height;else if("selected"===e)var n=t.font.size;else var n=i;return-n/2+"px"}).style("top",function(e){return"label"===e?"auto":"50%"}).style("left",function(e){return"icon"===e&&!n||"selected"===e&&n?t.ui.padding+"px":"auto"}).style("right",function(e){return"icon"===e&&n||"selected"===e&&!n?t.ui.padding+"px":"auto"}).style(d3plus.prefix()+"transition",function(e){return"selected"===e?t.draw.timing/1e3+"s":"none"}).style(d3plus.prefix()+"transform",function(e){var n="selected"===e?t.icon.select.rotate:"none";return"rotate("+n+"deg)"}).style("opacity",function(e){return"selected"===e?t.icon.select.opacity:1}),o.exit().remove();var l=d3.select(this).selectAll(".d3plus_button_label");if(i>0){i+=2*t.ui.padding;var s=t.ui.padding;if(3===r.length)var u=s+"px "+i+"px";else if(r.indexOf("icon")>=0&&!d3plus.rtl||r.indexOf("selected")>=0&&d3plus.rtl)var u=s+"px "+s+"px "+s+"px "+i+"px";else var u=s+"px "+i+"px "+s+"px "+s+"px";l.style("padding",u)}else l.style("padding",t.ui.padding+"px");if("number"==typeof t.width.value){var d=t.width.value;d-=parseFloat(l.style("padding-left"),10),d-=parseFloat(l.style("padding-right"),10),d-=2*t.ui.border,d+="px"}else var d="auto";l.style("width",d)})}},{}],68:[function(e,t){t.exports=function(e,t,n){e.on(d3plus.evt.over,function(e){t.self.hover(e[t.id.value]),d3plus.ie||!t.draw.timing?d3.select(this).style("cursor","pointer").call(n,t):d3.select(this).style("cursor","pointer").transition().duration(t.timing.mouseevents).call(n,t)}).on(d3plus.evt.out,function(){t.self.hover(!1),d3plus.ie||!t.draw.timing?d3.select(this).style("cursor","auto").call(n,t):d3.select(this).style("cursor","auto").transition().duration(t.timing.mouseevents).call(n,t)}).on(d3plus.evt.click,function(e){t.id.value in e&&t.self.focus(e[t.id.value]).draw()})}},{}],69:[function(e,t){t.exports=function(e,t){e.style("position","relative").style("margin",t.ui.margin+"px").style("display",t.ui.display.value).style("border-style","solid").style("border-width",t.ui.border+"px").style("font-family",t.font.family.value).style("font-size",t.font.size+"px").style("font-weight",t.font.weight).style("letter-spacing",t.font.spacing+"px")}},{}],70:[function(e,t){t.exports=function(t){var n=e("./functions/element.js"),r=e("./functions/keyboard.js"),a=e("./functions/window.js"),i=e("./functions/width.js"),o=e("./functions/button.js"),l=e("./functions/selector.js"),s=e("./functions/title.js"),u=e("./functions/search.js"),d=e("./functions/list.js"),c=e("./functions/data.js"),p=e("./functions/update.js");t.margin.top=0,t.margin.title=0,n(t),r(t),a(t),i(t),o(t),l(t),s(t),u(t),d(t),c(t),p(t)}},{"./functions/button.js":73,"./functions/data.js":74,"./functions/element.js":75,"./functions/keyboard.js":78,"./functions/list.js":79,"./functions/search.js":81,"./functions/selector.js":82,"./functions/title.js":83,"./functions/update.js":84,"./functions/width.js":85,"./functions/window.js":86}],71:[function(e,t){t.exports=function(e,t,n){var r=[],n=n||e.active.value;if(n instanceof Array)for(var a=0;a<n.length;a++)r.push(this(e,t,n[a]));else{var i=typeof n;r.push("number"===i?e.depth.value===n:"function"===i?n(t):t===n)}return r.indexOf(!0)>=0}},{}],72:[function(e,t){t.exports=function(e){e.dev.value&&d3plus.console.time("rotating arrow");var t="&#x276f;"===e.icon.drop.value?90:0;if(e.open.value!=e.open.flipped.value)var n=180+t;else var n=t;e.container.button.icon({select:{opacity:e.open.value?.5:1,rotate:n}}).draw(),e.dev.value&&d3plus.console.timeEnd("rotating arrow")}},{}],73:[function(e,t){t.exports=function(e){if("button"in e.container||(e.dev.value&&d3plus.console.time("creating main button"),e.container.button=d3plus.form().container(e.container.ui).type("button").ui({margin:0}),e.dev.value&&d3plus.console.timeEnd("creating main button")),e.focus.changed||e.data.changed||e.depth.changed){var t=e.depth.value,n=d3plus.util.copy(e.data.value.filter(function(n){for(var r=!1,a=0;a<e.id.nesting.length;a++){var i=e.id.nesting[a];if(r=i in n&&n[i]===e.focus.value[0]){t=a;break}}return r})[0]);n||(n=e.container.button.data()[0]||e.data.app[0]),e.container.button.data([n]).id(e.id.nesting).depth(t)}e.container.button.draw({update:e.draw.update}).focus(e.focus.value[0]).font(e.font).icon({button:e.icon.drop.value,select:e.icon.drop.value,value:e.icon.value}).text(e.text.value).timing({ui:e.draw.timing}).ui({color:e.ui.color,padding:e.ui.padding}).width(e.width.value).draw();var r=e.container.button.container(Object).ui;e.margin.top+=r.node().offsetHeight||r.node().getBoundingClientRect().height,r.on(d3plus.evt.click,function(){e.self.open(!e.open.value).draw()})}},{}],74:[function(e,n){n.exports=function(e){if(e.data.url&&!e.data.loaded){var n={};n[e.text.value||e.id.value]=e.format.value(e.format.locale.value.ui.loading),e.data.filtered=[n]}else if(e.open.value){var r=e.text.solo.value.length?e.text.solo.value[0].toLowerCase():"",a=d3plus.string.strip(r).split("_"),i=[e.id.value,e.text.value,e.alt.value,e.keywords.value];if(i=i.filter(function(e){return e}),a=a.filter(function(e){return""!=e}),e.text.solo.value.length&&""!==e.text.solo.value[0]){var o=[],l=[],u=[],d=[];e.id.nesting.forEach(function(t){d=d.concat(e.data.nested.all[t])}),d.forEach(function(n){var d=!1;i.forEach(function(i){if(!d&&i in n&&"string"==typeof n[i]){var c=n[i].toLowerCase();if([e.text.value,e.id.value].indexOf(i)>=0&&0==c.indexOf(r))o.push(n),d=!0;else if(c.indexOf(r)>=0)l.push(n),d=!0;else{var p=d3plus.string.strip(c).split("_");for(t in p){if(d)break;for(s in a)if(0===p[t].indexOf(a[s])){u.push(n),d=!0;break}}}}})}),e.data.filtered=d3.merge([o,l,u]),e.data.filtered.forEach(function(e,t){e.d3plus_order=t})}else e.data.filtered=e.data.app,e.id.nesting.length>1&&e.depth.value<e.id.nesting.length-1&&(e.data.filtered=e.data.filtered.filter(function(t){return"endPoint"in t.d3plus&&t.d3plus.endPoint===e.depth.value&&(t.d3plus.icon=!1),!0}));if(0===e.data.filtered.length){var c={},p=e.format.value(e.format.locale.value.ui.noResults);c[e.text.value||e.id.value]=d3plus.string.format(p,'"'+r+'"'),e.data.filtered=[c]}}else e.data.filtered=[]}},{}],75:[function(e,t){t.exports=function(e){e.data.element.value&&(e.data.element.value.on("focus."+e.container.id,function(){e.self.draw({update:!1}).draw()}),e.data.element.value.on("blur."+e.container.id,function(){var t=e.search.enabled?d3.event.relatedTarget!=e.container.value.select("input").node():!0;t&&e.self.draw({update:!1}).draw()}),e.data.element.value.on("change."+e.container.id,function(){e.self.focus(this.value).draw()}),e.data.element.value.on("keydown.cancel_"+e.container.id,function(){var e=d3.event.keyCode;9!=e&&d3.event.preventDefault()}))}},{}],76:[function(e,t){t.exports=function(e){var t=e.container.button.container().node().getBoundingClientRect();e.height.secondary=window.innerHeight-t.bottom-e.ui.margin-2*e.ui.padding-2*e.ui.border,e.height.secondary<3*t.height?(e.height.secondary=t.top-10,e.self.open({flipped:!0})):e.self.open({flipped:!1});e.height.secondary>e.height.max&&(e.height.secondary=e.height.max)}},{}],77:[function(e,t){t.exports=function(t){var n=e("./active.js");if(t.open.value){t.dev.value&&d3plus.console.time("updating list items"),"items"in t.container||(t.container.items=d3plus.form().container(t.container.list).type("button").ui({border:0,display:"block",margin:0}).width(!1));var r=t.draw.timing?t.data.large:1,a=d3plus.util.copy(t.order),i=t.depth.value===t.id.nesting.length-1;a.value=t.text.solo.value.length&&""!==t.text.solo.value[0]?"d3plus_order":t.order.value,(t.focus.changed||!t.container.items.focus().length)&&t.container.items.focus(t.focus.value[0],function(e){e=e[0];var r=e!==t.focus.value[0];r&&t.active.value&&(r=n(t,e)),r&&t.self.focus(e);var a=t.data.filtered.filter(function(n){return n[t.id.value]===e})[0];if(t.depth.value<t.id.nesting.length-1&&t.id.nesting[t.depth.value+1]in a){var i=t.depth.value,o=t.id.solo.value;t.history.states.push(function(){t.self.depth(i).id({solo:o}).draw()}),t.self.depth(t.depth.value+1).id({solo:[e]}).draw()}else t.depth.changed?r&&t.self.draw():t.self.open(!1).draw()}),t.container.items.active(t.active.value).data({large:r,value:t.data.filtered}).draw({update:t.draw.update}).font(t.font.secondary).id(t.id.value).icon({button:i?!1:t.icon.next,select:i?t.icon.select:!1}).order(a).text(t.text.secondary.value||t.text.value).timing({ui:t.draw.timing}).ui({color:{primary:1===t.id.nesting.length?t.ui.color.primary.value:t.ui.color.secondary.value,secondary:t.ui.color.secondary.value},padding:t.ui.padding}).draw(),t.dev.value&&d3plus.console.timeEnd("updating list items")}}},{"./active.js":71}],78:[function(e,t){t.exports=function(e){d3.select(document).on("keydown."+e.container.id,function(){if(e.open.value||e.hover===!0){var t=d3.event.keyCode,n=e.container.list.select("div").selectAll("div.d3plus_node"),r=0;if(n.each("boolean"==typeof e.hover?function(t,n){t.value==e.focus&&(r=n)}:function(t,n){t.value==e.hover&&(r=n)}),[9].indexOf(t)>=0&&(!e.search.enabled||e.search.enabled&&!d3.event.shiftKey))e.self.draw({update:!1}).disable();else if([40].indexOf(t)>=0){if(e.open.value&&(r>=n.size()-1?r=0:r+=1),"boolean"!=typeof e.hover)var a=n.data()[r].value;else var a=e.focus;e.open.value?e.self.draw({update:!1}).hover(a).draw(60):e.self.draw({update:!1}).hover(a).enable()}else if([38].indexOf(t)>=0){if(e.open.value&&(0>=r?r=n.size()-1:r-=1),"boolean"!=typeof e.hover)var a=n.data()[r].value;else var a=e.focus;e.open.value?e.self.draw({update:!1}).hover(a).draw(60):e.self.draw({update:!1}).hover(a).enable()}else[13].indexOf(t)>=0?"boolean"!=typeof e.hover?e.self.value(e.hover).draw():e.self.hover(e.focus).toggle():[27].indexOf(t)>=0&&(e.open.value?e.self.disable():e.hover===!0&&e.self.hover(!1).draw())}})}},{}],79:[function(e,t){t.exports=function(e){e.dev.value&&d3plus.console.time("populating list"),e.container.list=e.container.selector.selectAll("div.d3plus_drop_list").data(["list"]),e.container.list.enter().append("div").attr("class","d3plus_drop_list").attr("id","d3plus_drop_list_"+e.container.id).style("overflow-y","auto").style("overflow-x","hidden"),e.dev.value&&d3plus.console.timeEnd("populating list")}},{}],80:[function(e,t){t.exports=function(e){if(e.open.value){e.dev.value&&d3plus.console.time("calculating height");var t=!1;if("none"==e.container.selector.style("display"))var t=!0;t&&e.container.selector.style("display","block");var n=e.search.enabled?e.container.search.node().offsetHeight||e.container.search.node().getBoundingClientRect().height:0,r=e.container.selector.style("height"),a=e.container.selector.property("scrollTop"),i=e.container.list.style("max-height"),o=e.container.list.property("scrollTop");e.container.selector.style("height","auto"),e.container.list.style("max-height","200000px"),e.container.listHeight=parseFloat(e.container.selector.style("height"),10),e.container.list.style("max-height",i).property("scrollTop",o),e.container.selector.style("height",r).property("scrollTop",a);var l=!1;if(e.container.listHeight>e.height.secondary&&(e.container.listHeight=e.height.secondary,l=!0),t&&e.container.selector.style("display","none"),e.dev.value&&d3plus.console.timeEnd("calculating height"),l){e.dev.value&&d3plus.console.time("calculating scroll position");var s=e.container.list.select("div").selectAll("div.d3plus_node"),u=s[0][0];s.each(function(t){t[e.id.value]==e.focus.value[0]&&(u=this)});var t=!1;"none"===e.container.selector.style("display")&&(t=!0,e.container.selector.style("display","block"));var d=u.offsetTop,c=u.offsetHeight||u.getBoundingClientRect().height,p=e.container.list.property("scrollTop");t&&e.container.selector.style("display","none"),t||e.data.changed||e.depth.changed?e.container.listScroll=d:(e.container.listScroll=p,p>d?e.container.listScroll=d:d+c>p+e.height.secondary-n&&(e.container.listScroll=d-(e.height.secondary-c-n))),e.dev.value&&d3plus.console.timeEnd("calculating scroll position")}else e.container.listScroll=0}else e.container.listScroll=e.container.list.property("scrollTop"),e.container.listHeight=0}},{}],81:[function(e,t){t.exports=function(t){function n(e){e.style("padding",t.ui.padding+"px").style("display","block").style("background-color",t.ui.color.secondary.value)}function r(e){var n=t.width.secondary-4*t.ui.padding-2*t.ui.border;e.style("padding",t.ui.padding+"px").style("width",n+"px").style("border-style","solid").style("border-width","0px").style("font-family",t.font.secondary.family.value).style("font-size",t.font.secondary.size+"px").style("font-weight",t.font.secondary.weight).style("text-align",t.font.secondary.align).style("outline","none").style(d3plus.prefix()+"border-radius","0").attr("placeholder",t.format.value(t.format.locale.value.method.search))}t.dev.value&&d3plus.console.time("creating search");var a=e("./data.js"),i=e("./items.js"),o=e("./update.js");t.container.search=t.container.selector.selectAll("div.d3plus_drop_search").data(t.search.enabled?["search"]:[]),t.draw.timing?(t.container.search.transition().duration(t.draw.timing).call(n),t.container.search.select("input").transition().duration(t.draw.timing).call(r)):(t.container.search.call(n),t.container.search.select("input").call(r)),t.container.search.enter().insert("div","#d3plus_drop_list_"+t.container.id).attr("class","d3plus_drop_search").attr("id","d3plus_drop_search_"+t.container.id).call(n).append("input").attr("id","d3plus_drop_input_"+t.container.id).style("-webkit-appearance","none").call(r),t.container.search.select("input").on("keyup."+t.container.id,function(){t.text.solo[0]!==this.value&&(t.self.text({solo:[this.value]}),a(t),i(t),o(t))
}),t.container.search.exit().remove(),t.search.enabled&&(t.margin.title+=t.container.search.node().offsetHeight||t.container.search.node().getBoundingClientRect().height),t.dev.value&&d3plus.console.timeEnd("creating search")}},{"./data.js":74,"./items.js":77,"./update.js":84}],82:[function(e,t){t.exports=function(e){e.container.selector=e.container.ui.selectAll("div.d3plus_drop_selector").data(["selector"]),e.container.selector.enter().append("div").attr("class","d3plus_drop_selector").style("position","absolute").style("top","0px").style("z-index","-1").style("overflow","hidden"),e.container.selector.style("padding",e.ui.border+"px")}},{}],83:[function(e,t){t.exports=function(e){function t(t){t.style("padding",e.ui.padding+"px").style("display","block").style("background-color",e.ui.color.secondary.value).style("font-family",e.font.secondary.family.value).style("font-size",e.font.secondary.size+"px").style("font-weight",e.font.secondary.weight).style("text-align",e.font.secondary.align).style("color",d3plus.color.text(e.ui.color.secondary.value))}function n(t){if(!t.empty()){var n=0===e.icon.back.value.indexOf("fa-")?" fa "+e.icon.back.value:"";n="d3plus_drop_back"+n;var r=0===e.icon.back.value.indexOf("fa-")?"":e.icon.back.value;t.style("position","absolute").attr("class",n).style("top",e.ui.padding+e.font.secondary.size/2/2.5+"px").html(r)}}function r(t){var n=i?e.focus.value.length:e.format.locale.value.ui.back;t.text(e.format.value(n)).style("padding","0px "+2*e.ui.padding+"px")}if(e.open.value){e.dev.value&&d3plus.console.time("creating title and back button");var a=1===e.id.solo.value.length&&e.depth.value>0,i=a,o=e.container.button.data(Object).app[0];i=!0;for(var l=0;l<e.id.nesting.length;l++){var s=e.id.nesting[l];if(s in o&&o[s]===e.focus.value[0]){i=!1;break}}e.container.title=e.container.selector.selectAll("div.d3plus_drop_title").data(a?["title"]:[]),e.draw.timing?(e.container.title.transition().duration(e.draw.timing).call(t),e.container.title.select("div.d3plus_drop_title_text").transition().duration(e.draw.timing).call(r)):(e.container.title.call(t),e.container.title.select("div.d3plus_drop_title_text").call(r)),e.container.title.select("span.d3plus_drop_back").call(n);var u=e.container.title.enter().insert("div","#d3plus_drop_list_"+e.container.id).attr("class","d3plus_drop_title").attr("id","d3plus_drop_title_"+e.container.id).call(t);u.append("span").attr("id","d3plus_drop_back_"+e.container.id).attr("class","d3plus_drop_back").call(n),u.append("div").attr("id","d3plus_drop_title_text_"+e.container.id).attr("class","d3plus_drop_title_text").call(r),e.container.title.on(d3plus.evt.over,function(){var t=d3plus.color.lighter(e.ui.color.secondary.value);d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("background-color",t).style("color",d3plus.color.text(t))}).on(d3plus.evt.out,function(){var t=e.ui.color.secondary.value;d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("background-color",t).style("color",d3plus.color.text(t))}).on(d3plus.evt.click,function(){e.history.back()}),e.container.title.exit().remove(),a&&(e.margin.title+=e.container.title.node().offsetHeight||e.container.title.node().getBoundingClientRect().height),e.dev.value&&d3plus.console.timeEnd("creating title and back button")}}},{}],84:[function(e,t){t.exports=function(t){function n(e){e.style("left",function(){return"left"===t.font.align.value?t.margin.left+"px":"center"===t.font.align.value?t.margin.left-(t.width.secondary-t.width.value)/2+"px":"auto"}).style("right",function(){return"right"===t.font.align.value?"0px":"auto"}).style("height",t.container.listHeight+"px").style("padding",t.ui.border+"px").style("background-color",t.ui.color.secondary.value).style("z-index",function(){return t.open.value?"9999":"-1"}).style("width",t.width.secondary-2*t.ui.border+"px").style("top",function(){return t.open.flipped.value?"auto":t.margin.top+"px"}).style("bottom",function(){return t.open.flipped.value?t.margin.top+"px":"auto"}).style("opacity",t.open.value?1:0)}function r(e){e.style("top",function(){return t.open.flipped.value?"auto":t.margin.top+"px"}).style("bottom",function(){return t.open.flipped.value?t.margin.top+"px":"auto"}).style("display",t.open.value?null:"none"),t.search.enabled&&t.open.value&&t.container.selector.select("div.d3plus_drop_search input").node().focus()}function a(e){return function(){var t=d3.interpolateNumber(this.scrollTop,e);return function(e){this.scrollTop=t(e)}}}var i=e("./items.js"),o=e("./height.js"),l=e("./scroll.js"),s=e("./arrow.js");t.draw.timing?t.container.ui.transition().duration(t.draw.timing).each("start",function(){t.open.value&&d3.select(this).style("z-index",9999)}).style("margin",t.ui.margin+"px").each("end",function(){t.open.value||d3.select(this).style("z-index","auto")}):t.container.ui.style("margin",t.ui.margin+"px").style("z-index",function(){return t.open.value?9999:"auto"}),i(t),o(t),l(t),s(t),t.dev.value&&d3plus.console.time("drawing list");var u=t.open.value?t.height.secondary-t.margin.title:0;t.draw.timing?(t.container.selector.transition().duration(t.draw.timing).each("start",function(){d3.select(this).style("display",t.open.value?"block":null)}).call(n).each("end",function(){d3.select(this).transition().duration(t.draw.timing).call(r)}),t.container.list.transition().duration(t.draw.timing).style("width",t.width.secondary-2*t.ui.border+"px").style("max-height",u+"px").tween("scroll",a(t.container.listScroll))):(t.container.selector.call(n).call(r),t.container.list.style("width",t.width.secondary-2*t.ui.border+"px").style("max-height",u+"px").property("scrollTop",t.container.listScroll)),t.dev.value&&d3plus.console.timeEnd("drawing list")}},{"./arrow.js":72,"./height.js":76,"./items.js":77,"./scroll.js":80}],85:[function(e,t){var n=e("../../../../core/font/tester.coffee");t.exports=function(e){function t(t){var a="primary"===t?"value":t,i="value"===a?e.icon.drop.value:e.icon.select.value||e.icon.drop.value,o="value"===a?e.text.value:e.text.secondary.value||e.text.value,l="value"===a?e.font:e.font.secondary;e.dev.value&&d3plus.console.time("calculating "+t+" width");var s=d3plus.form().container(n()).data({large:9999,value:r}).draw({update:!1}).font(l).icon({button:i,value:e.icon.value}).id(e.id.value).timing({ui:0}).text(o||e.id.value).type("button").ui({border:"primary"===t?e.ui.border:0,display:"inline-block",margin:0,padding:e.ui.padding}).width(!1).draw(),u=[];s.selectAll("div.d3plus_node").each(function(){u.push(this.offsetWidth)}).remove();var d={};d[a]=d3.max(u),e.self.width(d),e.dev.value&&d3plus.console.timeEnd("calculating "+t+" width")}var r=[];for(var a in e.data.nested.all){var i=e.data.nested.all[a],o=d3plus.object.validate(e.text.nesting)&&a in e.text.nesting?e.text.nesting[a][0]:a;[e.id.value,e.text.value].indexOf(o)<0&&(i=d3plus.util.copy(i),i.forEach(function(t){t[e.text.value||e.id.value]=t[o]})),r=r.concat(i)}"number"!=typeof e.width.value&&t("primary"),"number"!=typeof e.width.secondary&&(e.text.secondary.value&&e.text.value!==e.text.secondary.value?t("secondary"):e.self.width({secondary:e.width.value}))}},{"../../../../core/font/tester.coffee":52}],86:[function(e,t){var n=function(e,t){if(void 0===t)var t=window;d3.select(t).on("click."+e.container.id,function(){var t=d3.event.target||d3.event.toElement,n=t.parentNode;n&&["d3plus_node","d3plus_drop_title"].indexOf(n.className)>=0&&(t=n.parentNode),t&&n&&!d3plus.util.child(e.container.ui,t)&&e.open.value&&e.self.open(!e.open.value).draw()});try{var r=window.parent.location.host===window.location.host}catch(a){var r=!1}r&&t.self!==window.top&&n(e,t.parent)};t.exports=n},{}],87:[function(e,t){t.exports=function(e){"buttons"in e.container||(e.container.buttons=d3plus.form().container(e.container.ui).type("button"));var t=e.data.app.length,n=e.width.value?e.width.value/t:!1,r=e.container.ui.selectAll("div.d3plus_toggle").data(e.data.app,function(t){return t[e.id.value]});r.enter().append("div").attr("class","d3plus_toggle").style("display","inline-block").style("vertical-align","top"),r.order().each(function(t){"form"in t.d3plus||(t.d3plus.form=d3plus.form().container(d3.select(this)));var r=e.id.nesting.length>e.depth.value?e.id.nesting[e.depth.value+1]:e.id.value;t[r]instanceof Array?t.d3plus.form.container({id:e.container.id+"_"+t[e.id.value]}).data(t[r]).id(e.id.nesting.slice(1)).type("drop"):t.d3plus.form.data([t]).id(e.id.value).type("button"),t.d3plus.form.color(e.color).focus(e.focus.value[0],function(t){t[0]!==e.focus.value[0]&&e.self.focus(t[0]).draw()}).icon({select:!1,value:e.icon.value}).font(e.font).format(e.format).order(e.order).text(e.text.value).ui({border:e.ui.border,color:e.ui.color,display:"inline-block",margin:0,padding:e.ui.padding}).width(n).draw()})}},{}],88:[function(e,t){var n;n=e("./wiki.coffee"),d3plus.console=function(e,t,n){n=n||"",d3plus.ie||"undefined"!=typeof InstallTrigger?console.log("[ D3plus ] "+t):"groupCollapsed"===e?window.chrome&&navigator.onLine?console[e]("%c%c "+t,"padding:3px 10px;line-height:25px;background-size:20px;background-position:top left;background-image:url('http://d3plus.org/assets/img/favicon.ico');","font-weight:200;"+n):console[e]("%cD3plus%c "+t,"line-height:25px;font-weight:800;color:#b35c1e;margin-left:0px;","font-weight:200;"+n):console[e]("%c"+t,n+"font-weight:200;")},d3plus.console.comment=function(e){this("log",e,"color:#aaa;")},d3plus.console.error=function(e,t){this("groupCollapsed","ERROR: "+e,"font-weight:800;color:#D74B03;"),this.stack(),this.wiki(t),this.groupEnd()},d3plus.console.group=function(e){this("group",e,"color:#888;")},d3plus.console.groupCollapsed=function(e){this("groupCollapsed",e,"color:#888;")},d3plus.console.groupEnd=function(){d3plus.ie||console.groupEnd()},d3plus.console.log=function(e){this("log",e,"color:#444444;")},d3plus.console.stack=function(){var e,t,n,r,a,i,o;d3plus.ie||(e=new Error,e.stack&&(i=e.stack.split("\n"),i=i.filter(function(e){return 0!==e.indexOf("Error")&&e.indexOf("d3plus.js:")<0&&e.indexOf("d3plus.min.js:")<0}),i.length&&(a=window.chrome?"at ":"@",o=i[0].split(a)[1],i=o.split(":"),3===i.length&&i.pop(),t=i.pop(),r=i.join(":").split("/"),r=r[r.length-1],n="line "+t+" of "+r+": "+o,this("log",n,"color:#D74B03;"))))},d3plus.console.time=function(e){d3plus.ie||console.time(e)},d3plus.console.timeEnd=function(e){d3plus.ie||console.timeEnd(e)},d3plus.console.warning=function(e,t){this("groupCollapsed",e,"color:#888;"),this.stack(),this.wiki(t),this.groupEnd()},d3plus.console.wiki=function(e){e&&(e in n&&(e=d3plus.repo+"wiki/"+n[e]),this("log","documentation: "+e,"color:#aaa;"))},t.exports=d3plus.console},{"./wiki.coffee":94}],89:[function(){d3plus.touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?!0:!1,d3plus.evt=d3plus.touch?{click:"click",down:"touchstart",up:"touchend",over:"touchstart",out:"touchend",move:"touchmove"}:{click:"click",down:"mousedown",up:"mouseup",over:d3plus.ie?"mouseenter":"mouseover",out:d3plus.ie?"mouseleave":"mouseout",move:"mousemove"}},{}],90:[function(){d3plus.ie=!1},{}],91:[function(){d3plus.prefix=function(){var e;return e="-webkit-transform"in document.body.style?"-webkit-":"-moz-transform"in document.body.style?"-moz-":"-ms-transform"in document.body.style?"-ms-":"-o-transform"in document.body.style?"-o-":"",d3plus.prefix=function(){return e},e}},{}],92:[function(){d3plus.rtl="rtl"==d3.select("html").attr("dir")},{}],93:[function(){d3plus.scrollbar=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;n==r&&(r=t.clientWidth),document.body.removeChild(t);var a=n-r;return d3plus.scrollbar=function(){return a},a}},{}],94:[function(e,t){d3plus.wiki={active:"Segmenting-Data#active",aggs:"Custom-Aggregations",alt:"Alt-Text-Parameters",attrs:"Attribute-Data#axes",axes:"Axis-Parameters",background:"Background",color:"Color-Parameters",container:"Container-Element",coords:"Geography-Data",csv:"CSV-Export",data:"Data-Points",depth:"Visible-Depth",descs:"Value-Definitions",dev:"Verbose-Mode",draw:"Draw",edges:"Edges-List",error:"Custom-Error-Message",focus:"Focus-Element",font:"Font-Styles",footer:"Custom-Footer",format:"Value-Formatting",height:"Height",history:"User-History",hover:"Hover-Element",icon:"Icon-Parameters",id:"Unique-ID",keywords:"Keyword-Parameters",labels:"Data-Labels",legend:"Legend",links:"Link-Styles",margin:"Outer-Margins",messages:"Status-Messages",method:"Methods",nodes:"Node-Positions",open:"Open",order:"Data-Ordering",remove:"Remove",search:"Search-Box",select:"Selecting-Elements#select",selectAll:"Selecting-Elements#selectall",shape:"Data-Shapes",size:"Size-Parameters",temp:"Segmenting-Data#temp",text:"Text-Parameters",time:"Time-Parameters",timeline:"Timeline",timing:"Animation-Timing",title:"Custom-Titles",tooltip:"Tooltip-Parameters",total:"Segmenting-Data#total",type:"Output-Type",ui:"Custom-Interface",width:"Width",x:"Axis-Parameters",y:"Axis-Parameters",zoom:"Zooming"},t.exports=d3plus.wiki},{}],95:[function(e){var t,n,r,a,i,o,l,s,u,d,c;d=e("simplify-js"),d3plus.geom.largestRect=function(e,n){var a,o,l,u,p,f,h,v,g,m,y,x,b,w,_,k,z,A,j,M,E,S,T,O,F,V,N,B,I,q,C,P,L,U,D,R,H,Y,X,G,W,Q,J,Z,K,$,et,tt,nt,rt,at,it,ot,lt,st,ut,dt,ct,pt,ft,ht,vt,gt,mt,yt,xt,bt;if(e.length<3)return d3plus.console.error("polygon has to have at least 3 points"),null;if(w=[],v=.5,p=5,null==n&&(n={}),null==n.maxAspectRatio&&(n.maxAspectRatio=15),null==n.minWidth&&(n.minWidth=0),null==n.minHeight&&(n.minHeight=0),null==n.tolerance&&(n.tolerance=.02),null==n.nTries&&(n.nTries=20),null!=n.angle&&(n.angle instanceof Array?f=n.angle:"number"==typeof n.angle?f=[n.angle]:"string"!=typeof n.angle||isNaN(n.angle)||(f=[Number(n.angle)])),null==f&&(f=d3.range(-90,90+p,p)),null!=n.aspectRatio&&(n.aspectRatio instanceof Array?g=n.aspectRatio:"number"==typeof n.aspectRatio?g=[n.aspectRatio]:"string"!=typeof n.aspectRatio||isNaN(n.aspectRatio)||(g=[Number(n.aspectRatio)])),null!=n.origin&&n.origin instanceof Array&&(U=n.origin[0]instanceof Array?n.origin:[n.origin]),h=Math.abs(d3.geom.polygon(e).area()),0===h)return d3plus.console.error("polygon has 0 area"),null;if(pt=d3.extent(e,function(e){return e[0]}),I=pt[0],O=pt[1],ft=d3.extent(e,function(e){return e[1]}),q=ft[0],F=ft[1],$=Math.min(O-I,F-q)*n.tolerance,K=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)D=e[t],r.push({x:D[0],y:D[1]});return r}(),$>0&&(K=d(K,$),e=function(){var e,t,n;for(n=[],e=0,t=K.length;t>e;e++)D=K[e],n.push([D.x,D.y]);return n}()),n.vdebug&&w.push({type:"simplify",poly:e}),ht=d3.extent(e,function(e){return e[0]}),I=ht[0],O=ht[1],vt=d3.extent(e,function(e){return e[1]}),q=vt[0],F=vt[1],m=[[I,q],[O,q],[O,F],[I,F]],gt=[O-I,F-q],x=gt[0],y=gt[1],tt=Math.min(x,y)/50,null==U)for(U=[],b=d3.geom.polygon(e).centroid(),r(b,e)&&U.push(b);U.length<n.nTries;)J=Math.random()*x+I,Z=Math.random()*y+q,Q=[J,Z],r(Q,e)&&U.push(Q);for(n.vdebug&&w.push({type:"origins",points:U}),j=0,S=null,at=0,st=f.length;st>at;at++)for(l=f[at],u=-l*Math.PI/180,n.vdebug&&w.push({type:"angle",angle:l}),k=it=0,ut=U.length;ut>it;k=++it)for(P=U[k],mt=t(e,P,u),H=mt[0],X=mt[1],yt=t(e,P,u+Math.PI/2),R=yt[0],Y=yt[1],C=[],null!=H&&null!=X&&C.push([(H[0]+X[0])/2,(H[1]+X[1])/2]),null!=R&&null!=Y&&C.push([(R[0]+Y[0])/2,(R[1]+Y[1])/2]),n.vdebug&&w.push({type:"modifOrigin",idx:k,p1W:H,p2W:X,p1H:R,p2H:Y,modifOrigins:C}),ot=0,dt=C.length;dt>ot;ot++)if(L=C[ot],n.vdebug&&w.push({type:"origin",cx:L[0],cy:L[1]}),xt=t(e,L,u),H=xt[0],X=xt[1],B=Math.min(c(L,H),c(L,X)),T=2*Math.sqrt(B),bt=t(e,L,u+Math.PI/2),R=bt[0],Y=bt[1],N=Math.min(c(L,R),c(L,Y)),E=2*Math.sqrt(N),!(j>T*E))for(null!=g?o=g:(V=Math.max(1,n.minWidth/E,j/(E*E)),M=Math.min(n.maxAspectRatio,T/n.minHeight,T*T/j),o=d3.range(V,M+v,v)),lt=0,ct=o.length;ct>lt;lt++)if(a=o[lt],A=Math.max(n.minWidth,Math.sqrt(j*a)),W=Math.min(T,E*a),!(j>W*E))for(W-A>=tt&&n.vdebug&&w.push({type:"aRatio",aRatio:a});W-A>=tt;)et=(A+W)/2,_=et/a,nt=L[0],rt=L[1],G=[[nt-et/2,rt-_/2],[nt+et/2,rt-_/2],[nt+et/2,rt+_/2],[nt-et/2,rt+_/2]],G=s(G,u,L),i(G,e)?(z=!0,j=et*_,S={cx:nt,cy:rt,width:et,height:_,angle:l},A=et):(z=!1,W=et),n.vdebug&&w.push({type:"rectangle",cx:nt,cy:rt,width:et,height:_,areaFraction:et*_/h,angle:l,insidePoly:z});return[S,j,w]},c=function(e,t){var n,r;return n=t[0]-e[0],r=t[1]-e[1],n*n+r*r},o=function(e,t,n){var r,a,i,o,l;return l=t[1]<n[1]?[t,n]:[n,t],r=l[0],a=l[1],(e[1]===a[1]||e[1]===r[1])&&(e[1]+=Number.MIN_VALUE),e[1]>a[1]||e[1]<r[1]?!1:e[0]>r[0]&&e[0]>a[0]?!1:e[0]<r[0]&&e[0]<a[0]?!0:(i=(a[1]-r[1])/(a[0]-r[0]),o=(e[1]-r[1])/(e[0]-r[0]),o>i)},r=function(e,t){var n,r,a,i,l;for(i=-1,l=t.length,r=t[l-1],a=0;++i<l;)n=r,r=t[i],o(e,n,r)&&a++;return a%2!==0},a=function(e,t,n){var r,a,i;return r=1e-9,a=e[0],i=e[1],a<Math.min(t[0],n[0])-r||a>Math.max(t[0],n[0])+r||i<Math.min(t[1],n[1])-r||i>Math.max(t[1],n[1])+r?!1:!0},n=function(e,t,n,r){var a,i,o,l,s,u,d,c,p,f;return c=1e-9,l=e[0]-t[0],u=e[1]-t[1],s=n[0]-r[0],d=n[1]-r[1],o=l*d-u*s,Math.abs(o)<c?null:(a=e[0]*t[1]-e[1]*t[0],i=n[0]*r[1]-n[1]*r[0],p=(a*s-i*l)/o,f=(a*d-i*u)/o,[p,f])},u=function(e,t,r,i){var o;return o=n(e,t,r,i),null==o?!1:a(o,e,t)&&a(o,r,i)},i=function(e,t){var n,a,i,o,l,s,d,c;for(l=-1,d=e.length,c=t.length,i=e[d-1];++l<d;)for(n=i,i=e[l],s=-1,o=t[c-1];++s<c;)if(a=o,o=t[s],u(n,i,a,o))return!1;return r(e[0],t)},l=function(e,t,n){var r,a,i,o;return null==n&&(n=[0,0]),i=e[0]-n[0],o=e[1]-n[1],r=Math.cos(t),a=Math.sin(t),[r*i-a*o+n[0],a*i+r*o+n[1]]},s=function(e,t,n){var r,a,i,o;for(o=[],a=0,i=e.length;i>a;a++)r=e[a],o.push(l(r,t,n));return o},t=function(e,t,r){var i,o,l,s,u,d,p,f,h,v,g,m,y,x,b;for(u=1e-9,t=[t[0]+u*Math.cos(r),t[1]+u*Math.sin(r)],x=t[0],b=t[1],m=[x+Math.cos(r),b+Math.sin(r)],p=0,Math.abs(m[0]-x)<u&&(p=1),d=-1,v=e.length,o=e[v-1],f=Number.MAX_VALUE,h=Number.MAX_VALUE,l=null,s=null;++d<v;)i=o,o=e[d],g=n(t,m,i,o),null!=g&&a(g,i,o)&&(y=c(t,g),g[p]<t[p]?f>y&&(f=y,l=g):g[p]>t[p]&&h>y&&(h=y,s=g));return[l,s]}},{"simplify-js":4}],96:[function(e){var t,n,r;t=window.d3plus||{},window.d3plus=t,t.version="1.5.0 - Aqua",t.repo="https://github.com/alexandersimoes/d3plus/",t.array={},t.color={},t.data={},t.draw={},t.font={},t.geom={},t.locale={},t.method={},t.network={},t.number={},t.object={},t.shape={},t.string={},t.style={},t.tooltip={},t.ui={},t.util={},t.zoom={},r=e("./style/sheet.coffee"),n=e("./general/console.coffee"),r("d3plus.css")&&n.warning("d3plus.css has been deprecated, you do not need to load this file.","https://github.com/alexandersimoes/d3plus/releases/tag/v1.4.0")},{"./general/console.coffee":88,"./style/sheet.coffee":198}],97:[function(){d3plus.locale.en_US={dev:{accepted:"{0} is not an accepted value for {1}, please use one of the following: {2}.",deprecated:"the {0} method has been removed, please update your code to use {1}.",noChange:"{0} was not updated because it did not change.",noContainer:"cannot find a container on the page matching {0}.",of:"of",oldStyle:"style properties for {0} have now been embedded directly into .{1}().",sameEdge:"edges cannot link to themselves. automatically removing self-referencing edge {0}.",set:"{0} has been set.",setLong:"{0} has been set to {1}.",setContainer:"please define a container div using .container()"},error:{accepted:"{0} is not an accepted {1} for {2} visualizations, please use one of the following: {3}.",connections:"no connections available for {0}.",data:"no data available",dataYear:"no data available for {0}.",lib:"{0} visualizations require loading the {1} library.",libs:"{0} visualizations require loading the following libraries: {1}.",method:"{0} visualizations require setting the {1} method.",methods:"{0} visualizations require setting the following methods: {1}."},format:{decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%A, %B %-d, %Y %X",date:"%-m/%-d/%Y",time:"%I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},lowercase:["a","and","at","but","in","of","or","the","to","with"],message:{data:"analyzing data",draw:"drawing visualization",initializing:"initializing {0}",loading:"loading data",tooltipReset:"resetting tooltips",ui:"updating ui"},method:{active:"active segments",color:"color",depth:"depth",dev:"verbose",focus:"focus",icon:"icon",id:"id",height:"height",labels:"labels",legend:"legend",margin:"margin",messages:"status messages",mode:"mode",order:"order",search:"search",shape:"shape",size:"size",style:"style",temp:"temporary segments",text:"text",time:"time",timeline:"timeline",total:"total segments",type:"type",width:"width",x:"x axis",y:"y axis",zoom:"zoom"},time:["date","day","month","time","year"],timeFormat:{FullYear:"%Y",Month:"%B",MonthSmall:"%b",Date:"%A %-d",DateSmall:"%-d",Hours:"%I %p",Minutes:"%I:%M",Seconds:"%Ss",Milliseconds:"%Lms","FullYear-Month":"%b %Y","FullYear-Date":"%-m/%-d/%Y","Month-Date":"%b %-d","Hours-Minutes":"%I:%M %p","Hours-Seconds":"%I:%M:%S %p","Hours-Milliseconds":"%H:%M:%S.%L"},ui:{and:"and",back:"back",collapse:"click to collapse",error:"error",expand:"click to expand",including:"including",loading:"loading...",more:"{0} more",moreInfo:"click for more info",noResults:"no results matching {0}.",primary:"primary connections",share:"share",total:"total",values:"values"},uppercase:["tv","ui"],visualization:{bubbles:"Bubbles",chart:"Chart",geo_map:"Geo Map",line:"Line Plot",network:"Network",rings:"Rings",scatter:"Scatter Plot",stacked:"Stacked Area",tree_map:"Tree Map"}}},{}],98:[function(){d3plus.locale.mk_MK={dev:{accepted:"{0}   a   {1},    a   : {2}.",deprecated:"{0}   ,           {1}.",noChange:"{0}   ,   .",noContainer:" e           {0}.",of:"",oldStyle:"    {0}     . {1} ().",sameEdge:"        .       - {0}.",set:"{0}  .",setLong:"{0}    {1}.",setContainer:"    div  .container()"},error:{accepted:"{0}     {1} {2} ,      : {3}.",connections:"     {0}.",data:" ",dataYear:"    {0}.",lib:"{0}      {1} .",libs:"{0}      : {1}.",method:"{0}     {1} .",methods:"{0}      : {1}."},format:{decimal:",",thousands:".",grouping:[3],currency:[""," ."],dateTime:"%A, %e %B %Y . %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["","","","","","",""],shortDays:["","","","","","",""],months:["","","","","","","","","","","",""],shortMonths:["","","","","","","","","","","",""]},lowercase:["a","","","","","","","",""],method:{active:" ",color:"",depth:"",dev:"",focus:"",icon:"",id:"ID",height:"",labels:"",legend:"",margin:"",messages:"  ",order:"",search:"",shape:"",size:"",style:"",temp:" ",text:"",time:"",timeline:"",total:" ",type:"",width:"",x:"x ",y:"y ",zoom:"",mode:""},time:["","","","",""],visualization:{bubbles:"",chart:"",geo_map:" ",line:" ",network:"",rings:"",scatter:" ",stacked:" ",tree_map:"    "},ui:{and:"",back:"",collapse:"    ",error:"",expand:"    ",loading:"  ...",more:"{0} ",moreInfo:"   ",noResults:"     {0}.",primary:" ",share:"",total:"",values:"",including:""},message:{data:"  ",draw:"  ",initializing:" {0}",loading:"  ",tooltipReset:"  ",ui:"   "},uppercase:["TV","UI"]}},{}],99:[function(){d3plus.locale.pt_BR={dev:{accepted:"{0} no  um valor aceito para {1}, por favor, use um dos seguintes procedimentos: {2}.",deprecated:"{0} mtodo foi removido, por favor atualize seu cdigo para utilizar {1}.",noChange:"{0} no foi atualizado porque ele no mudou.",noContainer:"No foi possvel encontrar um local na pgina correspondente a {0}.",of:"de",oldStyle:"propriedades de estilo para {0} j foram incorporados diretamente no. {1} ().",sameEdge:"bordas no podem vincular a si mesmos. removendo automaticamente borda de auto-referncia {0}.",set:"{0} foi definida.",setLong:"{0} foi definida para {1}.",setContainer:"por favor, defina um div utilizando .container()"},error:{accepted:"{0} no  um reconhecido {1} para {2} visualizaes, por favor, use um dos seguintes procedimentos: {3}.",connections:"No h conexes disponveis para {0}.",data:"No h dados disponveis",dataYear:"No h dados disponveis para {0}.",lib:"A visualizao {0} necessita que seja carregado a biblioteca {1}.",libs:"A visualizao {0} necessita que seja carregado as bibliotecas {1}.",method:"A visualizao {0} exige a definio do mtodo {1}.",methods:"A visualizao {0} exige a definio dos mtodos {1}."},format:{decimal:",",thousands:".",grouping:[3],currency:["R$",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},lowercase:["a","com","de","e","em","mas","ou","para","um"],method:{active:"segmentos ativos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"cone",id:"id",height:"altura",labels:"rtulos",legend:"legenda",margin:"margem",messages:"mensagens de status",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",style:"estilo",temp:"segmentos temporrios",text:"texto",time:"tempo",timeline:"cronograma",total:"segmentos totais",type:"tipo",width:"largura",x:"eixo x",y:"eixo y",zoom:"zoom",mode:"modo"},time:["ano","data","dia","hora","ms"],visualization:{bubbles:"Bolhas",chart:"Grfico",geo_map:"Mapa",line:"Grfico de Linha",network:"Rede",rings:"Anis",scatter:"Disperso",stacked:"Evoluo",tree_map:"Tree Map"},ui:{and:"e",back:"de volta",collapse:"Clique para fechar",error:"erro",expand:"clique para expandir",loading:"carregando ...",more:"mais {0}",moreInfo:"clique para mais informaes",noResults:"nenhum resultado para {0}.",primary:"conexes primrias",share:"participao",total:"total",values:"valores",including:"incluindo"},message:{data:"analisando dados",draw:"desenhando visualizao",initializing:"inicializando {0}",loading:"carregando dados",tooltipReset:"redefinindo as dicas",ui:"atualizando interface"},uppercase:["TV"]}},{}],100:[function(){d3plus.locale.zh_CN={dev:{accepted:"{0}{1}, :{2}",deprecated:"{0}, {1}",noChange:"{0}, ",noContainer:"{0}",of:"",oldStyle:"{0}{1}",sameEdge:"{0}",set:"{0}",setLong:"{0}{1}",setContainer:"()div"},error:{accepted:"{0}{2}{1}, {3}.",connections:"{0}",data:"",dataYear:"{0}",lib:"{0}{1}",libs:"{0}{1}",method:"{0}{1}",methods:"{0}{1}"},format:{decimal:".",thousands:",",grouping:[3],currency:["",""],dateTime:"%A %B %e %Y %X",date:"%Y/%-m/%-d",time:"%H:%M:%S",periods:["",""],days:["","","","","","",""],shortDays:["","","","","","",""],months:["","","","","","","","","","","",""],shortMonths:["","","","","","","","","","","",""]},lowercase:["","","","","...","","","","","..."],method:{active:"",color:"",depth:"",dev:"",focus:"",icon:"",id:"",height:"",labels:"",legend:"",margin:"",messages:"",order:"",search:"",shape:"",size:"",style:"",temp:"",text:"",time:"",timeline:"",total:"",type:"",width:"",x:"X",y:"Y",zoom:"",mode:""},time:["","","","",""],visualization:{bubbles:"",chart:"",geo_map:"",line:"",network:"",rings:"",scatter:"",stacked:"",tree_map:""},ui:{and:"",back:"",collapse:"",error:"",expand:"",loading:"...",more:"{0}",moreInfo:"",noResults:"{0}",primary:"",share:"",total:"",values:"",including:""},message:{data:"",draw:"",initializing:"{0}",loading:"",tooltipReset:"",ui:"UI"},uppercase:["","",""]}},{}],101:[function(){d3plus.method.axis=function(e){var e=e||"x";return{accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,deprecates:[e+"axis",e+"axis_val",e+"axis_var"],domain:!1,lines:[],mute:d3plus.method.filter(!0),range:!1,reset:["range"],scale:{accepted:["linear","log","continuous","share"],value:"linear",deprecates:["layout","unique_axis","yaxis_scale"]},solo:d3plus.method.filter(!0),stacked:{accepted:[Boolean],value:!1},value:!1,zerofill:{accepted:[Boolean],value:!1}}}},{}],102:[function(){d3plus.method.filter=function(e){var e=e||!1;return{accepted:[Array,Boolean,Function,Number,Object,String],global:e,process:Array,value:[]}}},{}],103:[function(){d3plus.method.function=function(e,t){return function(n,r){function a(e){if(d3plus.object.validate(e))if("family"in e)e.family.value=e.family.process(n.family);else for(var t in e)a(e[t])}var i=e in t&&d3plus.object.validate(t[e])&&"accepted"in t[e]?t[e].accepted:e in t?typeof t[e]:null;if("function"==typeof i&&(i=i(t)),null===i||i instanceof Array||(i=[i]),n===Object)return t[e];if(!arguments.length&&(null===i&&!("value"in t)||void 0!==i&&i.indexOf(void 0)<0))return"value"in t[e]?t[e].value:t[e];if("style"===e&&"object"==typeof n){var o=t.format.locale.value.dev.oldStyle;(t.dev.value||"dev"===e&&n)&&!t.methodGroup&&"wait"!==t.methodGroup&&(t.methodGroup=!0,d3plus.console.groupCollapsed("method behavior"));for(var l in n)d3plus.console.warning(d3plus.string.format(o,'"'+l+'"',l),l),t.self[l](n[l]);return t.self}return"font"===e&&d3plus.object.validate(n)&&"family"in n&&"string"==typeof n.family&&a(t),d3plus.method.object(t,e,t,e,n),"function"==typeof r&&(t[e].callback=r),t[e].chainable===!1?t[e].value:t.self}}},{}],104:[function(){d3plus.method.init=function(e,t,n){t.previous=!1,t.changed=!1,t.initialized=!1,t.getVars=function(){return e},"init"in t&&!("value"in t)&&(t.value=t.init(e),delete t.init),"process"in t&&(t.value=d3plus.method.process(t,t.value));for(var r in t)if("deprecates"===r){var a=t[r]instanceof Array?t[r]:[t[r]];a.forEach(function(t){e.self[t]=function(t,n){return function(){e.dev.value&&e.methodGroup&&(d3plus.console.groupEnd(),e.methodGroup=!1);
var r=e.format.locale.value.dev.deprecated;return t="."+t+"()",d3plus.console.error(d3plus.string.format(r,t,"."+n+"()"),n),e.self}}(t,n)})}else"global"===r?n in e||(e[n]=[]):d3plus.object.validate(t[r])&&d3plus.method.init(e,t[r],r);t.initialized=!0}},{}],105:[function(){d3plus.method.object=function(e,t,n,r,a){if(["accepted","getVars"].indexOf(r)<0){var i=d3plus.object.validate(a),o=!(!i||"value"in a||d3.keys(a)[0]in n[r]);if(null===a||!i||o)o?d3plus.method.set(e,t,n[r],"value",a):d3plus.method.set(e,t,n,r,a);else if(i)for(d in a)d3plus.method.object(e,t,n[r],d,a[d])}}},{}],106:[function(){d3plus.method.process=function(e,t){return e.process===Array?d3plus.array.update(d3plus.util.copy(e.value),t):"object"==typeof e.process&&"string"==typeof t?e.process[t]:"function"==typeof e.process?e.process(t):t}},{}],107:[function(){d3plus.method.processData=function(e,t){if("string"==typeof e||d3plus.util.d3selection(e)){if(void 0===t)var t=this;var n=(t.getVars(),e.indexOf("/")>=0);return!n&&d3plus.util.d3selection(e)?e:n||d3.selectAll(e).empty()?(t.url=e,[]):d3.selectAll(e)}return e}},{}],108:[function(){d3plus.method.set=function(e,t,n,r,a){if("value"!==r&&r&&r!==t)var i=e.format.locale.value.dev.of,o='"'+r+'" '+i+" ."+t+"()";else var o="."+t+"()";if("value"===r&&"accepted"in n)var l=n.accepted;else if(d3plus.object.validate(n[r])&&"accepted"in n[r])var l=n[r].accepted;else var l=null;"function"==typeof l&&(l=l(e)),null===l||l instanceof Array||(l=[l]);var s=!0;if(l instanceof Array){var u=void 0===a?a:a.constructor;s=l.indexOf(a)>=0||l.indexOf(u)>=0}if(s===!1){if(void 0!==a){var d=e.format.locale.value.dev.accepted,c=[],p=JSON.stringify(a),f=e.format.locale.value.ui.and;"string"!=typeof a&&(p='"'+p+'"'),l.forEach(function(e){c.push("string"==typeof e?'"'+e+'"':"function"==typeof e?e.toString().split("()")[0].substring(9):e.toString())}),c=d3plus.string.list(c,f),d3plus.console.warning(d3plus.string.format(d,p,o,c),t)}}else{if(d3plus.object.validate(n[r])&&"value"in n[r]){var h=r;n=n[r],r="value"}if("value"===r&&"process"in n&&(a=d3plus.method.process(n,a)),n[r]instanceof Array||n[r]!==a||void 0===a){if(n.changed=!0,"history"in e&&"draw"!==t){var v=d3plus.util.copy(n);v.method=t,e.history.chain.push(v)}if(n.previous=n[r],"id"in e&&"value"===r&&"nesting"in n)if("id"!==t){if("object"!=typeof n.nesting&&(n.nesting={}),d3plus.object.validate(a)){for(var g in a)"string"==typeof a[g]&&(a[g]=[a[g]]);n.nesting=d3plus.object.merge(n.nesting,a),e.id.value in n.nesting||(n.nesting[e.id.value]=a[d3.keys(a)[0]])}else n.nesting[e.id.value]=a instanceof Array?a:[a];n[r]=n.nesting[e.id.value][0]}else a instanceof Array?(n.nesting=a,"depth"in e&&e.depth.value<a.length?n[r]=a[e.depth.value]:(n[r]=a[0],"depth"in e&&(e.depth.value=0))):(n[r]=a,n.nesting=[a],"depth"in e&&(e.depth.value=0));else if("depth"===t){if(e.depth.value=a>=e.id.nesting.length?e.id.nesting.length-1:0>a?0:a,e.id.value=e.id.nesting[e.depth.value],"object"==typeof e.text.nesting){var m=e.text.nesting[e.id.value];m&&(e.text.nesting[e.id.value]="string"==typeof m?[m]:m,e.text.value=m instanceof Array?m[0]:m)}}else n[r]=d3plus.object.validate(n[r])&&d3plus.object.validate(a)?d3plus.object.merge(n[r],a):a;if("value"===r&&n.global){var y=n[r].length>0,x=h||r;x in e&&(y&&e.data[x].indexOf(t)<0||!y&&e.data[x].indexOf(t)>=0)&&(e.data[x]=d3plus.array.update(e.data[x],t))}if("value"===r&&n.dataFilter&&e.data&&e.data.filters.indexOf(t)<0&&e.data.filters.push(t),"value"===r&&n.reset){var b="string"==typeof n.reset?[n.reset]:n.reset;b.forEach(function(e){n[e]=!1})}if((e.dev.value||"dev"===r)&&n.changed&&void 0!==n[r]){var w=n[r]instanceof Array&&n[r].length>10,_=d3plus.util.d3selection(n[r]),k="function"==typeof n[r],z=w||_||k?null:"string"==typeof n[r]?n[r]:JSON.stringify(n[r]);if((e.dev.value||"dev"===r&&user)&&!e.methodGroup&&"wait"!==e.methodGroup&&(e.methodGroup=!0,d3plus.console.groupCollapsed("method behavior")),null!==z&&z.length<260){var d=e.format.locale.value.dev.setLong;d3plus.console.log(d3plus.string.format(d,o,'"'+z+'"'))}else{var d=e.format.locale.value.dev.set;d3plus.console.log(d3plus.string.format(d,o))}}}else{var d=e.format.locale.value.dev.noChange;e.dev.value&&d3plus.console.comment(d3plus.string.format(d,o))}"value"===r&&n.callback&&!n.url&&n.callback(a)}}},{}],109:[function(){d3plus.method=function(e,t,n){var t=t||[],n=n||[],r=d3plus.style[d3plus.method.style.value];t.forEach(function(t){t in e||(e[t]={}),e[t]=d3plus.object.merge(d3plus.method[t],e[t]),n.indexOf(t)>=0&&(e[t]=d3plus.object.merge(r[t],e[t]),n.splice(n.indexOf(t),1)),d3plus.method.init(e,e[t],t),e.self[t]=d3plus.method.function(t,e)}),n.forEach(function(t){e[t]=d3plus.object.merge(e[t]||{},r[t]),d3plus.method.init(e,e[t],t),e.self[t]=d3plus.method.function(t,e)})}},{}],110:[function(){d3plus.method.active={accepted:[!1,Array,Function,Number,Object,String],deprecates:"active_var",mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),spotlight:{accepted:[Boolean],deprecates:"spotlight",value:!1},value:!1}},{}],111:[function(){d3plus.method.aggs={accepted:[Object],deprecated:"nesting_aggs",value:{}}},{}],112:[function(){d3plus.method.alt={accepted:[!1,Array,Function,Object,String],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:"alt"}},{}],113:[function(){d3plus.method.attrs={accepted:[!1,Array,Object,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},process:d3plus.method.processData,value:!1}},{}],114:[function(){d3plus.method.axes={mirror:{accepted:[Boolean],deprecates:["mirror_axis","mirror_axes"],value:!1},values:["x","y"]}},{}],115:[function(){d3plus.method.color={accepted:[!1,Array,Function,Object,String],deprecates:"color_var",init:function(e){return"form"===e.shell?"color":!1},mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0)}},{}],116:[function(){d3plus.method.container={accepted:[Array,Object,String],element:!1,id:"default",process:function(e){if(e===!1){var t=this.getVars().shell;return"form"===t?d3.select("body"):e}return d3plus.util.d3selection(e)?e:d3.select(e instanceof Array?e[0][0]:e)},value:!1}},{}],117:[function(){d3plus.method.coords={accepted:[!1,Array,Function,Object,String],filetype:{accepted:["json"],value:"json"},mute:d3plus.method.filter(!1),process:d3plus.method.processData,solo:d3plus.method.filter(!1),value:!1}},{}],118:[function(e){var t=e("../../core/fetch/value.js");d3plus.method.csv={accepted:[void 0,Array,String],chainable:!1,data:[],process:function(e){var n=this.getVars();if(void 0===n.returned)return[];if(e instanceof Array)var r=e;else if("string"==typeof e)var r=[e];var a=[],i=[],o=n.title.value||"My D3plus App Data";if(o=d3plus.string.strip(o),!r){var r=[n.id.value];n.time.value&&r.push(n.time.value),n.size.value&&r.push(n.size.value),n.text.value&&r.push(n.text.value)}r.forEach(function(e){i.push(n.format.value(e))}),a.push(i),n.returned.nodes.forEach(function(e){var i=[];r.forEach(function(r){i.push(t(n,e,r))}),a.push(i)});var l="data:text/csv;charset=utf-8,";if(a.forEach(function(e,t){dataString=e.join(","),l+=t<a.length?dataString+"\n":dataString}),d3plus.ie){var s=new Blob([l],{type:"text/csv;charset=utf-8;"});navigator.msSaveBlob(s,o+".csv")}else{var u=encodeURI(l),d=document.createElement("a");d.setAttribute("href",u),d.setAttribute("download",o+".csv"),d.click()}return this.data=a,r},value:void 0}},{"../../core/fetch/value.js":51}],119:[function(){d3plus.method.data={accepted:[!1,Array,Function,String],cache:{},delimiter:{accepted:[String],value:"|"},element:{process:function(e){if(d3plus.util.d3selection(e))var t=e;else if("string"!=typeof e||d3.select(e).empty())var t=!1;else var t=d3.select(e);if(t){var n=this.getVars();n.self.container(d3.select(t.node().parentNode)),t.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}return t},value:!1},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],mute:[],process:function(e){var t=this.getVars();return"default"===t.container.id&&e.length&&t.self.container({id:"default"+e.length}),d3plus.method.processData(e,this)},solo:[],value:!1}},{}],120:[function(){d3plus.method.depth={accepted:[Function,Number],value:0}},{}],121:[function(){d3plus.method.descs={accepted:[!1,Function,Object],value:!1}},{}],122:[function(){d3plus.method.dev={accepted:[Boolean],value:!1}},{}],123:[function(e){var t=e("../../core/parse/element.js");d3plus.method.draw={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e){if(this.initialized===!1)return this.initialized=!0,e;var n=this.getVars(),r="history"in n?n.history.chain:[];if("data"in n&&n.data.value&&d3plus.util.d3selection(n.data.value)&&(n.data.value=t(n)),void 0===e&&"function"==typeof this.value&&(e=this.value),n.container.value===!1){var a=n.format.locale.value.dev.setContainer;d3plus.console.warning(a,"container")}else if(n.container.value.empty()){var a=n.format.locale.value.dev.noContainer;d3plus.console.warning(d3plus.string.format(a,'"'+n.container.value+'"'),"container")}else n.dev.value&&(n.methodGroup&&(n.methodGroup="wait",d3plus.console.groupEnd()),d3plus.console.time("total draw time")),n.container.value.call(n.self);if("function"==typeof e&&r.length){var i={};r.forEach(function(e){var t=e.method;delete e.method,i[t]=e}),e(i),n.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/parse/element.js":55}],124:[function(){d3plus.method.edges={accepted:[!1,Array,Function,String],connections:function(e,t,n){var r=this;if(!r.value)return[];if(!t)var t="id";var a=r.restricted||r.value,i=[];if(!e)return a;var o=a.filter(function(a){var o=!1;return a[r.source][t]==e?(o=!0,n&&i.push(a[r.target])):a[r.target][t]==e&&(o=!0,n&&i.push(a[r.source])),o});return n?i:o},delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},interpolate:{accepted:["basis","cardinal","linear","monotone","step"],value:"basis"},label:!1,limit:{accepted:[!1,Function,Number],value:!1},process:d3plus.method.processData,size:!1,source:"source",target:"target",value:!1}},{}],125:[function(){d3plus.method.error={accepted:[Boolean,String],value:!1}},{}],126:[function(){d3plus.method.focus={accepted:[!1,Array,Function,Number,String],deprecates:"highlight",process:function(e){if(e===!1)return[];e instanceof Array||(e=[e]);var t=this.getVars();if(["string","number"].indexOf(typeof e[0])>=0&&t.data.element.value){var n=t.data.element.value.node().tagName.toLowerCase(),r=t.data.element.value.attr("type");"select"===n?t.data.element.value.selectAll("option").each(function(n,r){n&&n[t.id.value]===e[0]&&(t.data.element.value.node().selectedIndex=r)}):"input"===n&&"radio"===r&&t.data.element.value.each(function(n){this.checked=n&&n[t.id.value]===e[0]?!0:!1})}return e},tooltip:{accepted:[Boolean],value:!0},value:[]}},{}],127:[function(){d3plus.method.footer={accepted:[!1,Number,String],link:!1,value:!1}},{}],128:[function(){d3plus.method.format={accepted:[Function,String],deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(d3plus.locale)},process:function(e){var t="en_US",n=d3plus.locale[t];return e!==t&&(n=d3plus.object.merge(n,d3plus.locale[e])),this.language=e,n},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e){if("string"==typeof e){var t=this.getVars();t.self.format({locale:e})}else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var n=this.getVars();if(n.time&&n.time.value&&t===n.time.value){var r=n.time.format.value||n.data.time.format,a=e.constructor===Date?e:new Date(e);return r(a)}if("number"==typeof e){var r=this.number.value||d3plus.number.format;return r(e,t)}if("string"==typeof e){var r=this.text.value||d3plus.string.title;return r(e,t)}return JSON.stringify(e)}}},{}],129:[function(){d3plus.method.height={accepted:[!1,Number],secondary:!1,value:!1}},{}],130:[function(){d3plus.method.history={accepted:[Boolean],back:function(){if(this.states.length>0){var e=this.states.pop();e()}},chain:[],states:[],value:!0}},{}],131:[function(){d3plus.method.hover={accepted:[!1,Number,String],value:!1}},{}],132:[function(){d3plus.method.icon={accepted:[!1,Array,Function,Object,String],deprecates:"icon_var",style:{accepted:[Object,String],deprecates:"icon_style",value:"default"},value:"icon"}},{}],133:[function(){d3plus.method.id={accepted:[Array,String],dataFilter:!0,deprecates:["id_var","nesting"],init:function(e){return"form"===e.shell?(this.nesting=["value"],"value"):(this.nesting=["id"],"id")},mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0)}},{}],134:[function(){d3plus.method.keywords={accepted:[!1,Array,Function,Object,String],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:"keywords"}},{}],135:[function(){d3plus.method.labels={accepted:[Boolean],resize:{accepted:[Boolean],value:!0},value:!0}},{}],136:[function(){d3plus.method.legend={accepted:[Boolean],value:!0}},{}],137:[function(){d3plus.method.margin={accepted:[Number,Object,String],process:function(e){var t=this,n=["top","right","bottom","left"];if(void 0===e)var e=t.value;var r=e;if("string"==typeof e&&(e=e.split(" "),e.forEach(function(t,n){e[n]=parseFloat(t,10)}),e=1===e.length?e[0]:2===e.length?{top:e[0],right:e[1],bottom:e[0],left:e[1]}:3===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[1]}:4===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[3]}:0),"number"==typeof e)n.forEach(function(n){t[n]=e});else{for(var a in e){var i=n.indexOf(a);i>=0&&(n.splice(i,1),t[a]=e[a])}n.forEach(function(e){t[e]=0})}return r},value:0}},{}],138:[function(){d3plus.method.messages={accepted:[Boolean,String],value:!0}},{}],139:[function(){d3plus.method.nodes={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},process:d3plus.method.processData,value:!1}},{}],140:[function(){d3plus.method.open={accepted:[Boolean],flipped:{accepted:[Boolean],value:!1},value:!1}},{}],141:[function(){d3plus.method.order={accepted:[!1,Function,String],sort:{accepted:["asc","desc"],value:"asc",deprecates:["sort"]},value:!1}},{}],142:[function(){d3plus.method.remove={accepted:void 0,process:function(e){if(!this.initialized)return e;var t=this.getVars();t.container.value.remove()},value:void 0}},{}],143:[function(){d3plus.method.resize={accepted:[Boolean],value:!1}},{}],144:[function(){d3plus.method.search={accepted:["auto",Boolean],process:function(e){return"Boolean"==typeof e&&(this.enabled=e),e},value:"auto"}},{}],145:[function(){d3plus.method.select={accepted:[String],chainable:!1,process:function(e){var t=this.getVars();return t.container.value&&e?t.container.value.select(e):e},value:void 0}},{}],146:[function(){d3plus.method.selectAll={accepted:[String],chainable:!1,process:function(e){var t=this.getVars();return t.container.value&&e?t.container.value.selectAll(e):e},value:void 0}},{}],147:[function(){d3plus.method.shape={accepted:function(e){return"textwrap"===e.shell?["circle","square"]:["circle","donut","line","square","area","coordinates"]},value:!1}},{}],148:[function(){d3plus.method.size={accepted:function(e){return"textwrap"===e.shell?[Array,!1]:[Array,Boolean,Function,Object,String]},dataFilter:!0,deprecates:["value","value_var"],mute:d3plus.method.filter(!0),scale:{accepted:[Function],deprecates:"size_scale",value:d3.scale.sqrt()},solo:d3plus.method.filter(!0),threshold:!0,value:!1}},{}],149:[function(){d3plus.method.style={accepted:function(){return d3.keys(d3plus.style).filter(function(e){return"object"==typeof d3plus.style[e]})},value:"default"}},{}],150:[function(){d3plus.method.temp={accepted:[!1,Array,Function,Object,String],deprecates:["else_var","else"],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:!1}},{}],151:[function(){d3plus.method.text={accepted:[Array,Boolean,Function,Object,String],deprecates:["name_array","text_var"],html:{accepted:[Boolean],value:!1},init:function(e){if("textwrap"===e.shell){var t=this.split;this.break=new RegExp("[^\\s\\"+t.join("\\")+"]+\\"+t.join("?\\")+"?","g")}return!1},nesting:!0,mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),secondary:{accepted:[Array,Boolean,Function,Object,String],nesting:!0,value:!1},split:["-","/",";",":","&"]}},{}],152:[function(){d3plus.method.time={accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,deprecates:["year","year_var"],fixed:{accepted:[Boolean],deprecates:["static_axis","static_axes"],value:!0},format:{accepted:[!1,String],value:!1},mute:d3plus.method.filter(!1),solo:d3plus.method.filter(!1),value:!1}},{}],153:[function(){d3plus.method.timeline={accepted:[Boolean],value:!0}},{}],154:[function(){d3plus.method.title={accepted:[!1,Function,String],link:!1,sub:{accepted:[!1,String],deprecates:"sub_title",link:!1,value:!1},total:{accepted:[Boolean,Object],deprecates:"total_bar",link:!1,value:!1},process:function(e){var t=this.getVars();if(0===t.container.id.indexOf("default")&&e){var n=d3plus.string.strip(e).toLowerCase();t.self.container({id:n})}return e},value:!1}},{}],155:[function(){d3plus.method.tooltip={accepted:[!1,Array,Function,Object,String],deprecates:"tooltip_info",html:{accepted:[!1,Function,String],deprecates:"click_function",value:!1},value:!1}},{}],156:[function(){d3plus.method.total={accepted:[!1,Array,Function,Object,String],deprecates:["total_var"],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:!1}},{}],157:[function(){d3plus.method.type={accepted:function(e){return d3.keys(e.types)},init:function(e){var t=e.shell;return"viz"===t?"tree_map":"form"===t?"auto":void 0},mode:{accepted:function(e){return e.types[e.type.value].modes||[!1]},value:!1}}},{}],158:[function(){d3plus.method.ui={accepted:[Array,Boolean],value:!1}},{}],159:[function(){d3plus.method.width={accepted:[!1,Number],secondary:!1,value:!1}},{}],160:[function(){d3plus.method.x=d3plus.method.axis("x")},{}],161:[function(){d3plus.method.y=d3plus.method.axis("y")},{}],162:[function(){d3plus.method.zoom={accepted:[Boolean],behavior:d3.behavior.zoom().scaleExtent([1,1]),click:{accepted:[Boolean],value:!0},direction:function(e){var t=this.getVars(),n=t.id.nesting.length-1,r=t.depth.value,a=t.types[t.type.value].nesting===!1;return a?0:e.d3plus.merged||n>r&&(!e||t.id.nesting[t.depth.value+1]in e)?1:r!==n&&(!e||t.id.nesting[t.depth.value+1]in e)||!t.small&&t.tooltip.html.value?0:-1},pan:{accepted:[Boolean],value:!0},scroll:{accepted:[Boolean],deprecates:"scroll_zoom",value:!0},touchEvent:function(){var e=this.getVars(),t=e.zoom.scale>e.zoom.behavior.scaleExtent()[0],n=e.types[e.type.value].zoom&&e.zoom.value&&e.zoom.scroll.value,r=d3.event.touches.length>1&&n;r||t||d3.event.stopPropagation()},value:!0}},{}],163:[function(){d3plus.network.cluster=function(e,t){var n,r,a,i,o,l,s,u,d,c,p,f,h,v,g,m,y,x,b,w,_,k,z,A,j,M,E,S,T,O,F,V;if(h=[],null==t&&(t={}),(null==t.nodes||"object"!=typeof t.nodes)&&(F=d3plus.network.normalize(e,t),e=F[0],t=F[1],null===t))return null;c=t.distance,k=t.nodeid,M=t.startpoint,f=t.endpoint,z=t.nodes,A={};for(v in z)A[v]={node:z[v].node,degree:0};for(x=0,y={},E=0,T=e.length;T>E;E++)p=e[E],r=k(M(p)),a=k(f(p)),r in y||(y[r]={}),a in y||(y[a]={}),a in y[r]||(y[r][a]=0,y[a][r]=0,x++,A[r].degree+=1,A[a].degree+=1);s={},n=0;for(v in A)_=A[v],s[v]={score:_.degree/(2*x),nodes:[v]};for(r in y)for(a in y[r])y[r][a]=1/(2*x)-A[r].degree*A[a].degree/(4*x*x);for(g=0;1e3>g;){d=-1,b=void 0,w=void 0;for(r in y)for(a in y[r])y[r][a]>d&&(d=y[r][a],b=r,w=a);if(0>d)break;for(m in y[b])m!==w&&(m in y[w]?y[w][m]+=y[b][m]:y[w][m]=y[b][m]-2*s[w].score*s[m].score,y[m][w]=y[w][m]),delete y[m][b];for(m in y[w])m in y[b]||m===w||(y[w][m]-=2*s[b].score*s[m].score,y[m][w]=y[w][m]);for(V=s[b].nodes,S=0,O=V.length;O>S;S++)_=V[S],s[w].nodes.push(_);s[w].score+=s[b].score,t.vdebug&&h.push({type:"merge",father:w,child:b,nodes:s[w].nodes}),delete s[b],delete y[b],n+=d,g++}return l=function(){var e;e=[];for(i in s)u=s[i],e.push([i,u.nodes.length]);return e}(),l.sort(function(e,t){return t[1]-e[1]}),j=function(){var e,t,n;for(n=[],e=0,t=l.length;t>e;e++)o=l[e],n.push(s[o[0]].nodes);return n}(),[j,h]}},{}],164:[function(){d3plus.network.normalize=function(e,t){var n,r,a,i,o,l,s,u,d,c,p,f,h,v,g,m,y,x,b,w,_,k,z,A,j,M,E,S,T,O,F;if(w=t.source,k=t.target,i=t.directed,o=t.distance,x=t.nodeid,_=t.startpoint,u=t.endpoint,n=t.K,z=t.vdebug,i||(i=!1),null==n&&(n=1),null==x?x=function(e){return e}:"string"==typeof x&&(x=function(e){return function(t){return t[e]}}(x)),null!=w&&"object"==typeof w&&(w=x(w)),null!=k&&"object"==typeof k&&(k=x(k)),null==_?_=function(e){return e.source}:"string"==typeof _&&(_=function(e){return function(t){return t[e]}}(_)),null==u?u=function(e){return e.target}:"string"==typeof u&&(u=function(e){return function(t){return t[e]}}(u)),null==o)o=function(){return 1};else if("number"==typeof o)o=function(e){return function(){return e}}(o);else if("string"==typeof o)o=function(e){return function(t){return t[e]}}(o);else if(o instanceof Array){for(s={},c=A=0,E=e.length;E>A;c=++A)l=e[c],r=x(_(l)),a=x(u(l)),s[r+"_"+a]=o[c];o=function(e){return r=x(_(e)),a=x(u(e)),s[r+"_"+a]}}for(b={},j=0,S=e.length;S>j;j++){for(l=e[j],m=_(l),y=u(l),h=x(m),v=x(y),O=[m,y],M=0,T=O.length;T>M;M++)g=O[M],p=x(g),p in b||(b[p]={node:g,outedges:[]});b[h].outedges.push(l),i||b[v].outedges.push(l)}return d=null,0===e.length?d="The length of edges is 0":0>n?d="K can not have negative value":null==o(e[0])?d="Check the distance function/attribute":null==_(e[0])?d="Check the startpoint function/attribute":null==u(e[0])?d="Check the endpoint function/attribute":(f=x(_(e[0])),null==f||"string"!=(F=typeof f)&&"number"!==F?d="Check the nodeid function/attribute":null==w||w in b?null==k||k in b||(d="The target is not in the graph"):d="The source is not in the graph"),null!=d?(d3plus.console.error(d),null):[e,{source:w,target:k,directed:i,distance:o,nodeid:x,startpoint:_,endpoint:u,K:n,nodes:b,vdebug:z}]}},{}],165:[function(e,t){var n;n=e("heap"),d3plus.network.shortestPath=function(e,t,r){var a,i,o,l,s,u,d,c,p,f,h,v,g,m,y,x,b,w,_,k,z,A,j,M,E,S,T,O,F;if(null==r&&(r={}),r.source=t,(null==r.nodes||"object"!=typeof r.nodes)&&(T=d3plus.network.normalize(e,r),e=T[0],r=T[1],null===r))return null;t=r.source,k=r.target,s=r.directed,u=r.distance,m=r.nodeid,_=r.startpoint,c=r.endpoint,a=r.K,y=r.nodes;for(h in y)g=y[h],g.count=0;for(f=new n(function(e,t){return e.distance-t.distance}),A={},null==k&&(A[t]=!0),f.push({edge:null,target:t,distance:0}),v=0,w=[];!f.empty()&&(v=Math.max(v,f.size()),x=f.pop(),z=x.target,y[z].count++,null==k?w.push(x):z===k&&w.push(x),w.length!==a);)if(y[z].count<=a)for(O=y[z].outedges,j=0,E=O.length;E>j;j++){if(d=O[j],i=m(_(d)),l=m(c(d)),s||l!==z||(F=[l,i],i=F[0],l=F[1]),null==k){if(A[l])continue;A[l]=!0}o=x.distance+u(d),f.push({edge:d,previous:x,target:l,distance:o})}for(p=function(t){for(e=[];null!=t.edge;)e.push(t.edge),t=t.previous;return e.reverse()},M=0,S=w.length;S>M;M++)b=w[M],null!=k&&(delete b.target,b.edges=p(b)),delete b.edge,delete b.previous;return w},t.exports=d3plus.network.shortestPath},{heap:1}],166:[function(){d3plus.network.subgraph=function(e,t,n){var r,a,i,o,l,s,u,d,c,p,f,h;return null==n&&(n={}),n.source=t,null!=n.nodes&&"object"==typeof n.nodes||(h=d3plus.network.normalize(e,n),e=h[0],n=h[1],null!==n)?(t=n.source,i=n.directed,o=n.distance,d=n.nodeid,p=n.startpoint,s=n.endpoint,r=n.K,c=n.nodes,f={},f[t]=!0,a=function(e,t){var n,l,u,h,v,g,m,y,x;for(m=c[e].outedges,x=[],v=0,g=m.length;g>v;v++)u=m[v],n=d(p(u)),l=d(s(u)),i||l!==e||(y=[l,n],n=y[0],l=y[1]),l in f?x.push(void 0):(h=t+o(u),r>=h?(f[l]=!0,x.push(a(l,h))):x.push(void 0));return x},a(t,0),{nodes:function(){var e;e=[];for(u in f)e.push(c[u].node);return e}(),edges:function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)l=e[t],d(p(l))in f&&d(s(l))in f&&r.push(l);return r}()}):null}},{}],167:[function(){d3plus.number.format=function(e,t,n){if(!n&&"getVars"in this)var n=this.getVars();if(n&&t&&(t===n.x.value&&"log"===n.x.scale.value||t===n.y.value&&"log"===n.y.scale.value)){var r="",a=function(e){return(e+"").split("").map(function(e){return r[e]}).join("")};return"10"+a(Math.round(Math.log(e)/Math.LN10))}if("locale"in this)var i=this.locale.value,o=i.time;else var i=d3plus.locale.en_US,o=i.time;if(n&&"string"==typeof n.time.value&&o.push(n.time.value),t&&o.indexOf(t.toLowerCase())>=0)return e;if(10>e&&e>-10)return d3.round(e,2);if(e.toString().split(".")[0].length>4){var l=d3.formatPrefix(e).symbol;return l=l.replace("G","B"),e=d3.formatPrefix(e).scale(e),e=parseFloat(d3.format(".3g")(e)),e+l}return"share"==t?d3.format(".2f")(e):d3.format(",f")(e)}},{}],168:[function(e,t){var n;n=e("../util/d3selection.js"),d3plus.object.merge=function(e,t){var r,a;return r=function(e,t){var a,i;i=[];for(a in e)"undefined"!=typeof e[a]?d3plus.object.validate(e[a])?("object"!=typeof t[a]&&(t[a]={}),i.push(r(e[a],t[a]))):i.push(!n(e[a])&&e[a]instanceof Array?t[a]=e[a].slice(0):t[a]=e[a]):i.push(void 0);return i},a={},e&&r(e,a),t&&r(t,a),a},t.exports=d3plus.object.merge},{"../util/d3selection.js":218}],169:[function(e,t){d3plus.object.validate=function(e){return null!==e&&"object"==typeof e&&!(e instanceof Array)},t.exports=d3plus.object.validate},{}],170:[function(){d3plus.string.format=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.unkeyed_index=0,t.replace(/\{(\w*)\}/g,function(n,r){if(""===r&&(r=t.unkeyed_index,t.unkeyed_index++),r==+r)return"undefined"!==e[r]?e[r]:n;for(var a=0;a<e.length;a++)if("object"==typeof e[a]&&"undefined"!=typeof e[a][r])return e[a][r];return n}.bind(t))}},{}],171:[function(){d3plus.string.list=function(e,t,n,r){var a;return e instanceof Array?(e=e.slice(0),t||(t=d3plus.locale.en_US.ui.and),r||(r=d3plus.locale.en_US.ui.moreText),2===e.length?e.join(" "+t+" "):(n&&e.length>n&&(a=e.length-n+1,e=e.slice(0,n-1),e[n-1]=d3plus.string.format(r,a)),e.length>1&&(e[e.length-1]=t+" "+e[e.length-1]),e.join(", "))):e}},{}],172:[function(){d3plus.string.strip=function(e){var t=["!","@","#","$","%","^","&","*","(",")","[","]","{","}",".",",","/","\\","|","'",'"',";",":","<",">","?","=","+"];return e+="",""+e.replace(/[^A-Za-z0-9\-_]/g,function(e){if(" "==e)return"_";if(t.indexOf(e)>=0)return"";var n=[[/[\300-\306]/g,"A"],[/[\340-\346]/g,"a"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\322-\330]/g,"O"],[/[\362-\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\307]/g,"C"],[/[\347]/g,"c"]],r="";for(var a in n)if(n[a][0].test(e)){r=n[a][1];break}return r})}},{}],173:[function(){d3plus.string.title=function(e){var t,n,r;return e?("locale"in this?(n=this.locale.value,"string"==typeof n&&(n=n in d3plus.locale?d3plus.locale[n]:d3plus.locale.en_US)):n=d3plus.locale.en_US,"."===e.charAt(e.length-1)?e.charAt(0).toUpperCase()+e.substr(1):(r=n.lowercase,t=n.uppercase,e.replace(/\S*/g,function(n,a){return t.indexOf(n.toLowerCase())>=0?n.toUpperCase():r.indexOf(n.toLowerCase())>=0&&0!==a&&a!==e.length-1?n.toLowerCase():n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()}))):""}},{}],174:[function(){d3plus.style.default={},d3plus.style.default.fontFamily=["Helvetica Neue","HelveticaNeue","Helvetica","Arial","sans-serif"]},{}],175:[function(){d3plus.style.default.axes={ticks:{color:"#ccc",font:{color:"#888",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:10,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},size:10,width:1}}},{}],176:[function(){d3plus.style.default.background={accepted:[String],value:"#ffffff"}},{}],177:[function(){d3plus.style.default.color={heatmap:["#27366c","#7b91d3","#9ed3e3","#f3d261","#c9853a","#d74b03"],focus:"#444444",missing:"#eeeeee",primary:"#d74b03",range:["#d74b03","#eeeeee","#94b153"],scale:{accepted:[Array,"d3plus","category10","category20","category20b","category20c"],process:function(e){return e instanceof Array?d3.scale.ordinal().range(e):"d3plus"===e?d3plus.color.scale:(console.log("Here!"),d3.scale[e]())},value:"d3plus"},secondary:"#e5b3bb"}},{}],178:[function(){d3plus.style.default.coords={center:[0,0],fit:{accepted:["auto","height","width"],value:"auto"},padding:20,projection:{accepted:["mercator","equirectangular"],value:"mercator"},threshold:.1}},{}],179:[function(){d3plus.style.default.data={donut:{size:.35},large:400,opacity:.9,stroke:{width:1}}},{}],180:[function(){d3plus.style.default.edges={arrows:{accepted:[Boolean,Number],direction:{accepted:["source","target"],value:"target"},value:!1},color:"#d0d0d0",large:100,limit:!1,opacity:1,width:1}},{}],181:[function(){d3plus.style.default.font={align:{accepted:["left","center","right"],process:function(e){return d3plus.rtl?"left"===e?"right":"right"===e?"left":e:e},value:"left"},color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),secondary:{align:{accepted:["left","center","right"],process:function(e){return d3plus.rtl?"left"===e?"right":"right"===e?"left":e:e},value:"left"},color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,spacing:0,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},size:12,spacing:0,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200}},{}],182:[function(){d3plus.style.default.footer={font:{align:"center",color:"#444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:11,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:0,position:"bottom"}},{}],183:[function(){d3plus.style.default.height={small:300,max:600}},{}],184:[function(){d3plus.style.default.icon={back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-angle-left"},button:{accepted:[!1,String],fallback:!1,opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:!1},drop:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-angle-down"},fontCheck:function(e,t){return e===!1||0===e.indexOf("fa-")&&d3plus.font.awesome||e.indexOf("fa-")<0?e:t},next:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-angle-right"},select:{accepted:[!1,String],fallback:"&#x2713;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-check"}}},{}],185:[function(){d3plus.style.default.labels={align:"middle",font:{decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:11,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:7,segments:2}},{}],186:[function(){d3plus.style.default.legend={align:"middle",font:{align:"middle",color:"#444444",family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:10,weight:200},gradient:{height:10},order:{accepted:["color","id","size","text"],sort:{accepted:["asc","desc"],value:"asc"},value:"color"},size:[8,30]}
},{}],187:[function(){d3plus.style.default.links={font:{color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},hover:{color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"underline"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200}}},{}],188:[function(){d3plus.style.default.messages={font:{color:"#444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:16,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:5}},{}],189:[function(){d3plus.style.default.nodes={overlap:.6}},{}],190:[function(){d3plus.style.default.shape={interpolate:{accepted:["basis","basis-open","cardinal","cardinal-open","linear","monotone","step","step-before","step-after"],deprecates:"stack_type",value:"linear"},rendering:{accepted:["auto","optimizeSpeed","crispEdges","geometricPrecision"],value:"auto"}}},{}],191:[function(){d3plus.style.default.timeline={align:"middle",hover:{accepted:["all-scroll","col-resize","crosshair","default","grab","grabbing","move","pointer"],value:"pointer"},handles:{accepted:[Boolean],color:"#e5e5e5",hover:"#cccccc",opacity:1,size:2,stroke:"#818181",value:!0},height:{accepted:[Number],value:23},tick:"#818181"}},{}],192:[function(){d3plus.style.default.timing={mouseevents:60,transitions:600,ui:200}},{}],193:[function(){d3plus.style.default.title={font:{align:"center",color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:16,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:400},height:!1,padding:2,position:"top",sub:{font:{align:"center",color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:1,position:"top"},total:{font:{align:"center",color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:1,position:"top"},width:!1}},{}],194:[function(){d3plus.style.default.tooltip={anchor:"top center",background:"#ffffff",children:{accepted:[Boolean],value:!0},connections:{accepted:[Boolean],value:!0},curtain:{color:"#ffffff",opacity:.8},font:{color:"#444",family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},large:250,share:{accepted:[Boolean],value:!0},size:{accepted:[Boolean],value:!0},small:225}},{}],195:[function(){d3plus.style.default.ui={align:{accepted:["left","center","right"],process:function(e){return d3plus.rtl?"left"===e?"right":"right"===e?"left":e:e},value:"center"},border:1,color:{primary:{process:function(e){var t=this.getVars(),n=this.value,r=t.ui.color.secondary.value;return r&&r!==d3.rgb(n).darker(2).toString()||(t.ui.color.secondary.value=d3.rgb(e).darker(2).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:"center",color:"#444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:11,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},margin:5,padding:5,position:{accepted:["top","right","bottom","left"],value:"bottom"}}},{}],196:[function(){d3plus.style.default.width={small:400}},{}],197:[function(){d3plus.style.fontFamily=function(e){return{process:d3plus.font.validate,value:e}}},{}],198:[function(e,t){d3plus.style.sheet=function(e){var t,n,r;for(t=0,n=!1;t<document.styleSheets.length;){if(r=document.styleSheets[t],r.href&&r.href.indexOf(e)>=0){n=!0;break}t++}return n},t.exports=d3plus.style.sheet},{}],199:[function(){d3plus.textwrap.flow=function(e){e.text.html.value?this.foreign(e):this.tspan(e)}},{}],200:[function(){d3plus.textwrap.foreign=function(e){var t=e.container.value,n=t.attr("font-family")||t.style("font-family"),r=t.attr("text-anchor")||t.style("text-anchor"),a=t.attr("fill")||t.style("fill"),i=t.attr("opacity")||t.style("opacity");r="end"===r?"right":"middle"===r?"center":"left",d3.select(t.node().parentNode).append("foreignObject").attr("width",e.width.value+"px").attr("height",e.height.value+"px").attr("x","0px").attr("y","0px").append("xhtml:div").style("font-family",n).style("font-size",e.size.value[1]).style("color",a).style("text-align",r).style("opacity",i).text(e.text.current)}},{}],201:[function(){d3plus.textwrap.getDimensions=function(e){if(!e.width.value||!e.height.value){var t=d3.select(e.container.value.node().parentNode),n=t.select("rect"),r=t.select("circle");if(n.empty())if(r.empty())e.width.value||e.self.width(500),e.height.value||e.self.height(500);else{var a=r.attr("r");e.width.value||e.self.width(parseFloat(2*a,10)),e.height.value||e.self.height(parseFloat(2*a,10))}else{if(!e.width.value){var i=n.attr("width")||n.style("width");e.self.width(parseFloat(i,10))}if(!e.height.value){var o=n.attr("height")||n.style("height");e.self.height(parseFloat(o,10))}}}}},{}],202:[function(){d3plus.textwrap.getSize=function(e){var t=e.container.value.attr("font-size")||e.container.value.style("font-size");e.size.value||(t=parseFloat(t,10),e.self.size(e.resize.value?[t,2*t]:[t/2,t])),e.container.fontSize=t}},{}],203:[function(){d3plus.textwrap.getText=function(e){if(!e.text.value){var t=e.container.value.text();t&&(t.indexOf("tspan")>=0&&(t.replace(/\<\/tspan\>\<tspan\>/g," "),t.replace(/\<\/tspan\>/g,""),t.replace(/\<tspan\>/g,"")),e.self.text(t))}e.text.phrases=e.text.value instanceof Array?e.text.value.filter(function(e){return["string","number"].indexOf(typeof e)>=0}):[e.text.value+""],e.container.value.text("")}},{}],204:[function(){d3plus.textwrap.resize=function(e){if(e.resize.value){for(var t=[],n=0;n<e.text.words.length;n++){var r=n===e.text.words.length-1?"":" ";t.push(e.text.words[n]+r)}var a=Math.floor(e.size.value[1]),i="circle"===e.shape.value?.785*e.width.value:e.width.value,o=d3plus.font.sizes(t,{"font-size":a+"px"},e.container.value),l=d3.max(o,function(e){return e.width}),s=1.165+e.width.value/e.height.value*.037,u=d3.sum(o,function(e){return e.width*e.height})*s,d="circle"===e.shape.value?Math.PI*Math.pow(e.width.value/2,2):i*e.height.value;if(l>i||u>d){var c=Math.sqrt(d/u),p=i/l,f=d3.min([c,p]);a=d3.max([e.size.value[0],Math.floor(a*f)])}var h=Math.floor(.8*e.height.value);a>h&&(a=h),l*(a/e.size.value[1])<=i?(a!==e.size.value[1]&&e.self.size([e.size.value[0],a]),e.container.value.attr("font-size",e.size.value[1]+"px"),this.flow(e)):this.wrap(e)}}},{}],205:[function(){d3plus.textwrap.tspan=function(e){var t=e.container.value.attr("x")||"0px",n=e.text.words.slice(0),r=!1,a=e.resize.value?e.size.value[1]:e.container.fontSize||e.size.value[0],i=e.container.value.append("tspan").text(n[0]).attr("dy",a+"px"),o=i.node().offsetHeight||i.node().getBoundingClientRect().height,l=1,s=function(){return e.container.value.append("tspan").attr("x",t).attr("dy",a+"px")},u=function(){i.empty()||(n=i.text().match(/[^\s-]+-?/g),d())},d=function(){if(n&&n.length){var t=n.pop(),r=t.charAt(t.length-1);if(1===t.length&&e.text.split.indexOf(t)>=0)d();else{e.text.split.indexOf(r)>=0&&(t=t.substr(0,t.length-1)),i.text(n.join(" ")+" "+t+" ...");var a=(l-1)*o,s="circle"===e.shape.value?2*Math.sqrt(a*(2*(e.width.value/2)-a)):e.width.value;i.node().getComputedTextLength()>s&&d()}}else i.remove(),i=d3.select(e.container.value.node().lastChild),i.empty()||(l--,u())};"circle"===e.shape.value&&e.container.value.attr("text-anchor","middle");for(var c=1;c<n.length;c++){if(l*o>e.height.value){i.remove(),1!==c&&(i=d3.select(e.container.value.node().lastChild),i.empty()||u());break}var p=i.text(),f=(p.slice(-1),e.text.current.charAt(e.text.current.indexOf(p)+p.length)),h=" "==f?" ":"";i.text(p+h+n[c]);var v=(l-1)*o,g="circle"===e.shape.value?2*Math.sqrt(v*(2*(e.width.value/2)-v)):e.width.value;i.node().getComputedTextLength()>g&&(r||(i.text(""),i=s()),i.text(p),i=s(),i.text(n[c]),l++)}}},{}],206:[function(){d3plus.textwrap.wrap=function(e){e.text.phrases.length&&(e.text.current=e.text.phrases.shift()+"",e.text.words=e.text.current.match(e.text.break),e.resize.value?this.resize(e):this.flow(e))}},{}],207:[function(){d3plus.textwrap=function(){var e={shell:"textwrap"};e.self=function(t){return t.each(function(){d3plus.textwrap.getDimensions(e),d3plus.textwrap.getSize(e),e.size.value[0]<=e.height.value&&(d3plus.textwrap.getText(e),d3plus.textwrap.wrap(e))}),e.self};var t=["container","dev","draw","format","height","resize","text","shape","size","width"];return d3plus.method(e,t),e.self}},{}],208:[function(e){var t=e("../core/fetch/value.js"),n=e("../core/fetch/color.js"),r=e("../core/fetch/text.js");d3plus.tooltip.app=function(e){function a(a){var d={},v={},g=i.id.nesting[l+1]in o?l+1:l,m=i.id.nesting[g],_="merged"in o.d3plus?o.d3plus.merged:o[m],k=t(i,o,i.size.value);if(i.tooltip.children.value)if(_ instanceof Array){if(_=_.slice(0),i.size.value&&d3plus.object.validate(_[0])){var z=_.filter(function(e){return i.size.value in e}),A=_.filter(function(e){return!(i.size.value in e)});d3plus.array.sort(z,i.size.value,"desc",[],i),_=z.concat(A)}for(var j="short"===h?3:i.data.large,M=d3.min([_.length,j]),E=0;M>E;E++){var S=_[E],T=r(i,S,g)[0],O=t(i,S,i.size.value,m),F=n(i,S,m);v[T]=O?i.format.value(O,i.size.value):"",F&&(v.d3plus_colors||(v.d3plus_colors={}),v.d3plus_colors[T]=F)}_.length>M&&(v.d3plusMore=_.length-M)}else if(_&&"null"!==_){var T=r(i,_,g)[0];v[T]=k?i.format.value(k,i.size.value):""}i.size.value&&i.tooltip.size.value&&k&&(!_||_ instanceof Array)&&(d[i.size.value]=k);var V=i.active.value?t(i,o,i.active.value):o.d3plus.active,N=i.temp.value?t(i,o,i.temp.value):o.d3plus.temp,B=i.total.value?t(i,o,i.total.value):o.d3plus.total;if("number"==typeof V&&V>0&&B){var I=i.active.value||"active";d[I]=V+"/"+B+" ("+i.format.value(V/B*100,"share")+"%)"}if("number"==typeof N&&N>0&&B){var I=i.temp.value||"temp";d[I]=N+"/"+B+" ("+i.format.value(N/B*100,"share")+"%)"}i.tooltip.share.value&&o.d3plus.share&&(d.share=i.format.value(100*o.d3plus.share,"share")+"%");var g="depth"in e?e.depth:l,q=e.title||r(i,o,g)[0],C=t(i,o,i.icon.value,i.id.nesting[g]),P=d3plus.tooltip.data(i,o,h,d,v,g);if("null"===C&&(C=!1),P.length>0||y||!o.d3plus_label&&"short"==h&&q||o.d3plus_label&&(!("visible"in o.d3plus_label)||"visible"in o.d3plus_label&&o.d3plus_label.visible===!1)){q||(q=S);var g="d3plus"in o&&"merged"in o.d3plus?l-1:l;if(0>g&&(g=0),g=i.id.nesting[g],"string"==typeof i.icon.style.value)var L=i.icon.style.value;else if("object"==typeof i.icon.style.value&&i.icon.style.value[g])var L=i.icon.style.value[g];else var L="default";if(e.width)var U=e.width;else if(p||0!=P.length)var U=i.tooltip.small;else var U="auto";d3plus.tooltip.create({align:f,arrow:u,locale:i.format.locale.value,background:i.tooltip.background,curtain:i.tooltip.curtain.color,curtainopacity:i.tooltip.curtain.opacity,fontcolor:i.tooltip.font.color,fontfamily:i.tooltip.font.family.value,fontsize:i.tooltip.font.size,fontweight:i.tooltip.font.weight,data:P,color:n(i,o),allColors:!0,footer:e.footer===!1?e.footer:y,fullscreen:p,html:a,icon:C,id:c,max_height:e.maxheight,max_width:i.tooltip.small,mouseevents:s,offset:w,parent:i.container.value,style:L,title:q,width:U,x:x,y:b})}else d3plus.tooltip.remove(c)}"d3plus"in e.data||(e.data.d3plus={});var i=e.vars,o=e.data,l="d3plus"in o&&"depth"in o.d3plus?o.d3plus.depth:i.depth.value,s=(e.ex,e.mouseevents?e.mouseevents:!1),u="arrow"in e?e.arrow:!0,d=t(i,o,i.id.value),c=e.id||i.type.value;if(!d3.event||"click"!=d3.event.type||!i.tooltip.html.value&&!i.tooltip.value.long||"fullscreen"in e){var p=!1,f=e.anchor||i.tooltip.anchor,h=e.length||"short",v=i.zoom.direction(o);if(-1===v){var g=i.id.nesting[l-1];t(i,d,g)}if(1===v&&i.zoom.value)var m=i.format.value(i.format.locale.value.ui.expand);else if(-1===v&&i.zoom.value&&i.history.states.length)var m=i.format.value(i.format.locale.value.ui.collapse);else if(i.small||"short"!=h||!i.tooltip.html.value&&!i.tooltip.value.long||1===i.focus.value.length&&i.focus.value[0]==d)if("long"==h)var m=i.footer.value||"";else var m="";else var m=i.format.locale.value.ui.moreInfo;var y=m.length?i.format.value(m,"footer"):!1}else{var p=!0,u=!1,s=!0,h="long",y=i.footer.value;i.covered=!0}if("x"in e)var x=e.x;else if("follow"==i.types[i.type.value].tooltip)var x=d3.mouse(i.container.value.node())[0];else{var x=o.d3plus.x;i.zoom.translate&&i.zoom.scale&&(x=i.zoom.translate[0]+x*i.zoom.scale),x+=i.margin.left}if("y"in e)var b=e.y;else if("follow"==i.types[i.type.value].tooltip)var b=d3.mouse(i.container.value.node())[1];else{var b=o.d3plus.y;i.zoom.translate&&i.zoom.scale&&(b=i.zoom.translate[1]+b*i.zoom.scale),b+=i.margin.top}if("offset"in e)var w=e.offset;else if("follow"==i.types[i.type.value].tooltip)var w=3;else{var w=o.d3plus.r?o.d3plus.r:o.d3plus.height/2;i.zoom.scale&&(w*=i.zoom.scale)}p?"string"==typeof i.tooltip.html.value?a(i.tooltip.html.value):"function"==typeof i.tooltip.html.value?a(i.tooltip.html.value(d)):i.tooltip.html.value&&"object"==typeof i.tooltip.html.value&&i.tooltip.html.value.url?d3.json(i.tooltip.html.value.url,function(e){var t=i.tooltip.html.value.callback?i.tooltip.html.value.callback(e):e;a(t)}):a(""):a("")}},{"../core/fetch/color.js":48,"../core/fetch/text.js":50,"../core/fetch/value.js":51}],209:[function(){d3plus.tooltip.arrow=function(e){e.style("bottom",function(e){return"center"==e.anchor.y||e.flip?"auto":"-5px"}).style("top",function(e){return"center"!=e.anchor.y&&e.flip?"-5px":"center"==e.anchor.y?"50%":"auto"}).style("left",function(e){return"center"==e.anchor.y&&e.flip?"-5px":"center"!=e.anchor.y?"50%":"auto"}).style("right",function(e){return"center"!=e.anchor.y||e.flip?"auto":"-5px"}).style("margin-left",function(e){if("center"==e.anchor.y)return"auto";if("right"==e.anchor.x)var t=-e.width/2+e.arrow_offset/2;else if("left"==e.anchor.x)var t=e.width/2-2*e.arrow_offset-5;else var t=-5;if(e.cx-e.width/2-5<t)t=e.cx-e.width/2-5,t<2-e.width/2&&(t=2-e.width/2);else if(-(e.limit[0]-e.cx-e.width/2+5)>t){var t=-(e.limit[0]-e.cx-e.width/2+5);t>e.width/2-11&&(t=e.width/2-11)}return t+"px"}).style("margin-top",function(e){if("center"!=e.anchor.y)return"auto";if("bottom"==e.anchor.y)var t=-e.height/2+e.arrow_offset/2-1;else if("top"==e.anchor.y)var t=e.height/2-2*e.arrow_offset-2;else var t=-9;if(e.cy-e.height/2-e.arrow_offset<t)t=e.cy-e.height/2-e.arrow_offset,t<4-e.height/2&&(t=4-e.height/2);else if(-(e.limit[1]-e.cy-e.height/2+e.arrow_offset)>t){var t=-(e.limit[1]-e.cy-e.height/2+e.arrow_offset);t>e.height/2-22&&(t=e.height/2-22)}return t+"px"})}},{}],210:[function(){d3plus.tooltip.create=function(e){var t=e.fullscreen?250:200,n=d3plus.prefix();e.width=e.width||t,e.max_width=e.max_width||386,e.id=e.id||"default",e.size=e.fullscreen||e.html?"large":"small",e.offset=e.offset||0,e.arrow_offset=e.arrow?8:0,e.x=e.x||0,e.y=e.y||0,e.parent=e.parent||d3.select("body"),e.curtain=e.curtain||"#fff",e.curtainopacity=e.curtainopacity||.8,e.background=e.background||"#fff",e.fontcolor=e.fontcolor||"#444",e.fontfamily=e.fontfamily||"sans-serif",e.fontweight=e.fontweight||"normal",e.fontsize=e.fontsize||"12px",e.style=e.style||"default",e.zindex="small"==e.size?2e3:500,e.locale=e.locale||d3plus.locale.en_US;var r=e.parent?e.parent.node().offsetHeight||e.parent.node().getBoundingClientRect().height:0;if(e.iconsize||(e.iconsize="small"==e.size?22:50),e.limit=[parseFloat(e.parent.style("width"),10),parseFloat(e.parent.style("height"),10)],e.title instanceof Array){var a=e.locale.ui.and,i=e.locale.ui.more;e.title=d3plus.string.list(e.title,a,3,i)}var o=function(){d3.selectAll("div.d3plus_tooltip_data_desc").style("height","0px"),d3.selectAll("div.d3plus_tooltip_data_help").style("background-color","#ccc")};if(d3plus.tooltip.remove(e.id),e.anchor={},e.fullscreen)e.anchor.x="center",e.anchor.y="center",e.x=e.parent?e.parent.node().offsetWidth/2:window.innerWidth/2,e.y=e.parent?r/2:window.innerHeight/2;else if(e.align){var l=e.align.split(" ");e.anchor.y=l[0],e.anchor.x=l[1]?l[1]:"center"}else e.anchor.x="center",e.anchor.y="top";var s=e.width-30;if(e.fullscreen){e.parent.append("div").attr("id","d3plus_tooltip_curtain_"+e.id).attr("class","d3plus_tooltip_curtain").style("background-color",e.curtain).style("opacity",e.curtainopacity).style("position","absolute").style("z-index",499).style("top","0px").style("right","0px").style("bottom","0px").style("left","0px").on(d3plus.evt.click,function(){d3plus.tooltip.remove(e.id)})}var u=e.parent.append("div").datum(e).attr("id","d3plus_tooltip_id_"+e.id).attr("class","d3plus_tooltip d3plus_tooltip_"+e.size).style("color",e.fontcolor).style("font-family",e.fontfamily).style("font-weight",e.fontweight).style("font-size",e.fontsize+"px").style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("z-index",e.zindex).on(d3plus.evt.out,function(){o()});e.max_height&&u.style("max-height",e.max_height+"px"),e.fixed?(u.style("z-index",500),e.mouseevents=!0):u.style("z-index",2e3);var d=u.append("div").datum(e).attr("class","d3plus_tooltip_container").style("background-color",e.background).style("padding","6px");if(e.fullscreen&&e.html){p=e.parent?.75*e.parent.node().offsetWidth:.75*window.innerWidth,A=e.parent?.75*r:.75*window.innerHeight,d.style("width",p+"px").style("height",A+"px");var c=d.append("div").attr("class","d3plus_tooltip_body").style("padding-right","6px").style("display","inline-block").style("z-index",1).style("width",e.width+"px")}else{if("auto"==e.width){var p="auto";d.style("max-width",e.max_width+"px")}else var p=e.width-14+"px";var c=d.style("width",p)}if(e.title||e.icon)var f=c.append("div").attr("class","d3plus_tooltip_header").style("position","relative").style("z-index",1);if(e.fullscreen){u.append("div").attr("class","d3plus_tooltip_close").style("background-color",e.color).style("color",d3plus.color.text(e.color)).style("position","absolute").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)").style("font-size","20px").style("height","18px").style("line-height","14px").style("text-align","center").style("right","16px").style("top","-10px").style("width","18px").style("z-index",10).html("&times;").on(d3plus.evt.over,function(){d3.select(this).style("cursor","pointer").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.5)")}).on(d3plus.evt.out,function(){d3.select(this).style("cursor","auto").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)")}).on(d3plus.evt.click,function(){d3plus.tooltip.remove(e.id)})}if(e.mouseevents){if(e.mouseevents!==!0){var h=d3.select(e.mouseevents).on(d3plus.evt.out),v=function(){var t=d3.event.toElement||d3.event.relatedTarget;if(t)var n="string"==typeof t.className?t.className:t.className.baseVal,r=0==n.indexOf("d3plus_tooltip");else var r=!1;t&&(g(u.node(),t)||g(e.mouseevents,t)||r)||(h(d3.select(e.mouseevents).datum()),o(),d3.select(e.mouseevents).on(d3plus.evt.out,h))},g=function(e,t){for(var n=t.parentNode;null!==n;){if(n==e)return!0;n=n.parentNode}return!1};d3.select(e.mouseevents).on(d3plus.evt.out,v),u.on(d3plus.evt.out,v);var m=d3.select(e.mouseevents).on(d3plus.evt.move);m&&u.on(d3plus.evt.move,m)}}else u.style("pointer-events","none");if(e.arrow){u.append("div").attr("class","d3plus_tooltip_arrow").style("background-color",e.background).style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("bottom","-5px").style("height","10px").style("left","50%").style("margin-left","-5px").style("width","10px").style(n+"transform","rotate(45deg)").style("z-index",-1)}if(e.icon){var y=f.append("div").attr("class","d3plus_tooltip_icon").style("width",e.iconsize+"px").style("height",e.iconsize+"px").style("z-index",1).style("background-position","50%").style("background-size","100%").style("background-image","url("+e.icon+")").style("display","inline-block").style("margin","0px 3px 3px 0px");"knockout"==e.style&&y.style("background-color",e.color),s-=y.node().offsetWidth}if(e.title){var x=e.max_width-6;e.icon&&(x-=e.iconsize+6),x+="px";{f.append("div").attr("class","d3plus_tooltip_title").style("max-width",x).style("color",e.icon?e.fontcolor:d3plus.color.legible(e.color)).style("vertical-align","top").style("width",s+"px").style("display","inline-block").style("overflow","hidden").style("text-overflow","ellipsis").style("word-wrap","break-word").style("z-index",1).style("font-size","large"===e.size?"18px":"16px").style("line-height","large"===e.size?"20px":"17px").style("padding","large"===e.size?"3px 6px":"3px").text(e.title)}}if(e.description){c.append("div").attr("class","d3plus_tooltip_description").style("font-size","12px").style("padding","6px").text(e.description)}if(e.data||e.html&&!e.fullscreen)var b=c.append("div").attr("class","d3plus_tooltip_data_container").style("overflow-y","auto").style("z-index",-1);if(e.data){var w=0,_={},k=null;e.data.forEach(function(t,r){t.group&&k!=t.group&&(k=t.group,b.append("div").attr("class","d3plus_tooltip_data_title").style("font-size","12px").style("font-weight","bold").style("padding","6px 3px 0px 3px").text(t.group));var a=b.append("div").attr("class","d3plus_tooltip_data_block").style("font-size","12px").style("padding","3px 6px").style("position","relative").datum(t);t.highlight===!0?a.style("color",d3plus.color.legible(e.color)):(t.allColors||t.highlight!==e.color)&&a.style("color",d3plus.color.legible(t.highlight));var i=a.append("div").attr("class","d3plus_tooltip_data_name").style("display","inline-block").html(t.name).on(d3plus.evt.out,function(){d3.event.stopPropagation()});if(t.value instanceof Array){var l=e.locale.ui.and,s=e.locale.ui.more;t.value=d3plus.string.list(t.value,l,3,s)}var u=a.append("div").attr("class","d3plus_tooltip_data_value").style("display","block").style("position","absolute").style("text-align","right").style("top","3px").text(t.value).on(d3plus.evt.out,function(){d3.event.stopPropagation()});if(d3plus.rtl?u.style("left","6px"):u.style("right","6px"),e.mouseevents&&t.desc){var d=a.append("div").attr("class","d3plus_tooltip_data_desc").style("color","#888").style("overflow","hidden").style(n+"transition","height 0.5s").style("width","85%").text(t.desc).on(d3plus.evt.out,function(){d3.event.stopPropagation()}),c=d.node().offsetHeight||d.node().getBoundingClientRect().height;d.style("height","0px");var p=i.append("div").attr("class","d3plus_tooltip_data_help").style("background-color","#ccc").style(n+"border-radius","5px").style("color","#fff").style("cursor","pointer").style("display","inline-block").style("font-size","8px").style("font-weight","bold").style("height","10px").style("margin","3px 0px 0px 3px").style("padding-right","1px").style("text-align","center").style("width","10px").style("vertical-align","top").style(prefix+"transition","background-color 0.5s").text("?").on(d3plus.evt.over,function(){var e=d3.select(this.parentNode.parentNode).style("color");d3.select(this).style("background-color",e),d.style("height",c+"px")}).on(d3plus.evt.out,function(){d3.event.stopPropagation()});i.style("cursor","pointer").on(d3plus.evt.over,function(){o();var e=d3.select(this.parentNode).style("color");p.style("background-color",e),d.style("height",c+"px")}),a.on(d3plus.evt.out,function(){d3.event.stopPropagation(),o()})}var f=parseFloat(u.style("width"),10);f>e.width/2&&(f=e.width/2),f>w&&(w=f),r!=e.data.length-1&&(t.group&&t.group==e.data[r+1].group||!t.group&&!e.data[r+1].group)&&b.append("div").attr("class","d3plus_tooltip_data_seperator").style("background-color","#ddd").style("display","block").style("height","1px").style("margin","0px 3px")}),b.selectAll(".d3plus_tooltip_data_name").style("width",function(){var e=parseFloat(d3.select(this.parentNode).style("width"),10);return e-w-30+"px"}),b.selectAll(".d3plus_tooltip_data_value").style("width",w+"px").each(function(e){var t=parseFloat(d3.select(this).style("height"),10);_[e.name]=t}),b.selectAll(".d3plus_tooltip_data_name").style("min-height",function(e){return _[e.name]+"px"})}e.html&&!e.fullscreen&&b.append("div").html(e.html);var z=c.append("div").attr("class","d3plus_tooltip_footer").style("font-size","10px").style("position","relative").style("text-align","center");if(e.footer&&z.html(e.footer),e.height=u.node().offsetHeight||u.node().getBoundingClientRect().height,e.html&&e.fullscreen){var A=e.height-12,p=u.node().offsetWidth-e.width-44;d.append("div").attr("class","d3plus_tooltip_html").style("width",p+"px").style("height",A+"px").style("display","inline-block").style("vertical-align","top").style("overflow-y","auto").style("padding","0px 12px").style("position","absolute").html(e.html)}if(e.width=u.node().offsetWidth,"center"!=e.anchor.y?e.height+=e.arrow_offset:e.width+=e.arrow_offset,e.data||!e.fullscreen&&e.html){if(e.fullscreen)var A=e.height;else var j=e.fixed?r-e.y-10:r-10,A=e.height<j?e.height:j;A-=parseFloat(d.style("padding-top"),10),A-=parseFloat(d.style("padding-bottom"),10),f&&(A-=f.node().offsetHeight||f.node().getBoundingClientRect().height,A-=parseFloat(f.style("padding-top"),10),A-=parseFloat(f.style("padding-bottom"),10)),z&&(A-=z.node().offsetHeight||z.node().getBoundingClientRect().height,A-=parseFloat(z.style("padding-top"),10),A-=parseFloat(z.style("padding-bottom"),10)),b.style("max-height",A+"px")}e.height=u.node().offsetHeight||u.node().getBoundingClientRect().height,d3plus.tooltip.move(e.x,e.y,e.id)}},{}],211:[function(e){var t=e("../core/fetch/value.js"),n=e("../core/fetch/color.js"),r=e("../core/fetch/text.js");d3plus.tooltip.data=function(e,a,i,o,l,s){function u(n,r){if(e.attrs.value[r])var i=r;else var i=null;r&&(r=e.format.value(r));var o=c[n]||t(e,a,n,i);if(null!=o&&"undefined"!=o&&!(o instanceof Array)&&("string"==typeof o&&o.indexOf("d3plus_other")<0||"string"!=typeof o)){var l=e.format.value(e.format.locale.value.ui[n]?e.format.locale.value.ui[n]:n),s=f.indexOf(n)>=0;o instanceof Array?o.forEach(function(t){t=e.format.value(t,n)}):o=e.format.value(o,n);var u={name:l,value:o,highlight:s,group:r};if(e.descs.value)if("function"==typeof e.descs.value){var d=e.descs.value(n);"string"==typeof d&&(u.desc=d)}else n in e.descs.value&&(u.desc=e.descs.value[n]);v.push(u)}}if(e.small)return[];if(!i)var i="long";if("long"==i)var d="short";else var d="long";var c={};if(o&&"string"==typeof o)o=[o];else if(o&&"object"==typeof o){c=d3plus.object.merge(c,o);var o=[];for(var p in c)o.push(p)}else if(!o)var o=[];var f=[];if(e.tooltip.value instanceof Array)var h=e.tooltip.value;else if("string"==typeof e.tooltip.value)var h=[e.tooltip.value];else{if(e.tooltip.value[e.id.nesting[s]])var h=e.tooltip.value[e.id.nesting[s]];else var h=e.tooltip.value;h instanceof Array||(h=h[i]?h[i]:h[d]?[]:d3plus.object.merge({"":[]},h)),"string"==typeof h?h=[h]:h instanceof Array||(h=d3plus.object.merge({"":[]},h))}var v=[];if(h instanceof Array)o.forEach(function(e){h.indexOf(e)<0&&h.push(e)}),h.forEach(function(e){u(e)});else{if(e.id.nesting.length&&s<e.id.nesting.length-1){var h=d3plus.util.copy(h);e.id.nesting.forEach(function(e,t){t>s&&h[e]&&delete h[e]})}if(e.tooltip.value.long&&"object"==typeof e.tooltip.value.long){var g=[];for(var m in e.tooltip.value.long)o.forEach(function(t){e.tooltip.value.long[m].indexOf(t)>=0&&(h[m]&&h[m].indexOf(t)<0||!h[m])?(h[m]||(h[m]=[]),h[m].push(t),g.push(t)):h[m]&&h[m].indexOf(t)>=0&&g.push(t)});o.forEach(function(e){g.indexOf(e)<0&&(h[""]||(h[""]=[]),h[""].push(e))})}else{var y=[];for(var m in h)o.forEach(function(e){h[m]instanceof Array&&h[m].indexOf(e)>=0?y.push(e):"string"==typeof h[m]&&h[m]==e&&y.push(e)});y.length!=o.length&&(h[""]||(h[""]=[]),o.forEach(function(e){y.indexOf(e)<0&&h[""].push(e)}))}h[""]&&(h[""].forEach(function(e){u(e,"")}),delete h[""]);for(var m in h)h[m]instanceof Array?h[m].forEach(function(e){u(e,m)}):"string"==typeof h[m]&&u(h[m],m)}if(l){var x=e.format.locale.value.ui.including,b=l.d3plus_colors;for(var w in l)if("d3plus_colors"!==w){if("d3plusMore"===w){var _=e.format.locale.value.ui.more,k=d3plus.string.format(_,l[w]),z=!0;l[w]=""}else var k=w,z=b&&b[k]?b[k]:!1;v.push({group:e.format.value(x),highlight:z,name:k,value:l[w]})}}if(e.tooltip.connections.value&&"long"===i){var A=e.edges.connections(a[e.id.value],e.id.value,!0);A.length&&A.forEach(function(t){var a=r(e,t)[0],i=n(e,t),o=e.tooltip.font.size,l="square"==e.shape.value?0:o;styles=["background-color: "+i,"border-color: "+d3plus.color.legible(i),"border-style: solid","border-width: "+e.data.stroke.width+"px","display: inline-block","height: "+o+"px","left: 0px","position: absolute","width: "+o+"px","top: 0px",d3plus.prefix()+"border-radius: "+l+"px"],node="<div style='"+styles.join("; ")+";'></div>",v.push({group:e.format.value(e.format.locale.value.ui.primary),highlight:!1,name:"<div style='position:relative;padding-left:"+1.5*o+"px;'>"+node+a+"</div>",value:""})})}return v}},{"../core/fetch/color.js":48,"../core/fetch/text.js":50,"../core/fetch/value.js":51}],212:[function(){d3plus.tooltip.move=function(e,t,n){if(n)var r=d3.select("div#d3plus_tooltip_id_"+n);else var r=d3.select("div#d3plus_tooltip_id_default");if(r.node()){var a=r.datum();a.cx=e,a.cy=t,a.fixed||("center"!=a.anchor.y?("right"==a.anchor.x?a.x=a.cx-a.arrow_offset-4:"center"==a.anchor.x?a.x=a.cx-a.width/2:"left"==a.anchor.x&&(a.x=a.cx-a.width+a.arrow_offset+2),"bottom"==a.anchor.y?a.flip=a.cy+a.height+a.offset<=a.limit[1]:"top"==a.anchor.y&&(a.flip=a.cy-a.height-a.offset<0),a.y=a.flip?a.cy+a.offset+a.arrow_offset:a.cy-a.height-a.offset-a.arrow_offset):(a.y=a.cy-a.height/2,"right"==a.anchor.x?a.flip=a.cx+a.width+a.offset<=a.limit[0]:"left"==a.anchor.x&&(a.flip=a.cx-a.width-a.offset<0),"center"==a.anchor.x?(a.flip=!1,a.x=a.cx-a.width/2):a.x=a.flip?a.cx+a.offset+a.arrow_offset:a.cx-a.width-a.offset),a.x<0?a.x=0:a.x+a.width>a.limit[0]&&(a.x=a.limit[0]-a.width),a.y<0?a.y=0:a.y+a.height>a.limit[1]&&(a.y=a.limit[1]-a.height)),r.style("top",a.y+"px").style("left",a.x+"px"),a.arrow&&r.selectAll(".d3plus_tooltip_arrow").call(d3plus.tooltip.arrow)}}},{}],213:[function(){d3plus.tooltip.remove=function(e){e?(d3.selectAll("div#d3plus_tooltip_curtain_"+e).remove(),d3.selectAll("div#d3plus_tooltip_id_"+e).remove()):(d3.selectAll("div#d3plus_tooltip_curtain").remove(),d3.selectAll("div.d3plus_tooltip").remove())}},{}],214:[function(){d3plus.util.buckets=function(e,t){for(var n=[],r=1/(t-1)*(e[1]-e[0]),a=r,a=e[0];a<=e[1];a+=r)n.push(a);return n.length<t&&(n[t-1]=e[1]),n[n.length-1]<e[1]&&(n[n.length-1]=e[1]),n}},{}],215:[function(e){var t;t=e("./d3selection.js"),d3plus.util.child=function(e,n){var r;if(!e||!n)return!1;for(t(e)&&(e=e.node()),t(e)&&(n=n.node()),r=n.parentNode;null!==r;){if(r===e)return!0;r=r.parentNode}return!1}},{"./d3selection.js":218}],216:[function(){d3plus.util.closest=function(e,t){var n;return n=e[0],e.forEach(function(e){return Math.abs(t-e)<Math.abs(t-n)?n=e:void 0}),n}},{}],217:[function(e){var t,n;t=e("../object/merge.coffee"),n=e("../object/validate.coffee"),d3plus.util.copy=function(e){var r;return n(e)?t(e):e instanceof Array?(r=[],e.forEach(function(e){return r.push(d3plus.util.copy(e))}),r):e}},{"../object/merge.coffee":168,"../object/validate.coffee":169}],218:[function(e,t){d3plus.util.d3selection=function(e){return d3plus.ie?"object"==typeof e&&e instanceof Array:e instanceof d3.selection},t.exports=d3plus.util.d3selection
},{}],219:[function(){d3plus.util.dataurl=function(e,t){var n=new Image;n.src=e,n.crossOrigin="Anonymous",n.onload=function(){var e=document.createElement("canvas");e.width=this.width,e.height=this.height;var n=e.getContext("2d");n.drawImage(this,0,0),t.call(this,e.toDataURL("image/png")),e=null}}},{}],220:[function(){d3plus.util.distances=function(e,t){var n,r;return r=[],n=[],e.forEach(function(a){var i;return i=t?t(a):[a.x,a.y],n.push(a),e.forEach(function(e){var a,o,l;return n.indexOf(e)<0?(a=t?t(e):[e.x,e.y],o=Math.abs(i[0]-a[0]),l=Math.abs(i[1]-a[1]),r.push(Math.sqrt(o*o+l*l))):void 0})}),r.sort(function(e,t){return e-t}),r}},{}],221:[function(){d3plus.util.offset=function(e,t,n){var r,a,i,o;return a={x:0,y:0},0>e&&(e=2*Math.PI+e),"square"===n?(i=45*(Math.PI/180),e<=Math.PI?e<Math.PI/2?i>e?(a.x+=t,o=Math.tan(e)*t,a.y+=o):(a.y+=t,r=t/Math.tan(e),a.x+=r):e<Math.PI-i?(a.y+=t,r=t/Math.tan(Math.PI-e),a.x-=r):(a.x-=t,o=Math.tan(Math.PI-e)*t,a.y+=o):e<3*Math.PI/2?e<i+Math.PI?(a.x-=t,o=Math.tan(e-Math.PI)*t,a.y-=o):(a.y-=t,r=t/Math.tan(e-Math.PI),a.x-=r):e<2*Math.PI-i?(a.y-=t,r=t/Math.tan(2*Math.PI-e),a.x+=r):(a.x+=t,o=Math.tan(2*Math.PI-e)*t,a.y-=o)):(a.x+=t*Math.cos(e),a.y+=t*Math.sin(e)),a}},{}],222:[function(e){var t;t=e("../object/validate.coffee"),d3plus.util.uniques=function(e,n){var r,a,i,o,l,s,u;if(void 0===e||void 0===n)return[];for(e instanceof Array||(e=[e]),l=[],i=[],s=0,u=e.length;u>s;s++)r=e[s],t(r)&&(o="function"==typeof n?n(r):r[n],a=["number","string"].indexOf(typeof o)>=0?o:JSON.stringify(o),i.indexOf(a)<0&&(l.push(o),i.push(a)));return l.sort(function(e,t){return e-t})}},{"../object/validate.coffee":169}],223:[function(){d3plus.draw.app=function(e){if(e.group=e.g.apps[e.type.value],e.mouse={},e.internal_error)var t=null;else{var n=e.format.locale.value.visualization[e.type.value];e.dev.value&&d3plus.console.time("running "+n);var t=e.types[e.type.value](e);e.dev.value&&d3plus.console.timeEnd("running "+n)}e.returned={nodes:[],edges:null},t instanceof Array?e.returned.nodes=t:t&&(t.nodes&&(e.returned.nodes=t.nodes),t.edges&&(e.returned.edges=t.edges))}},{}],224:[function(){d3plus.draw.container=function(e){if(e.container.changed){e.container.value.style("position",function(){var e=d3.select(this).style("position"),t=["absolute","fixed"].indexOf(e)>=0;return t?e:"relative"}).html("");var t=["width","height"];t.forEach(function(t){function n(r){if(void 0===r.tagName||["BODY","HTML"].indexOf(r.tagName)>=0){var a=window["inner"+t.charAt(0).toUpperCase()+t.slice(1)],i=document!=r?d3.select(r):null;i&&"width"==t?(a-=parseFloat(i.style("margin-left"),10),a-=parseFloat(i.style("margin-right"),10),a-=parseFloat(i.style("padding-left"),10),a-=parseFloat(i.style("padding-right"),10)):i&&"height"==t&&(a-=parseFloat(i.style("margin-top"),10),a-=parseFloat(i.style("margin-bottom"),10),a-=parseFloat(i.style("padding-top"),10),a-=parseFloat(i.style("padding-bottom"),10)),1==d3.selectAll("body > *:not(script)").size()&&d3.select("body").style("overflow","hidden"),20>=a&&(a=e[t].small),e[t].value=a}else{var a=parseFloat(d3.select(r).style(t),10);"number"==typeof a&&a>0?e[t].value=a:"BODY"!=r.tagName&&n(r.parentNode)}}e[t].value||n(e.container.value.node())}),e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px")}e.width.viz=e.width.value,e.height.viz=e.height.value}},{}],225:[function(){d3plus.draw.enter=function(e){e.dev.value&&d3plus.console.time("creating SVG elements"),e.svg=e.container.value.selectAll("svg#d3plus").data([0]),e.svg.enter().insert("svg","#d3plus_message").attr("id","d3plus").attr("width",e.width.value).attr("height",e.height.value).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xmlns:xlink","http://www.w3.org/1999/xlink"),e.g.bg=e.svg.selectAll("rect#bg").data(["bg"]),e.g.bg.enter().append("rect").attr("id","bg").attr("fill",e.background.value).attr("width",e.width.value).attr("height",e.height.value),e.g.timeline=e.svg.selectAll("g#timeline").data(["timeline"]),e.g.timeline.enter().append("g").attr("id","timeline").attr("transform","translate(0,"+e.height.value+")"),e.g.legend=e.svg.selectAll("g#key").data(["key"]),e.g.legend.enter().append("g").attr("id","key").attr("transform","translate(0,"+e.height.value+")"),e.g.footer=e.svg.selectAll("g#footer").data(["footer"]),e.g.footer.enter().append("g").attr("id","footer").attr("transform","translate(0,"+e.height.value+")"),e.g.clipping=e.svg.selectAll("#clipping").data(["clipping"]),e.g.clipping.enter().append("clipPath").attr("id","clipping").append("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container=e.svg.selectAll("g#container").data(["container"]),e.g.container.enter().append("g").attr("id","container").attr("clip-path","url(#clipping)").attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.g.zoom=e.g.container.selectAll("g#zoom").data(["zoom"]),e.g.zoom.enter().append("g").attr("id","zoom"),e.g.viz=e.g.zoom.selectAll("g#d3plus_viz").data(["d3plus_viz"]),e.g.viz.enter().append("g").attr("id","d3plus_viz"),e.g.overlay=e.g.viz.selectAll("rect#d3plus_overlay").data([{id:"d3plus_overlay"}]),e.g.overlay.enter().append("rect").attr("id","d3plus_overlay").attr("width",e.width.value).attr("height",e.height.value).attr("opacity",0),d3plus.touch?e.g.overlay.on(d3plus.evt.over,e.zoom.touchEvent).on(d3plus.evt.move,e.zoom.touchEvent).on(d3plus.evt.out,e.zoom.touchEvent):e.g.overlay.on(d3plus.evt.move,function(t){t.dragging||(e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",d3plus.prefix()+"grab"):d3.select(this).style("cursor","auto"))}).on(d3plus.evt.up,function(t){e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?(t.dragging=!1,d3.select(this).style("cursor",d3plus.prefix()+"grab")):d3.select(this).style("cursor","auto")}).on(d3plus.evt.down,function(t){e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?(t.dragging=!0,d3.select(this).style("cursor",d3plus.prefix()+"grabbing")):d3.select(this).style("cursor","auto")}),e.g.app=e.g.viz.selectAll("g#app").data(["app"]),e.g.app.enter().append("g").attr("id","app"),e.g.edges=e.g.viz.selectAll("g#edges").data(["edges"]),e.g.edges.enter().append("g").attr("id","edges").attr("opacity",0),e.g.edge_focus=e.g.viz.selectAll("g#focus").data(["focus"]),e.g.edge_focus.enter().append("g").attr("id","focus"),e.g.edge_hover=e.g.viz.selectAll("g#edge_hover").data(["edge_hover"]),e.g.edge_hover.enter().append("g").attr("id","edge_hover").attr("opacity",0),e.g.data=e.g.viz.selectAll("g#data").data(["data"]),e.g.data.enter().append("g").attr("id","data").attr("opacity",0),e.g.data_focus=e.g.viz.selectAll("g#data_focus").data(["data_focus"]),e.g.data_focus.enter().append("g").attr("id","data_focus"),e.g.labels=e.g.viz.selectAll("g#d3plus_labels").data(["d3plus_labels"]),e.g.labels.enter().append("g").attr("id","d3plus_labels"),e.defs=e.svg.selectAll("defs").data(["defs"]),e.defs.enter().append("defs"),e.dev.value&&d3plus.console.timeEnd("creating SVG elements")}},{}],226:[function(e){var t=e("../../core/fetch/text.js");d3plus.draw.errors=function(e){e.dev.value&&d3plus.console.time("checking for errors");var n=["id"],r=e.types[e.type.value].requirements;r&&(r instanceof Array?n=n.concat(e.types[e.type.value].requirements):n.push(r));var a=[];if(n.forEach(function(t){if("string"==typeof t)e[t].value||a.push('"'+t+'"');else if("function"==typeof t){var n=t(e);!n.status&&n.text&&a.push('"'+n.text+'"')}}),a.length>1){var i=e.format.locale.value.error.methods,o=e.format.locale.value.visualization[e.type.value]||e.type.value,l=e.format.locale.value.ui.and;a=d3plus.string.list(a,l),e.internal_error=d3plus.string.format(i,o,a)}else if(1===a.length){var i=e.format.locale.value.error.method,o=e.format.locale.value.visualization[e.type.value]||e.type.value;e.internal_error=d3plus.string.format(i,o,a[0])}if(!e.internal_error&&n.indexOf("edges")>=0&&n.indexOf("focus")>=0){var s=e.edges.connections(e.focus.value[0],e.id.value);if(0==s.length){var u=t(e,e.focus.value[0],e.depth.value),i=e.format.locale.value.error.connections;e.internal_error=d3plus.string.format(i,'"'+u+'"')}}var n=["d3"];e.types[e.type.value].libs&&(n=n.concat(e.types[e.type.value].libs));var a=[];if(n.forEach(function(e){window[e]||a.push('"'+e+'"')}),a.length>1){var i=e.format.locale.value.error.libs,o=e.format.locale.value.visualization[e.type.value],l=e.format.locale.value.ui.and;a=d3plus.string.list(a,l),e.internal_error=d3plus.string.format(i,o,a)}else if(1===a.length){var i=e.format.locale.value.error.lib,o=e.format.locale.value.visualization[e.type.value];e.internal_error=d3plus.string.format(i,o,a[0])}var d=e.types[e.type.value].shapes||["circle"];if(d instanceof Array||(d=[d]),e.shape.value){if(d.indexOf(e.shape.value)<0){var d=e.types[e.type.value].shapes.join('", "'),i=e.format.locale.value.error.accepted,c='"'+e.shape.value+'"',p=e.format.locale.value.method.shape,o=e.format.locale.value.visualization[e.type.value]||e.type.value;d3plus.console.warning(d3plus.string.format(i,c,p,o,'"'+d+'"'),"shape"),e.self.shape(d.length?d[0]:"circle")}}else e.self.shape(d.length?d[0]:"circle");if("modes"in e.types[e.type.value])if(e.type.mode.value){if(e.types[e.type.value].modes.indexOf(e.type.mode.value)<0){var f=e.types[e.type.value].modes.join('", "'),i=e.format.locale.value.error.accepted,h='"'+e.type.mode.value+'"',v=e.format.locale.value.method.mode,o=e.format.locale.value.visualization[e.type.value]||e.type.value;d3plus.console.warning(d3plus.string.format(i,h,v,o,'"'+f+'"')),e.self.type({mode:e.types[e.type.value].modes[0]})}}else e.self.type({mode:e.types[e.type.value].modes[0]});e.dev.value&&d3plus.console.timeEnd("checking for errors")}},{"../../core/fetch/text.js":50}],227:[function(e){var t=e("../../core/method/reset.js");d3plus.draw.finish=function(e){var n=e.zoom.viewport||e.zoom.bounds;e.types[e.type.value].zoom&&e.zoom.value&&n?(e.dev.value&&d3plus.console.time("calculating zoom"),e.draw.first?d3plus.zoom.bounds(e,n,0):(e.focus.changed||e.height.changed||e.width.changed||e.nodes.changed)&&d3plus.zoom.bounds(e,n),e.dev.value&&d3plus.console.timeEnd("calculating zoom")):e.zoom.scale=1;var r=e.zoom.size?e.zoom.size.width:e.width.viz,a=e.zoom.size?e.zoom.size.height:e.height.viz,i=e.zoom.bounds?e.zoom.bounds[0][0]:0,o=e.zoom.bounds?e.zoom.bounds[0][1]:0;e.g.overlay.attr("width",r).attr("height",a).attr("x",i).attr("y",o),e.draw.update?(d3plus.shape.edges(e),(e.draw.timing||!e.types[e.type.value].zoom&&!e.draw.timing)&&(d3plus.shape.labels(e,"data"),e.edges.label&&setTimeout(function(){d3plus.shape.labels(e,"edges")},e.draw.timing+200))):e.types[e.type.value].zoom&&e.zoom.value&&e.draw.timing&&setTimeout(function(){d3plus.zoom.labels(e)},e.draw.timing),e.types[e.type.value].zoom&&e.zoom.value&&e.focus.value.length&&!e.draw.timing&&(e.dev.value&&d3plus.console.time("focus labels"),d3plus.shape.labels(e,"data_focus"),e.edges.label&&setTimeout(function(){d3plus.shape.labels(e,"edge_focus")},e.draw.timing+200),e.dev.value&&d3plus.console.timeEnd("focus labels"));var l=e.types[e.type.value].requirements||[];l instanceof Array||(l=[l]);var s=l.indexOf("data")>=0;e.internal_error||e.data.app&&e.returned.nodes.length||!s||(e.internal_error=e.format.locale.value.error.data);var u=e.type.previous;u&&e.type.value!=u&&e.g.apps[u]&&(e.dev.value&&d3plus.console.time('hiding "'+u+'"'),e.draw.timing?e.g.apps[u].transition().duration(e.draw.timing).attr("opacity",0):e.g.apps[u].attr("opacity",0),e.dev.value&&d3plus.console.timeEnd());var d=s&&0==e.data.app.length||e.internal_error?0:e.focus.value.length&&e.types[e.type.value].zoom&&e.zoom.value?.4:1,c=e.group.attr("opacity");if(d!=c){var p=e.draw.timing;e.group.transition().duration(p).attr("opacity",d),e.g.data.transition().duration(p).attr("opacity",d),e.g.edges.transition().duration(p).attr("opacity",d)}e.internal_error?(e.internal_error=d3plus.string.title(e.internal_error),d3plus.console.warning(e.internal_error),d3plus.ui.message(e,e.internal_error),e.internal_error=null):d3plus.ui.message(e),setTimeout(function(){t(e),e.types[e.type.value].zoom&&e.zoom.value?(e.g.zoom.datum(e).call(e.zoom.behavior.on("zoom",d3plus.zoom.mouse)),e.zoom.scroll.value||e.g.zoom.on("wheel.zoom",null),e.zoom.click.value||e.g.zoom.on("dblclick.zoom",null),e.zoom.pan.value||(e.g.zoom.on("mousemove.zoom",null),e.g.zoom.on("mousedown.zoom",null))):e.g.zoom.call(e.zoom.behavior.on("zoom",null))},e.draw.timing)}},{"../../core/method/reset.js":53}],228:[function(){d3plus.draw.focus=function(t){if(t.g.edge_focus.selectAll("g").remove(),t.g.data_focus.selectAll("g").remove(),t.focus.value.length&&t.types[t.type.value].zoom&&t.zoom.value){t.dev.value&&d3plus.console.time("drawing focus elements");var n=t.g.edges.selectAll("g");if(n.size()>0){n.each(function(e){var n=e[t.edges.source][t.id.value],r=e[t.edges.target][t.id.value];if(n==t.focus.value[0]||r==t.focus.value[0]){var a=t.g.edge_focus.node().appendChild(this.cloneNode(!0));d3.select(a).datum(e).attr("opacity",1).selectAll("line, path").datum(e)}});var r=t.edges.arrows.value;t.g.edge_focus.selectAll("line, path").attr("vector-effect","non-scaling-stroke").style("stroke",t.color.focus).style("stroke-width",function(){return t.edges.size?d3.select(this).style("stroke-width"):2*t.data.stroke.width}).attr("marker-start",function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3plus)var a="_"+e.d3plus.bucket;else var a="";return"source"==n&&r?"url(#d3plus_edge_marker_focus"+a+")":"none"}).attr("marker-end",function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3plus)var a="_"+e.d3plus.bucket;else var a="";return"target"==n&&r?"url(#d3plus_edge_marker_focus"+a+")":"none"}),t.g.edge_focus.selectAll("text").style("fill",t.color.focus)}var a=d3plus.util.uniques(t.edges.connections(t.focus.value[0],t.id.value,!0),t.id.value);a.push(t.focus.value[0]);{var i=[],o=[],l=[0],s=[0];t.g.data.selectAll("g").each(function(n){if(a.indexOf(n[t.id.value])>=0){var r=t.g.data_focus.node().appendChild(this.cloneNode(!0)),r=d3.select(r).datum(n).attr("opacity",1);"coordinates"==t.shape.value?t.zoom.viewport=t.path.bounds(t.zoom.coords[n.d3plus.id]):"d3plus"in n&&("x"in n.d3plus&&i.push(n.d3plus.x),"y"in n.d3plus&&o.push(n.d3plus.y),"r"in n.d3plus?(l.push(n.d3plus.r),s.push(n.d3plus.r)):("width"in n.d3plus&&l.push(n.d3plus.width/2),"height"in n.d3plus&&s.push(n.d3plus.height/2)));for(e in d3plus.evt){var u=d3.select(this).on(d3plus.evt[e]);u&&r.on(d3plus.evt[e],u)}}})}if(i.length&&o.length){var u=d3.extent(i),d=d3.extent(o),c=d3.max(l),p=d3.max(s);t.zoom.viewport=[[u[0]-c,d[0]-p],[u[1]+c,d[1]+p]]}t.g.data_focus.selectAll("path").style("stroke-width",2*t.data.stroke.width),t.dev.value&&d3plus.console.timeEnd("drawing focus elements")}else t.zoom.viewport=!1}},{}],229:[function(e){var t=e("../../core/data/format.js"),n=e("../../core/data/color.js"),r=e("../../core/data/keys.js"),a=e("../../core/data/load.coffee"),i=e("../../core/fetch/data.js"),o=e("../../core/parse/edges.js"),l=e("../../core/parse/nodes.js");d3plus.draw.steps=function(e){var s=[],u=e.type.value,d=e.format.locale.value,c=d.message.ui,p=d.message.draw,f=["data","attrs","coords","nodes","edges"];if(f.forEach(function(t){!e[t].loaded&&e[t].url&&s.push({"function":function(e,n){a(e,t,n)},message:d.message.loading,wait:!0})}),e.draw.update){var h=d.visualization[u]||u,v=e.types[u].setup||!1,g=e.types[u].requirements||[],m=d3plus.string.format(d.message.initializing,h),y=d.message.data;g instanceof Array||(g=[g]),h=h.toLowerCase(),"function"==typeof v&&s.push({"function":function(e){if(e.dev.value){var t="running "+h+" setup";d3plus.console.time(t)}v(e),e.dev.value&&d3plus.console.timeEnd(t)},message:m}),e.container.changed&&s.push({"function":d3plus.draw.enter,message:m}),u in e.g.apps||s.push({"function":function(e){if(e.dev.value){var t="creating "+h+" group";d3plus.console.time(t)}e.g.apps[u]=e.g.app.selectAll("g#"+u).data([u]),e.g.apps[u].enter().append("g").attr("id",u).attr("opacity",0),e.dev.value&&d3plus.console.timeEnd(t)},message:m}),e.data.changed&&s.push({"function":function(e){e.data.cache={},delete e.nodes.restricted,delete e.edges.restricted,r(e,"data")},message:y}),e.attrs.changed&&s.push({"function":function(e){r(e,"attrs")},message:y}),s.push({"function":function(e){if(e.color.changed&&e.color.value){if(e.color.valueScale=null,e.dev.value){var t="determining color type";d3plus.console.time(t)}var n=e.color.value;d3plus.object.validate(n)&&(n=n[e.id.value]?n[e.id.value]:n[d3.keys(n)[0]]),e.color.type=e.data.keys&&n in e.data.keys?e.data.keys[n]:e.attrs.keys&&n in e.attrs.keys?e.attrs.keys[n]:void 0,e.dev.value&&d3plus.console.timeEnd(t)}else e.color.value||(e.color.type="keys"in e.data?e.data.keys[e.id.value]:!1)},message:y}),g.indexOf("edges")>=0&&e.edges.value&&(!e.edges.linked||e.edges.changed)&&s.push({"function":o,message:y}),g.indexOf("nodes")>=0&&e.edges.value&&(!e.nodes.positions||e.nodes.changed)&&s.push({"function":l,message:y}),(e.data.changed||e.time.changed||e.id.changed)&&s.push({"function":t,message:y}),s.push({"function":function(e){var t=e.time.fixed.value?null:["all"];if(e.dev.value){var n=t?"fetching pool data":"fetching data";d3plus.console.time(n)}e.data.pool=i(e,t),e.dev.value&&d3plus.console.timeEnd(n),t?(e.dev.value&&d3plus.console.time("fetching data for current year"),e.data.app=i(e),e.dev.value&&d3plus.console.timeEnd("fetching data for current year")):e.data.app=e.data.pool},message:y}),s.push({check:function(e){return e.color.value&&"number"===e.color.type&&e.id.nesting.indexOf(e.color.value)<0&&e.data.value&&e.color.value!=e.id.value&&(e.color.changed||e.data.changed||e.depth.changed||e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed))},"function":n,message:y})}return s.push({"function":function(e){if(e.dev.value){var t=e.format.locale.value.message.tooltipReset;d3plus.console.time(t)}e.type.previous&&u!==e.type.previous&&d3plus.tooltip.remove(e.type.previous),d3plus.tooltip.remove(u),e.dev.value&&d3plus.console.timeEnd(t)},message:c}),s.push({"function":d3plus.draw.errors,message:c}),s.push({"function":function(e){if(e.margin.process(),d3plus.ui.titles(e),e.draw.update)d3plus.ui.drawer(e),d3plus.ui.timeline(e),d3plus.ui.legend(e);else{e.dev.value&&d3plus.console.time("calculating margins");var t=e.container.value.select("div#d3plus_drawer").node().offsetHeight||e.container.value.select("div#d3plus_drawer").node().getBoundingClientRect().height,n=e.g.timeline.node().getBBox();n=e.timeline.value?n.height+n.y:0;var r=e.g.legend.node().getBBox();r=e.legend.value?r.height+r.y:0,e.margin.bottom+=t+n+r,e.dev.value&&d3plus.console.timeEnd("calculating margins")}d3plus.ui.history(e),e.height.viz-=e.margin.top+e.margin.bottom,e.width.viz-=e.margin.left+e.margin.right},message:c}),s.push({"function":d3plus.ui.focus,message:c}),s.push({"function":d3plus.draw.update,message:p}),e.draw.update&&s.push({"function":[d3plus.draw.app,d3plus.shape.draw],message:p}),s.push({"function":[d3plus.draw.focus,d3plus.draw.finish],message:p}),s}},{"../../core/data/color.js":41,"../../core/data/format.js":43,"../../core/data/keys.js":44,"../../core/data/load.coffee":45,"../../core/fetch/data.js":49,"../../core/parse/edges.js":54,"../../core/parse/nodes.js":56}],230:[function(){d3plus.draw.update=function(e){e.dev.value&&d3plus.console.time("updating SVG elements"),e.draw.timing?(e.container.value.transition().duration(e.draw.timing).style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value),e.g.bg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value),e.g.clipping.select("rect").transition().duration(e.draw.timing).attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.transition().duration(e.draw.timing).attr("transform","translate("+e.margin.left+","+e.margin.top+")")):(e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.attr("width",e.width.value).attr("height",e.height.value),e.g.bg.attr("width",e.width.value).attr("height",e.height.value),e.g.clipping.select("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.attr("transform","translate("+e.margin.left+","+e.margin.top+")")),e.dev.value&&d3plus.console.timeEnd("updating SVG elements")}},{}],231:[function(e){var t=e("../../core/fetch/text.js");d3plus.shape.area=function(e,n,r){var a=d3.svg.area().x(function(e){return e.d3plus.x}).y0(function(e){return e.d3plus.y0}).y1(function(e){return e.d3plus.y}).interpolate(e.shape.interpolate.value);r.append("path").attr("class","d3plus_data").attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),n.selectAll("path.d3plus_data").data(function(n){if(e.labels.value&&n.values.length>1){var r=[],a=[],i=t(e,n);n.values.forEach(function(e){r.push([e.d3plus.x,e.d3plus.y]),a.push([e.d3plus.x,e.d3plus.y0])}),r=r.concat(a.reverse());var o={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value};if(i.length)var l=d3plus.font.sizes(i[0],o),s=l[0].width/l[0].height;else var s=null;var u=d3plus.geom.largestRect(r,{angle:d3.range(-70,71,1),aspectRatio:s,tolerance:0})[0];if(u){var d={w:Math.floor(u.width),h:Math.floor(u.height),x:Math.floor(u.cx),y:Math.floor(u.cy),angle:-1*u.angle,padding:2,names:i};d.translate=0!==u.angle?{x:d.x,y:d.y}:!1,d.w>=10&&d.h>=10&&(n.d3plus_label=d)}}return[n]}),e.draw.timing?n.selectAll("path.d3plus_data").transition().duration(e.draw.timing).attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e):n.selectAll("path.d3plus_data").attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e)}},{"../../core/fetch/text.js":50}],232:[function(e){var t=e("../../core/fetch/value.js"),n=e("../../core/fetch/color.js");d3plus.shape.color=function(e,r){var a=e.d3plus?e.d3plus.shapeType:r.shape.value;if("line"==r.shape.value)return"circle"==a?n(r,e):"none";if("area"==r.shape.value||"active"==a)return n(r,e);if("temp"==a)return"url(#d3plus_hatch_"+e.d3plus.id+")";if("active"==a)return n(r,e);if(e.d3plus.static)return d3plus.color.lighter(n(r,e),.75);var i=r.active.value?t(r,e,r.active.value):e.d3plus.active,o=r.temp.value?t(r,e,r.temp.value):e.d3plus.temp,l=r.total.value?t(r,e,r.total.value):e.d3plus.total;return!r.active.value&&!r.temp.value||i===!0||i&&l&&i==l&&!o||i&&!l?n(r,e):r.active.spotlight.value?"#eee":d3plus.color.lighter(n(r,e),.75)}},{"../../core/fetch/color.js":48,"../../core/fetch/value.js":51}],233:[function(e){var t=e("../../core/fetch/text.js");d3plus.shape.coordinates=function(e,n,r){var a=d3.geo[e.coords.projection.value]().center(e.coords.center);e.zoom.scale||(e.zoom.scale=1),e.zoom.area=1/e.zoom.scale/e.zoom.scale,e.path=d3.geo.path().projection(a),r.append("path").attr("id",function(e){return e.id}).attr("class","d3plus_data").attr("d",e.path).call(d3plus.shape.style,e),e.draw.timing?n.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(d3plus.shape.style,e):n.selectAll("path.d3plus_data").call(d3plus.shape.style,e);var i=e.old_height!=e.height.viz||e.height.changed||e.old_width!=e.width.viz||e.width.changed;e.old_height=e.height.viz,e.old_width=e.width.viz,e.coords.changed||i||e.coords.mute.changed||e.coords.solo.changed?(e.zoom.bounds=null,e.zoom.coords={},e.zoom.labels={},n.each(function(n){var r=e.path.bounds(n),a=[];n.geometry.coordinates=n.geometry.coordinates.filter(function(t,r){var i=d3plus.util.copy(n);i.geometry.coordinates=[i.geometry.coordinates[r]];var o=e.path.area(i);return o>=e.coords.threshold?(a.push(o),!0):!1}),a.sort(function(e,t){return e-t});var i=d3plus.util.copy(n),o=d3plus.util.copy(n);i.geometry.coordinates=i.geometry.coordinates.filter(function(t,r){var i=d3plus.util.copy(n);i.geometry.coordinates=[i.geometry.coordinates[r]];var l=e.path.area(i);return l==a[a.length-1]&&(o.geometry.coordinates=i.geometry.coordinates),l>=d3.quantile(a,.9)}),e.zoom.coords[n.d3plus.id]=i;var l=o.geometry.coordinates[0];if(l&&"MultiPolygon"===o.geometry.type&&(l=l[0],o.geometry.coordinates[0]=l,o.geometry.type="Polygon"),l){for(var s=e.path(o).split("M")[1].split("Z")[0].split("L"),u=0;u<s.length;u++)s[u]=s[u].split(","),s[u][0]=parseFloat(s[u][0]),s[u][1]=parseFloat(s[u][1]);var d={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value},c=t(e,n);if(c.length&&1===c[0].split(" ").length)var p=d3plus.font.sizes(c[0],d)[0],f=p.width/p.height;else var f=null;var h=d3plus.geom.largestRect(s,{angle:0,aspectRatio:f})[0];if(h){var v={anchor:"middle",valign:"center",group:e.g.labels,h:Math.floor(h.height),w:Math.floor(h.width),x:Math.floor(h.cx),y:Math.floor(h.cy),names:c};e.zoom.labels[n.d3plus.id]=v}else delete e.zoom.labels[n.d3plus.id]}else delete e.zoom.labels[n.d3plus.id];e.zoom.bounds?(e.zoom.bounds[0][0]>r[0][0]&&(e.zoom.bounds[0][0]=r[0][0]),e.zoom.bounds[0][1]>r[0][1]&&(e.zoom.bounds[0][1]=r[0][1]),e.zoom.bounds[1][0]<r[1][0]&&(e.zoom.bounds[1][0]=r[1][0]),e.zoom.bounds[1][1]<r[1][1]&&(e.zoom.bounds[1][1]=r[1][1])):e.zoom.bounds=r})):e.focus.value.length||(e.zoom.viewport=!1)}},{"../../core/fetch/text.js":50}],234:[function(){d3plus.shape.donut=function(e,t,n,r){function a(t,n,r,a){if(!n)var n=0;if("number"!=typeof r)var r=void 0;if("number"!=typeof a)var a=void 0;t.attrTween("d",function(t){if(void 0==r)var o=t.d3plus.r?t.d3plus.r:d3.max([t.d3plus.width,t.d3plus.height]);else var o=r;if(void 0==a)var l=t.d3plus.segments[t.d3plus.shapeType];else var l=a;e.arcs[t.d3plus.shapeType][t.d3plus.id]||(e.arcs[t.d3plus.shapeType][t.d3plus.id]={r:0},e.arcs[t.d3plus.shapeType][t.d3plus.id].a="donut"==t.d3plus.shapeType?2*Math.PI:0);var s=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].r,o+n),u=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].a,l);return function(n){return e.arcs[t.d3plus.shapeType][t.d3plus.id].r=s(n),e.arcs[t.d3plus.shapeType][t.d3plus.id].a=u(n),i(t)}})}e.arcs||(e.arcs={donut:{},active:{},temp:{}});var i=d3.svg.arc().startAngle(0).endAngle(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].a;return n>2*Math.PI?2*Math.PI:n}).innerRadius(function(t){if("donut"!=shape||t.d3plus.static)return 0;var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return n*e.data.donut.size}).outerRadius(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return"donut"!=t.d3plus.shapeType?2*n:n});r.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(a,0,0).each("end",function(t){delete e.arcs[t.d3plus.shapeType][t.d3plus.id]}),t.selectAll("path.d3plus_data").data(function(e){return[e]}).transition().duration(e.draw.timing).call(a).call(d3plus.shape.style,e),n.append("path").attr("class","d3plus_data").transition().duration(0).call(a,0,0).call(d3plus.shape.style,e)}},{}],235:[function(e){var t=e("../../core/fetch/value.js"),n=e("../../core/fetch/color.js"),r=e("../../core/fetch/text.js");d3plus.shape.draw=function(e){function a(n){n.d3plus.id="";for(var r=0;r<=e.depth.value;r++)n.d3plus.id+=t(e,n,e.id.nesting[r])+"_";return n.d3plus.id+=c,e.axes.values.forEach(function(r){"continuous"==e[r].scale.value&&(n.d3plus.id+="_"+t(e,n,e[r].value))}),n.d3plus.id=d3plus.string.strip(n.d3plus.id),n}function i(t,n){var r=e.types[e.type.value].scale;if(n&&r&&r[e.shape.value])var a=r[e.shape.value];else if(n&&r&&"number"==typeof r)var a=r;else var a=1;t.attr("transform",function(e){var t=e.d3plus.x||0,n=e.d3plus.y||0;return["line","area","coordinates"].indexOf(c)<0?"translate("+t+","+n+")scale("+a+")":"scale("+a+")"})}function o(t){if(t&&e.g.edges.selectAll("g").size()>0){e.g.edge_hover.selectAll("*").remove(),e.g.edges.selectAll("g").each(function(n){var r=t[e.id.value],a=n[e.edges.source][e.id.value],i=n[e.edges.target][e.id.value];if(a==r||i==r){var o=e.g.edge_hover.node().appendChild(this.cloneNode(!0));d3.select(o).datum(n).attr("opacity",1).selectAll("line, path").datum(n)}});var n=e.edges.arrows.value;e.g.edge_hover.attr("opacity",0).selectAll("line, path").style("stroke",e.color.primary).style("stroke-width",function(){return e.edges.size?d3.select(this).style("stroke-width"):2*e.data.stroke.width}).attr("marker-start",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"source"==r&&n?"url(#d3plus_edge_marker_highlight"+a+")":"none"}).attr("marker-end",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"target"==r&&n?"url(#d3plus_edge_marker_highlight"+a+")":"none"}),e.g.edge_hover.selectAll("text").style("fill",e.color.primary),e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",1),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",.5)):e.g.edge_hover.attr("opacity",1)}else e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",0).transition().selectAll("*").remove(),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",1)):e.g.edge_hover.selectAll("*").remove()}var l=e.returned.nodes||[],s=e.returned.edges||[];e.draw.timing=l.length<e.data.large&&s.length<e.edges.large?e.timing.transitions:0;var u={area:"area",circle:"rect",donut:"donut",line:"line",square:"rect",coordinates:"coordinates"},d={};l.forEach(function(t){if(t.d3plus)if(t.d3plus.shape){var n=t.d3plus.shape;t.d3plus.shapeType=n}else{var n=u[e.shape.value];t.d3plus.shapeType=n}else var n=u[e.shape.value];d[n]||(d[n]=[]),d[n].push(t)});for(c in u)u[c]in d&&0!==d3.keys(d).length||(e.draw.timing?e.g.data.selectAll("g.d3plus_"+u[c]).transition().duration(e.draw.timing).attr("opacity",0).remove():e.g.data.selectAll("g.d3plus_"+u[c]).remove());for(var c in d){var p=e.g.data.selectAll("g.d3plus_"+c).data(d[c],function(t){if(t.d3plus||(t.d3plus={}),"coordinates"===c)return t.d3plus.id=t.id,t.id;if(!t.d3plus.id)if(t.values)t.values.forEach(function(e){e=a(e),e.d3plus.shapeType="circle"}),t.d3plus.id=t.key;else if(t=a(t),!t.d3plus.segments){t.d3plus.segments={donut:2*Math.PI};var n=e.active.value?t.d3plus[e.active.value]:t.d3plus.active,r=e.temp.value?t.d3plus[e.temp.value]:t.d3plus.temp,i=e.total.value?t.d3plus[e.total.value]:t.d3plus.total;i&&(t.d3plus.segments.active=n?n/i*2*Math.PI:0,t.d3plus.segments.temp=r?r/i*2*Math.PI+t.d3plus.segments.active:0)}return t.d3plus?t.d3plus.id:!1});if(e.draw.timing)var f=p.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();else var f=p.exit().remove();e.draw.timing?p.transition().duration(e.draw.timing).call(i):p.call(i);var h=e.draw.timing?0:1,v=p.enter().append("g").attr("class","d3plus_"+c).attr("opacity",h).call(i);e.draw.timing&&v.transition().duration(e.draw.timing).attr("opacity",1),p.order(),e.dev.value&&d3plus.console.time('drawing "'+c+'" shapes'),d3plus.shape[c](e,p,v,f,i),e.dev.value&&d3plus.console.timeEnd('drawing "'+c+'" shapes'),["rect","donut"].indexOf(c)>=0&&e.types[e.type.value].fill&&(e.dev.value&&d3plus.console.time('filling "'+c+'" shapes'),d3plus.shape.fill(e,p,v,f,i),e.dev.value&&d3plus.console.timeEnd('filling "'+c+'" shapes'))}o(),d3plus.touch?e.g.data.selectAll("g").on(d3plus.evt.over,e.zoom.touchEvent).on(d3plus.evt.move,e.zoom.touchEvent).on(d3plus.evt.out,e.zoom.touchEvent):e.g.data.selectAll("g").on(d3plus.evt.over,function(t){if(!(e.draw.frozen||t.d3plus&&t.d3plus.static)){if(d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).call(i,!0),d3.select(this).selectAll(".d3plus_data").transition().duration(e.timing.mouseevents).attr("opacity",1),e.covered=!1,1!==e.focus.value.length||e.focus.value[0]!=t[e.id.value]){if(t.values&&e.continuous_axis){var n="x"===e.continuous_axis?0:1,r=d3.mouse(e.container.value.node())[n],a=d3plus.util.uniques(t.values,function(t){return t.d3plus[e.continuous_axis]}),l=d3plus.util.closest(a,r);t.d3plus_data=t.values[a.indexOf(l)],t.d3plus=t.values[a.indexOf(l)].d3plus
}var s=t.d3plus_data?t.d3plus_data:t;d3plus.tooltip.app({vars:e,data:s})}"function"==typeof e.mouse?e.mouse(t):e.mouse[d3plus.evt.over]&&e.mouse[d3plus.evt.over](t),o(t)}}).on(d3plus.evt.move,function(t){if(!(e.draw.frozen||t.d3plus&&t.d3plus.static)){if(e.covered=!1,t.values||"follow"==e.types[e.type.value].tooltip&&e.focus.value[0]!=t[e.id.value]){if(t.values&&e.continuous_axis){var n="x"===e.continuous_axis?0:1,r=d3.mouse(e.container.value.node())[n],a=d3plus.util.uniques(t.values,function(t){return t.d3plus[e.continuous_axis]}),i=d3plus.util.closest(a,r);t.d3plus_data=t.values[a.indexOf(i)],t.d3plus=t.values[a.indexOf(i)].d3plus}var o=t.d3plus_data?t.d3plus_data:t;d3plus.tooltip.app({vars:e,data:o})}"function"==typeof e.mouse?e.mouse(t):e.mouse[d3plus.evt.move]&&e.mouse[d3plus.evt.move](t)}}).on(d3plus.evt.out,function(t){var n=d3plus.util.child(this,d3.event.toElement);n||e.draw.frozen||t.d3plus&&t.d3plus.static||(d3.select(this).transition().duration(e.timing.mouseevents).call(i),d3.select(this).selectAll(".d3plus_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),e.covered||d3plus.tooltip.remove(e.type.value),"function"==typeof e.mouse?e.mouse(t):e.mouse[d3plus.evt.out]&&e.mouse[d3plus.evt.out](t),o())}),e.g.data.selectAll("g").on(d3plus.evt.click,function(a){if(!(d3.event.defaultPrevented||e.draw.frozen||a.d3plus&&a.d3plus.static)){"function"==typeof e.mouse?e.mouse(a):e.mouse[d3plus.evt.out]?e.mouse[d3plus.evt.out](a):e.mouse[d3plus.evt.click]&&e.mouse[d3plus.evt.click](a);var l=e.zoom.direction(a.d3plus_data||a),s=e.id.solo.value,u=r(e,a)[0],d=d3plus.color.legible(n(e,a)),c=e.title.sub.value||!1,p=e.title.sub.font.color,f=e.title.total.font.color;if(a.d3plus.threshold&&a.d3plus.merged&&e.zoom.value)e.history.states.push(function(){e.self.id({solo:s}).title({sub:{font:{color:p},value:c},total:{font:{color:f}}}).draw()}),e.self.id({solo:d3plus.util.uniques(a.d3plus.merged,e.id.value)}).title({sub:{font:{color:d},value:u},total:{font:{color:d}}}).draw();else if(1===l&&e.zoom.value){var h=t(e,a,e.id.value);e.history.states.push(function(){e.self.depth(e.depth.value-1).id({solo:s}).title({sub:{font:{color:p},value:c},total:{font:{color:f}}}).draw()}),e.self.depth(e.depth.value+1).id({solo:[h]}).title({sub:{font:{color:d},value:u},total:{font:{color:d}}}).draw()}else if(-1===l&&e.zoom.value)e.history.back();else if(e.types[e.type.value].zoom&&e.zoom.value)o(),d3.select(this).transition().duration(e.timing.mouseevents).call(i),d3.select(this).selectAll(".d3plus_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),d3plus.tooltip.remove(e.type.value),e.draw.update=!1,a&&a[e.id.value]!=e.focus.value[0]?e.self.focus(a[e.id.value]).draw():e.self.focus(!1).draw();else if(1!==e.focus.value.length||a[e.id.value]!=e.focus.value[0]){o();var v=a.d3plus_data?a.d3plus_data:a;d3plus.tooltip.app({vars:e,data:v})}}})}},{"../../core/fetch/color.js":48,"../../core/fetch/text.js":50,"../../core/fetch/value.js":51}],236:[function(){d3plus.shape.edges=function(e){function t(t){var n=1==e.edges.opacity?e.edges.opacity:0;t.attr("opacity",n).style("stroke-width",0).style("stroke",e.background.value).style("fill","none")}function n(t){var n=e.edges.arrows.value;t.style("stroke-width",function(t){return e.edges.scale(t[e.edges.size])}).style("stroke",e.edges.color).attr("opacity",e.edges.opacity).attr("marker-start",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"source"==r&&n?"url(#d3plus_edge_marker_default"+a+")":"none"}).attr("marker-end",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"target"==r&&n?"url(#d3plus_edge_marker_default"+a+")":"none"}).attr("vector-effect","non-scaling-stroke").attr("pointer-events","none")}function r(t){t.attr("x1",function(t){return t[e.edges.source].d3plus.edges[t[e.edges.target][e.id.value]].x}).attr("y1",function(t){return t[e.edges.source].d3plus.edges[t[e.edges.target][e.id.value]].y}).attr("x2",function(t){return t[e.edges.target].d3plus.edges[t[e.edges.source][e.id.value]].x}).attr("y2",function(t){return t[e.edges.target].d3plus.edges[t[e.edges.source][e.id.value]].y})}function a(e){e.attr("d",function(e){return c(e.d3plus.spline)})}function i(t){if(delete t.d3plus_label,e.g.edges.selectAll("line, path").size()<e.edges.large&&e.edges.label&&t[e.edges.label]){if("spline"in t.d3plus)var n=this.getTotalLength(),r=this.getPointAtLength(n/2),a=this.getPointAtLength(n/2-.1*n),i=this.getPointAtLength(n/2+.1*n),o=Math.atan2(i.y-a.y,i.x-a.x),l=o*(180/Math.PI),s=(this.parentNode.getBBox(),.8*n),u=r.x,d=r.y;else var c=(this.getBBox(),t[e.edges.source]),p=t[e.edges.target],f={x:c.d3plus.edges[p[e.id.value]].x,y:c.d3plus.edges[p[e.id.value]].y},h={x:p.d3plus.edges[c[e.id.value]].x,y:p.d3plus.edges[c[e.id.value]].y},v=h.x-f.x,g=h.y-f.y,r={x:h.x-v/2,y:h.y-g/2},o=Math.atan2(g,v),l=o*(180/Math.PI),n=Math.sqrt(v*v+g*g),s=n,u=r.x,d=r.y;s+=2*e.labels.padding;var m=0;e.edges.arrows.value&&(m="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8,m/=e.zoom.behavior.scaleExtent()[1],s-=2*m),(-90>l||l>90)&&(l-=180),s*e.zoom.behavior.scaleExtent()[0]>20&&(t.d3plus_label={x:u,y:d,translate:{x:u,y:d},w:s,h:15+2*e.labels.padding,angle:l,anchor:"middle",valign:"center",color:e.edges.color,resize:!1,names:[e.format.value(t[e.edges.label])],background:1})}}var o=e.returned.edges||[],l=e.zoom.behavior.scaleExtent()[0];if("string"==typeof e.edges.size){var s=d3.extent(o,function(t){return t[e.edges.size]}),u=.5*d3.min(e.returned.nodes||[],function(e){return e.d3plus.r});e.edges.scale=d3.scale.sqrt().domain(s).range([e.edges.width,u*l])}else{var d="number"==typeof e.edges.size?e.edges.size:e.edges.width;e.edges.scale=function(){return d}}var c=d3.svg.line().interpolate(e.edges.interpolate.value),p=e.edges.arrows.value?"string"==typeof e.edges.size?["default_0","default_1","default_2","highlight_0","highlight_1","highlight_2","focus_0","focus_1","focus_2"]:["default","highlight","focus"]:[];if("string"==typeof e.edges.size)for(var f=d3plus.util.buckets(e.edges.scale.range(),4),h=[],v=0;3>v;v++)h.push(f[v+1]+(f[1]-f[0])*(v+2)*2);else var g="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8,h="number"==typeof e.edges.size?e.edges.size/g:g;var m=e.defs.selectAll(".d3plus_edge_marker").data(p,String),y=function(t){t.attr("d",function(t){var n=t.split("_");if(2==n.length&&e.edges.scale){n=parseInt(n[1]);var r=h[n]}else var r=h;return"target"==e.edges.arrows.direction.value?"M 0,-"+r/2+" L "+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2:"M 0,-"+r/2+" L -"+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2}).attr("fill",function(t){var n=t.split("_")[0];return"default"==n?e.edges.color:"focus"==n?e.color.focus:e.color.primary}).attr("transform","scale("+1/l+")")};e.draw.timing?(m.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),m.select("path").transition().duration(e.draw.timing).attr("opacity",1).call(y)):(m.exit().remove(),m.select("path").attr("opacity",1).call(y));var x=e.draw.timing?0:1,b=m.enter().append("marker").attr("id",function(e){return"d3plus_edge_marker_"+e}).attr("class","d3plus_edge_marker").attr("orient","auto").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("path").attr("opacity",x).attr("vector-effect","non-scaling-stroke").call(y);e.draw.timing&&b.transition().duration(e.draw.timing).attr("opacity",1);var w="string"==typeof e.edges.size?d3plus.util.buckets(e.edges.scale.domain(),4):null,_=e.edges.arrows.direction.value,k=o.filter(function(t){if(t.d3plus||(t.d3plus={}),t.d3plus.id="edge_"+t[e.edges.source][e.id.value]+"_"+t[e.edges.target][e.id.value],t.d3plus.spline!==!0){if(w){var n=t[e.edges.size];t.d3plus.bucket=n<w[1]?0:n<w[2]?1:2;var r=.85*h[t.d3plus.bucket]/l}else{delete t.d3plus.bucket;var r=.85*h/l}var a=t[e.edges.source],i=t[e.edges.target];if(!a.d3plus||!i.d3plus)return!1;var o=Math.atan2(a.d3plus.y-i.d3plus.y,a.d3plus.x-i.d3plus.x),s=Math.atan2(i.d3plus.y-a.d3plus.y,i.d3plus.x-a.d3plus.x),u="source"==_&&e.edges.arrows.value?a.d3plus.r+r:a.d3plus.r,d="target"==_&&e.edges.arrows.value?i.d3plus.r+r:i.d3plus.r,c=d3plus.util.offset(o,u,e.shape.value),p=d3plus.util.offset(s,d,e.shape.value);return"edges"in a.d3plus||(a.d3plus.edges={}),a.d3plus.edges[i[e.id.value]]={x:a.d3plus.x-c.x,y:a.d3plus.y-c.y},"edges"in i.d3plus||(i.d3plus.edges={}),i.d3plus.edges[a[e.id.value]]={x:i.d3plus.x-p.x,y:i.d3plus.y-p.y},!0}return!1}),z=e.g.edges.selectAll("g.d3plus_edge_line").data(k,function(e){return e.d3plus.id}),A=o.filter(function(t){if(t.d3plus.spline){if(w){var n=t[e.edges.size];t.d3plus.bucket=n<w[1]?0:n<w[2]?1:2;var r=.85*h[t.d3plus.bucket]/l}else{delete t.d3plus.bucket;var r=.85*h/l}var a=t[e.edges.source],i=t[e.edges.target],o=a.d3plus.edges?a.d3plus.edges[i[e.id.value]]||{}:{},s=i.d3plus.edges?i.d3plus.edges[a[e.id.value]]||{}:{},u=e.edges.arrows.value&&"source"==_?r:0,d=e.edges.arrows.value&&"target"==_?r:0,c=.1,p=a.d3plus.x>i.d3plus.x?1-c:1+c,f=a.d3plus.x>i.d3plus.x?1+c:1-c,v="number"==typeof o.angle?o.angle:Math.atan2(a.d3plus.y-i.d3plus.y,a.d3plus.x-i.d3plus.x)*p,g=d3plus.util.offset(v,a.d3plus.r+u,e.shape.value),m="number"==typeof s.angle?s.angle:Math.atan2(i.d3plus.y-a.d3plus.y,i.d3plus.x-a.d3plus.x)*f,y=d3plus.util.offset(m,i.d3plus.r+d,e.shape.value),x=[a.d3plus.x-g.x,a.d3plus.y-g.y],b=o.offset?d3plus.util.offset(v,o.offset):!1,k=b?[x[0]-b.x,x[1]-b.y]:x,z=[i.d3plus.x-y.x,i.d3plus.y-y.y],A=s.offset?d3plus.util.offset(m,s.offset):!1,j=A?[z[0]-A.x,z[1]-A.y]:z,M=j[0]-k[0],E=j[1]-k[1],S="number"==typeof o.radius?o.radius:Math.sqrt(M*M+E*E)/4,T="number"==typeof s.radius?s.radius:Math.sqrt(M*M+E*E)/4,O=d3plus.util.offset(v,S-a.d3plus.r-2*u),F=d3plus.util.offset(m,T-i.d3plus.r-2*d);t.d3plus.spline=[x,z];var V=Math.abs(Math.atan2(a.d3plus.y-i.d3plus.y,a.d3plus.x-i.d3plus.x)).toFixed(5),N=Math.abs(v).toFixed(5),B=Math.abs(m-Math.PI).toFixed(5);return(N!==B||[N,B].indexOf(V)<0)&&(t.d3plus.spline.splice(1,0,[k[0]-O.x,k[1]-O.y],[j[0]-F.x,j[1]-F.y]),b&&t.d3plus.spline.splice(1,0,k),A&&t.d3plus.spline.splice(t.d3plus.spline.length-1,0,j)),!0}return!1}),j=e.g.edges.selectAll("g.d3plus_edge_path").data(A,function(e){return e.d3plus.id});e.draw.timing?(z.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),j.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),z.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),j.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),z.selectAll("line").data(function(e){return[e]}).transition().duration(e.draw.timing).call(r).call(n).each("end",i),j.selectAll("path").data(function(e){return[e]}).transition().duration(e.draw.timing).call(a).call(n).each("end",i),z.enter().append("g").attr("class","d3plus_edge_line").append("line").call(r).call(t).transition().duration(e.draw.timing).call(n).each("end",i),j.enter().append("g").attr("class","d3plus_edge_path").append("path").call(a).call(t).transition().duration(e.draw.timing).call(n).each("end",i)):(z.exit().remove(),j.exit().remove(),z.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),j.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),z.selectAll("line").data(function(e){return[e]}).call(r).call(n).call(i),j.selectAll("path").data(function(e){return[e]}).call(a).call(n).call(i),z.enter().append("g").attr("class","d3plus_edge_line").append("line").call(r).call(t).call(n).call(i),j.enter().append("g").attr("class","d3plus_edge_path").append("path").call(a).call(t).call(n).call(i))}},{}],237:[function(e){var t=e("../../core/fetch/color.js");d3plus.shape.fill=function(e,n){function r(e){e.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function a(t,n){if(!n)var n=0;t.attr("x",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return-t/2-n/2}).attr("y",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return-t/2-n/2}).attr("width",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return t+n}).attr("height",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return t+n}).attr("rx",function(t){var r=t.d3plus.r?2*t.d3plus.r:t.d3plus.width,a=["circle","donut"].indexOf(e.shape.value)>=0;return a?(r+n)/2:0}).attr("ry",function(t){var r=t.d3plus.r?2*t.d3plus.r:t.d3plus.height,a=["circle","donut"].indexOf(e.shape.value)>=0;return a?(r+n)/2:0}).attr("shape-rendering",function(){return["square"].indexOf(e.shape.value)>=0?e.shape.rendering.value:"auto"})}function i(t,n,r,a){if(!n)var n=0;if("number"!=typeof r)var r=void 0;if("number"!=typeof a)var a=void 0;t.attrTween("d",function(t){if(void 0==r)var i=t.d3plus.r?t.d3plus.r:d3.max([t.d3plus.width,t.d3plus.height]);else var i=r;if(void 0==a)var l=t.d3plus.a[t.d3plus.shapeType];else var l=a;e.arcs[t.d3plus.shapeType][t.d3plus.id]||(e.arcs[t.d3plus.shapeType][t.d3plus.id]={r:0},e.arcs[t.d3plus.shapeType][t.d3plus.id].a="donut"==t.d3plus.shapeType?2*Math.PI:0);var s=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].r,i+n),u=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].a,l);return function(n){return e.arcs[t.d3plus.shapeType][t.d3plus.id].r=s(n),e.arcs[t.d3plus.shapeType][t.d3plus.id].a=u(n),o(t)}})}e.arcs||(e.arcs={donut:{},active:{},temp:{}});var o=d3.svg.arc().startAngle(0).endAngle(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].a;return n>2*Math.PI?2*Math.PI:n}).innerRadius(function(t){if("donut"!=shape||t.d3plus.static)return 0;var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return n*e.data.donut.size}).outerRadius(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return"donut"!=t.d3plus.shapeType?2*n:n});n.each(function(n){function o(t){t.attr("stroke",c).attr("stroke-width",1).attr("shape-rendering",e.shape.rendering.value)}var l=e.active.value?n.d3plus[e.active.value]:n.d3plus.active,s=e.temp.value?n.d3plus[e.temp.value]:n.d3plus.temp,u=e.total.value?n.d3plus[e.total.value]:n.d3plus.total,d=d3.select(this),c=t(e,n),p=[],f=[];if(u&&e.types[e.type.value].fill){if(s){var h=d3plus.util.copy(n);h.d3plus.shapeType="temp",p.push(h),f=["temp"]}if(l&&(u>l||s)){var h=d3plus.util.copy(n);h.d3plus.shapeType="active",p.push(h)}}var v=e.defs.selectAll("pattern#d3plus_hatch_"+n.d3plus.id).data(f);e.draw.timing?(v.selectAll("rect").transition().duration(e.draw.timing).style("fill",c),v.selectAll("line").transition().duration(e.draw.timing).style("stroke",c)):(v.selectAll("rect").style("fill",c),v.selectAll("line").style("stroke",c));var g=v.enter().append("pattern").attr("id","d3plus_hatch_"+n.d3plus.id).attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g");g.append("rect").attr("x","0").attr("y","0").attr("width","10").attr("height","10").attr("fill",c).attr("fill-opacity",.25),g.append("line").attr("x1","0").attr("x2","10").attr("y1","0").attr("y2","10").call(o),g.append("line").attr("x1","-1").attr("x2","1").attr("y1","9").attr("y2","11").call(o),g.append("line").attr("x1","9").attr("x2","11").attr("y1","-1").attr("y2","1").call(o);var m=p.length?[n]:[],y=d.selectAll("#d3plus_clip_"+n.d3plus.id).data(m);y.enter().insert("clipPath",".d3plus_mouse").attr("id","d3plus_clip_"+n.d3plus.id).append("rect").attr("class","d3plus_clipping").call(r),e.draw.timing?(y.selectAll("rect").transition().duration(e.draw.timing).call(a),y.exit().transition().delay(e.draw.timing).remove()):(y.selectAll("rect").call(a),y.exit().remove());var x=d.selectAll("path.d3plus_fill").data(p);x.transition().duration(e.draw.timing).call(d3plus.shape.style,e).call(i),x.enter().insert("path","rect.d3plus_mouse").attr("class","d3plus_fill").attr("clip-path","url(#d3plus_clip_"+n.d3plus.id+")").transition().duration(0).call(i,0,void 0,0).call(d3plus.shape.style,e).transition().duration(e.draw.timing).call(i),x.exit().transition().duration(e.draw.timing).call(i,0,void 0,0).remove()})}},{"../../core/fetch/color.js":48}],238:[function(e){var t=e("../../core/fetch/text.js");d3plus.shape.labels=function(e,n){var r=e.zoom.behavior.scaleExtent(),a=e.g[n].selectAll("g"),i=function(t){t.attr("opacity",function(t){if(!t)var t={scale:r[1]};var n=parseFloat(d3.select(this).attr("font-size"),10);return t.visible=n/t.scale*e.zoom.scale>=7,t.visible?1:0})};if(remove=function(t){e.draw.timing?t.transition().duration(e.draw.timing).attr("opacity",0).remove():t.remove()},style=function(t,n){function a(t){if("circle"===t.shape)return"0px";var n=t.anchor||e.labels.align,a="tspan"===this.tagName.toLowerCase(),i=a?"d3plus_share"==this.parentNode.className.baseVal:"d3plus_share"==this.className.baseVal,o=d3.select(this).node().getComputedTextLength()/r[1];if("middle"==n||i)var l=t.x-o/2;else if("end"==n&&!d3plus.rtl||"start"==n&&d3plus.rtl)var l=t.x+(t.w-t.padding)/2-o;else var l=t.x-(t.w-t.padding)/2;if(a){var s=this.getComputedTextLength()/r[1];"middle"==n?d3plus.rtl?l-=(o-s)/2:l+=(o-s)/2:"end"==n&&(d3plus.rtl?l-=o-s:l+=o-s)}return d3plus.rtl&&(l+=o),l*r[1]}function i(t){if(d3.select(this).select("tspan").empty())return 0;var n=e.labels.align,a=d3.select(this).node().getBBox().height/r[1],i=parseFloat(d3.select(this).style("font-size"),10)/5/r[1];if("d3plus_share"==this.className.baseVal){var o=d3.select(this.parentNode).datum(),l=o.d3plus.r?2*o.d3plus.r:o.d3plus.height;if(l/=r[1],"end"==n)var s=t.y-l/2+i/2;else var s=t.y+l/2-a-i/2}else if("circle"===t.shape||"middle"===n||"center"===t.valign)var s=t.y-a/2-i/2;else if("end"==n)var s=t.y+(t.h-t.padding)/2-a+i/2;else var s=t.y-(t.h-t.padding)/2-i;return s*r[1]}t.attr("font-weight",e.labels.font.weight).attr("font-family",e.labels.font.family.value).style("text-anchor",function(e){return"circle"===e.shape?"middle":"start"}).attr("pointer-events",function(e){return e.mouse?"auto":"none"}).attr("fill",function(t){if(t.color)return t.color;var n=d3plus.shape.color(t.parent,e),r=d3plus.color.text(n),a=t.text?.15:1;return d3plus.color.mix(n,r,.2,a)}).attr("x",a).attr("y",i),n&&t.each(function(t){if(t.resize instanceof Array){t.resize[0],t.resize[1]}if(t.text){if(t.resize instanceof Array)var n=t.resize,r=!0;else var n=[9/t.scale,50*t.scale],r=t.resize;d3plus.textwrap().container(d3.select(this)).height(t.h*t.scale-t.padding).resize(r).size(n).text(e.format.value(100*t.text,"share")+"%").width(t.w*t.scale-t.padding).draw()}else{if("middle"!==e.labels.align&&t.share)var a=t.h-t.share-t.padding;else var a=t.h;if(t.resize instanceof Array)var n=t.resize,r=!0;else var n=[9/t.scale,40*t.scale],r=t.resize;var i=t.shape||"square";d3plus.textwrap().container(d3.select(this)).height(a*t.scale-t.padding).resize(r).size(n).shape(i).text(t.names).width(t.w*t.scale-t.padding).draw()}}).attr("x",a).attr("y",i),t.attr("transform",function(e){var t=e.angle||0,n=e.translate&&e.translate.x?e.translate.x:0,a=e.translate&&e.translate.y?e.translate.y:0;return"rotate("+t+","+n+","+a+")scale("+1/r[1]+")"}).selectAll("tspan").attr("x",a)},"edges"===n||e.labels.value){if(e.dev.value){var o="drawing "+n+" labels";d3plus.console.time(o)}a.each(function(a){function o(t){var n="none"===e.background.value?"#ffffff":e.background.value,a="string"==typeof label.background?label.background:n,i=label.angle||0,o=label.translate?b.x+b.width/2:0,l=label.translate?b.y+b.height/2:0,s="scale("+1/r[1]+")rotate("+i+","+o+","+l+")";t.attr("fill",a).attr(b).attr("transform",s)}var l=a.d3plus&&"label"in a.d3plus&&!a.d3plus.label,s=a.d3plus&&"static"in a.d3plus&&a.d3plus.static;if(label=a.d3plus_label?a.d3plus_label:e.zoom.labels?e.zoom.labels[a.d3plus.id]:null,share=a.d3plus_share,names=label&&label.names?label.names:t(e,a),n=label&&"group"in label?label.group:d3.select(this),share_size=0,fill=e.types[e.type.value].fill,label)if(["line","area"].indexOf(e.shape.value)>=0)var u=!0;else if(a&&"d3plus"in a)var d=e.active.value?a.d3plus[e.active.value]:a.d3plus.active,c=e.temp.value?a.d3plus[e.temp.value]:a.d3plus.temp,p=e.total.value?a.d3plus[e.total.value]:a.d3plus.total,u=!c&&!d||d==p;if(l||!u&&fill||s)delete a.d3plus_label,n.selectAll("text#d3plus_label_"+a.d3plus.id+", rect#d3plus_label_bg_"+a.d3plus.id).call(remove);else{if(share&&a.d3plus.share&&"middle"!=e.labels.align){share.resize=e.labels.resize.value===!1?!1:share&&"resize"in share?share.resize:!0,share.scale=share.resize?r[1]:r[0],share.padding=e.labels.padding/share.scale*2,share.text=a.d3plus.share,share.parent=a;var f=n.selectAll("text#d3plus_share_"+a.d3plus.id).data([share],function(e){return e.w+""+e.h+e.text});e.draw.timing?(f.transition().duration(e.draw.timing/2).call(style),f.enter().append("text").attr("id","d3plus_share_"+a.d3plus.id).attr("class","d3plus_share").attr("opacity",0).call(style,!0).transition().duration(e.draw.timing/2).delay(e.draw.timing/2).attr("opacity",1)):(f.attr("opacity",1).call(style),f.enter().append("text").attr("id","d3plus_share_"+a.d3plus.id).attr("class","d3plus_share").attr("opacity",1).call(style,!0)),share_size=f.node().getBBox().height,f.exit().call(remove)}else n.selectAll("text.d3plus_share").call(remove);if(label){label.resize=e.labels.resize.value===!1?!1:label&&"resize"in label?label.resize:!0,label.scale=label.resize?r[1]:r[0];var h="number"==typeof label.padding?label.padding:e.labels.padding;label.padding=h/label.scale*2}if(label&&label.w*label.scale-label.padding>=20&&label.h*label.scale-label.padding>=10&&names.length){for(var v=e.format.locale.value.ui.and,g=e.format.locale.value.ui.more,m=0;m<names.length;m++)names[m]instanceof Array&&(names[m]=d3plus.string.list(names[m],v,3,g));label.names=names,label.share=share_size,label.parent=a;var f=n.selectAll("text#d3plus_label_"+a.d3plus.id).data([label],function(e){return e?e.w+"_"+e.h+"_"+e.x+"_"+e.y+"_"+e.names.join("_"):!1}),y=label.resize?void 0:e.labels.font.size*label.scale;if(e.draw.timing?(f.transition().duration(e.draw.timing/2).call(style).call(i),f.enter().append("text").attr("font-size",y).attr("id","d3plus_label_"+a.d3plus.id).attr("class","d3plus_label").attr("opacity",0).call(style,!0).transition().duration(e.draw.timing/2).delay(e.draw.timing/2).call(i)):(f.attr("opacity",1).call(style).call(i),f.enter().append("text").attr("font-size",y).attr("id","d3plus_label_"+a.d3plus.id).attr("class","d3plus_label").call(style,!0).call(i)),f.exit().call(remove),0==f.size()||""==f.html())delete a.d3plus_label,n.selectAll("text#d3plus_label_"+a.d3plus.id+", rect#d3plus_label_bg_"+a.d3plus.id).call(remove);else{if(label.background){var x=["background"],b=f.node().getBBox();b.width+=e.labels.padding*r[0],b.height+=e.labels.padding*r[0],b.x-=e.labels.padding*r[0]/2,b.y-=e.labels.padding*r[0]/2}else var x=[],b={};var w=n.selectAll("rect#d3plus_label_bg_"+a.d3plus.id).data(x),_="number"==typeof label.background?label.background:.6;e.draw.timing?(w.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),w.transition().duration(e.draw.timing).attr("opacity",_).call(o),w.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+a.d3plus.id).attr("class","d3plus_label_bg").attr("opacity",0).call(o).transition().duration(e.draw.timing).attr("opacity",_)):(w.exit().remove(),w.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+a.d3plus.id).attr("class","d3plus_label_bg"),w.attr("opacity",_).call(o))}}else delete a.d3plus_label,n.selectAll("text#d3plus_label_"+a.d3plus.id+", rect#d3plus_label_bg_"+a.d3plus.id).call(remove)}}),e.dev.value&&d3plus.console.timeEnd(o)}else{if(e.dev.value){var o="removing "+n+" labels";d3plus.console.time(o)}a.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove),e.g.labels.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove),e.dev.value&&d3plus.console.timeEnd(o)}}},{"../../core/fetch/text.js":50}],239:[function(){d3plus.shape.line=function(e,t){function n(e){e.attr("x",function(e){return e.d3plus.x}).attr("y",function(e){return e.d3plus.y}).attr("width",0).attr("height",0)}function r(e,t){if(!t)var t=0;e.attr("x",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return e.d3plus.x-(n/2+t/2)}).attr("y",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return e.d3plus.y-(n/2+t/2)}).attr("width",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return n+t}).attr("height",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return n+t}).attr("rx",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return(n+t)/2}).attr("ry",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return(n+t)/2})}var a=d3.svg.line().x(function(e){return e.d3plus.x}).y(function(e){return e.d3plus.y}).interpolate(e.shape.interpolate.value),i=e.data.stroke.width;30>i&&(i=30),t.each(function(t){var o=!1,l=[],s=[],u=d3plus.util.copy(t),d=d3.select(this);u.values=[],t.values.forEach(function(n,r,a){s.push(n);var i=n[e[e.continuous_axis].value],d=e.tickValues[e.continuous_axis].indexOf(i);o===!1&&(o=d),r+o===d?(u.values.push(n),u.key+="_"+l.length):(r>0&&(l.push(u),u=d3plus.util.copy(t),u.values=[]),u.values.push(n),u.key+="_"+l.length,o++),r===a.length-1&&l.push(u)});var c=d.selectAll("path.d3plus_line").data(l,function(e){return e.key}),p=d.selectAll("rect.d3plus_anchor").data(s,function(e){return e.d3plus.id});e.draw.timing?(c.transition().duration(e.draw.timing).attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),c.enter().append("path").attr("class","d3plus_line").attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),p.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(e){return e.d3plus.id}).call(n).call(d3plus.shape.style,e),p.transition().duration(e.draw.timing).call(r).call(d3plus.shape.style,e),p.exit().transition().duration(e.draw.timing).call(n).remove()):(c.enter().append("path").attr("class","d3plus_line"),c.attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),p.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(e){return e.d3plus.id}),p.call(r).call(d3plus.shape.style,e));var f=d.selectAll("path.d3plus_mouse").data(l,function(e){return e.key});f.enter().append("path").attr("class","d3plus_mouse").attr("d",function(e){return a(e.values)}).style("stroke","black").style("stroke-width",i).style("fill","none").style("stroke-linecap","round").attr("opacity",0),f.on(d3plus.evt.over,function(){e.draw.frozen||(d3.select(this.parentNode).selectAll("path.d3plus_line").transition().duration(e.timing.mouseevents).style("stroke-width",2*e.data.stroke.width),d3.select(this.parentNode).selectAll("rect").transition().duration(e.timing.mouseevents).style("stroke-width",2*e.data.stroke.width).call(r,2))}).on(d3plus.evt.out,function(){e.draw.frozen||(d3.select(this.parentNode).selectAll("path.d3plus_line").transition().duration(e.timing.mouseevents).style("stroke-width",e.data.stroke.width),d3.select(this.parentNode).selectAll("rect").transition().duration(e.timing.mouseevents).style("stroke-width",e.data.stroke.width).call(r))}),e.draw.timing?f.transition().duration(e.draw.timing).attr("d",function(e){return a(e.values)}).style("stroke-width",i):f.attr("d",function(e){return a(e.values)}).style("stroke-width",i),f.exit().remove()})}},{}],240:[function(){d3plus.shape.rect=function(e,t,n,r){function a(t){if(e.labels.value&&!t.d3plus.label){t.d3plus_label={w:0,h:0,x:0,y:0};var n=t.d3plus.r?2*t.d3plus.r:t.d3plus.width,r=t.d3plus.r?2*t.d3plus.r:t.d3plus.height;t.d3plus_share={w:n,h:d3.max([25,r/3]),x:0,y:0},t.d3plus_label.w=n,t.d3plus_label.h=r,t.d3plus_label.shape="circle"===e.shape.value?"circle":"square"}else t.d3plus.label&&(t.d3plus_label=t.d3plus.label);return[t]}function i(e){e.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function o(t){t.attr("x",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return-t/2}).attr("y",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return-t/2}).attr("width",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return t}).attr("height",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return t}).attr("rx",function(t){var n="circle"==e.shape.value,r=t.d3plus.r?2*t.d3plus.r:t.d3plus.width;return n?(r+2)/2:0}).attr("ry",function(t){var n="circle"==e.shape.value,r=t.d3plus.r?2*t.d3plus.r:t.d3plus.height;return n?(r+2)/2:0}).attr("transform",function(e){return"rotate"in e.d3plus?"rotate("+e.d3plus.rotate+")":""}).attr("shape-rendering",function(t){return"square"!=e.shape.value||"rotate"in t.d3plus?"auto":e.shape.rendering.value})}e.draw.timing?n.append("rect").attr("class","d3plus_data").call(i).call(d3plus.shape.style,e):n.append("rect").attr("class","d3plus_data"),e.draw.timing?t.selectAll("rect.d3plus_data").data(a).transition().duration(e.draw.timing).call(o).call(d3plus.shape.style,e):t.selectAll("rect.d3plus_data").data(a).call(o).call(d3plus.shape.style,e),e.draw.timing&&r.selectAll("rect.d3plus_data").transition().duration(e.draw.timing).call(i)}},{}],241:[function(){d3plus.shape.style=function(e,t){e.attr("fill",function(e){return e.d3plus&&e.d3plus.spline?"none":d3plus.shape.color(e,t)}).style("stroke",function(e){if(e.values)var n=d3plus.shape.color(e.values[0],t);else var n=d3plus.shape.color(e,t);return d3.rgb(n).darker(.5)}).style("stroke-width",t.data.stroke.width).attr("opacity",t.data.opacity).attr("vector-effect","non-scaling-stroke")}},{}],242:[function(e,t){var n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),a=e("../../core/fetch/text.js"),i=function(e){function t(t){t.attr("x",function(e){return e.d3plus.x}).attr("y",function(e){return e.d3plus.y-e.r-e.d3plus.label_height-h}).style("text-anchor","middle").attr("font-weight",e.labels.font.weight).attr("font-family",e.labels.font.family.value).attr("font-size","12px").style("fill",function(t){var n=r(e,t);return d3plus.color.legible(n)}).each(function(t){if(t.r>10&&i>10){var n=a(e,t,t.depth);d3plus.textwrap().container(d3.select(this)).height(i).text(n).width(d-2*h).draw()}}).attr("y",function(e){return e.d3plus.label_height=d3.select(this).node().getBBox().height,e.d3plus.y-e.r-e.d3plus.label_height-h}).selectAll("tspan").attr("x",function(e){return e.d3plus.x})}var i=e.labels.value&&!e.small?50:0;d3plus.array.sort(e.data.app,e.order.value||e.size.value,e.order.sort.value,e.color.value,e);var o=e.data.app.length;if(4>o)var l=o,s=1;else var u=e.width.viz/e.height.viz,l=Math.ceil(Math.sqrt(o*u)),s=Math.ceil(Math.sqrt(o/u));if(o>0)for(;(s-1)*l>=e.data.app.length;)s--;var d=e.width.viz/l,c=e.height.viz/s,p=d3.min(e.data.app,function(t){return e.size.value?n(e,t,e.size.value,null,"min"):0}),f=d3.max(e.data.app,function(t){return e.size.value?n(e,t,e.size.value):0}),h=5,v=20,g=d3.min([d,c])/2-2*h;g-=i;var m=e.size.scale.value.domain([p,f]).rangeRound([v,g]),y=d3.layout.pack().size([d-2*h,c-2*h-i]).value(function(t){return e.size.value?n(e,t,e.size.value):0}).padding(h).radius(function(e){return m(e)}),x=[],b=0;e.data.app.forEach(function(t,n){var r=y.nodes(t),a=d*n%e.width.viz,o=c*b;r.forEach(function(t){t.xoffset=a,t.yoffset=o+i,t.d3plus.static=t.depth<e.depth.value?!0:!1,t.d3plus.label=1==r.length?!1:!0}),x=x.concat(r),(n+1)%l==0&&b++});var w=g/d3.max(x,function(e){return e.r});x.forEach(function(e){e.x=(e.x-d/2)*w+d/2,e.d3plus.x=e.x+e.xoffset,e.y=(e.y-c/2)*w+c/2,e.d3plus.y=e.y+e.yoffset,e.r=e.r*w,e.d3plus.r=e.r}),x.sort(function(e,t){return e.depth-t.depth});var _=x.filter(function(e){return 0==e.depth}),k=e.group.selectAll("text.d3plus_bubble_label").data(_,function(t){return t.d3plus.label_height||(t.d3plus.label_height=0),t[e.id.nesting[t.depth]]});return k.enter().append("text").attr("class","d3plus_bubble_label").call(t).attr("opacity",0),k.transition().duration(e.draw.timing).call(t).attr("opacity",1),k.exit().attr("opacity",0).remove(),x};i.fill=!0,i.requirements=["data"],i.scale=1.05,i.shapes=["circle","donut"],i.tooltip="static",t.exports=i},{"../../core/fetch/color.js":48,"../../core/fetch/text.js":50,"../../core/fetch/value.js":51}],243:[function(e,t){var n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),a=e("../../core/fetch/data.js"),i=function(e){function t(t,n){t.attr("stroke",e.axes.ticks.color).attr("stroke-width",e.axes.ticks.width).attr("shape-rendering",e.shape.rendering.value).style("opacity",function(t){var r="log"==e[n].scale.value&&"1"!=t.toString().charAt(0);
return r?.25:1})}function i(t,n){t.attr("x1",function(t){return"x"==n?e.x_scale(t):0}).attr("x2",function(t){return"x"==n?e.x_scale(t):c.width}).attr("y1",function(t){return"y"==n?e.y_scale(t):0}).attr("y2",function(t){return"y"==n?e.y_scale(t):c.height})}function o(e){return"number"==typeof e||"string"==typeof e?null:d3.keys(e)[0]}function l(e){if("number"==typeof e)return e;if("string"==typeof e)return parseFloat(e);var t=e[d3.keys(e)[0]];return"string"==typeof t?parseFloat(t):t}function s(t,n){t.attr("x1",function(e){return"y"==n?0:e.d3plus.x-c.margin.left}).attr("x2",function(e){return"y"==n?-5:e.d3plus.x-c.margin.left}).attr("y1",function(e){return"x"==n?c.height:e.d3plus.y-c.margin.top}).attr("y2",function(e){return"x"==n?c.height+5:e.d3plus.y-c.margin.top}).style("stroke",function(t){return d3plus.color.legible(r(e,t))}).style("stroke-width",e.data.stroke.width).attr("shape-rendering",e.shape.rendering.value)}function u(t){function a(e){e.attr("x2",function(e){var t="x"==e.axis?e.x:e.x-e.r;return t}).attr("y2",function(e){var t="y"==e.axis?e.y:e.y+e.r;return t}).style("stroke-width",0).attr("opacity",0)}var i=d3.event.type==d3plus.evt.click&&(e.tooltip.value.long||e.tooltip.html.value),o=[d3plus.evt.over,d3plus.evt.move].indexOf(d3.event.type)>=0;if(!i&&o&&"area"!=e.shape.value){if(t.data)var t=t.data;var l=[d3plus.util.copy(t.d3plus),d3plus.util.copy(t.d3plus)];l[0].axis="x",l[1].axis="y"}else var l=[];var s=U.selectAll("line.d3plus_axis_label").data(l,function(e){return e.axis+"_"+e.id});s.enter().append("line").attr("class","d3plus_axis_label").call(a).attr("x1",function(e){return"x"==e.axis?e.x:e.x-e.r}).attr("y1",function(e){return"y"==e.axis?e.y:e.y+e.r}).style("stroke",function(){return r(e,t)}).attr("shape-rendering",e.shape.rendering.value),s.transition().duration(e.timing.mouseevents).attr("class","d3plus_axis_label").attr("x2",function(t){return"x"==t.axis?t.x:c.margin.left-e.axes.ticks.size}).attr("y2",function(t){return"y"==t.axis?t.y:c.height+c.margin.top+e.axes.ticks.size}).style("stroke",function(){return d3plus.color.legible(r(e,t))}).style("stroke-width",e.data.stroke.width).attr("opacity",1),s.exit().transition().duration(e.timing.mouseevents).call(a).remove();var u=U.selectAll("text.d3plus_axis_label").data(l,function(e){return e.axis+"_"+e.id});u.enter().append("text").attr("class","d3plus_axis_label").attr("id",function(e){return e.axis+"_"+e.id}).text(function(r){var a=n(e,t.d3plus_data||t,e[r.axis].value);return e.format.value(a,e[r.axis].value)}).attr("x",function(t){return"x"==t.axis?t.x:c.margin.left-5-e.axes.ticks.size}).attr("y",function(t){return"y"==t.axis?t.y:c.height+c.margin.top+5+e.axes.ticks.size}).attr("dy",function(t){return"y"==t.axis?.35*e.axes.ticks.font.size:e.axes.ticks.font.size}).style("text-anchor",function(e){return"y"==e.axis?"end":"middle"}).attr("fill",function(){return d3plus.color.legible(r(e,t))}).attr("font-size",e.axes.ticks.font.size).attr("font-family",e.axes.ticks.font.family.value).attr("font-weight",e.axes.ticks.font.weight).attr("opacity",0),u.transition().duration(e.timing.mouseevents).delay(e.timing.mouseevents).attr("opacity",1),u.exit().transition().duration(e.timing.mouseevents).attr("opacity",0).remove();var d=U.selectAll("rect.d3plus_axis_label").data(l,function(e){return e.axis+"_"+e.id});d.enter().insert("rect","text").attr("class","d3plus_axis_label").attr("x",function(t){var n=d3.select("text#"+t.axis+"_"+t.id).node().getBBox().width,r="x"==t.axis?t.x:c.margin.left-e.axes.ticks.size;return"x"==t.axis?r-n/2-5:r-n-10}).attr("y",function(t){var n=d3.select("text#"+t.axis+"_"+t.id).node().getBBox().height,r="y"==t.axis?t.y:c.height+c.margin.top;return"x"==t.axis?r+e.axes.ticks.size:r-n/2-5}).attr("width",function(e){var t=d3.select("text#"+e.axis+"_"+e.id).node().getBBox();return t.width+10}).attr("height",function(e){var t=d3.select("text#"+e.axis+"_"+e.id).node().getBBox();return t.height+10}).style("stroke",function(){return d3plus.color.legible(r(e,t))}).attr("fill","white").style("stroke-width",e.data.stroke.width).attr("shape-rendering",e.shape.rendering.value).attr("opacity",0),d.transition().duration(e.timing.mouseevents).delay(e.timing.mouseevents).attr("opacity",1),d.exit().transition().duration(e.timing.mouseevents).attr("opacity",0).remove()}if(e.small)var c={margin:{top:0,right:0,bottom:0,left:0}};else var c={margin:{top:10,right:10,bottom:40,left:40}};if(c.width=e.width.viz-c.margin.left-c.margin.right,c.height=e.height.viz-c.margin.top-c.margin.bottom,e.data.app.length){if(e.tickValues||(e.tickValues={}),e.continuous_axis=null,e.opp_axis=null,e.stacked_axis=null,e.axes.values.forEach(function(t){if(e[t].stacked.value&&(e.stacked_axis=t),e.continuous_axis||"continuous"!=e[t].scale.value||(e.continuous_axis=t,e.opp_axis="x"==t?"y":"x"),e.data.changed||e.depth.changed||!e[t+"_range"]||e.time.fixed.value){if(e.dev.value&&d3plus.console.time("determining "+t+"-axis"),"share"==e[t].scale.value)e[t+"_range"]=[0,1],e.tickValues[t]=d3plus.util.buckets([0,1],11),e.stacked_axis=t;else if(e[t].stacked.value){if(e.time.fixed.value)var r=e.data.app;else var r=a(e,["all"]);var i=d3.nest().key(function(t){return t[e.x.value]}).rollup(function(r){return d3.sum(r,function(r){return n(e,r,e[t].value)})}).entries(r);e[t+"_range"]=[0,d3.max(i,function(e){return e.values})]}else if(e[t].domain instanceof Array)e[t+"_range"]=e[t].domain,e.tickValues[t]=d3plus.util.uniques(e.data.app,e[t].value),e.tickValues[t]=e.tickValues[t].filter(function(n){return n>=e[t+"_range"][0]&&n<=e[t+"_range"][1]});else if(e.time.fixed.value)e[t+"_range"]=d3.extent(e.data.app,function(r){return n(e,r,e[t].value)}),e.tickValues[t]=d3plus.util.uniques(e.data.app,e[t].value);else{var o=[];for(id in e.id.nesting)o=o.concat(e.data.grouped[e.id.nesting[id]].all);e[t+"_range"]=d3.extent(o,function(r){return n(e,r,e[t].value)}),e.tickValues[t]=d3plus.util.uniques(a(e,["all"]),e[t].value)}if(e[t+"_range"][0]==e[t+"_range"][1])if(e[t].value===e.time.value){var l=d3plus.util.closest(e.data.time.ticks,e[t+"_range"][0]),s=e.data.time.ticks.indexOf(l);if(s>0)e[t+"_range"][0]=e.data.time.ticks[s-1];else{var u=e.data.time.ticks[s+1]-l;e[t+"_range"][0]=new Date(l.getTime()-u)}if(s<e.data.time.ticks.length-1)e[t+"_range"][1]=e.data.time.ticks[s+1];else{var u=l-e.data.time.ticks[s-1];e[t+"_range"][1]=new Date(l.getTime()+u)}}else e[t+"_range"][0]-=1,e[t+"_range"][1]+=1;"y"==t&&(e.y_range=e.y_range.reverse()),e.dev.value&&d3plus.console.timeEnd("determining "+t+"-axis")}else e[t+"_range"]||(e[t+"_range"]=[-1,1])}),e.axes.mirror.value){var p=e.y_range.concat(e.x_range);e.x_range=d3.extent(p),e.y_range=d3.extent(p).reverse()}var f=e.data.app;if(f){if(e.dev.value&&d3plus.console.time("determining size scale"),e.size.value){if(e.time.fixed.value)var h=d3.extent(e.data.app,function(t){var r=n(e,t,e.size.value);return 0==r?null:r});else{var v=[];for(id in e.id.nesting)v=v.concat(e.data.grouped[e.id.nesting[id]].all);var h=d3.extent(v,function(t){var r=n(e,t,e.size.value);return 0==r?null:r})}h[0]&&h[1]||(h=[0,0])}else var h=[0,0];var g=Math.floor(d3.max([d3.min([c.width,c.height])/15,10])),m=10;if(h[0]==h[1])var m=g;var y=[m,g],x=e.size.scale.value.domain(h).rangeRound(y);e.dev.value&&d3plus.console.timeEnd("determining size scale")}var b={"font-size":e.axes.ticks.font.size,fill:e.axes.ticks.font.color,"font-family":e.axes.ticks.font.family.value,"font-weight":e.axes.ticks.font.weight};e.axes.values.forEach(function(t){var n="x"==t?c.width:c.height;if(["continuous","share"].indexOf(e[t].scale.value)>=0)var r="linear";else var r=e[t].scale.value;if(e[t+"_scale"]=d3.scale[r]().domain(e[t+"_range"]).rangeRound([0,n]),["square","circle","donut"].indexOf(e.shape.value)>=0&&["share"].indexOf(e[t].scale.value)<0){var a=e[t+"_scale"],i=2*x.range()[1],o=a.invert(-i),l=a.invert(n+i);e[t+"_scale"].domain([o,l])}var s="x"==t?"bottom":"left";if(e[t+"_axis"]=d3.svg.axis().tickSize(e.axes.ticks.size).tickPadding(5).orient(s).scale(e[t+"_scale"]).tickFormat(function(n){var r=!0;if(e[t].value==e.time.value&&n%1!=0&&(r=!1),("log"==e[t].scale.value&&"1"==n.toString().charAt(0)||"log"!=e[t].scale.value)&&r)if("share"==e[t].scale.value)var a=100*n+"%";else if(n.constructor===Date)var a=e.data.time.multiFormat(n);else var a=e.format.value(n,e[t].value);else var a=null;return a}),e[t].value===e.time.value){var u=e[t+"_range"];e[t].ticks=e.data.time.ticks.filter(function(e){return e<=u[1]&&e>=u[0]}),e[t].ticks.indexOf(u[0])<0&&e[t].ticks.unshift(u[0]),e[t].ticks.indexOf(u[1])<0&&e[t].ticks.push(u[1])}else e[t].ticks=e.continuous_axis===t?e.tickValues[t]:e[t+"_scale"].ticks();e[t+"_axis"].tickValues(e[t].ticks)})}var w=e.y.ticks.map(function(t){return e.format.value(t,e.y.value)}),_=d3.max(d3plus.font.sizes(w,b),function(e){return e.width})+e.labels.padding;c.margin.left+=_,c.width-=_;var k=e.x.ticks.map(function(t){return e.format.value(t,e.x.value)}),z=d3plus.font.sizes(k,b),A=d3.max(z,function(e){return e.width}),j=d3.max(z,function(e){return e.height}),M=d3.min([c.width/(k.length+1),2*c.margin.left])-2*e.labels.padding;if(M>A){A+=e.labels.padding;var E="middle",S="0ex",T="translate(0,10)"}else{A=j+e.labels.padding,j=d3.max(z,function(e){return e.width});var E="start",S="0.5ex",T="translate(15,10)rotate(70)"}c.height-=j,c.width-=A/2,e.x_scale.rangeRound([0,c.width]),e.y_scale.rangeRound([0,c.height]);var O=e.group.selectAll("g#plane").data(["plane"]);O.enter().append("g").attr("id","plane").attr("transform","translate("+c.margin.left+","+c.margin.top+")");var F=O.selectAll("rect#background").data(["background"]);F.enter().append("rect").attr("id","background").attr("x",0).attr("y",0).attr("width",c.width).attr("height",c.height).attr("stroke-width",1).attr("stroke","#ccc").attr("shape-rendering",e.shape.rendering.value).attr("fill","#fafafa");var V=O.selectAll("path#mirror").data(["mirror"]);V.enter().append("path").attr("id","mirror").attr("fill","#000").attr("fill-opacity",.03).attr("stroke-width",1).attr("stroke","#ccc").attr("stroke-dasharray","10,10").attr("opacity",0);var N=e.group.selectAll("g#axes").data(["axes"]);N.enter().append("g").attr("id","axes");var B=O.selectAll("g#xgrid").data(["xgrid"]);B.enter().append("g").attr("id","xgrid");var I=O.selectAll("g#ygrid").data(["ygrid"]);I.enter().append("g").attr("id","ygrid");var q=O.selectAll("g#xaxis").data(["xaxis"]);q.enter().append("g").attr("id","xaxis").attr("transform","translate(0,"+c.height+")").call(e.x_axis.scale(e.x_scale)).selectAll("g.tick").select("text").attr(b).style("text-anchor",E).attr("dy",S).attr("transform",T);var C=O.selectAll("g#yaxis").data(["yaxis"]);C.enter().append("g").attr("id","yaxis").call(e.y_axis.scale(e.y_scale)).selectAll("g.tick").select("text").attr(b);var P=N.selectAll("text#xlabel").data(e.small?[]:["xlabel"]);P.enter().append("text").attr("id","xlabel").attr("x",e.width.viz/2).attr("y",e.height.viz-10).text(e.format.value(e.x.value)).attr("font-family",e.labels.font.family.value).attr("font-weight",e.labels.font.weight).attr("font-size",e.labels.font.size).attr("fill",e.labels.font.color).style("text-anchor",e.labels.font.align),P.exit().remove();var L=N.selectAll("text#ylabel").data(e.small?[]:["ylabel"]);L.enter().append("text").attr("id","ylabel").attr("y",15).attr("x",-(c.height/2+c.margin.top)).text(e.format.value(e.y.value)).attr("transform","rotate(-90)").attr("font-family",e.labels.font.family.value).attr("font-weight",e.labels.font.weight).attr("font-size",e.labels.font.size).attr("fill",e.labels.font.color).style("text-anchor",e.labels.font.align),L.exit().remove();var U=e.group.selectAll("g#mouseevents").data(["mouseevents"]);U.enter().append("g").attr("id","mouseevents"),O.transition().duration(e.draw.timing).attr("transform","translate("+c.margin.left+","+c.margin.top+")"),F.attr("width",c.width).attr("height",c.height),V.transition().duration(e.draw.timing).attr("opacity",function(){return e.axes.mirror.value?1:0}).attr("d",function(){var e=c.width,t=c.height;return"M "+e+" "+t+" L 0 "+t+" L "+e+" 0 Z"}),C.transition().duration(e.draw.timing).call(e.y_axis.scale(e.y_scale)).selectAll("g.tick").select("text").attr(b),C.selectAll("line").transition().duration(e.draw.timing).call(t,"y"),C.selectAll("path").attr("fill","none"),q.transition().duration(e.draw.timing).attr("transform","translate(0,"+c.height+")").call(e.x_axis.scale(e.x_scale)).selectAll("g.tick").select("text").attr(b).style("text-anchor",E).attr("dy",S).attr("transform",T),q.selectAll("line").transition().duration(e.draw.timing).call(t,"x"),q.selectAll("path").attr("fill","none");var D=I.selectAll("line").data(e.y.ticks);D.enter().append("line").style("opacity",0).call(i,"y").call(t,"y"),D.transition().duration(e.draw.timing).style("opacity",1).call(i,"y").call(t,"y"),D.exit().transition().duration(e.draw.timing).style("opacity",0).remove();var R=B.selectAll("line").data(e.x.ticks);R.enter().append("line").style("opacity",0).call(i,"x").call(t,"x"),R.transition().duration(e.draw.timing).style("opacity",1).call(i,"x").call(t,"x"),R.exit().transition().duration(e.draw.timing).style("opacity",0).remove(),P.text(e.format.value(e.x.value)).attr("x",e.width.viz/2).attr("y",e.height.viz-10).attr("opacity",function(){return 0==e.data.app.length?0:1}),L.text(e.format.value(e.y.value)).attr("y",15).attr("x",-(c.height/2+c.margin.top)).attr("opacity",function(){return 0==e.data.app.length?0:1}),e.axes.values.forEach(function(t){var n=O.selectAll("g.d3plus_"+t+"line").data(e[t].lines,function(e){return"number"==typeof e||"string"==typeof e?e:d3.keys(e)[0]}),r=n.enter().append("g").attr("class","d3plus_"+t+"line"),a="x"==t?"height":"width",i="x"==t?c.height-8+"px":"10px",s="x"==t?10:20;r.append("line").attr(t+"1",0).attr(t+"2",c[a]).attr("stroke","#ccc").attr("stroke-width",3).attr("stroke-dasharray","10,10"),r.append("text").attr("font-size",e.axes.ticks.font.size).attr("fill",e.axes.ticks.font.color).attr("text-align","start").attr(t,i),n.selectAll("line").transition().duration(e.draw.timing).attr(t+"1",function(n){return l(n)?e[t+"_scale"](l(n)):0}).attr(t+"2",function(n){return l(n)?e[t+"_scale"](l(n)):0}).attr("opacity",function(n){var r=l(n)>e[t+"_scale"].domain()[1]&&l(n)<e[t+"_scale"].domain()[0];return null!==l(n)&&r?1:0}),n.selectAll("text").transition().duration(e.draw.timing).text(function(){if(null!==l(d)){var t=e.format.value(l(d),y_name);return o(d)?e.format.value(o(d))+": "+t:t}return null}).attr(t,function(n){return e[t+"_scale"](l(n))+s+"px"})}),["line","area"].indexOf(e.shape.value)>=0&&x.rangeRound([2,2]),e.axis_offset={x:c.margin.left,y:c.margin.top},f.forEach(function(t){t.d3plus.x=e.x_scale(n(e,t,e.x.value)),t.d3plus.x+=e.axis_offset.x,t.d3plus.r=x(n(e,t,e.size.value)),e.stacked_axis||(t.d3plus.y=e.y_scale(n(e,t,e.y.value)),t.d3plus.y+=e.axis_offset.y,"area"==e.shape.value&&(t.d3plus[e.opp_axis+"0"]=e[e.opp_axis+"_scale"].range()[1],t.d3plus[e.opp_axis+"0"]+=e.axis_offset[e.opp_axis]))});var H=e.order.value?e.order.value:e.continuous_axis?e[e.opp_axis].value:e.size.value||e.id.value;if(["line","area"].indexOf(e.shape.value)>=0&&(f=d3.nest().key(function(t){var r=n(e,t,e.id.value),a=t.d3plus.depth?t.d3plus.depth:0;return d3plus.string.strip(r)+"_"+a+"_"+e.shape.value}).rollup(function(t){var n=d3plus.util.uniques(t,e[e.continuous_axis].value),r=!1,a=e[e.continuous_axis].value===e.time.value;return a&&n[0].constructor===Date&&(n=n.map(function(e){return e.getTime()})),e[e.continuous_axis].ticks.forEach(function(i,o,l){var s=a?i.getTime():i;if(n.indexOf(s)<0){var u={};if(u[e[e.continuous_axis].value]=i,u[e.id.value]=t[0][e.id.value],u[e[e.opp_axis].value]=e[e.opp_axis+"_scale"].domain()[1],u.d3plus={},u.d3plus.r=x(x.domain()[0]),u.d3plus[e.continuous_axis]+=e.axis_offset[e.continuous_axis],e.stacked_axis||(u.d3plus[e.opp_axis]=e[e.opp_axis+"_scale"].range()[1],u.d3plus[e.opp_axis]+=e.axis_offset[e.opp_axis],u.d3plus[e.opp_axis+"0"]=u.d3plus[e.opp_axis]),e[e.continuous_axis].zerofill.value||e[e.opp_axis].stacked.value){var d=e[e.continuous_axis+"_scale"](i);d+=e.axis_offset[e.continuous_axis],u.d3plus[e.continuous_axis]=d,t.push(u)}else if("line"!=e.shape.value){if(!r&&o>0){var d=e[e.continuous_axis+"_scale"](l[o-1]);d+=e.axis_offset[e.continuous_axis],u.d3plus[e.continuous_axis]=d,t.push(u)}if(o<l.length-1){var d=e[e.continuous_axis+"_scale"](l[o+1]);d+=e.axis_offset[e.continuous_axis];var c=d3plus.util.copy(u);c.d3plus[e.continuous_axis]=d,t.push(c)}}r=!0}else r=!1}),t.sort(function(t,n){var r=t.d3plus[e.continuous_axis]-n.d3plus[e.continuous_axis];if(r)return r;var a=t[e[e.continuous_axis].value]-n[e[e.continuous_axis].value];return a}),t}).entries(f),f.forEach(function(t){"d3plus"in t.values[0]&&(t.d3plus||(t.d3plus={}),t.values.forEach(function(e){e.d3plus.merged instanceof Array&&(t.d3plus.merged||(t.d3plus.merged=[]),t.d3plus.merged=t.d3plus.merged.concat(e.d3plus.merged)),e.d3plus.text&&(t.d3plus.text=e.d3plus.text)})),e.id.nesting.forEach(function(n,r){r<=e.depth.value&&!t[n]&&(t[n]=d3plus.util.uniques(t.values,n).filter(function(e){return e&&"undefined"!=e})[0])}),H in t||(t[H]=0,t.values.forEach(function(r){var a=n(e,r,H);a&&("number"==typeof a?t[H]+=a:t[H]=a)}))})),H&&d3plus.array.sort(f,H,"desc"===e.order.sort.value?"asc":"desc",e.color.value||[],e),e.stacked_axis)var Y=d3.layout.stack().values(function(e){return e.values}).x(function(e){return e.d3plus.x}).y(function(t){var r=c.height,a=n(e,t,e.y.value);return r-e.y_scale(a)}).out(function(t,n,r){var a=c.height;"share"==e[e.stacked_axis].scale.value?(t.d3plus.y0=(1-n)*a,t.d3plus.y=t.d3plus.y0-r*a):(t.d3plus.y0=a-n,t.d3plus.y=t.d3plus.y0-r),t.d3plus.y+=c.margin.top,t.d3plus.y0+=c.margin.top}),X="share"==e[e.stacked_axis].scale.value?"expand":"zero",f=Y.offset(X)(f);else if(["area","line"].indexOf(e.shape.value)<0){var G=O.selectAll("g.d3plus_data_ticks").data(f,function(t){return t[e.id.value]+"_"+t.d3plus.depth}),W=G.enter().append("g").attr("class","d3plus_data_ticks").attr("opacity",0);W.append("line").attr("class","d3plus_data_y").call(s,"y"),G.selectAll("line.d3plus_data_y").call(s,"y"),W.append("line").attr("class","d3plus_data_x").call(s,"x"),G.selectAll("line.d3plus_data_x").call(s,"x"),G.transition().duration(e.draw.timing).attr("opacity",1),G.exit().transition().duration(e.draw.timing).attr("opacity",0).remove()}return e.mouse=u,f};i.fill=!0,i.requirements=["data","x","y"],i.scale={circle:1.1,donut:1.1,square:1.1},i.setup=function(e){e.x.value===e.time.value&&e.self.x({scale:"continuous"}),e.y.value===e.time.value&&e.self.y({scale:"continuous"})},i.shapes=["circle","donut","line","square","area"],i.tooltip="static",t.exports=i},{"../../core/fetch/color.js":48,"../../core/fetch/data.js":49,"../../core/fetch/value.js":51}],244:[function(e,t){var n=function(e){topojson.presimplify(e.coords.value);var t=e.coords.value,n=d3.keys(t.objects)[0],r=topojson.feature(t,t.objects[n]),a=r.features,a=a.filter(function(t){return t[e.id.value]=t.id,e.coords.solo.value.length?e.coords.solo.value.indexOf(t.id)>=0:e.coords.mute.value.length?e.coords.mute.value.indexOf(t.id)<0:!0});return a};n.libs=["topojson"],n.nesting=!1,n.requirements=["color","coords"],n.scale=1,n.shapes=["coordinates"],n.tooltip="follow",n.zoom=!0,t.exports=n},{}],245:[function(e,t){var n=function(e){return chart(e)};n.requirements=["data","x","y"],n.setup=function(e){e.self.x({scale:"continuous"})},n.shapes=["line"],n.tooltip="static",t.exports=n},{}],246:[function(e,t){var n=e("../../core/fetch/value.js"),r=function(e){var t=e.nodes.restricted||e.nodes.value,r=e.edges.restricted||e.edges.value,a=d3.extent(t,function(e){return e.x}),i=d3.extent(t,function(e){return e.y}),o=e.size.value?d3.extent(t,function(t){var r=n(e,t,e.size.value);return 0===r?null:r}):[1,1];"undefined"==typeof o[0]&&(o=[1,1]);var l=d3.min(d3plus.util.distances(t)),s=e.size.value?e.nodes.overlap:.4;if(l*=s,e.edges.arrows.value&&(l=.5*l),o[0]===o[1])var u=l;else{var d=a[1]+1.1*l-(a[0]-1.1*l),c=i[1]+1.1*l-(i[0]-1.1*l);if(aspect=d/c,app=e.width.viz/e.height.viz,app>aspect)var p=e.height.viz/c;else var p=e.width.viz/d;var u=.25*l;2>u*p&&(u=2/p)}var f=e.size.scale.value.domain(o).range([u,l]);e.zoom.bounds=[[a[0]-1.1*l,i[0]-1.1*l],[a[1]+1.1*l,i[1]+1.1*l]];var h=[],v={};return t.forEach(function(t){var r=e.data.app.filter(function(n){return n[e.id.value]==t[e.id.value]})[0];if(r)var a=d3plus.object.merge(t,r);else var a=d3plus.util.copy(t);a.d3plus={},a.d3plus.x=t.x,a.d3plus.y=t.y;var i=n(e,a,e.size.value);a.d3plus.r=i?f(i):f.range()[0],v[a[e.id.value]]={x:a.d3plus.x,y:a.d3plus.y,r:a.d3plus.r},h.push(a)}),h.sort(function(e,t){return t.d3plus.r-e.d3plus.r}),r.forEach(function(t){t[e.edges.source].d3plus={};var n=v[t[e.edges.source][e.id.value]];t[e.edges.source].d3plus.r=n.r,t[e.edges.source].d3plus.x=n.x,t[e.edges.source].d3plus.y=n.y,t[e.edges.target].d3plus={};var r=v[t[e.edges.target][e.id.value]];t[e.edges.target].d3plus.r=r.r,t[e.edges.target].d3plus.x=r.x,t[e.edges.target].d3plus.y=r.y}),{nodes:h,edges:r}};r.nesting=!1,r.requirements=["nodes","edges"],r.scale=1.05,r.shapes=["circle","square","donut"],r.tooltip="static",r.zoom=!0,t.exports=r},{"../../core/fetch/value.js":51}],247:[function(e,t){var n,r,a,i=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};r=e("../../network/shortestPath.coffee"),n=e("../../core/fetch/value.js"),a=function(e){var t,r,o,l,s,u,d,c,p,f,h,v,g,m,y,x,b,w,_,k,z,A,j,M,E,S,T,O,F,V,N,B,I,q,C,P,L,U,D,R,H,Y,X,G,W,Q,J,Z,K,$,et,tt,nt,rt,at,it,ot,lt,st,ut,dt,ct,pt;for(d=[],j={},j[e.focus.value[0]]=0,j[e.focus.value[1]]=0,M={all:[[e.focus.value[0]],[e.focus.value[1]]]},it=a.paths,A=R=0,G=it.length;G>R;A=++R)for(z=it[A],d=d.concat(z.edges),v=e.focus.value[0],M[A]=[v],ot=z.edges,u=H=0,W=ot.length;W>H;u=++H)s=ot[u],s[e.edges.source]=e.data.app.filter(function(t){return s[e.edges.source][e.id.value]===t[e.id.value]})[0],s[e.edges.target]=e.data.app.filter(function(t){return s[e.edges.target][e.id.value]===t[e.id.value]})[0],b=s[e.edges.source][e.id.value]===v?"target":"source",w=s[e.edges[b]][e.id.value],void 0===j[w]&&(j[w]=A),M[A].push(w),v=w;O=0;for(A in M)if(z=M[A],"all"!==A){for(y=0,c=Y=0,Q=z.length;Q>Y;c=++Y)if(p=z[c],0!==c&&c!==z.length-1&&j[p]===parseFloat(A)){for(y=1,E=z[c-1],x=z[c+1],S=null,_=null,lt=M.all,r=X=0,J=lt.length;J>X;r=++X)t=lt[r],i.call(t,E)>=0&&(S=r),i.call(t,x)>=0&&(_=r);null!==S&&null===_?S+1===M.all.length-1?M.all.splice(S+1,0,[p]):M.all[S+1].push(p):_-S===1?M.all.splice(_,0,[p]):_-S>1&&M.all[_-1].push(p)}O+=y}for(T=Math.floor(e.height.viz/O),C=[],c=0;O>c;)c%2===0?C.push(c):C.unshift(c),c++;for(f=e.size.value&&!e.small?30:0,q=d3.scale.ordinal().domain(C).range(d3.range(T/2-f,e.height.viz+T/2-f,(e.height.viz-T)/(O-1))),l=M.all.length,o=Math.floor(e.width.viz/l),B=d3.scale.linear().domain([0,l-1]).rangeRound([o/2,e.width.viz-o/2]),m=5,g=.4*d3.min([o,T-f]),V=d3.extent(e.data.app,function(t){var r;return r=n(e,t,e.size.value),r||0}),F=e.size.scale.value.domain(V).rangeRound([m,g]),st=e.data.app,tt=0,Z=st.length;Z>tt;tt++){for(k=st[tt],null==k.d3plus&&(k.d3plus={}),ut=M.all,r=nt=0,K=ut.length;K>nt;r=++nt)t=ut[r],dt=k[e.id.value],i.call(t,dt)>=0&&(k.d3plus.x=B(r));k.d3plus.y=q(j[k[e.id.value]]),e.size.value?(N=n(e,k,e.size.value),k.d3plus.r=N?F(N):m):k.d3plus.r=g,k.d3plus.r<.1*o&&!e.small?k.d3plus.label={x:0,y:k.d3plus.r+2*e.labels.padding,w:.6*o,h:f+g-k.d3plus.r,resize:!1}:delete k.d3plus.label}for(ct=a.paths,A=rt=0,$=ct.length;$>rt;A=++rt)for(z=ct[A],v=e.focus.value[0],pt=z.edges,u=at=0,et=pt.length;et>at;u=++at)s=pt[u],b=s[e.edges.source][e.id.value]===v?"target":"source",h="target"===b?"source":"target",w=s[e.edges[b]][e.id.value],j[v]!==j[w]?(s.d3plus={spline:!0},null==(P=s[e.edges.source]).d3plus&&(P.d3plus={}),null==(L=s[e.edges.source].d3plus).edges&&(L.edges={}),null==(U=s[e.edges.target]).d3plus&&(U.d3plus={}),null==(D=s[e.edges.target].d3plus).edges&&(D.edges={}),I=s[b].d3plus.x-s[h].d3plus.x,s[h].d3plus.edges[s[b][e.id.value]]={angle:Math.PI,radius:o/2},s[b].d3plus.edges[s[h][e.id.value]]={angle:0,radius:o/2,offset:I-o}):delete s.d3plus,v=w;return{nodes:e.data.app,edges:d}},a.filter=function(e,t){var n,i,o,l,s,u,d,c,p,f,h,v,g,m,y,x,b,w,_;for(l=e.edges.filtered||e.edges.value,a.paths=r(l,e.focus.value[0],{target:e.focus.value[1],distance:e.edges.size||void 0,nodeid:e.id.value,startpoint:e.edges.source,endpoint:e.edges.target,K:e.edges.limit.value||5}),a.nodes=[],n=[],w=a.paths,v=0,y=w.length;y>v;v++)for(c=w[v],_=c.edges,g=0,x=_.length;x>g;g++)o=_[g],f=o[e.edges.source],h=o[e.edges.target],n.indexOf(f[e.id.value])<0&&(a.nodes.push(f),n.push(f[e.id.value])),n.indexOf(h[e.id.value])<0&&(a.nodes.push(h),n.push(h[e.id.value]));for(u=d3plus.util.uniques(a.nodes,e.id.value),p=[],m=0,b=u.length;b>m;m++)s=u[m],i=t.filter(function(t){return t[e.id.value]===s}),i[0]?p.push(i[0]):(d={d3plus:{}},d[e.id.value]=s,p.push(d));return p},a.nesting=!1,a.requirements=[function(e){return{status:2===e.focus.value.length,text:e.format.locale.value.method.focus+" x 2"}},"edges"],a.scale=1,a.shapes=["circle","square","donut"],a.tooltip="static",t.exports=a},{"../../core/fetch/value.js":51,"../../network/shortestPath.coffee":165}],248:[function(e,t){var n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),i=function(e){var t=d3.min([e.height.viz,e.width.viz])/2,i=e.small||!e.labels.value?(t-2*e.labels.padding)/2:t/3,o=e.small||!e.labels.value?1.4*i:i,l=2*i,s=[],u=[],d=e.data.app.filter(function(t){return t[e.id.value]===e.focus.value[0]})[0];d||(d={d3plus:{}},d[e.id.value]=e.focus.value[0]),d.d3plus.x=e.width.viz/2,d.d3plus.y=e.height.viz/2,d.d3plus.r=.65*o;var c=[],p=[e.focus.value[0]];e.edges.connections(e.focus.value[0],e.id.value).forEach(function(t){var n=t[e.edges.source][e.id.value]==e.focus.value[0]?t[e.edges.target]:t[e.edges.source],r=e.data.app.filter(function(t){return t[e.id.value]===n[e.id.value]})[0];r||(r={d3plus:{}},r[e.id.value]=n[e.id.value]),r.d3plus.edges=e.edges.connections(r[e.id.value],e.id.value).filter(function(t){return t[e.edges.source][e.id.value]!=e.focus.value[0]&&t[e.edges.target][e.id.value]!=e.focus.value[0]}),r.d3plus.edge=t,p.push(r[e.id.value]),c.push(r)});var f=e.order.value||e.color.value||e.size.value||e.id.value;c.sort(function(t,n){var r=t.d3plus.edges.length-n.d3plus.edges.length;return r?r:d3plus.array.sort([t,n],f,e.order.sort.value,e.color.value||[],e)}),"number"==typeof e.edges.limit.value?c=c.slice(0,e.edges.limit.value):"function"==typeof e.edges.limit.value&&(c=e.edges.limit.value(c));var h=[],v=0;c.forEach(function(t){var n=t[e.id.value];t.d3plus.edges=t.d3plus.edges.filter(function(t){var r=t[e.edges.source][e.id.value],a=t[e.edges.target][e.id.value];return p.indexOf(r)<0&&a==n||p.indexOf(a)<0&&r==n}),v+=t.d3plus.edges.length||1,t.d3plus.edges.forEach(function(t){var r=t[e.edges.source],a=t[e.edges.target],i=a[e.id.value]==n?r:a;p.push(i[e.id.value])})}),d3plus.array.sort(c,f,e.order.sort.value,e.color.value||[],e);var g=0,m=2*Math.PI,y=0;c.forEach(function(t,n){var r=t.d3plus.edges.length||1,i=m/v*r;0==n&&(y=s,g-=i/2);var s=g+i/2;s-=m/4,t.d3plus.radians=s,t.d3plus.x=e.width.viz/2+o*Math.cos(s),t.d3plus.y=e.height.viz/2+o*Math.sin(s),g+=i,t.d3plus.edges.sort(function(n,r){var n=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source],r=r[e.edges.source][e.id.value]==t[e.id.value]?r[e.edges.target]:r[e.edges.source];return d3plus.array.sort([n,r],f,e.order.sort.value,e.color.value||[],e)}),t.d3plus.edges.forEach(function(n,i){var o=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source],u=m/v,d=e.data.app.filter(function(t){return t[e.id.value]===o[e.id.value]})[0];d||(d={d3plus:{}},d[e.id.value]=o[e.id.value]),a=s-u*r/2+u/2+u*i,d.d3plus.radians=a,d.d3plus.x=e.width.viz/2+l*Math.cos(a),d.d3plus.y=e.height.viz/2+l*Math.sin(a),h.push(d)})});var x=d3.min(d3plus.util.distances(c,function(e){return[e.d3plus.x,e.d3plus.y]})),b=d3.min(d3plus.util.distances(h,function(e){return[e.d3plus.x,e.d3plus.y]}));if(x||(x=i/2),b||(b=i/4),8>x/2-4)var w=d3.min([x/2,8]);else var w=x/2-4;if(4>b/2-4)var _=d3.min([b/2,4]);else var _=b/2-4;_>i/10&&(_=i/10),_>w?_=.75*w:w>1.5*_&&(w=1.5*_),w=Math.floor(w),_=Math.floor(_);var k=d3plus.util.uniques(c,e.id.value);k=k.concat(d3plus.util.uniques(h,e.id.value)),k.push(e.focus.value[0]);var z=e.data.app.filter(function(t){return k.indexOf(t[e.id.value])>=0});if(e.size.value){var A=d3.extent(z,function(t){return n(e,t,e.size.value)});A[0]==A[1]&&(A[0]=0);var t=d3.scale.linear().domain(A).rangeRound([3,d3.min([w,_])]),j=n(e,d,e.size.value);d.d3plus.r=t(j)}else{var t=d3.scale.linear().domain([1,2]).rangeRound([w,_]);e.edges.label&&(d.d3plus.r=1.5*t(1))}return h.forEach(function(r){r.d3plus.ring=2;var a=e.size.value?n(e,r,e.size.value):2;r.d3plus.r=t(a)}),c.forEach(function(r){r.d3plus.ring=1;var a=e.size.value?n(e,r,e.size.value):1;r.d3plus.r=t(a)}),u=[d].concat(c).concat(h),c.forEach(function(t){var n=[e.edges.source,e.edges.target],r=t.d3plus.edge;n.forEach(function(t){r[t]=u.filter(function(n){return n[e.id.value]==r[t][e.id.value]})[0]}),delete r.d3plus,s.push(r),e.edges.connections(t[e.id.value],e.id.value).forEach(function(n){var r=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source];if(r[e.id.value]!=d[e.id.value]){var a=h.filter(function(t){return t[e.id.value]==r[e.id.value]})[0];if(a);else{a=c.filter(function(t){return t[e.id.value]==r[e.id.value]})[0]}if(a){n.d3plus={spline:!0,translate:{x:e.width.viz/2,y:e.height.viz/2}};var o=[e.edges.source,e.edges.target];o.forEach(function(r,o){n[r]=u.filter(function(t){return t[e.id.value]==n[r][e.id.value]})[0],void 0===n[r].d3plus.edges&&(n[r].d3plus.edges={});var l=0===o?n[e.edges.target][e.id.value]:n[e.edges.source][e.id.value];n[r].d3plus.edges[l]=n[r][e.id.value]==t[e.id.value]?{angle:t.d3plus.radians+Math.PI,radius:i/2}:{angle:a.d3plus.radians,radius:i/2}}),s.push(n)}}})}),u.forEach(function(t){if(!e.small&&e.labels.value)if(t[e.id.value]!=e.focus.value[0]){t.d3plus.rotate=t.d3plus.radians*(180/Math.PI);var n=t.d3plus.rotate,a=i-3*e.labels.padding-t.d3plus.r;if(-90>n||n>90){n-=180;var l=-(t.d3plus.r+a/2+e.labels.padding),s="end"}else var l=t.d3plus.r+a/2+e.labels.padding,s="start";var u=c.indexOf(t)>=0?!0:!1,d=1==t.d3plus.ring?x:b;d+=2*e.labels.padding,t.d3plus.label={x:l,y:0,w:a,h:d,angle:n,anchor:s,valign:"center",color:d3plus.color.legible(r(e,t[e.id.value])),resize:[8,e.labels.font.size],background:u,mouse:!0}}else if(e.size.value||e.edges.label){var d=o-2*t.d3plus.r-2*e.labels.padding;t.d3plus.label={x:0,y:t.d3plus.r+d/2,w:o,h:d,color:d3plus.color.legible(r(e,t[e.id.value])),resize:[10,40],background:!0,mouse:!0}}else delete t.d3plus.rotate,delete t.d3plus.label;else delete t.d3plus.rotate,delete t.d3plus.label}),e.mouse[d3plus.evt.click]=function(t){t[e.id.value]!=e.focus.value[0]&&(d3plus.tooltip.remove(e.type.value),e.self.focus(t[e.id.value]).draw())},{edges:s,nodes:u,data:z}};i.filter=function(e,t){var n=e.edges.connections(e.focus.value[0],e.id.value,!0),r=[];n.forEach(function(t){r=r.concat(e.edges.connections(t[e.id.value],e.id.value,!0))});var a=n.concat(r),i=d3plus.util.uniques(a,e.id.value),o=[];return i.forEach(function(n){var r=t.filter(function(t){return t[e.id.value]==n})[0];if(r)o.push(r);else{var a={d3plus:{}};a[e.id.value]=n,o.push(a)}}),o},i.nesting=!1,i.scale=1,i.shapes=["circle","square","donut"],i.requirements=["edges","focus"],i.tooltip="static",t.exports=i},{"../../core/fetch/color.js":48,"../../core/fetch/value.js":51}],249:[function(e,t){var n=e("./chart.js"),r=function(e){return n(e)};r.fill=!0,r.requirements=["data","x","y"],r.scale=n.scale,r.setup=n.setup,r.shapes=["circle","square","donut"],r.tooltip="static",t.exports=r},{"./chart.js":243}],250:[function(e,t){var n=e("./chart.js"),r=e("../../core/data/threshold.js"),a=function(e){return n(e)};a.filter=function(e,t){return r(e,t,e.x.value)},a.requirements=["data","x","y"],a.setup=function(e){e.self.x({scale:"continuous",zerofill:!0}).y({stacked:!0});
var t=e.y,n=e.size;!t.value&&n.value||n.changed&&n.previous===t.value?e.self.y(n.value):(!n.value&&t.value||t.changed&&t.previous===n.value)&&e.self.size(t.value)},a.shapes=["area"],a.threshold=function(e){return 20/e.height.viz},a.tooltip="static",t.exports=a},{"../../core/data/threshold.js":47,"./chart.js":243}],251:[function(e,t){var n=e("../../core/data/threshold.js"),r=e("../../core/fetch/value.js"),a=function(e){var t=d3.nest();e.id.nesting.forEach(function(n,a){a<e.depth.value&&t.key(function(t){return r(e,t.d3plus,n)})});var n=[];e.data.app.forEach(function(t){var a=r(e,t,e.size.value);a&&"number"==typeof a&&n.push({d3plus:t,id:t[e.id.value],value:r(e,t,e.size.value)})}),t=t.entries(n);var a=d3.layout.treemap().mode(e.type.mode.value).round(!0).size([e.width.viz,e.height.viz]).children(function(e){return e.values}).padding(1).sort(function(e,t){var n=e.value-t.value;return 0===n?e.id<t.id:n}).nodes({name:"root",values:t}).filter(function(e){return!e.values&&e.area});if(a.length){for(var i=a[0];i.parent;)i=i.parent;var o=[];a.forEach(function(e){e.d3plus.d3plus=d3plus.object.merge(e.d3plus.d3plus,{x:e.x+e.dx/2,y:e.y+e.dy/2,width:e.dx,height:e.dy,share:e.value/i.value}),o.push(e.d3plus)})}return o};a.filter=function(e,t){return n(e,t)},a.modes=["squarify","slice","dice","slice-dice"],a.requirements=["data","size"],a.shapes=["square"],a.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},a.tooltip="follow",t.exports=a},{"../../core/data/threshold.js":47,"../../core/fetch/value.js":51}],252:[function(){d3plus.ui.drawer=function(e){var t=e.ui.value&&e.ui.value.length,n=e.ui.position.value;e.dev.value&&t&&d3plus.console.time("drawing custom UI elements");var r=e.container.value.selectAll("div#d3plus_drawer").data(["d3plus_drawer"]);r.enter().append("div").attr("id","d3plus_drawer");var a={};e.ui.position.accepted.forEach(function(t){a[t]=t==n?e.margin.bottom+"px":"auto"}),r.style("text-align",e.ui.align.value).style("position","absolute").style("width",e.width.value-2*e.ui.padding+"px").style("height","auto").style(a);var i=r.selectAll("div.d3plus_drawer_ui").data(t?e.ui.value:[],function(e){return e.method||!1});i.enter().append("div").attr("class","d3plus_drawer_ui").style("padding",e.ui.padding+"px").style("display","inline-block").each(function(t){var n=d3.select(this);t.form=d3plus.form().container(n).focus(e[t.method].value,function(n){n[0]!==e[t.method].value&&e.self[t.method](n[0]).draw()}).id("id").text("text").type("auto")}),i.each(function(t){var n=[],r=e.format.locale.value.method[t.method]||t.method;t.value.forEach(function(t){var r={id:t,text:e.format.value(t)};n.push(r)});var a=d3plus.util.copy(e.ui.font);a.secondary=e.ui.font,t.form.data(n).font(a).format(e.format.locale.language).title(e.format.value(r)).ui({align:e.ui.align.value,padding:e.ui.padding,margin:0}).width(t.width||!1).draw()}),i.exit().remove();var o=r.node().offsetHeight||r.node().getBoundingClientRect().height;o&&(e.margin[n]+=o),e.dev.value&&t&&d3plus.console.timeEnd("drawing custom UI elements")}},{}],253:[function(e){var t=e("../../core/fetch/value.js");d3plus.ui.focus=function(e){if(!e.internal_error&&1===e.focus.value.length&&e.focus.value.length&&!e.small&&e.focus.tooltip.value){e.dev.value&&d3plus.console.time("drawing focus tooltip");var n=e.data.pool.filter(function(n){return t(e,n,e.id.value)==e.focus.value[0]});n.length>=1?n=n[0]:(n={},n[e.id.value]=e.focus.value[0]);var r=e.labels.padding;d3plus.tooltip.app({anchor:"top left",arrow:!1,data:n,length:"long",fullscreen:!1,id:e.type.value+"_focus",maxheight:e.height.viz-2*r,mouseevents:!0,offset:0,vars:e,x:e.width.value-e.margin.right-r,y:e.margin.top+r,width:e.tooltip.large}),d3.select("div#d3plus_tooltip_id_"+e.type.value+"_focus").empty()||(e.width.viz-=e.tooltip.large+2*r),e.dev.value&&d3plus.console.timeEnd("drawing focus tooltip")}else d3plus.tooltip.remove(e.type.value+"_focus")}},{"../../core/fetch/value.js":51}],254:[function(){d3plus.ui.history=function(e){function t(t){t.style("position","absolute").style("left",e.ui.padding+"px").style("top",e.margin.top/2-r/2+"px").style("color",a).style("font-family",i).style("font-weight",o).style("font-size",r+"px").style("z-index",2e3)}if(!e.small&&e.history.states.length>0){e.dev.value&&d3plus.console.time("drawing back button");var n=e.container.value.selectAll("div#d3plus_back_button").data(["d3plus_back_button"]),r=e.title.value?e.title.font.size:e.title.sub.font.size,a=e.title.sub.value?e.title.sub.font.color:e.title.font.color,i=e.title.sub.value?e.title.sub.font.family.value:e.title.font.family.value,o=e.title.sub.value?e.title.sub.font.weight:e.title.font.weight,l=e.title.sub.value?e.title.sub.padding:e.title.padding,s=r+2*l;e.margin.top<s&&(e.margin.top=s);{n.enter().append("div").attr("id","d3plus_back_button").style("opacity",0).call(t).html(function(){if(d3plus.font.awesome)var t="<span style='font-family:FontAwesome;margin-right:5px;'>&#xf104</span>";else var t="&laquo; ";return t+e.format.value(e.format.locale.value.ui.back)})}n.on(d3plus.evt.over,function(){!e.small&&e.history.states.length>0&&d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("color",d3plus.color.lighter(a,.25))}).on(d3plus.evt.out,function(){!e.small&&e.history.states.length>0&&d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("color",a)}).on(d3plus.evt.click,function(){e.history.back()}).transition().duration(e.draw.timing).style("opacity",1).call(t),e.dev.value&&d3plus.console.timeEnd("drawing back button")}else e.container.value.selectAll("div#d3plus_back_button").transition().duration(e.draw.timing).style("opacity",0).remove()}},{}],255:[function(e){var t=e("../../core/data/nest.js"),n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),a=e("../../core/fetch/text.js");d3plus.ui.legend=function(e){function i(t){t.attr("transform",function(t,n){var r=b+n*(e.ui.padding+s);return"translate("+r+","+e.ui.padding+")"})}function o(t){t.attr("width",s).attr("height",s).attr("fill",function(t){d3.select(this.parentNode).selectAll("text").remove();var i="depth"in t.d3plus?t.d3plus.depth:e.depth.value,o=e.id.nesting[i],l=n(e,t,e.icon.value,o),u=r(e,t,o);if(l&&"null"!==l){var c=d3plus.string.strip(l+"_"+u),p=e.icon.style.value,f=e.defs.selectAll("pattern#"+c).data([c]);if("string"==typeof p)var h=e.icon.style.value;else if(d3plus.object.validate(p)&&p[o])var h=p[o];else var h="default";var u="knockout"==h?u:"none";f.select("rect").transition().duration(e.draw.timing).attr("fill",u).attr("width",s).attr("height",s),f.select("image").transition().duration(e.draw.timing).attr("width",s).attr("height",s);var v=f.enter().append("pattern").attr("id",c).attr("width",s).attr("height",s);return v.append("rect").attr("fill",u).attr("width",s).attr("height",s),v.append("image").attr("xlink:href",l).attr("width",s).attr("height",s).each(function(){0==l.indexOf("/")||l.indexOf(window.location.hostname)>=0?d3plus.util.dataurl(l,function(e){f.select("image").attr("xlink:href",e)}):f.select("image").attr("xlink:href",l)}),"url(#"+c+")"}var g=d3.select(this.parentNode).append("text");return g.attr("font-size",e.legend.font.size).attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).style("text-anchor","start").attr("fill",d3plus.color.text(u)).attr("x",0).attr("y",0).each(function(t){var r=e.id.nesting.indexOf(M),i=r>=0?a(e,t,r):[e.format.value(n(e,t,d,M))];1===i.length&&i[0].length&&d3plus.textwrap().container(d3.select(this)).height(s-2*e.ui.padding).resize(e.labels.resize.value).text(i[0]).width(s-2*e.ui.padding).draw()}).attr("y",function(){var e=this.getBBox().height,t=parseFloat(d3.select(this).style("font-size"),10)/5;return s/2-e/2-t/2}).selectAll("tspan").attr("x",function(){var e=this.getComputedTextLength();return s/2-e/2}),g.select("tspan").empty()&&g.remove(),u})}var l=!0,s=0,u=e.color.value,d=e.color.value||"d3plus_color";if(!e.internal_error&&u&&!e.small&&e.legend.value)if(e.color.valueScale)if(e.color.valueScale){e.dev.value&&d3plus.console.time("drawing color scale"),e.g.legend.selectAll("g.d3plus_color").transition().duration(e.draw.timing).attr("opacity",0).remove();var c=e.color.valueScale.domain(),p=e.color.valueScale.range();c.length<=2&&(c=d3plus.util.buckets(c,6));var f=e.g.legend.selectAll("g.d3plus_scale").data(["scale"]);f.enter().append("g").attr("class","d3plus_scale").attr("opacity",0);var h=f.selectAll("#d3plus_legend_heatmap").data(["heatmap"]);h.enter().append("linearGradient").attr("id","d3plus_legend_heatmap").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");var v=h.selectAll("stop").data(d3.range(0,p.length));v.enter().append("stop").attr("stop-opacity",1),v.attr("offset",function(e){return Math.round(e/(p.length-1)*100)+"%"}).attr("stop-color",function(e){return p[e]}),v.exit().remove();var g=f.selectAll("rect#gradient").data(["gradient"]);g.enter().append("rect").attr("id","gradient").attr("x",function(){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",e.ui.padding).attr("width",0).attr("height",e.legend.gradient.height).attr("stroke",e.legend.font.color).attr("stroke-width",1).style("fill","url(#d3plus_legend_heatmap)");var m=f.selectAll("text.d3plus_tick").data(d3.range(0,c.length));m.enter().append("text").attr("class","d3plus_tick").attr("x",function(){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",function(){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding});var y=0;m.order().attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).attr("font-size",e.legend.font.size).style("text-anchor",e.legend.font.align).attr("fill",e.legend.font.color).text(function(t){return e.format.value(c[t],u)}).attr("y",function(){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding}).each(function(){var e=this.offsetWidth;e>y&&(y=e)}),y+=2*e.labels.padding;var x=y*(c.length-1);if(x+y<e.width.value){if(x+y<e.width.value/2&&(x=e.width.value/2,y=x/c.length,x-=y),"start"==e.legend.align)var b=e.ui.padding;else if("end"==e.legend.align)var b=e.width.value-e.ui.padding-x;else var b=e.width.value/2-x/2;m.transition().duration(e.draw.timing).attr("x",function(e){return b+y*e}),m.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();var w=f.selectAll("rect.d3plus_tick").data(d3.range(0,c.length));w.enter().append("rect").attr("class","d3plus_tick").attr("x",function(){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",e.ui.padding).attr("width",0).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),w.transition().duration(e.draw.timing).attr("x",function(e){var t=0==e?1:0;return b+y*e-t}).attr("y",e.ui.padding).attr("width",1).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),w.exit().transition().duration(e.draw.timing).attr("width",0).remove(),g.transition().duration(e.draw.timing).attr("x",function(){return"middle"==e.legend.align?e.width.value/2-x/2:"end"==e.legend.align?e.width.value-x-e.ui.padding:e.ui.padding}).attr("y",e.ui.padding).attr("width",x).attr("height",e.legend.gradient.height),f.transition().duration(e.draw.timing).attr("opacity",1),e.dev.value&&d3plus.console.timeEnd("drawing color scale")}else l=!1}else l=!1;else{if(e.dev.value&&d3plus.console.time("grouping data by colors"),e.nodes.value&&e.types[e.type.value].requirements.indexOf("nodes")>=0){var _=e.nodes.restriced||e.nodes.value;if(e.data.app.length)for(var k=0;k<_.length;k++){var z=e.data.app.filter(function(t){return t[e.id.value]===_[k][e.id.value]});z.length&&(_[k]=d3plus.object.merge(_[k],z[0]))}}else var _=e.data.app;var A=function(t){return r(e,t,M)},j=0,M=e.id.value;if(e.id.nesting.indexOf(d)>=0)j=e.id.nesting.indexOf(e.color.value),M=e.id.nesting[e.id.nesting.indexOf(d)];else for(var k=0;k<=e.depth.value;k++){j=k,M=e.id.nesting[k];var E=d3plus.util.uniques(_,function(t){return n(e,t,M)}),S=d3plus.util.uniques(_,A);if(E.length===S.length&&S.length>1)break}var p=t(e,_,[A],[]);e.dev.value&&d3plus.console.timeEnd("grouping data by color");var T=e.width.value;s=e.legend.size;var x=s*p.length+e.ui.padding*(p.length+1);if(s instanceof Array){e.dev.value&&d3plus.console.time("calculating legend size");for(var k=s[1];k>=s[0];k--)if(x=k*p.length+e.ui.padding*(p.length+1),T>=x){s=k;break}e.dev.value&&d3plus.console.timeEnd("calculating legend size")}else"number"!=typeof s&&s!==!1&&(s=30);if(x>T||1==p.length)l=!1;else{x-=2*e.ui.padding,e.dev.value&&d3plus.console.time("sorting legend");var O=e[e.legend.order.value].value;if(d3plus.array.sort(p,O,e.legend.order.sort.value,d,e),e.dev.value&&d3plus.console.timeEnd("sorting legend"),e.dev.value&&d3plus.console.time("drawing legend"),"start"==e.legend.align)var b=e.ui.padding;else if("end"==e.legend.align)var b=T-e.ui.padding-x;else var b=T/2-x/2;e.g.legend.selectAll("g.d3plus_scale").transition().duration(e.draw.timing).attr("opacity",0).remove();var F=e.g.legend.selectAll("g.d3plus_color").data(p,function(t){var a=r(e,t,M),i=n(e,t,d);return a+i}),V=F.enter().append("g").attr("class","d3plus_color").attr("opacity",0).call(i);V.append("rect").attr("class","d3plus_color").call(o),d3plus.touch||F.on(d3plus.evt.over,function(t,r){d3.select(this).style("cursor","pointer");var i=b+r*(e.ui.padding+s),o=d3.transform(d3.select(this.parentNode).attr("transform")).translate[1];i+=s/2,o+=e.ui.padding+s/2;var l=e.id.nesting.indexOf(M),u=l>=0?a(e,t,l)[0]:e.format.value(n(e,t,d,M));d3plus.tooltip.app({data:t,footer:!1,vars:e,x:i,y:o,title:u,offset:.4*s})}).on(d3plus.evt.out,function(){d3plus.tooltip.remove(e.type.value)}),F.order().transition().duration(e.draw.timing).attr("opacity",1).call(i),F.selectAll("rect.d3plus_color").transition().duration(e.draw.timing).call(o),F.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.dev.value&&d3plus.console.timeEnd("drawing legend")}}else l=!1;if(e.legend.value&&u&&l){if(e.dev.value&&d3plus.console.time("positioning legend"),s)var N=s+e.ui.padding;else var B=e.g.legend.node().getBBox(),N=B.height+B.y-e.ui.padding;0===e.margin.bottom&&(e.margin.bottom+=e.ui.padding),e.margin.bottom+=N,e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+(e.height.value-e.margin.bottom)+")"),e.dev.value&&d3plus.console.timeEnd("positioning legend")}else e.dev.value&&d3plus.console.time("hiding legend"),e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+e.height.value+")"),e.dev.value&&d3plus.console.timeEnd("hiding legend")}},{"../../core/data/nest.js":46,"../../core/fetch/color.js":48,"../../core/fetch/text.js":50,"../../core/fetch/value.js":51}],256:[function(){d3plus.ui.message=function(e,t){function n(t){t.style(a).style("position","absolute").style("background",o).style("text-align","center").style("left",function(){return"center"==i?"50%":"0px"}).style("width",function(){return"center"==i?"auto":e.width.value+"px"}).style("margin-left",function(){var t=e.width.value-e.width.viz;return"center"==i?-(this.offsetWidth/2+t/2)+"px":"0px"}).style("top",function(){return"center"==i?"50%":"top"==i?"0px":"auto"}).style("bottom",function(){return"bottom"==i?"0px":"auto"}).style("margin-top",function(){if("large"==r){var e=this.offsetHeight||this.getBoundingClientRect().height;return-e/2+"px"}return"0px"})}var t=e.messages.value?t:null,r=t==e.internal_error?"large":e.messages.style;if("large"==r)var a=e.messages,i="center";else{if(e.footer.value)var a=e.footer;else if(e.title.value)var a=e.title;else if(e.title.sub.value)var a=e.title.sub;else if(e.title.total.value)var a=e.title.total;else var a=e.title.sub;var i=a.position}var a={color:a.font.color,"font-family":a.font.family.value,"font-weight":a.font.weight,"font-size":a.font.size+"px",padding:a.padding+"px"},o="none"!=e.background.value?e.background.value:"white";e.g.message=e.container.value.selectAll("div#d3plus_message").data(["message"]),e.g.message.enter().append("div").attr("id","d3plus_message").attr("opacity",0);var l=t?1:0,s=t?t:e.g.message.text(),u=t?"inline-block":"none";e.g.message.text(s).style("opacity",l).style("display",u).call(n)}},{}],257:[function(){d3plus.ui.timeline=function(e){var t=[];if(e.data.time.values.forEach(function(e){t.push(new Date(e))}),(!e.internal_error||!e.data.missing)&&!e.small&&t&&t.length>1&&e.timeline.value){e.dev.value&&d3plus.console.time("drawing timeline");var n=e.time.format.value||e.data.time.format,r=e.time.format.value||e.data.time.multiFormat;if(e.time.value==e.x.value&&"continuous"==e.x.scale.value||e.time.value==e.y.value&&"continuous"==e.y.scale.value)var a=2;else var a=1;if(e.time.solo.value.length){for(var i=d3.extent(e.time.solo.value),o=0;o<i.length;o++)if(i[o].constructor!==Date){var l=new Date(i[o].toString());l.setTime(l.getTime()+60*l.getTimezoneOffset()*1e3),i[o]=l}}else var i=d3.extent(t);var s=t[0],u=new Date(i[0]),d=new Date(i[1]);t=e.data.time.ticks;var c=t.slice(),l=new Date(s);l["set"+e.data.time.stepType](l["get"+e.data.time.stepType]()+t.length),c.push(l),d["set"+e.data.time.stepType](d["get"+e.data.time.stepType]()+1),u=d3plus.util.closest(c,u),d=d3plus.util.closest(c,d);for(var p=c.slice(0),o=0;o<p.length;o++)p[o]=p[o].getTime();var f=p.indexOf(u.getTime()),h=p.indexOf(d.getTime()),v=function(){if(null!==d3.event.sourceEvent){M=B.extent();var e=d3plus.util.closest(c,M[0]),n=d3plus.util.closest(c,M[1]);if(e===n&&(f=p.indexOf(e.getTime()),e<M[0]||0===f?n=c[f+1]:e=c[f-1]),f=p.indexOf(e.getTime()),h=p.indexOf(n.getTime()),h-f>=a)var r=[e,n];else if(f+a<=t.length)var r=[e,c[f+a]];else{for(var r=[e],i=1;a>=i;i++)f+i<=t.length?r.push(c[f+i]):r.unshift(c[f-(f+i-t.length)]);r=[r[0],r[r.length-1]]}M=r,V.attr("fill",E),d3.select(this).call(B.extent(r))}},g=function(){if(null!==d3.event.sourceEvent){if(e.time.solo.value.length)var n=d3.extent(e.time.solo.value),r=p.indexOf(d3plus.util.closest(c,n[0]).getTime()),a=p.indexOf(d3plus.util.closest(c,n[1]).getTime())+1,i=r!==f||a!==h;else var i=h-f!==t.length;if(i){if(h-f==t.length)var o=[];else var o=d3.range(f,h).map(function(n){var r=e.data.time.dataSteps.indexOf(n);return r>=0?e.data.time.values[r]:t[n]});e.self.time({solo:o}).draw()}}},m={"font-weight":e.ui.font.weight,"font-family":e.ui.font.family.value,"font-size":e.ui.font.size,"text-anchor":"middle"},y=function(e,a){return 0===a||a===t.length-1?n(e):r(e)},x=d3plus.font.sizes(t.map(y),m),b=x.map(function(e){return e.width}),w=d3.max(b),_=d3.max(x.map(function(e){return e.height})),k=w+2*e.ui.padding,z=_+2*e.ui.padding;timeline_width=k*t.length,available_width=e.width.value-2*e.ui.padding,tickStep=1,textRotate=0,timeline_width>available_width&&(k=_+2*e.ui.padding,z=w+2*e.ui.padding,timeline_width=k*t.length,textRotate=90),z=d3.max([z,e.timeline.height.value]);var A=k;if(timeline_width>available_width&&(timeline_width=available_width,A=k-2*e.ui.padding,k=timeline_width/t.length,A>k))for(tickStep=Math.ceil(A/(timeline_width/t.length));tickStep<t.length-1&&(t.length-1)%tickStep!=0;tickStep++);if("start"==e.timeline.align)var j=e.ui.padding;else if("end"==e.timeline.align)var j=e.width.value-e.ui.padding-timeline_width;else var j=e.width.value/2-timeline_width/2;var M=[u,d],E=function(t){if(t>=M[0]&&t<M[1])var n=1,r=d3plus.color.text(e.ui.color.primary.value);else var n=.5,r=d3plus.color.text(e.ui.color.secondary.value);var r=d3.rgb(r);return"rgba("+r.r+","+r.g+","+r.b+","+n+")"},S=e.g.timeline.selectAll("rect.d3plus_timeline_background").data(["background"]);S.enter().append("rect").attr("class","d3plus_timeline_background").attr("shape-rendering","crispEdges").attr("width",timeline_width+2).attr("height",z+2).attr("fill",e.ui.color.secondary.value).attr("x",j-1).attr("y",e.ui.padding),S.transition().duration(e.draw.timing).attr("width",timeline_width+2).attr("height",z+2).attr("fill",e.ui.color.secondary.value).attr("x",j-1).attr("y",e.ui.padding);var T=e.g.timeline.selectAll("g#ticks").data(["ticks"]);T.enter().append("g").attr("id","ticks").attr("transform","translate("+e.width.value/2+","+e.ui.padding+")");var O=e.g.timeline.selectAll("g#brush").data(["brush"]);O.enter().append("g").attr("id","brush");var F=e.g.timeline.selectAll("g#labels").data(["labels"]);F.enter().append("g").attr("id","labels");var V=F.selectAll("text").data(t,function(e,t){return t});V.enter().append("text").attr("y",0).attr("dy","0.5ex").attr("x",0),V.order().attr(m).text(function(a,i){if(0===i||i===t.length-1)return n(a);{var o=(i-1)%tickStep===0,l=(i+1)%tickStep===0,s=e.data.time.dataSteps.indexOf(i)>=0;b[i-1]/2+b[i]+b[i+1]/2+4*e.ui.padding<2*k}return i%tickStep===0||!o&&!l&&s&&3*k>A?r(a):""}).attr("opacity",function(t,n){return e.data.time.dataSteps.indexOf(n)>=0?1:.4}).attr("fill",E).attr("transform",function(t,n){var r=j+k*n+k/2,a=z/2+e.ui.padding+1;return"translate("+Math.round(r)+","+Math.round(a)+")rotate("+textRotate+")"}),V.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();var N=d3.time.scale().domain(d3.extent(c)).rangeRound([0,timeline_width]),B=d3.svg.brush().x(N).extent(M).on("brush",v).on("brushend",g);if(T.attr("transform","translate("+j+","+e.ui.padding+")").transition().duration(e.draw.timing).call(d3.svg.axis().scale(N).orient("top").ticks(function(){return c}).tickFormat("").tickSize(-z).tickPadding(0)).selectAll("path").attr("fill","none"),T.selectAll("line").attr("stroke",e.timeline.tick).attr("stroke-width",1).attr("shape-rendering","crispEdges"),O.attr("transform","translate("+j+","+(e.ui.padding+1)+")").attr("opacity",1).call(B),V.attr("pointer-events","none"),O.selectAll("rect.background").attr("fill","none").style("visibility","visible").attr("height",z).attr("shape-rendering","crispEdges").on(d3plus.evt.move,function(){var t=e.timeline.hover.value;["grab","grabbing"].indexOf(t)>=0&&(t=d3plus.prefix()+t),d3.select(this).style("cursor",t)}),O.selectAll("rect.extent").attr("height",z).attr("fill",e.ui.color.primary.value).attr("shape-rendering","crispEdges").on(d3plus.evt.move,function(){var t=e.timeline.hover.value;["grab","grabbing"].indexOf(t)>=0&&(t=d3plus.prefix()+t),d3.select(this).style("cursor",t)}),e.timeline.handles.value){var I=O.selectAll("g.resize").selectAll("rect.d3plus_handle").data(["d3plus_handle"]);I.enter().insert("rect","rect").attr("class","d3plus_handle"),I.attr("fill",e.timeline.handles.color).attr("transform",function(){var t="resize e"===this.parentNode.className.baseVal?-e.timeline.handles.size:0;return"translate("+t+",0)"}).attr("width",e.timeline.handles.size).style("visibility","visible").attr("shape-rendering","crispEdges").attr("opacity",e.timeline.handles.opacity).on(d3plus.evt.over,function(){d3.select(this).select("rect").transition().duration(e.timing.mouseevents).attr("fill",e.timeline.handles.hover)}).on(d3plus.evt.out,function(){d3.select(this).select("rect").transition().duration(e.timing.mouseevents).attr("fill",e.timeline.handles.color)}),O.selectAll("g.resize").selectAll("rect").attr("height",z)}else O.selectAll("g.resize").remove();0===e.margin.bottom&&(e.margin.bottom+=e.ui.padding);var q=e.g.timeline.node().getBBox();e.margin.bottom+=q.height+q.y,e.g.timeline.transition().duration(e.draw.timing).attr("transform","translate(0,"+Math.round(e.height.value-e.margin.bottom-e.ui.padding/2)+")"),e.margin.bottom+=e.ui.padding,e.dev.value&&d3plus.console.time("drawing timeline")}else e.g.timeline.transition().duration(e.draw.timing).attr("transform","translate(0,"+e.height.value+")")}},{}],258:[function(e){var t=e("../../core/fetch/value.js");d3plus.ui.titles=function(e){function n(t){t.style("text-anchor",function(e){var t=e.style.font.align;return"center"==t?"middle":"left"==t&&!d3plus.rtl||"right"==t&&d3plus.rtl?"start":"left"==t&&d3plus.rtl||"right"==t&&!d3plus.rtl?"end":void 0}).attr("x",function(t){var n=t.style.font.align;return"center"==n?e.width.value/2:"left"==n&&!d3plus.rtl||"right"==n&&d3plus.rtl?e.padding:"left"==n&&d3plus.rtl||"right"==n&&!d3plus.rtl?e.width.value-e.padding:void 0}).attr("y",0)}function r(t){t.attr("font-size",function(e){return e.style.font.size}).attr("fill",function(t){return t.link?e.links.font.color:t.style.font.color}).attr("font-family",function(t){return t.link?e.links.font.family.value:t.style.font.family.value}).attr("font-weight",function(t){return t.link?e.links.font.weight:t.style.font.weight}).style("text-decoration",function(t){return t.link?e.links.font.decoration.value:t.style.font.decoration.value}).style("text-transform",function(t){return t.link?e.links.font.transform.value:t.style.font.transform.value})}var a=e.size.value?e.size.value:"number"===e.color.type?e.color.value:!1;if(e.data.app&&e.title.total.value&&!e.small)if(a){if(e.dev.value&&d3plus.console.time("calculating total value"),e.focus.value.length){var i=e.data.app.filter(function(t){return t[e.id.value]==e.focus.value[0]});i=d3.sum(i,function(n){return t(e,n,a)})}else var i=d3.sum(e.data.pool,function(n){return t(e,n,a)});if(0===i&&(i=!1),"number"==typeof i){var o="";if(e.data.mute.length||e.data.solo.length||e.focus.value.length){var l=d3.sum(e.data.value,function(n){if(e.time.solo.value.length>0)var r=e.time.solo.value.indexOf(t(e,n,e.time.value))>=0;else if(e.time.mute.value.length>0)var r=e.time.solo.value.indexOf(t(e,n,e.time.value))<0;else var r=!0;return r?t(e,n,a):void 0});if(l>i)var o=i/l*100,s=e.format.value(l,e.size.value),o=" ("+e.format.value(o,"share")+"% of "+s+")"}i=e.format.value(i,e.size.value);var u=e.title.total.value,d=u.prefix||e.format.value(e.format.locale.value.ui.total)+": ";i=d+i,u.suffix?i+=u.suffix:null,i+=o}e.dev.value&&d3plus.console.timeEnd("calculating total value")}else var i=!1;else var i=!1;var c=[];e.footer.value&&c.push({link:e.footer.link,style:e.footer,type:"footer",value:e.footer.value}),e.small||(e.title.value&&c.push({link:e.title.link,style:e.title,type:"title",value:e.title.value}),e.title.sub.value&&c.push({link:e.title.sub.link,style:e.title.sub,type:"sub",value:e.title.sub.value}),e.title.total.value&&i&&c.push({link:e.title.total.link,style:e.title.total,type:"total",value:i})),e.dev.value&&d3plus.console.time("drawing titles");var p=e.svg.selectAll("g.d3plus_title").data(c,function(e){return e.type}),f=e.title.width||e.width.value;p.enter().append("g").attr("class","d3plus_title").attr("opacity",0).attr("transform",function(t){var n="top"==t.style.position?0:e.height.value;return"translate(0,"+n+")"}).append("text").call(n).call(r),p.each(function(t){d3plus.textwrap().container(d3.select(this).select("text")).height(e.height.value/8).size(!1).text(t.value).width(f).draw(),t.y=e.margin[t.style.position],e.margin[t.style.position]+=this.getBBox().height+2*t.style.padding}).on(d3plus.evt.over,function(t){t.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","pointer").select("text").attr("fill",e.links.hover.color).attr("font-family",e.links.hover.family.value).attr("font-weight",e.links.hover.weight).style("text-decoration",e.links.hover.decoration.value).style("text-transform",e.links.hover.transform.value)}).on(d3plus.evt.out,function(t){t.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","auto").select("text").call(r)}).on(d3plus.evt.click,function(e){if(e.link){var t="/"!=e.link.charAt(0)?"_blank":"_self";window.open(e.link,t)}}).transition().duration(e.draw.timing).attr("opacity",1).attr("transform",function(t){var n=t.style.position,r="top"==n?0+t.y:e.height.value-t.y;return"bottom"==n?r-=this.getBBox().height+t.style.padding:r+=t.style.padding,"translate(0,"+r+")"}).select("text").call(n).call(r),p.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.margin.top>0&&(e.margin.top+=e.title.padding),e.margin.bottom>0&&(e.margin.bottom+=e.title.padding);var h=e.title.height;h&&e.margin[e.title.position]<h&&(e.margin[e.title.position]=h),e.dev.value&&d3plus.console.timeEnd("drawing titles")}},{"../../core/fetch/value.js":51}],259:[function(e){d3plus.viz=function(){var t={g:{apps:{}},types:{bubbles:e("./types/bubbles.js"),chart:e("./types/chart.js"),geo_map:e("./types/geo_map.js"),line:e("./types/line.js"),network:e("./types/network.js"),paths:e("./types/paths.coffee"),rings:e("./types/rings.js"),scatter:e("./types/scatter.js"),stacked:e("./types/stacked.js"),tree_map:e("./types/tree_map.js")},shell:"viz"};t.self=function(e){return e.each(function(){function e(){s=l.shift();var e=t.g.message&&a===s.message,n="check"in s?s.check:!0;if("function"==typeof n&&(n=n(t)),n)if(!e&&t.draw.update){t.dev.value&&(a!==!1&&d3plus.console.groupEnd(),d3plus.console.groupCollapsed(s.message)),a="string"==typeof t.messages.value?t.messages.value:s.message;var r="string"==typeof t.messages.value?t.messages.value:t.format.value(s.message);d3plus.ui.message(t,r),setTimeout(d,10)}else d();else"otherwise"in s?setTimeout(function(){d("otherwise")},10):u()}t.draw.frozen=!0,t.internal_error=null,d3plus.draw.container(t),"timing"in t.draw||(t.draw.timing=t.timing.transitions);var n=t.width.value<=t.width.small,r=t.height.value<=t.height.small;t.small=n||r;var a=!1;if(t.error.value){var i=t.draw.timing;t.group.transition().duration(i).attr("opacity",0),t.g.data.transition().duration(i).attr("opacity",0),t.g.edges.transition().duration(i).attr("opacity",0),t.messages.style="large";var o=t.error.value===!0?t.format.value(t.format.locale.value.ui.error):t.error.value;a=o,d3plus.ui.message(t,o)}else{var l=d3plus.draw.steps(t),s=!1;t.container.value.style("cursor","wait"),t.messages.style=t.group&&"1"===t.group.attr("opacity")?"small":"large";var u=function(){l.length?e():(t.methodGroup=!1,t.dev.value&&(d3plus.console.timeEnd("total draw time"),d3plus.console.groupEnd(),d3plus.console.log("\n")),t.container.value.style("cursor","auto"))},d=function(e){var e=e||"function";s[e]instanceof Array?s[e].forEach(function(e){e(t,u)}):"function"==typeof s[e]&&s[e](t,u),s.wait||u()};e()}}),t.self};var n=["active","aggs","attrs","axes","color","container","coords","csv","data","depth","descs","dev","draw","edges","error","focus","footer","format","height","history","icon","id","labels","legend","margin","messages","nodes","order","shape","size","style","temp","text","time","timeline","title","tooltip","total","type","ui","width","x","y","zoom"],r=["axes","background","color","coords","data","edges","font","footer","height","labels","legend","links","messages","nodes","shape","timeline","timing","title","tooltip","ui","width "];return d3plus.method(t,n,r),t.self}},{"./types/bubbles.js":242,"./types/chart.js":243,"./types/geo_map.js":244,"./types/line.js":245,"./types/network.js":246,"./types/paths.coffee":247,"./types/rings.js":248,"./types/scatter.js":249,"./types/stacked.js":250,"./types/tree_map.js":251}],260:[function(){d3plus.zoom.bounds=function(e,t,n){if(!t)var t=e.zoom.bounds;if("number"!=typeof n)var n=e.timing.transitions;e.zoom.size={height:t[1][1]-t[0][1],width:t[1][0]-t[0][0]};var r=e.coords.fit.value;if("auto"==r||e.types[e.type.value].requirements.indexOf("coords")<0)var a=d3.max([e.zoom.size.width/e.width.viz,e.zoom.size.height/e.height.viz]);else var a=e.zoom.size[r]/e["app_"+r];var i=d3.min([e.width.viz,e.height.viz]),o=(i-2*e.coords.padding)/i/a,l=e.zoom.behavior.scaleExtent();(l[0]==l[1]||t==e.zoom.bounds)&&e.zoom.behavior.scaleExtent([o,16*o]);var s=e.zoom.behavior.scaleExtent()[1];o>s&&(o=s),e.zoom.scale=o;var u=[];u[0]=e.width.viz/2-e.zoom.size.width*o/2-t[0][0]*o,u[1]=e.height.viz/2-e.zoom.size.height*o/2-t[0][1]*o,e.zoom.translate=u,e.zoom.behavior.translate(u).scale(o),e.zoom.size={height:e.zoom.bounds[1][1]-e.zoom.bounds[0][1],width:e.zoom.bounds[1][0]-e.zoom.bounds[0][0]},d3plus.zoom.transform(e,n)}},{}],261:[function(){d3plus.zoom.controls=function(){if(d3.select("#d3plus.utilsts.zoom_controls").remove(),!vars.small){var e=vars.container.value.append("div").attr("id","d3plus.utilsts.zoom_controls").style("top",vars.margin.top+5+"px");
e.append("div").attr("id","zoom_in").attr("unselectable","on").on(d3plus.evt.click,function(){vars.zoom("in")}).text("+"),e.append("div").attr("id","zoom_out").attr("unselectable","on").on(d3plus.evt.click,function(){vars.zoom("out")}).text("-"),e.append("div").attr("id","zoom_reset").attr("unselectable","on").on(d3plus.evt.click,function(){vars.zoom("reset"),vars.draw.update()}).html("&#8634;")}}},{}],262:[function(){d3plus.zoom.labels=function(e){var t=e.zoom.behavior.scaleExtent()[1];e.dev.value&&d3plus.console.time("determining label visibility"),e.draw.timing?e.g.viz.selectAll("text.d3plus_label").transition().duration(e.draw.timing).attr("opacity",function(n){if(!n)var n={scale:t};var r=parseFloat(d3.select(this).attr("font-size"),10);return n.visible=r/n.scale*e.zoom.scale>=7,n.visible?1:0}):e.g.viz.selectAll("text.d3plus_label").attr("opacity",function(n){if(!n)var n={scale:t};var r=parseFloat(d3.select(this).attr("font-size"),10);return n.visible=r/n.scale*e.zoom.scale>=7,n.visible?1:0}),e.dev.value&&d3plus.console.timeEnd("determining label visibility")}},{}],263:[function(){d3plus.zoom.mouse=function(e){var t=d3.event.translate,n=d3.event.scale,r=e.zoom.bounds,a=(e.width.viz-e.zoom.size.width*n)/2,i=a>0?a:0,o=a>0?e.width.viz-a:e.width.viz,l=(e.height.viz-e.zoom.size.height*n)/2,s=l>0?l:0,u=l>0?e.height.viz-l:e.height.viz;if(t[0]+r[0][0]*n>i?t[0]=-r[0][0]*n+i:t[0]+r[1][0]*n<o&&(t[0]=o-r[1][0]*n),t[1]+r[0][1]*n>s?t[1]=-r[0][1]*n+s:t[1]+r[1][1]*n<u&&(t[1]=u-r[1][1]*n),e.zoom.behavior.translate(t).scale(n),e.zoom.translate=t,e.zoom.scale=n,"wheel"==d3.event.sourceEvent.type){var d=e.draw.timing?100:250;clearTimeout(e.zoom.wheel),e.zoom.wheel=setTimeout(function(){d3plus.zoom.labels(e)},d)}else d3plus.zoom.labels(e);"dblclick"===d3.event.sourceEvent.type?d3plus.zoom.transform(e,e.timing.transitions):d3plus.zoom.transform(e,0)}},{}],264:[function(){d3plus.zoom.transform=function(e,t){if("number"!=typeof t)var t=e.timing.transitions;var n=e.zoom.translate,r=e.zoom.scale;t?e.g.viz.transition().duration(t).attr("transform","translate("+n+")scale("+r+")"):e.g.viz.attr("transform","translate("+n+")scale("+r+")")}},{}]},{},[96,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,87,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,88,89,90,91,92,93,94,95,97,98,99,100,109,101,102,103,104,105,106,107,108,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,197,198,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,207,199,200,201,202,203,204,205,206,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,259,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,260,261,262,263,264]);