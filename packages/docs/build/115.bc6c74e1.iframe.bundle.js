"use strict";(self.webpackChunk_d3plus_docs=self.webpackChunk_d3plus_docs||[]).push([[115],{"./node_modules/d3-array/src/mean.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function mean(values,valueof){let count=0,sum=0;if(void 0===valueof)for(let value of values)null!=value&&(value=+value)>=value&&(++count,sum+=value);else{let index=-1;for(let value of values)null!=(value=valueof(value,++index,values))&&(value=+value)>=value&&(++count,sum+=value)}if(count)return sum/count}__webpack_require__.d(__webpack_exports__,{A:()=>mean})},"./node_modules/d3plus-color/es/src/legible.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var d3_color__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/d3-color/src/color.js");function __WEBPACK_DEFAULT_EXPORT__(c){return(c=(0,d3_color__WEBPACK_IMPORTED_MODULE_0__.KI)(c)).l>.45&&(c.s>.8&&(c.s=.8),c.l=.45),c.toString()}},"./node_modules/d3plus-plot/es/src/Plot.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Plot});var range=__webpack_require__("./node_modules/d3-array/src/range.js"),min=__webpack_require__("./node_modules/d3-array/src/min.js"),max=__webpack_require__("./node_modules/d3-array/src/max.js"),extent=__webpack_require__("./node_modules/d3-array/src/extent.js"),sum=__webpack_require__("./node_modules/d3-array/src/sum.js"),deviation=__webpack_require__("./node_modules/d3-array/src/deviation.js"),mean=__webpack_require__("./node_modules/d3-array/src/mean.js"),merge=__webpack_require__("./node_modules/d3-array/src/merge.js"),src=__webpack_require__("./node_modules/d3-collection/src/index.js"),d3_scale_src=__webpack_require__("./node_modules/d3-scale/src/index.js"),linear=__webpack_require__("./node_modules/d3-scale/src/linear.js"),none=__webpack_require__("./node_modules/d3-shape/src/order/none.js"),stack=__webpack_require__("./node_modules/d3-shape/src/stack.js"),d3_shape_src=__webpack_require__("./node_modules/d3-shape/src/index.js"),Axis=__webpack_require__("./node_modules/d3plus-axis/es/src/Axis.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===_typeof(key)?key:String(key)),descriptor)}var arg,key}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var AxisBottom=function(_Axis){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(AxisBottom,_Axis);var _super=_createSuper(AxisBottom);function AxisBottom(){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AxisBottom),(_this=_super.call(this)).orient("bottom"),_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(AxisBottom)}(Axis.A);function AxisTop_typeof(obj){return AxisTop_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},AxisTop_typeof(obj)}function AxisTop_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function AxisTop_toPrimitive(input,hint){if("object"!==AxisTop_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==AxisTop_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===AxisTop_typeof(key)?key:String(key)),descriptor)}var arg,key}function AxisTop_setPrototypeOf(o,p){return AxisTop_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},AxisTop_setPrototypeOf(o,p)}function AxisTop_createSuper(Derived){var hasNativeReflectConstruct=function AxisTop_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=AxisTop_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=AxisTop_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function AxisTop_possibleConstructorReturn(self,call){if(call&&("object"===AxisTop_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function AxisTop_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function AxisTop_getPrototypeOf(o){return AxisTop_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},AxisTop_getPrototypeOf(o)}var AxisTop=function(_Axis){!function AxisTop_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&AxisTop_setPrototypeOf(subClass,superClass)}(AxisTop,_Axis);var _super=AxisTop_createSuper(AxisTop);function AxisTop(){var _this;return function AxisTop_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AxisTop),(_this=_super.call(this)).orient("top"),_this}return function AxisTop_createClass(Constructor,protoProps,staticProps){return protoProps&&AxisTop_defineProperties(Constructor.prototype,protoProps),staticProps&&AxisTop_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(AxisTop)}(Axis.A);function AxisLeft_typeof(obj){return AxisLeft_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},AxisLeft_typeof(obj)}function AxisLeft_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function AxisLeft_toPrimitive(input,hint){if("object"!==AxisLeft_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==AxisLeft_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===AxisLeft_typeof(key)?key:String(key)),descriptor)}var arg,key}function AxisLeft_setPrototypeOf(o,p){return AxisLeft_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},AxisLeft_setPrototypeOf(o,p)}function AxisLeft_createSuper(Derived){var hasNativeReflectConstruct=function AxisLeft_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=AxisLeft_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=AxisLeft_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function AxisLeft_possibleConstructorReturn(self,call){if(call&&("object"===AxisLeft_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function AxisLeft_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function AxisLeft_getPrototypeOf(o){return AxisLeft_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},AxisLeft_getPrototypeOf(o)}var AxisLeft=function(_Axis){!function AxisLeft_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&AxisLeft_setPrototypeOf(subClass,superClass)}(AxisLeft,_Axis);var _super=AxisLeft_createSuper(AxisLeft);function AxisLeft(){var _this;return function AxisLeft_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AxisLeft),(_this=_super.call(this)).orient("left"),_this}return function AxisLeft_createClass(Constructor,protoProps,staticProps){return protoProps&&AxisLeft_defineProperties(Constructor.prototype,protoProps),staticProps&&AxisLeft_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(AxisLeft)}(Axis.A);function AxisRight_typeof(obj){return AxisRight_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},AxisRight_typeof(obj)}function AxisRight_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function AxisRight_toPrimitive(input,hint){if("object"!==AxisRight_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==AxisRight_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===AxisRight_typeof(key)?key:String(key)),descriptor)}var arg,key}function AxisRight_setPrototypeOf(o,p){return AxisRight_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},AxisRight_setPrototypeOf(o,p)}function AxisRight_createSuper(Derived){var hasNativeReflectConstruct=function AxisRight_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=AxisRight_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=AxisRight_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function AxisRight_possibleConstructorReturn(self,call){if(call&&("object"===AxisRight_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function AxisRight_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function AxisRight_getPrototypeOf(o){return AxisRight_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},AxisRight_getPrototypeOf(o)}var AxisRight=function(_Axis){!function AxisRight_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&AxisRight_setPrototypeOf(subClass,superClass)}(AxisRight,_Axis);var _super=AxisRight_createSuper(AxisRight);function AxisRight(){var _this;return function AxisRight_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AxisRight),(_this=_super.call(this)).orient("right"),_this}return function AxisRight_createClass(Constructor,protoProps,staticProps){return protoProps&&AxisRight_defineProperties(Constructor.prototype,protoProps),staticProps&&AxisRight_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(AxisRight)}(Axis.A),date=__webpack_require__("./node_modules/d3plus-axis/es/src/date.js"),src_assign=__webpack_require__("./node_modules/d3plus-color/es/src/assign.js"),defaults=__webpack_require__("./node_modules/d3plus-color/es/src/defaults.js"),contrast=__webpack_require__("./node_modules/d3plus-color/es/src/contrast.js"),legible=__webpack_require__("./node_modules/d3plus-color/es/src/legible.js"),constant=__webpack_require__("./node_modules/d3plus-common/es/src/constant.js"),es_src_assign=__webpack_require__("./node_modules/d3plus-common/es/src/assign.js"),accessor=__webpack_require__("./node_modules/d3plus-common/es/src/accessor.js"),unique=__webpack_require__("./node_modules/d3plus-common/es/src/unique.js"),elem=__webpack_require__("./node_modules/d3plus-common/es/src/elem.js"),configPrep=__webpack_require__("./node_modules/d3plus-common/es/src/configPrep.js"),Line=__webpack_require__("./node_modules/d3plus-shape/es/src/Shape/Line.js"),largestRect=__webpack_require__("./node_modules/d3plus-shape/es/src/geom/largestRect.js"),Rect=__webpack_require__("./node_modules/d3plus-shape/es/src/Shape/Rect.js"),es=__webpack_require__("./node_modules/d3plus-shape/es/index.js"),Area=__webpack_require__("./node_modules/d3plus-shape/es/src/Shape/Area.js"),Circle=__webpack_require__("./node_modules/d3plus-shape/es/src/Shape/Circle.js"),TextBox=__webpack_require__("./node_modules/d3plus-text/es/src/TextBox.js"),textWidth=__webpack_require__("./node_modules/d3plus-text/es/src/textWidth.js"),Viz=__webpack_require__("./node_modules/d3plus-viz/es/src/Viz.js");const discreteBuffer=function(scale,data,discrete){if(scale.padding)scale.padding(.5);else{var closest=Array.from(new Set(data.map((function(d){return+d[discrete]})))).reduce((function(acc,curr,i,arr){if(!i)return acc;var prev=arr[i-1];return!acc||curr-prev<acc?curr-prev:acc}),0),domain=scale.domain().slice();"y"===discrete&&domain.reverse(),domain[0]=new Date(+domain[0]-closest/2),domain[1]=new Date(+domain[1]+closest/2),"y"===discrete&&domain.reverse(),scale.domain(domain)}};function Bar(_ref){var negVals,posVals,_this=this,data=_ref.data,x=_ref.x,y=_ref.y,x2=_ref.x2,y2=_ref.y2,_ref$buffer=_ref.buffer,buffer=void 0===_ref$buffer?10:_ref$buffer,xKey=x2?"x2":"x",yKey=y2?"y2":"y",oppScale="x"===this._discrete?y:x,oppDomain=oppScale.domain().slice(),isDiscreteX="x"===this._discrete;if(isDiscreteX&&oppDomain.reverse(),this._stacked){var groupedData=(0,src.$I)().key((function(d){return"".concat(d[_this._discrete],"_").concat(d.group)})).entries(data).map((function(d){return d.values.map((function(x){return x[isDiscreteX?yKey:xKey]}))}));posVals=groupedData.map((function(arr){return(0,sum.A)(arr.filter((function(d){return d>0})))})),negVals=groupedData.map((function(arr){return(0,sum.A)(arr.filter((function(d){return d<0})))}))}else{var allValues=data.map((function(d){return d[isDiscreteX?yKey:xKey]}));posVals=allValues.filter((function(d){return d>0})),negVals=allValues.filter((function(d){return d<0}))}var bMax=oppScale((0,max.A)(posVals));(isDiscreteX?bMax<oppScale(0):bMax>oppScale(0))&&(bMax+=isDiscreteX?-buffer:buffer),bMax=oppScale.invert(bMax);var bMin=oppScale((0,min.A)(negVals));return(isDiscreteX?bMin>oppScale(0):bMin<oppScale(0))&&(bMin+=isDiscreteX?buffer:-buffer),bMin=oppScale.invert(bMin),bMax>oppDomain[1]&&(oppDomain[1]=bMax),bMin<oppDomain[0]&&(oppDomain[0]=bMin),isDiscreteX&&oppDomain.reverse(),oppScale.domain(oppDomain),discreteBuffer(isDiscreteX?x:y,data,this._discrete),[x,y]}function Box(_ref){var negVals,posVals,_this=this,data=_ref.data,x=_ref.x,y=_ref.y,x2=_ref.x2,y2=_ref.y2,_ref$buffer=_ref.buffer,buffer=void 0===_ref$buffer?10:_ref$buffer,xKey=x2?"x2":"x",yKey=y2?"y2":"y",oppScale="x"===this._discrete?y:x,oppDomain=oppScale.domain().slice(),isDiscreteX="x"===this._discrete;if(isDiscreteX&&oppDomain.reverse(),this._stacked){var groupedData=(0,src.$I)().key((function(d){return d[_this._discrete]})).entries(data).map((function(d){return d.values.map((function(x){return x[isDiscreteX?yKey:xKey]}))}));posVals=groupedData.map((function(arr){return(0,sum.A)(arr.filter((function(d){return d>0})))})),negVals=groupedData.map((function(arr){return(0,sum.A)(arr.filter((function(d){return d<0})))}))}else negVals=posVals=data.map((function(d){return d[isDiscreteX?yKey:xKey]}));var bMax=oppScale((0,max.A)(posVals));bMax+=isDiscreteX?-buffer:buffer,bMax=oppScale.invert(bMax);var bMin=oppScale((0,min.A)(negVals));return bMin+=isDiscreteX?buffer:-buffer,bMin=oppScale.invert(bMin),bMax>oppDomain[1]&&(oppDomain[1]=bMax),bMin<oppDomain[0]&&(oppDomain[0]=bMin),isDiscreteX&&oppDomain.reverse(),oppScale.domain(oppDomain),discreteBuffer(isDiscreteX?x:y,data,this._discrete),[x,y]}var log=__webpack_require__("./node_modules/d3-scale/src/log.js"),floor10=function floor10(v){return Math.pow(10,Math.floor(Math.log10(Math.abs(v))))*Math.pow(-1,v<0)},ceil10=function ceil10(v){return Math.pow(10,Math.ceil(Math.log10(Math.abs(v))))*Math.pow(-1,v<0)};function numericBuffer(axis,scale,value,size,range,domain,index,invert){if(void 0===value||isNaN(domain[0])||isNaN(domain[1]))return domain;if(invert&&(domain=domain.slice().reverse(),range=range.slice().reverse()),domain[0]===domain[1]){if(domain=domain.slice(),"log"===scale)(domain=[floor10(domain[0]),ceil10(domain[0])])[1]<domain[0]&&domain.reverse();else{var mod=Math.abs(parseFloat(domain[0].toPrecision(1).replace(/[0-9]{1}$/,"1")));domain[0]-=mod,domain[1]+=mod}return axis.domain(invert?domain.slice().reverse():domain),invert?domain.reverse():domain}var logMod=domain[0]===domain[1]?10:Math.abs(Math.log(domain[1]-domain[0])/100),needsBuffer=function needsBuffer(){var tempAxis=axis.copy(),diverging=!1;if("log"===scale){var d=axis.domain().slice(),r=axis.range().slice();if(invert&&(d=d.reverse(),r=r.reverse()),diverging=d[0]*d[1]<0){var leftPercentage=(0,log.A)().domain([1e-6,Math.abs(d[index])]).range([0,1])(Math.abs(d[index?0:1])),zero=leftPercentage/(leftPercentage+1)*(r[1]-r[0]);d=(0===index?[d[0],1e-6]:[1e-6,d[1]]).map(Math.abs),r=0===index?[r[0],r[0]+zero]:[r[0]+zero,r[1]]}tempAxis=(0,log.A)().domain(d).range(r)}var pixelValue,outside=!1,tempRange=tempAxis.range();return pixelValue=tempAxis("log"===scale&&diverging?Math.abs(value):value),invert?0===index?outside=pixelValue+size>tempRange[index]:1===index&&(outside=pixelValue-size<tempRange[index]):0===index?outside=pixelValue-size<tempRange[index]:1===index&&(outside=pixelValue+size>tempRange[index]),outside};if(axis.invert&&needsBuffer()){if("log"===scale)for(var i=0;i<10&&needsBuffer();){var _mod2=(0===index?-1:1)*(domain[index]<0?-1:1);domain[index]+=domain[index]*logMod*_mod2,axis.domain(invert?domain.slice().reverse():domain),i++}else if(0===index){var v=axis.invert(axis(value)+(size+10)*(invert?1:-1));v<domain[index]&&(domain[index]=v,axis.domain(invert?domain.slice().reverse():domain))}else if(1===index){var _v=axis.invert(axis(value)+(size+10)*(invert?-1:1));_v>domain[index]&&(domain[index]=_v,axis.domain(invert?domain.slice().reverse():domain))}}return invert?domain.reverse():domain}function buffers_Circle(_ref){var data=_ref.data,x=_ref.x,y=_ref.y,x2=_ref.x2,y2=_ref.y2,yScale=_ref.yScale,xScale=_ref.xScale,config=_ref.config,buffer=_ref.buffer;x=x.copy(),y=y.copy();var xKey=x2?"x2":"x",yKey=y2?"y2":"y",xD=x.domain().slice(),yD=y.domain().slice(),xR=x.range(),yR=y.range();return!x.invert&&x.padding&&discreteBuffer(x,data,this._discrete),!y.invert&&y.padding&&discreteBuffer(y,data,this._discrete),(x.invert||y.invert)&&data.forEach((function(d){var s=buffer||2*config.r(d.data,d.i);x.invert&&(xD=numericBuffer(x,xScale,d[xKey],s,xR,xD,0,!1),xD=numericBuffer(x,xScale,d[xKey],s,xR,xD,1,!1)),y.invert&&(yD=numericBuffer(y,yScale,d[yKey],s,yR,yD,0,!0),yD=numericBuffer(y,yScale,d[yKey],s,yR,yD,1,!0))})),[x,y]}function buffers_Line(_ref){var _this=this,data=_ref.data,x=_ref.x,y=_ref.y,x2=_ref.x2,y2=_ref.y2,xKey=x2?"x2":"x",yKey=y2?"y2":"y",s="x"===this._discrete?y:x,d=s.domain().slice();"x"===this._discrete&&d.reverse();var vals=data.map((function(d){return d["x"===_this._discrete?yKey:xKey]})),b=s.invert(s((0,max.A)(vals))+("x"===this._discrete?-10:10));return b>d[1]&&(d[1]=b),"x"===this._discrete&&d.reverse(),s.domain(d),[x,y]}function buffers_Rect(_ref){var data=_ref.data,x=_ref.x,y=_ref.y,x2=_ref.x2,y2=_ref.y2,yScale=_ref.yScale,xScale=_ref.xScale,config=_ref.config;x=x.copy(),y=y.copy();var xKey=x2?"x2":"x",yKey=y2?"y2":"y",xD=x.domain().slice(),yD=y.domain().slice(),xR=x.range(),yR=y.range();return!x.invert&&x.padding&&discreteBuffer(x,data,this._discrete),!y.invert&&y.padding&&discreteBuffer(y,data,this._discrete),(x.invert||y.invert)&&data.forEach((function(d){if(x.invert){var w=config.width(d.data,d.i);xD=numericBuffer(x,xScale,d[xKey],w,xR,xD,0,!1),xD=numericBuffer(x,xScale,d[xKey],w,xR,xD,1,!1)}if(y.invert){var h=config.height(d.data,d.i);yD=numericBuffer(y,yScale,d[yKey],h,yR,yD,0,!0),yD=numericBuffer(y,yScale,d[yKey],h,yR,yD,1,!0)}})),[x,y]}function Plot_typeof(obj){return Plot_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Plot_typeof(obj)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperty(obj,key,value){return(key=Plot_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function Plot_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,Plot_toPropertyKey(descriptor.key),descriptor)}}function Plot_toPropertyKey(arg){var key=function Plot_toPrimitive(input,hint){if("object"!==Plot_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==Plot_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===Plot_typeof(key)?key:String(key)}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(target,property,receiver){var base=function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=Plot_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function Plot_setPrototypeOf(o,p){return Plot_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},Plot_setPrototypeOf(o,p)}function Plot_createSuper(Derived){var hasNativeReflectConstruct=function Plot_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Plot_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Plot_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function Plot_possibleConstructorReturn(self,call){if(call&&("object"===Plot_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return Plot_assertThisInitialized(self)}(this,result)}}function Plot_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function Plot_getPrototypeOf(o){return Plot_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Plot_getPrototypeOf(o)}var testLineShape=new Line.A,testTextBox=new TextBox.A;function defaultSize(d){return this._sizeScaleD3(this._size?this._size(d):null)}function stackOrderAscending(series){var sums=series.map(stackSum),keys=series.map((function(d){return d.key.split("_")[0]}));return none.A(series).sort((function(a,b){return keys[b].localeCompare(keys[a])||sums[a]-sums[b]}))}function stackOrderDescending(series){return stackOrderAscending(series).reverse()}function stackSum(series){for(var v,i=-1,s=0,n=series.length;++i<n;)(v=+series[i][1])&&(s+=v);return s}function stackOffsetDiverging(series,order){var n;if((n=series.length)>0)for(var d,dy,i,yn,yp,m=series[order[0]].length,j=0;j<m;++j)for(yp=yn=0,i=0;i<n;++i)(dy=(d=series[order[i]][j])[1]-d[0])>=0?(d[0]=yp,d[1]=yp+=dy):dy<0?(d[1]=yn,d[0]=yn+=dy):d[0]=yp}function outside(d,i){if(this._stacked)return!1;var labelPosition=this._labelPosition(d,i);if("outside"===labelPosition)return!0;if("inside"===labelPosition)return!1;var other="x"===this._discrete.charAt(0)?"y":"x",nonDiscrete=this._discrete.replace(this._discrete.charAt(0),other),range=this["_".concat(nonDiscrete,"Axis")]._d3Scale.range(),value=this["_".concat(nonDiscrete)](d,i),negative=value<0,zero=this["_".concat(nonDiscrete,"Axis")]._getPosition(0),space="y"===nonDiscrete?negative?range[1]-zero:zero-range[0]:negative?zero-range[0]:range[1]-zero,pos=this["_".concat(nonDiscrete,"Axis")]._getPosition(value);return Math.abs(pos-zero)<space/2}var Plot=function(_Viz){!function Plot_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Plot_setPrototypeOf(subClass,superClass)}(Plot,_Viz);var _super=Plot_createSuper(Plot);function Plot(){var _this;return function Plot_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Plot),(_this=_super.call(this))._annotations=[],_this._backgroundConfig={duration:0,fill:"transparent"},_this._barPadding=0,_this._buffer={Bar,Box,Circle:buffers_Circle,Line:buffers_Line,Rect:buffers_Rect},_this._confidenceConfig={fill:function fill(d,i){return"function"==typeof _this._shapeConfig.Line.stroke?_this._shapeConfig.Line.stroke(d,i):_this._shapeConfig.Line.stroke},fillOpacity:(0,constant.A)(.5)},_this._discreteCutoff=100,_this._groupPadding=5,_this._labelPosition=(0,constant.A)("auto"),_this._lineMarkerConfig={fill:function fill(d,i){return(0,src_assign.A)(_this._id(d,i))},r:(0,constant.A)(3)},_this._lineMarkers=!1,_this._previousAnnotations=[],_this._previousShapes=[],_this._shape=(0,constant.A)("Circle"),_this._shapeConfig=(0,es_src_assign.A)(_this._shapeConfig,{Area:{label:function label(d,i){return!!_this._stacked&&_this._drawLabel(d,i)},labelBounds:function labelBounds(d,i,aes){var r=largestRect.A(aes.points,{angle:(0,range.A)(-20,20,5)});if((!r||r.height<20||r.width<50)&&(r=largestRect.A(aes.points,{angle:(0,range.A)(-80,80,5)})),!r)return null;var x=(0,min.A)(aes.points,(function(d){return d[0]})),y=(0,max.A)(aes.points.filter((function(d){return d[0]===x})),(function(d){return d[1]}));return{angle:r.angle,width:r.width,height:r.height,x:r.cx-r.width/2-x,y:r.cy-r.height/2-y}},labelConfig:{fontMin:6,fontResize:!0,padding:10}},ariaLabel:function ariaLabel(d,i){var ariaLabelStr="";return d.nested?ariaLabelStr="".concat(_this._drawLabel(d.data,d.i)):(ariaLabelStr="".concat(_this._drawLabel(d,i)),void 0!==_this._x(d,i)&&(ariaLabelStr+=", x: ".concat(_this._x(d,i))),void 0!==_this._y(d,i)&&(ariaLabelStr+=", y: ".concat(_this._y(d,i))),void 0!==_this._x2(d,i)&&(ariaLabelStr+=", x2: ".concat(_this._x2(d,i))),void 0!==_this._y2(d,i)&&(ariaLabelStr+=", y2: ".concat(_this._y2(d,i)))),"".concat(ariaLabelStr,".")},Bar:{labelBounds:function labelBounds(d,i,s){var _ref2,_ref,width="y"===this._discrete?"width":"height",height="y"===this._discrete?"height":"width",other="x"===this._discrete.charAt(0)?"y":"x",invert="y"===other,nonDiscrete=this._discrete.replace(this._discrete.charAt(0),other),range=this["_".concat(nonDiscrete,"Axis")]._d3Scale.range(),space=Math.abs(range[1]-range[0]),negative=this["_".concat(nonDiscrete)](d,i)<0;return outside.bind(this)(d,i)?(_defineProperty(_ref={},width,space-s[width]),_defineProperty(_ref,height,s[height]),_defineProperty(_ref,"x",invert?-s.width/2:negative?-space:s.width+1),_defineProperty(_ref,"y",invert?negative?s.height+1:-space:-s.height/2+1),_ref):(_defineProperty(_ref2={},width,s[width]),_defineProperty(_ref2,height,s[height]),_defineProperty(_ref2,"x",invert?-s.width/2:negative?this._stacked?1:1-s.width:-1),_defineProperty(_ref2,"y",invert?negative?this._stacked?1-s.height:1:1-s.height:-s.height/2+1),_ref2)},labelConfig:{fontMax:16,fontMin:6,fontResize:!0,fontColor:function fontColor(d,i){return outside.bind(this)(d,i)?"transparent"===this._backgroundConfig.fill?defaults.A.dark:(0,contrast.A)(this._backgroundConfig.fill):(0,contrast.A)("function"==typeof this._shapeConfig.fill?this._shapeConfig.fill(d,i):this._shapeConfig.fill)},fontStroke:function fontStroke(d,i){return outside.bind(this)(d,i)?"transparent"===this._backgroundConfig.fill?defaults.A.dark:(0,contrast.A)(this._backgroundConfig.fill):"transparent"},fontStrokeWidth:function fontStrokeWidth(d,i){return outside.bind(this)(d,i)?.1:0},padding:3,textAnchor:function textAnchor(d,i){var other="x"===this._discrete.charAt(0)?"y":"x",invert="y"===other,nonDiscrete=this._discrete.replace(this._discrete.charAt(0),other),negative=this["_".concat(nonDiscrete)](d,i)<0;return invert?"middle":outside.bind(this)(d,i)?negative?"end":"start":negative?"start":"end"},verticalAlign:function verticalAlign(d,i){var other="x"===this._discrete.charAt(0)?"y":"x",invert="y"===other,nonDiscrete=this._discrete.replace(this._discrete.charAt(0),other),negative=this["_".concat(nonDiscrete)](d,i)<0;return invert?outside.bind(this)(d,i)?negative?"top":"bottom":negative?"bottom":"top":"middle"}}},Circle:{r:defaultSize.bind(Plot_assertThisInitialized(_this))},Line:{curve:function curve(){return _this._discrete?"monotone".concat(_this._discrete.charAt(0).toUpperCase()):"linear"},fill:(0,constant.A)("none"),labelConfig:{fontColor:function fontColor(d,i){var c="function"==typeof _this._shapeConfig.Line.stroke?_this._shapeConfig.Line.stroke(d,i):_this._shapeConfig.Line.stroke;return(0,legible.A)(c)},fontResize:!1,padding:5,textAnchor:"start",verticalAlign:"middle"},strokeWidth:(0,constant.A)(2)},Rect:{height:function height(d){return 2*defaultSize.bind(Plot_assertThisInitialized(_this))(d)},width:function width(d){return 2*defaultSize.bind(Plot_assertThisInitialized(_this))(d)}}}),_this._shapeOrder=["Area","Path","Bar","Box","Line","Rect","Circle"],_this._shapeSort=function(a,b){return _this._shapeOrder.indexOf(a)-_this._shapeOrder.indexOf(b)},_this._sizeMax=20,_this._sizeMin=5,_this._sizeScale="sqrt",_this._stackOffset=stackOffsetDiverging,_this._stackOrder=stackOrderDescending,_this._timelineConfig=(0,es_src_assign.A)(_this._timelineConfig,{brushing:!0,brushMin:function brushMin(){return _this._xTime||_this._yTime||_this._x2Time||_this._y2Time?2:1}}),_this._x=(0,accessor.A)("x"),_this._xAxis=(new AxisBottom).align("end"),_this._xTest=(new AxisBottom).align("end").gridSize(0),_this._xConfig={gridConfig:{stroke:function stroke(d){return _this._discrete&&"x"===_this._discrete.charAt(0)||_this._xAxis.range()[0]===_this._xAxis._getPosition.bind(_this._xAxis)(d.id)?"transparent":"#eee"}}},_this._xCutoff=150,_this._x2=(0,accessor.A)("x2"),_this._x2Axis=(new AxisTop).align("start"),_this._x2Test=(new AxisTop).align("start").gridSize(0),_this._x2Config={padding:0},_this._y=(0,accessor.A)("y"),_this._yAxis=(new AxisLeft).align("start"),_this._yTest=(new AxisLeft).align("start").gridSize(0),_this._yConfig={gridConfig:{stroke:function stroke(d){if(_this._discrete&&"y"===_this._discrete.charAt(0))return"transparent";var range=_this._yAxis.range();return range[range.length-1]===_this._yAxis._getPosition.bind(_this._yAxis)(d.id)?"transparent":"#eee"}}},_this._yCutoff=150,_this._y2=(0,accessor.A)("y2"),_this._y2Axis=(new AxisRight).align("end"),_this._y2Test=(new AxisLeft).align("end").gridSize(0),_this._y2Config={},_this}return function Plot_createClass(Constructor,protoProps,staticProps){return protoProps&&Plot_defineProperties(Constructor.prototype,protoProps),staticProps&&Plot_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Plot,[{key:"_preDraw",value:function _preDraw(){var _this2=this;["x","y","x2","y2"].forEach((function(k){if(_this2["_".concat(k,"Key")]){var str=_this2["_".concat(k,"Key")];_this2._aggs[str]||_this2._discrete!==k||(_this2._aggs[str]=function(a,c){var v=Array.from(new Set(a.map(c)));return 1===v.length?v[0]:v}),str!==k&&_this2["_".concat(k,"Title")]===_this2["_".concat(k,"Config")].title&&_this2._discrete!==k&&(_this2["_".concat(k,"Title")]=str,_this2["_".concat(k,"Config")].title=str)}})),_get(Plot_getPrototypeOf(Plot.prototype),"_preDraw",this).call(this)}},{key:"_draw",value:function _draw(callback){var _this3=this;if(!this._filteredData.length)return this;var stackGroup=function stackGroup(d,i){return _this3._stacked?"".concat(_this3._groupBy.length>1?_this3._ids(d,i).slice(0,-1).join("_"):"group"):"".concat(_this3._ids(d,i).join("_"))},data=this._filteredData.map((function(d,i){return{__d3plus__:!0,data:d,group:stackGroup(d,i),i,hci:_this3._confidence&&_this3._confidence[1]&&_this3._confidence[1](d,i),id:_this3._ids(d,i).slice(0,_this3._drawDepth+1).join("_"),lci:_this3._confidence&&_this3._confidence[0]&&_this3._confidence[0](d,i),shape:_this3._shape(d,i),x:_this3._x(d,i),x2:_this3._x2(d,i),y:_this3._y(d,i),y2:_this3._y2(d,i)}}));if(this._formattedData=data,this._size){var rExtent=(0,extent.A)(data,(function(d){return _this3._size(d.data)}));this._sizeScaleD3=function(){return _this3._sizeMin},this._sizeScaleD3=d3_scale_src["scale".concat(this._sizeScale.charAt(0).toUpperCase()).concat(this._sizeScale.slice(1))]().domain(rExtent).range([rExtent[0]===rExtent[1]?this._sizeMax:(0,min.A)([this._sizeMax/2,this._sizeMin]),this._sizeMax])}else this._sizeScaleD3=function(){return _this3._sizeMin};for(var x2Exists=data.some((function(d){return void 0!==d.x2})),y2Exists=data.some((function(d){return void 0!==d.y2})),height=this._height-this._margin.top-this._margin.bottom,opp=this._discrete?"x"===this._discrete?"y":"x":void 0,opp2=this._discrete?"x"===this._discrete?"y2":"x2":void 0,opps=[opp,opp2].filter((function(d){return d})),parent=this._select,transition=this._transition,width=this._width-this._margin.left-this._margin.right,x2Time=this._x2Time=this._time&&data[0].x2===this._time(data[0].data,data[0].i),xTime=this._xTime=this._time&&data[0].x===this._time(data[0].data,data[0].i),y2Time=this._y2Time=this._time&&data[0].y2===this._time(data[0].data,data[0].i),yTime=this._yTime=this._time&&data[0].y===this._time(data[0].data,data[0].i),i=0;i<data.length;i++){var d=data[i];xTime&&(d.x=(0,date.A)(d.x)),x2Time&&(d.x2=(0,date.A)(d.x2)),yTime&&(d.y=(0,date.A)(d.y)),y2Time&&(d.y2=(0,date.A)(d.y2)),d.discrete="Bar"===d.shape?"".concat(d[this._discrete],"_").concat(d.group):"".concat(d[this._discrete])}function getValues(axis){var _this4=this,axisData=data.filter((function(d){return d[axis]})).sort((function(a,b){return _this4["_".concat(axis,"Sort")]?_this4["_".concat(axis,"Sort")](a.data,b.data):a[axis]-b[axis]})).map((function(d){return d[axis]}));return this._discrete!==axis.charAt(0)&&this._confidence&&(this._confidence[0]&&(axisData=axisData.concat(data.map((function(d){return d.lci})))),this._confidence[1]&&(axisData=axisData.concat(data.map((function(d){return d.hci}))))),(0,unique.A)(axisData,(function(d){return"".concat(d)}))}var discreteKeys,domains,stackData,stackKeys,xData=getValues.bind(this)("x"),x2Data=getValues.bind(this)("x2"),yData=getValues.bind(this)("y"),y2Data=getValues.bind(this)("y2");if(this._stacked){var _domains,stackedData=data.filter((function(d){return["Area","Bar"].includes(d.shape)})),groupValues=(0,src.$I)().key((function(d){return d.group})).entries(stackedData).reduce((function(obj,d){return obj[d.key]||(obj[d.key]=0),obj[d.key]+=(0,sum.A)(d.values,(function(dd){return dd[opp]})),obj}),{});data=data.sort((function(a,b){if(_this3["_".concat(_this3._discrete,"Sort")])return _this3["_".concat(_this3._discrete,"Sort")](a.data,b.data);var a1=a[_this3._discrete],b1=b[_this3._discrete];return a1-b1!=0?a1-b1:a.group!==b.group?groupValues[b.group]-groupValues[a.group]:b[opp]-a[opp]})),discreteKeys=Array.from(new Set(data.map((function(d){return d.discrete})))),stackKeys=Array.from(new Set(data.map((function(d){return d.id})))),stackData=(0,src.$I)().key((function(d){return d.discrete})).entries(data).map((function(d){return d.values})),stackData.forEach((function(g){var ids=Array.from(new Set(g.map((function(d){return d.id}))));ids.length<stackKeys.length&&stackKeys.forEach((function(k){if(!ids.includes(k)){var _d=data.filter((function(d){return d.id===k}))[0];if("Area"===_d.shape){var _fillerPoint,group=stackGroup(_d.data,_d.i),fillerPoint=(_defineProperty(_fillerPoint={__d3plus__:!0,data:_d.data,discrete:"Bar"===_d.shape?"".concat(g[0][_this3._discrete],"_").concat(group):"".concat(g[0][_this3._discrete]),group,id:k,shape:_d.shape},_this3._discrete,g[0][_this3._discrete]),_defineProperty(_fillerPoint,opp,0),_fillerPoint);data.push(fillerPoint)}}}))})),this["_".concat(this._discrete,"Sort")]?data.sort((function(a,b){return _this3["_".concat(_this3._discrete,"Sort")](a.data,b.data)})):data.sort((function(a,b){return a[_this3._discrete]-b[_this3._discrete]}));var order=this._stackOrder;order instanceof Array?stackKeys.sort((function(a,b){return order.indexOf(a)-order.indexOf(b)})):order===none.A&&stackKeys.sort((function(a,b){return a.localeCompare(b)})),stackData=stack.A().keys(stackKeys).offset(this._stackOffset).order(order instanceof Array?none.A:order).value((function(group,key){var d=group.filter((function(g){return g.id===key}));return d.length?d[0][opp]:0}))(stackData);var discreteData="x"===this._discrete?xData:yData;_defineProperty(_domains={},this._discrete,this["_".concat(this._discrete,"Time")]?(0,extent.A)(discreteData):discreteData),_defineProperty(_domains,opp,[(0,min.A)(stackData.map((function(g){return(0,min.A)(g.map((function(p){return p[0]})))}))),(0,max.A)(stackData.map((function(g){return(0,max.A)(g.map((function(p){return p[1]})))})))]),domains=_domains}else{var _discrete=this._discrete||"x";this["_".concat(this._discrete,"Sort")]?data.sort((function(a,b){return _this3["_".concat(_this3._discrete,"Sort")](a.data,b.data)})):data.sort((function(a,b){return a[_discrete]-b[_discrete]})),domains={x:!xTime&&"x"===this._discrete||this._xSort?xData:(0,extent.A)(xData),x2:!x2Time&&"x"===this._discrete||this._x2Sort?x2Data:(0,extent.A)(x2Data),y:!yTime&&"y"===this._discrete||this._ySort?yData:(0,extent.A)(yData),y2:!y2Time&&"y"===this._discrete||this._y2Sort?y2Data:(0,extent.A)(y2Data)}}function domainScaleSetup(axis){var scale=this["_".concat(axis,"Time")]?"Time":this._discrete===axis||this["_".concat(axis,"Sort")]?"Point":"Linear",domain=this["_".concat(axis,"Domain")]?this["_".concat(axis,"Domain")].slice():domains[axis],domain2=this["_".concat(axis,"2Domain")]?this["_".concat(axis,"2Domain")].slice():domains["".concat(axis,"2")];return"Point"!==scale&&(domain&&void 0===domain[0]&&(domain[0]=domains[axis][0]),domain&&void 0===domain[1]&&(domain[1]=domains[axis][1]),domain2&&void 0===domain2[0]&&(domain2[0]=domains["".concat(axis,"2")][0]),domain2&&void 0===domain2[1]&&(domain2[1]=domains["".concat(axis,"2")][1])),[domain,scale,domain2,scale]}var _domainScaleSetup$bin2=_slicedToArray(domainScaleSetup.bind(this)("x"),4),xAutoDomain=_domainScaleSetup$bin2[0],xScale=_domainScaleSetup$bin2[1],x2AutoDomain=_domainScaleSetup$bin2[2],x2Scale=_domainScaleSetup$bin2[3],_domainScaleSetup$bin4=_slicedToArray(domainScaleSetup.bind(this)("y"),4),yAutoDomain=_domainScaleSetup$bin4[0],yScale=_domainScaleSetup$bin4[1],y2AutoDomain=_domainScaleSetup$bin4[2],y2Scale=_domainScaleSetup$bin4[3],autoScale=function autoScale(axis,fallback){var userScale=_this3["_".concat(axis,"Config")].scale;if("auto"===userScale){if(_this3._discrete===axis)return fallback;var values=data.map((function(d){return d[axis]}));return(0,deviation.A)(values)/(0,mean.A)(values)>3?"log":"linear"}return userScale||fallback},yConfigScale=this._yConfigScale=autoScale("y",yScale).toLowerCase(),y2ConfigScale=this._y2ConfigScale=autoScale("y2",y2Scale).toLowerCase(),xConfigScale=this._xConfigScale=autoScale("x",xScale).toLowerCase(),x2ConfigScale=this._x2ConfigScale=autoScale("x2",x2Scale).toLowerCase();domains={x:xAutoDomain,x2:x2AutoDomain||xAutoDomain,y:yAutoDomain,y2:y2AutoDomain||yAutoDomain},Object.keys(domains).forEach((function(axis){"log"===_this3["_".concat(axis,"ConfigScale")]&&domains[axis].includes(0)&&((0,min.A)(domains[axis])<0?domains[axis][1]=(0,max.A)(data.map((function(d){return d[axis]})).filter(Boolean)):domains[axis][0]=(0,min.A)(data.map((function(d){return d[axis]})).filter(Boolean)))})),opps.forEach((function(opp){if(_this3["_".concat(opp,"Config")].domain){var _d2=_this3["_".concat(opp,"Config")].domain;"x"===_this3._discrete&&_d2.reverse(),domains[opp]=_d2}else if(opp&&void 0!==_this3._baseline){var b=_this3._baseline;domains[opp]&&domains[opp][0]>b?domains[opp][0]=b:domains[opp]&&domains[opp][1]<b&&(domains[opp][1]=b)}}));var _x3=d3_scale_src["scale".concat(xScale)]().domain(domains.x).range((0,range.A)(0,width+1,width/(domains.x.length-1))),x2=d3_scale_src["scale".concat(x2Scale)]().domain(domains.x2).range((0,range.A)(0,width+1,width/(domains.x2.length-1))),_y2=d3_scale_src["scale".concat(yScale)]().domain(domains.y.reverse()).range((0,range.A)(0,height+1,height/(domains.y.length-1))),y2=d3_scale_src["scale".concat(y2Scale)]().domain(domains.y2.reverse()).range((0,range.A)(0,height+1,height/(domains.y2.length-1))),shapeData=(0,src.$I)().key((function(d){return d.shape})).entries(data).sort((function(a,b){return _this3._shapeSort(a.key,b.key)}));"Point"!==("x"===this._discrete?yScale:xScale)&&shapeData.forEach((function(d){if(_this3._buffer[d.key]){var res=_this3._buffer[d.key].bind(_this3)({data:d.values,x:_x3,y:_y2,yScale:yConfigScale,xScale:xConfigScale,config:_this3._shapeConfig[d.key]});_x3=res[0],_y2=res[1];var res2=_this3._buffer[d.key].bind(_this3)({data:d.values,x:x2,y:y2,yScale:y2ConfigScale,xScale:x2ConfigScale,x2:!0,y2:!0,config:_this3._shapeConfig[d.key]});x2=res2[0],y2=res2[1]}}));var xDomain=_x3.domain(),x2Domain=x2.domain(),yDomain=_y2.domain(),y2Domain=y2.domain(),defaultConfig={barConfig:{"stroke-width":0},gridSize:0,labels:[],title:!1,tickSize:0},defaultX2Config=x2Exists?{data:x2Time?x2Data:[]}:defaultConfig,defaultY2Config=y2Exists?{data:y2Time?y2Data:[]}:defaultConfig,showX="x"===this._discrete&&this._width>this._discreteCutoff||this._width>this._xCutoff,showY="y"===this._discrete&&this._height>this._discreteCutoff||this._height>this._yCutoff,yC={data:yTime?yData:[],locale:this._locale,scalePadding:_y2.padding?_y2.padding():0};showX||(yC.barConfig={stroke:"transparent"},yC.tickSize=0,yC.shapeConfig={labelBounds:function labelBounds(d,i){var _d$labelBounds=d.labelBounds,width=_d$labelBounds.width,y=_d$labelBounds.y,height=_this3._height/2;return{x:i?-height:0,y,width,height}},labelConfig:{padding:0,rotate:0,verticalAlign:function verticalAlign(d){return d.id===yTicks[0]?"top":"bottom"}},labelRotation:!1});var testGroup=(0,elem.A)("g.d3plus-plot-test",{enter:{opacity:0},parent:this._select}),barConfig=configPrep.A.bind(this)(this._shapeConfig,"shape","Bar"),barLabelFunction=void 0!==barConfig.label?"function"==typeof barConfig.label?barConfig.label:(0,constant.A)(barConfig.label):this._drawLabel,barLabels=this._filteredData.map((function(d,i){return barLabelFunction(d,i)})).filter((function(d){return"number"==typeof d||d})).map(String),x2Ticks="Point"===x2Scale&&x2Ticks instanceof Array&&x2Ticks.every((function(t){return barLabels.includes("".concat(t))}))?[]:void 0,xTicks="Point"===xScale&&xTicks instanceof Array&&xTicks.every((function(t){return barLabels.includes("".concat(t))}))?[]:void 0,y2Ticks="Point"===y2Scale&&y2Ticks instanceof Array&&y2Ticks.every((function(t){return barLabels.includes("".concat(t))}))?[]:void 0,yTicks="Point"===yScale&&yTicks instanceof Array&&yTicks.every((function(t){return barLabels.includes("".concat(t))}))?[]:void 0;showY&&this._yTest.domain(yDomain).height(height).maxSize(width/2).range([void 0,void 0]).select(testGroup.node()).ticks(yTicks).width(width).config(yC).config(this._yConfig).scale(yConfigScale).render();var yBounds=this._yTest.outerBounds(),yWidth=yBounds.width?yBounds.width+this._yTest.padding():void 0;y2Exists&&this._y2Test.domain(y2Domain).height(height).range([void 0,void 0]).select(testGroup.node()).ticks(y2Ticks).width(width).config(yC).config(defaultY2Config).config(this._y2Config).scale(y2ConfigScale).render();var y2Bounds=this._y2Test.outerBounds(),y2Width=y2Bounds.width?y2Bounds.width+this._y2Test.padding():void 0,xC={data:xTime?xData:[],locale:this._locale,scalePadding:_x3.padding?_x3.padding():0};showY||(xC.barConfig={stroke:"transparent"},xC.tickSize=0,xC.shapeConfig={labelBounds:function labelBounds(d,i){var _d$labelBounds2=d.labelBounds,height=_d$labelBounds2.height,y=_d$labelBounds2.y,width=_this3._width/2;return{x:i?-width:0,y,width,height}},labelConfig:{padding:0,rotate:0,textAnchor:function textAnchor(d){return d.id===xTicks[0]?"start":"end"}},labelRotation:!1});var largestLabel,xRangeMax=void 0;if(showX&&this._xTest.domain(xDomain).height(height).maxSize(height/2).range([void 0,xRangeMax]).select(testGroup.node()).ticks(xTicks).width(width).config(xC).config(this._xConfig).scale(xConfigScale).render(),this._lineLabels){var lineData=(0,src.$I)().key((function(d){return d.id})).entries(data.filter((function(d){return"Line"===d.shape})));if(lineData.length){var userConfig=configPrep.A.bind(this)(this._shapeConfig,"shape","Line");testLineShape.config(userConfig);var lineLabelConfig=testLineShape.labelConfig(),fontSizeAccessor=void 0!==lineLabelConfig.fontSize?lineLabelConfig.fontSize:testTextBox.fontSize(),fontWeightAccessor=void 0!==lineLabelConfig.fontWeight?lineLabelConfig.fontWeight:testTextBox.fontWeight(),fontFamilyAccessor=void 0!==lineLabelConfig.fontFamily?lineLabelConfig.fontFamily:testTextBox.fontFamily(),paddingAccessor=void 0!==lineLabelConfig.padding?lineLabelConfig.padding:testTextBox.padding(),labelFunction=userConfig.label||this._drawLabel,xEstimate=function xEstimate(d){return"log"===xConfigScale&&0===d&&(d=xDomain[0]<0?_this3._xTest._d3Scale.domain()[1]:_this3._xTest._d3Scale.domain()[0]),_this3._xTest._getPosition.bind(_this3._xTest)(d)},maxX=(0,max.A)(lineData.map((function(group){return(0,max.A)(group.values.map((function(d){return xEstimate(d.x)})))}))),labelWidths=lineData.map((function(group){for(var i,d=group.values[group.values.length-1];d.__d3plus__&&d.data;)i=(d=d.data).i;var label="function"==typeof labelFunction?labelFunction(d,i):labelFunction,fontSize="function"==typeof fontSizeAccessor?fontSizeAccessor(d,i):fontSizeAccessor,fontWeight="function"==typeof fontWeightAccessor?fontWeightAccessor(d,i):fontWeightAccessor,fontFamily="function"==typeof fontFamilyAccessor?fontFamilyAccessor(d,i):fontFamilyAccessor;fontFamily instanceof Array&&(fontFamily=fontFamily.map((function(f){return"'".concat(f,"'")})).join(", "));var labelPadding="function"==typeof paddingAccessor?paddingAccessor(d,i):paddingAccessor,labelWidth=(0,textWidth.A)(label,{"font-size":fontSize,"font-family":fontFamily,"font-weight":fontWeight}),myMaxX=(0,max.A)(group.values.map((function(d){return xEstimate(d.x)})));return{labelWidth:labelWidth+2*labelPadding,spaceNeeded:myMaxX-maxX+labelWidth+2*labelPadding}}));largestLabel=(0,max.A)(labelWidths.map((function(d){return d.labelWidth})));var spaceNeeded=(0,max.A)(labelWidths.map((function(d){return d.spaceNeeded}))),labelSpace=(0,min.A)([spaceNeeded,width/4]);xRangeMax=width-labelSpace-this._margin.right}}showX&&xRangeMax&&this._xTest.domain(xDomain).height(height).maxSize(height/2).range([void 0,xRangeMax]).select(testGroup.node()).ticks(xTicks).width(width).config(xC).config(this._xConfig).scale(xConfigScale).render(),x2Exists&&this._x2Test.domain(x2Domain).height(height).range([void 0,xRangeMax]).select(testGroup.node()).ticks(x2Ticks).width(width).config(xC).tickSize(0).config(defaultX2Config).config(this._x2Config).scale(x2ConfigScale).render();var xTestRange=this._xTest._getRange(),x2TestRange=this._x2Test._getRange(),x2Bounds=this._x2Test.outerBounds(),x2Height=x2Exists?x2Bounds.height+this._x2Test.padding():0,xOffsetLeft=(0,max.A)([yWidth,xTestRange[0],x2TestRange[0]]);showX&&this._xTest.range([xOffsetLeft,void 0]).render();var topOffset=showY?this._yTest.shapeConfig().labelConfig.fontSize()/2:0,xOffsetRight=(0,max.A)([y2Width,width-xTestRange[1],width-x2TestRange[1]]),xHeight=this._xTest.outerBounds().height+(showY?this._xTest.padding():0);this._padding.left+=xOffsetLeft,this._padding.right+=xOffsetRight,this._padding.bottom+=xHeight,this._padding.top+=x2Height+topOffset,_get(Plot_getPrototypeOf(Plot.prototype),"_draw",this).call(this,callback);var horizontalMargin=this._margin.left+this._margin.right,verticalMargin=this._margin.top+this._margin.bottom,yRange=[x2Height,height-(xHeight+topOffset+verticalMargin)];showY&&this._yTest.domain(yDomain).height(height).maxSize(width/2).range(yRange).select(testGroup.node()).ticks(yTicks).width(width).config(yC).config(this._yConfig).scale(yConfigScale).render(),yWidth=(yBounds=this._yTest.outerBounds()).width?yBounds.width+this._yTest.padding():void 0,xOffsetLeft=(0,max.A)([yWidth,xTestRange[0],x2TestRange[0]]),y2Exists&&this._y2Test.config(yC).domain(y2Domain).gridSize(0).height(height).range(yRange).select(testGroup.node()).width(width-(0,max.A)([0,xOffsetRight-y2Width])).title(!1).config(this._y2Config).config(defaultY2Config).scale(y2ConfigScale).render(),y2Width=(y2Bounds=this._y2Test.outerBounds()).width?y2Bounds.width+this._y2Test.padding():void 0,xOffsetRight=(0,max.A)([0,y2Width,width-xTestRange[1],width-x2TestRange[1]]);var xRange=[xOffsetLeft,width-(xOffsetRight+horizontalMargin)],rectGroup=(0,elem.A)("g.d3plus-plot-background",{parent,transition}),transform="translate(".concat(this._margin.left,", ").concat(this._margin.top+x2Height+topOffset,")"),x2Transform="translate(".concat(this._margin.left,", ").concat(this._margin.top+topOffset,")"),xGroup=showX&&(0,elem.A)("g.d3plus-plot-x-axis",{parent,transition,enter:{transform},update:{transform}}),x2Group=x2Exists&&(0,elem.A)("g.d3plus-plot-x2-axis",{parent,transition,enter:{transform:x2Transform},update:{transform:x2Transform}}),xTrans=xOffsetLeft>yWidth?xOffsetLeft-yWidth:0,yTransform="translate(".concat(this._margin.left+xTrans,", ").concat(this._margin.top+topOffset,")"),yGroup=showY&&(0,elem.A)("g.d3plus-plot-y-axis",{parent,transition,enter:{transform:yTransform},update:{transform:yTransform}}),y2Transform="translate(-".concat(this._margin.right,", ").concat(this._margin.top+topOffset,")"),y2Group=y2Exists&&(0,elem.A)("g.d3plus-plot-y2-axis",{parent,transition,enter:{transform:y2Transform},update:{transform:y2Transform}});this._xAxis.domain(xDomain).height(height-(x2Height+topOffset+verticalMargin)).maxSize(height/2).range(xRange).select(showX?xGroup.node():void 0).ticks(xTicks).width(width).config(xC).config(this._xConfig).scale(xConfigScale).render(),x2Exists&&this._x2Axis.domain(x2Domain).height(height-(xHeight+topOffset+verticalMargin)).range(xRange).select(x2Group.node()).ticks(x2Ticks).width(width).config(xC).config(defaultX2Config).config(this._x2Config).scale(x2ConfigScale).render(),this._xFunc=_x3=function x(d,_x2){return"x2"===_x2?("log"===x2ConfigScale&&0===d&&(d=x2Domain[0]<0?_this3._x2Axis._d3Scale.domain()[1]:_this3._x2Axis._d3Scale.domain()[0]),_this3._x2Axis._getPosition.bind(_this3._x2Axis)(d)):("log"===xConfigScale&&0===d&&(d=xDomain[0]<0?_this3._xAxis._d3Scale.domain()[1]:_this3._xAxis._d3Scale.domain()[0]),_this3._xAxis._getPosition.bind(_this3._xAxis)(d))},yRange=[this._xAxis.outerBounds().y+x2Height,height-(xHeight+topOffset+verticalMargin)],this._yAxis.domain(yDomain).height(height).maxSize(width/2).range(yRange).select(showY?yGroup.node():void 0).ticks(yTicks).width(xRange[xRange.length-1]).config(yC).config(this._yConfig).scale(yConfigScale).render(),y2Exists&&this._y2Axis.config(yC).domain(y2Exists?y2Domain:yDomain).gridSize(0).height(height).range(yRange).select(y2Group.node()).width(width-(0,max.A)([0,xOffsetRight-y2Width])).title(!1).config(this._y2Config).config(defaultY2Config).scale(y2ConfigScale).render(),this._yFunc=_y2=function y(d,_y){return"y2"===_y?("log"===y2ConfigScale&&0===d&&(d=y2Domain[1]<0?_this3._y2Axis._d3ScaleNegative.domain()[0]:_this3._y2Axis._d3Scale.domain()[1]),_this3._y2Axis._getPosition.bind(_this3._y2Axis)(d)-x2Height):("log"===yConfigScale&&0===d&&(d=yDomain[1]<0?_this3._yAxis._d3ScaleNegative.domain()[0]:_this3._yAxis._d3Scale.domain()[1]),_this3._yAxis._getPosition.bind(_this3._yAxis)(d)-x2Height)},(new Rect.A).data([{}]).select(rectGroup.node()).x(xRange[0]+(xRange[1]-xRange[0])/2).width(xRange[1]-xRange[0]).y(this._margin.top+topOffset+yRange[0]+(yRange[1]-yRange[0])/2).height(yRange[1]-yRange[0]).config(this._backgroundConfig).render();var annotationGroup=(0,elem.A)("g.d3plus-plot-annotations",{parent,transition,enter:{transform},update:{transform}}).node(),annotationShapes=this._annotations.map((function(d){return d.shape}));this._annotations.forEach((function(annotation){(new es[annotation.shape]).config(annotation).config({x:function x(d){return d.x2?_x3(d.x2,"x2"):_x3(d.x)},x0:"x"===_this3._discrete?function(d){return d.x2?_x3(d.x2,"x2"):_x3(d.x)}:_x3(domains.x[0]),x1:"x"===_this3._discrete?null:function(d){return d.x2?_x3(d.x2,"x2"):_x3(d.x)},y:function y(d){return d.y2?_y2(d.y2,"y2"):_y2(d.y)},y0:"y"===_this3._discrete?function(d){return d.y2?_y2(d.y2,"y2"):_y2(d.y)}:_y2(domains.y[1])-yOffset,y1:"y"===_this3._discrete?null:function(d){return d.y2?_y2(d.y2,"y2"):_y2(d.y)-yOffset}}).select(annotationGroup).render()}));var exitAnnotations=this._previousAnnotations.filter((function(d){return!annotationShapes.includes(d)}));exitAnnotations.forEach((function(shape){(new es[shape]).data([]).select(annotationGroup).render()})),this._previousAnnotations=annotationShapes;var yOffset=this._xAxis.barConfig()["stroke-width"];yOffset&&(yOffset/=2);var discrete=this._discrete||"x",shapeConfig={discrete:this._discrete,duration:this._duration,label:function label(d){return _this3._drawLabel(d.data,d.i)},select:(0,elem.A)("g.d3plus-plot-shapes",{parent,transition,enter:{transform},update:{transform}}).node(),x:function x(d){return void 0!==d.x2?_x3(d.x2,"x2"):_x3(d.x)},x0:"x"===discrete?function(d){return d.x2?_x3(d.x2,"x2"):_x3(d.x)}:_x3("number"==typeof this._baseline?this._baseline:domains.x[0]),x1:"x"===discrete?null:function(d){return d.x2?_x3(d.x2,"x2"):_x3(d.x)},y:function y(d){return void 0!==d.y2?_y2(d.y2,"y2"):_y2(d.y)},y0:"y"===discrete?function(d){return d.y2?_y2(d.y2,"y2"):_y2(d.y)}:_y2("number"==typeof this._baseline?this._baseline:domains.y[1])-yOffset,y1:"y"===discrete?null:function(d){return d.y2?_y2(d.y2,"y2"):_y2(d.y)-yOffset}},events=Object.keys(this._on);shapeData.forEach((function(d){var shapeConfigInner=Object.assign({},shapeConfig);if(_this3._stacked&&["Area","Bar"].includes(d.key)){var scale="x"===opp?_x3:_y2;shapeConfigInner["".concat(opp)]=shapeConfigInner["".concat(opp,"0")]=function(d){var dataIndex=stackKeys.indexOf(d.id),discreteIndex=discreteKeys.indexOf(d.discrete);return scale(dataIndex>=0?stackData[dataIndex][discreteIndex][0]:domains[opp]["x"===opp?0:1])},shapeConfigInner["".concat(opp,"1")]=function(d){var dataIndex=stackKeys.indexOf(d.id),discreteIndex=discreteKeys.indexOf(d.discrete);return scale(dataIndex>=0?stackData[dataIndex][discreteIndex][1]:domains[opp]["x"===opp?0:1])}}var s=(new es[d.key]).config(shapeConfigInner).data(d.values);if("Bar"===d.key){var space,_scale="x"===_this3._discrete?_x3:_y2,scaleType="x"===_this3._discrete?xScale:yScale,vals="x"===_this3._discrete?xDomain:yDomain,_range="x"===_this3._discrete?xRange:yRange;if("Point"!==scaleType&&2===vals.length)space=Array.from(new Set(d.values.map((function(d){return _scale(d[_this3._discrete])})))).reduce((function(n,d,i,arr){if(i){var dist=Math.abs(d-arr[i-1]);dist<n&&(n=dist)}return n}),1/0);else space=vals.length>1?_scale(vals[1])-_scale(vals[0]):_range[_range.length-1]-_range[0];_this3._groupPadding<space&&(space-=_this3._groupPadding);var barSize=space||1,groups=(0,src.$I)().key((function(d){return d[_this3._discrete]})).key((function(d){return d.group})).entries(d.values),ids=(0,merge.A)(groups.map((function(d){return d.values.map((function(v){return v.key}))}))),uniqueIds=Array.from(new Set(ids));if(1===(0,max.A)(groups.map((function(d){return d.values.length}))))s[_this3._discrete]((function(d,i){return shapeConfig[_this3._discrete](d,i)}));else{var offset=space/2-(barSize=(barSize-_this3._barPadding*uniqueIds.length-1)/uniqueIds.length)/2,xMod=linear.A().domain([0,uniqueIds.length-1]).range([-offset,offset]);s[_this3._discrete]((function(d,i){return shapeConfig[_this3._discrete](d,i)+xMod(uniqueIds.indexOf(d.group))}))}s.width(barSize),s.height(barSize)}else if("Line"===d.key){if(s.duration(1.5*width),_this3._confidence){var areaConfig=Object.assign({},shapeConfig),_discrete2=_this3._discrete||"x",key="x"===_discrete2?"y":"x",scaleFunction="x"===_discrete2?_y2:_x3;areaConfig["".concat(key,"0")]=function(d){return scaleFunction(_this3._confidence[0]?d.lci:d[key])},areaConfig["".concat(key,"1")]=function(d){return scaleFunction(_this3._confidence[1]?d.hci:d[key])};var area=(new Area.A).config(areaConfig).data(d.values),confidenceConfig=Object.assign(_this3._shapeConfig,_this3._confidenceConfig);area.config((0,es_src_assign.A)(configPrep.A.bind(_this3)(confidenceConfig,"shape","Line"),configPrep.A.bind(_this3)(confidenceConfig,"shape","Area"))).render(),_this3._shapes.push(area)}s.config({discrete:shapeConfig.discrete||"x",label:!!_this3._lineLabels&&_this3._drawLabel,labelBounds:!!_this3._lineLabels&&function(d,i,s){var _s$points$=_slicedToArray(s.points[0],2),firstX=_s$points$[0],firstY=_s$points$[1],_s$points=_slicedToArray(s.points[s.points.length-1],2),lastX=_s$points[0],lastY=_s$points[1],height=_this3._height/4;return{x:lastX-firstX,y:lastY-firstY-height/2,width:largestLabel,height}}})}for(var classEvents=events.filter((function(e){return e.includes(".".concat(d.key))})),globalEvents=events.filter((function(e){return!e.includes(".")})),shapeEvents=events.filter((function(e){return e.includes(".shape")})),_loop=function _loop(e){s.on(globalEvents[e],(function(d,i,x,event){return _this3._on[globalEvents[e]](d.data,d.i,x,event)}))},e=0;e<globalEvents.length;e++)_loop(e);for(var _loop2=function _loop2(e){s.on(shapeEvents[e],(function(d,i,x,event){return _this3._on[shapeEvents[e]](d.data,d.i,x,event)}))},_e2=0;_e2<shapeEvents.length;_e2++)_loop2(_e2);for(var _loop3=function _loop3(e){s.on(classEvents[e],(function(d,i,x,event){return _this3._on[classEvents[e]](d.data,d.i,x,event)}))},_e3=0;_e3<classEvents.length;_e3++)_loop3(_e3);var userConfig=configPrep.A.bind(_this3)(_this3._shapeConfig,"shape",d.key);if(void 0===_this3._shapeConfig.duration&&delete userConfig.duration,s.config(userConfig).render(),_this3._shapes.push(s),"Line"===d.key){for(var markers=(new Circle.A).data(_this3._lineMarkers?d.values:[]).config(shapeConfig).config(_this3._lineMarkerConfig).id((function(d){return"".concat(d.id,"_").concat(d.discrete)})),_loop4=function _loop4(e){markers.on(globalEvents[e],(function(d,i,x,event){return _this3._on[globalEvents[e]](d.data,d.i,x,event)}))},_e4=0;_e4<globalEvents.length;_e4++)_loop4(_e4);for(var _loop5=function _loop5(e){markers.on(shapeEvents[e],(function(d,i,x,event){return _this3._on[shapeEvents[e]](d.data,d.i,x,event)}))},_e5=0;_e5<shapeEvents.length;_e5++)_loop5(_e5);for(var _loop6=function _loop6(e){markers.on(classEvents[e],(function(d,i,x,event){return _this3._on[classEvents[e]](d.data,d.i,x,event)}))},_e6=0;_e6<classEvents.length;_e6++)_loop6(_e6);markers.render(),_this3._shapes.push(markers)}}));var dataShapes=shapeData.map((function(d){return d.key}));dataShapes.includes("Line")&&(this._confidence&&dataShapes.push("Area"),this._lineMarkers&&dataShapes.push("Circle"));var exitShapes=this._previousShapes.filter((function(d){return!dataShapes.includes(d)}));return exitShapes.forEach((function(shape){(new es[shape]).config(shapeConfig).data([]).render()})),this._previousShapes=dataShapes,this}},{key:"annotations",value:function annotations(_){return arguments.length?(this._annotations=_ instanceof Array?_:[_],this):this._annotations}},{key:"backgroundConfig",value:function backgroundConfig(_){return arguments.length?(this._backgroundConfig=(0,es_src_assign.A)(this._backgroundConfig,_),this):this._backgroundConfig}},{key:"barPadding",value:function barPadding(_){return arguments.length?(this._barPadding=_,this):this._barPadding}},{key:"baseline",value:function baseline(_){return arguments.length?(this._baseline=_,this):this._baseline}},{key:"confidence",value:function confidence(_){if(arguments.length&&_ instanceof Array){this._confidence=[];var lower=_[0];this._confidence[0]="function"!=typeof lower&&lower?(0,accessor.A)(lower):lower;var upper=_[1];return this._confidence[1]="function"!=typeof upper&&upper?(0,accessor.A)(upper):upper,this}return this._confidence}},{key:"confidenceConfig",value:function confidenceConfig(_){return arguments.length?(this._confidenceConfig=(0,es_src_assign.A)(this._confidenceConfig,_),this):this._confidenceConfig}},{key:"discrete",value:function discrete(_){return arguments.length?(this._discrete=_,this):this._discrete}},{key:"discreteCutoff",value:function discreteCutoff(_){return arguments.length?(this._discreteCutoff=_,this):this._discreteCutoff}},{key:"groupPadding",value:function groupPadding(_){return arguments.length?(this._groupPadding=_,this):this._groupPadding}},{key:"labelPosition",value:function labelPosition(_){return arguments.length?(this._labelPosition="function"==typeof _?_:(0,constant.A)(_),this):this._labelPosition}},{key:"lineLabels",value:function lineLabels(_){return arguments.length?(this._lineLabels=_,this):this._lineLabels}},{key:"lineMarkerConfig",value:function lineMarkerConfig(_){return arguments.length?(this._lineMarkerConfig=(0,es_src_assign.A)(this._lineMarkerConfig,_),this):this._lineMarkerConfig}},{key:"lineMarkers",value:function lineMarkers(_){return arguments.length?(this._lineMarkers=_,this):this._lineMarkers}},{key:"shapeSort",value:function shapeSort(_){return arguments.length?(this._shapeSort=_,this):this._shapeSort}},{key:"size",value:function size(_){return arguments.length?(this._size="function"!=typeof _&&_?(0,accessor.A)(_):_,this):this._size}},{key:"sizeMax",value:function sizeMax(_){return arguments.length?(this._sizeMax=_,this):this._sizeMax}},{key:"sizeMin",value:function sizeMin(_){return arguments.length?(this._sizeMin=_,this):this._sizeMin}},{key:"sizeScale",value:function sizeScale(_){return arguments.length?(this._sizeScale=_,this):this._sizeScale}},{key:"stacked",value:function stacked(_){return arguments.length?(this._stacked=_,this):this._stacked}},{key:"stackOffset",value:function stackOffset(_){return arguments.length?(this._stackOffset="function"==typeof _?_:d3_shape_src["stackOffset".concat(_.charAt(0).toUpperCase()+_.slice(1))],this):this._stackOffset}},{key:"stackOrder",value:function stackOrder(_){return arguments.length?(this._stackOrder="string"==typeof _?"ascending"===_?stackOrderAscending:"descending"===_?stackOrderDescending:d3_shape_src["stackOrder".concat(_.charAt(0).toUpperCase()+_.slice(1))]:_,this):this._stackOrder}},{key:"x",value:function x(_){return arguments.length?("function"==typeof _?this._x=_:(this._x=(0,accessor.A)(_),this._xKey=_),this):this._x}},{key:"x2",value:function x2(_){return arguments.length?("function"==typeof _?this._x2=_:(this._x2=(0,accessor.A)(_),this._x2Key=_),this):this._x2}},{key:"xConfig",value:function xConfig(_){return arguments.length?(this._xConfig=(0,es_src_assign.A)(this._xConfig,_),this):this._xConfig}},{key:"xCutoff",value:function xCutoff(_){return arguments.length?(this._xCutoff=_,this):this._xCutoff}},{key:"x2Config",value:function x2Config(_){return arguments.length?(this._x2Config=(0,es_src_assign.A)(this._x2Config,_),this):this._x2Config}},{key:"xDomain",value:function xDomain(_){return arguments.length?(this._xDomain=_,this):this._xDomain}},{key:"x2Domain",value:function x2Domain(_){return arguments.length?(this._x2Domain=_,this):this._x2Domain}},{key:"xSort",value:function xSort(_){return arguments.length?(this._xSort=_,this):this._xSort}},{key:"x2Sort",value:function x2Sort(_){return arguments.length?(this._x2Sort=_,this):this._x2Sort}},{key:"y",value:function y(_){return arguments.length?("function"==typeof _?this._y=_:(this._y=(0,accessor.A)(_),this._yKey=_),this):this._y}},{key:"y2",value:function y2(_){return arguments.length?("function"==typeof _?this._y2=_:(this._y2=(0,accessor.A)(_),this._y2Key=_),this):this._y2}},{key:"yConfig",value:function yConfig(_){return arguments.length?(_.domain&&(_.domain=_.domain.slice().reverse()),this._yConfig=(0,es_src_assign.A)(this._yConfig,_),this):this._yConfig}},{key:"yCutoff",value:function yCutoff(_){return arguments.length?(this._yCutoff=_,this):this._yCutoff}},{key:"y2Config",value:function y2Config(_){return arguments.length?(_.domain&&(_.domain=_.domain.slice().reverse()),this._y2Config=(0,es_src_assign.A)(this._y2Config,_),this):this._y2Config}},{key:"yDomain",value:function yDomain(_){return arguments.length?(this._yDomain=_,this):this._yDomain}},{key:"y2Domain",value:function y2Domain(_){return arguments.length?(this._y2Domain=_,this):this._y2Domain}},{key:"ySort",value:function ySort(_){return arguments.length?(this._ySort=_,this):this._ySort}},{key:"y2Sort",value:function y2Sort(_){return arguments.length?(this._y2Sort=_,this):this._y2Sort}}]),Plot}(Viz.A)},"./node_modules/d3plus-react/es/src/Plot.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),d3plus_plot__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/d3plus-plot/es/src/Plot.js"),_Viz_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/d3plus-react/es/src/Viz.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const __WEBPACK_DEFAULT_EXPORT__=function Plot(props){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_Viz_js__WEBPACK_IMPORTED_MODULE_1__.A,_extends({type:d3plus_plot__WEBPACK_IMPORTED_MODULE_2__.A},props))}}}]);