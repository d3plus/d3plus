!function r(e,t,n){function a(o,l){if(!t[o]){if(!e[o]){var u="function"==typeof require&&require;if(!l&&u)return u(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var s=t[o]={exports:{}};e[o][0].call(s.exports,function(t){var n=e[o][1][t];return a(n?n:t)},s,s.exports,r,e,t,n)}return t[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,n){function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);var a,i=typeof e;if("number"===i)a=e>0?e>>>0:0;else if("string"===i)"base64"===t&&(e=E(e)),a=r.byteLength(e,t);else{if("object"!==i||null===e)throw new Error("First argument needs to be a number, array or string.");"Buffer"===e.type&&T(e.data)&&(e=e.data),a=+e.length>0?Math.floor(+e.length):0}var o;Y?o=r._augment(new Uint8Array(a)):(o=this,o.length=a,o._isBuffer=!0);var l;if(Y&&"number"==typeof e.byteLength)o._set(e);else if(N(e))if(r.isBuffer(e))for(l=0;a>l;l++)o[l]=e.readUInt8(l);else for(l=0;a>l;l++)o[l]=(e[l]%256+256)%256;else if("string"===i)o.write(e,0,t);else if("number"===i&&!Y&&!n)for(l=0;a>l;l++)o[l]=0;return o}function a(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r),r>a&&(r=a)):r=a;var i=t.length;D(i%2===0,"Invalid hex string"),r>i/2&&(r=i/2);for(var o=0;r>o;o++){var l=parseInt(t.substr(2*o,2),16);D(!isNaN(l),"Invalid hex string"),e[n+o]=l}return o}function i(e,t,n,r){var a=L(C(t),e,n,r);return a}function o(e,t,n,r){var a=L(F(t),e,n,r);return a}function l(e,t,n,r){return o(e,t,n,r)}function u(e,t,n,r){var a=L(P(t),e,n,r);return a}function s(e,t,n,r){var a=L(q(t),e,n,r);return a}function c(e,t,n){return R.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function d(e,t,n){var r="",a="";n=Math.min(e.length,n);for(var i=t;n>i;i++)e[i]<=127?(r+=I(a)+String.fromCharCode(e[i]),a=""):a+="%"+e[i].toString(16);return r+I(a)}function f(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;n>a;a++)r+=String.fromCharCode(e[a]);return r}function p(e,t,n){return f(e,t,n)}function h(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var a="",i=t;n>i;i++)a+=O(e[i]);return a}function g(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function v(e,t,n,r){r||(D("boolean"==typeof n,"missing or invalid endian"),D(void 0!==t&&null!==t,"missing offset"),D(t+1<e.length,"Trying to read beyond buffer length"));var a=e.length;if(!(t>=a)){var i;return n?(i=e[t],a>t+1&&(i|=e[t+1]<<8)):(i=e[t]<<8,a>t+1&&(i|=e[t+1])),i}}function m(e,t,n,r){r||(D("boolean"==typeof n,"missing or invalid endian"),D(void 0!==t&&null!==t,"missing offset"),D(t+3<e.length,"Trying to read beyond buffer length"));var a=e.length;if(!(t>=a)){var i;return n?(a>t+2&&(i=e[t+2]<<16),a>t+1&&(i|=e[t+1]<<8),i|=e[t],a>t+3&&(i+=e[t+3]<<24>>>0)):(a>t+1&&(i=e[t+1]<<16),a>t+2&&(i|=e[t+2]<<8),a>t+3&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}}function y(e,t,n,r){r||(D("boolean"==typeof n,"missing or invalid endian"),D(void 0!==t&&null!==t,"missing offset"),D(t+1<e.length,"Trying to read beyond buffer length"));var a=e.length;if(!(t>=a)){var i=v(e,t,n,!0),o=32768&i;return o?-1*(65535-i+1):i}}function x(e,t,n,r){r||(D("boolean"==typeof n,"missing or invalid endian"),D(void 0!==t&&null!==t,"missing offset"),D(t+3<e.length,"Trying to read beyond buffer length"));var a=e.length;if(!(t>=a)){var i=m(e,t,n,!0),o=2147483648&i;return o?-1*(4294967295-i+1):i}}function b(e,t,n,r){return r||(D("boolean"==typeof n,"missing or invalid endian"),D(t+3<e.length,"Trying to read beyond buffer length")),H.read(e,t,n,23,4)}function w(e,t,n,r){return r||(D("boolean"==typeof n,"missing or invalid endian"),D(t+7<e.length,"Trying to read beyond buffer length")),H.read(e,t,n,52,8)}function _(e,t,n,r,a){a||(D(void 0!==t&&null!==t,"missing value"),D("boolean"==typeof r,"missing or invalid endian"),D(void 0!==n&&null!==n,"missing offset"),D(n+1<e.length,"trying to write beyond buffer length"),V(t,65535));var i=e.length;if(!(n>=i)){for(var o=0,l=Math.min(i-n,2);l>o;o++)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o);return n+2}}function k(e,t,n,r,a){a||(D(void 0!==t&&null!==t,"missing value"),D("boolean"==typeof r,"missing or invalid endian"),D(void 0!==n&&null!==n,"missing offset"),D(n+3<e.length,"trying to write beyond buffer length"),V(t,4294967295));var i=e.length;if(!(n>=i)){for(var o=0,l=Math.min(i-n,4);l>o;o++)e[n+o]=t>>>8*(r?o:3-o)&255;return n+4}}function M(e,t,n,r,a){a||(D(void 0!==t&&null!==t,"missing value"),D("boolean"==typeof r,"missing or invalid endian"),D(void 0!==n&&null!==n,"missing offset"),D(n+1<e.length,"Trying to write beyond buffer length"),B(t,32767,-32768));var i=e.length;if(!(n>=i))return t>=0?_(e,t,n,r,a):_(e,65535+t+1,n,r,a),n+2}function A(e,t,n,r,a){a||(D(void 0!==t&&null!==t,"missing value"),D("boolean"==typeof r,"missing or invalid endian"),D(void 0!==n&&null!==n,"missing offset"),D(n+3<e.length,"Trying to write beyond buffer length"),B(t,2147483647,-2147483648));var i=e.length;if(!(n>=i))return t>=0?k(e,t,n,r,a):k(e,4294967295+t+1,n,r,a),n+4}function z(e,t,n,r,a){a||(D(void 0!==t&&null!==t,"missing value"),D("boolean"==typeof r,"missing or invalid endian"),D(void 0!==n&&null!==n,"missing offset"),D(n+3<e.length,"Trying to write beyond buffer length"),U(t,3.4028234663852886e38,-3.4028234663852886e38));var i=e.length;if(!(n>=i))return H.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,a){a||(D(void 0!==t&&null!==t,"missing value"),D("boolean"==typeof r,"missing or invalid endian"),D(void 0!==n&&null!==n,"missing offset"),D(n+7<e.length,"Trying to write beyond buffer length"),U(t,1.7976931348623157e308,-1.7976931348623157e308));var i=e.length;if(!(n>=i))return H.write(e,t,n,r,52,8),n+8}function E(e){for(e=S(e).replace(G,"");e.length%4!==0;)e+="=";return e}function S(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function T(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function N(e){return T(e)||r.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function O(e){return 16>e?"0"+e.toString(16):e.toString(16)}function C(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(127>=r)t.push(r);else{var a=n;r>=55296&&57343>=r&&n++;for(var i=encodeURIComponent(e.slice(a,n+1)).substr(1).split("%"),o=0;o<i.length;o++)t.push(parseInt(i[o],16))}}return t}function F(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function q(e){for(var t,n,r,a=[],i=0;i<e.length;i++)t=e.charCodeAt(i),n=t>>8,r=t%256,a.push(r),a.push(n);return a}function P(e){return R.toByteArray(e)}function L(e,t,n,r){for(var a=0;r>a&&!(a+n>=t.length||a>=e.length);a++)t[a+n]=e[a];return a}function I(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function V(e,t){D("number"==typeof e,"cannot write a non-number as a number"),D(e>=0,"specified a negative value for writing an unsigned value"),D(t>=e,"value is larger than maximum value for type"),D(Math.floor(e)===e,"value has a fractional component")}function B(e,t,n){D("number"==typeof e,"cannot write a non-number as a number"),D(t>=e,"value larger than maximum allowed value"),D(e>=n,"value smaller than minimum allowed value"),D(Math.floor(e)===e,"value has a fractional component")}function U(e,t,n){D("number"==typeof e,"cannot write a non-number as a number"),D(t>=e,"value larger than maximum allowed value"),D(e>=n,"value smaller than minimum allowed value")}function D(e,t){if(!e)throw new Error(t||"Failed assertion")}var R=e("base64-js"),H=e("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var Y=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}();r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(e){return!(null==e||!e._isBuffer)},r.byteLength=function(e,t){var n;switch(e=e.toString(),t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=C(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=P(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(e,t){if(D(T(e),"Usage: Buffer.concat(list[, length])"),0===e.length)return new r(0);if(1===e.length)return e[0];var n;if(void 0===t)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var a=new r(t),i=0;for(n=0;n<e.length;n++){var o=e[n];o.copy(a,i),i+=o.length}return a},r.compare=function(e,t){D(r.isBuffer(e)&&r.isBuffer(t),"Arguments must be Buffers");for(var n=e.length,a=t.length,i=0,o=Math.min(n,a);o>i&&e[i]===t[i];i++);return i!==o&&(n=e[i],a=t[i]),a>n?-1:n>a?1:0},r.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var c=r;r=t,t=n,n=c}t=Number(t)||0;var d=this.length-t;n?(n=Number(n),n>d&&(n=d)):n=d,r=String(r||"utf8").toLowerCase();var f;switch(r){case"hex":f=a(this,e,t,n);break;case"utf8":case"utf-8":f=i(this,e,t,n);break;case"ascii":f=o(this,e,t,n);break;case"binary":f=l(this,e,t,n);break;case"base64":f=u(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":f=s(this,e,t,n);break;default:throw new Error("Unknown encoding")}return f},r.prototype.toString=function(e,t,n){var r=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,n=void 0===n?r.length:Number(n),n===t)return"";var a;switch(e){case"hex":a=h(r,t,n);break;case"utf8":case"utf-8":a=d(r,t,n);break;case"ascii":a=f(r,t,n);break;case"binary":a=p(r,t,n);break;case"base64":a=c(r,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=g(r,t,n);break;default:throw new Error("Unknown encoding")}return a},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.equals=function(e){return D(r.isBuffer(e),"Argument must be a Buffer"),0===r.compare(this,e)},r.prototype.compare=function(e){return D(r.isBuffer(e),"Argument must be a Buffer"),r.compare(this,e)},r.prototype.copy=function(e,t,n,r){var a=this;if(n||(n=0),r||0===r||(r=this.length),t||(t=0),r!==n&&0!==e.length&&0!==a.length){D(r>=n,"sourceEnd < sourceStart"),D(t>=0&&t<e.length,"targetStart out of bounds"),D(n>=0&&n<a.length,"sourceStart out of bounds"),D(r>=0&&r<=a.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;if(100>i||!Y)for(var o=0;i>o;o++)e[o+t]=this[o+n];else e._set(this.subarray(n,n+i),t)}},r.prototype.slice=function(e,t){var n=this.length;if(e=~~e,t=void 0===t?n:~~t,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),e>t&&(t=e),Y)return r._augment(this.subarray(e,t));for(var a=t-e,i=new r(a,void 0,!0),o=0;a>o;o++)i[o]=this[o+e];return i},r.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},r.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},r.prototype.readUInt8=function(e,t){return t||(D(void 0!==e&&null!==e,"missing offset"),D(e<this.length,"Trying to read beyond buffer length")),e>=this.length?void 0:this[e]},r.prototype.readUInt16LE=function(e,t){return v(this,e,!0,t)},r.prototype.readUInt16BE=function(e,t){return v(this,e,!1,t)},r.prototype.readUInt32LE=function(e,t){return m(this,e,!0,t)},r.prototype.readUInt32BE=function(e,t){return m(this,e,!1,t)},r.prototype.readInt8=function(e,t){if(t||(D(void 0!==e&&null!==e,"missing offset"),D(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length)){var n=128&this[e];return n?-1*(255-this[e]+1):this[e]}},r.prototype.readInt16LE=function(e,t){return y(this,e,!0,t)},r.prototype.readInt16BE=function(e,t){return y(this,e,!1,t)},r.prototype.readInt32LE=function(e,t){return x(this,e,!0,t)},r.prototype.readInt32BE=function(e,t){return x(this,e,!1,t)},r.prototype.readFloatLE=function(e,t){return b(this,e,!0,t)},r.prototype.readFloatBE=function(e,t){return b(this,e,!1,t)},r.prototype.readDoubleLE=function(e,t){return w(this,e,!0,t)},r.prototype.readDoubleBE=function(e,t){return w(this,e,!1,t)},r.prototype.writeUInt8=function(e,t,n){return n||(D(void 0!==e&&null!==e,"missing value"),D(void 0!==t&&null!==t,"missing offset"),D(t<this.length,"trying to write beyond buffer length"),V(e,255)),t>=this.length?void 0:(this[t]=e,t+1)},r.prototype.writeUInt16LE=function(e,t,n){return _(this,e,t,!0,n)},r.prototype.writeUInt16BE=function(e,t,n){return _(this,e,t,!1,n)},r.prototype.writeUInt32LE=function(e,t,n){return k(this,e,t,!0,n)},r.prototype.writeUInt32BE=function(e,t,n){return k(this,e,t,!1,n)},r.prototype.writeInt8=function(e,t,n){return n||(D(void 0!==e&&null!==e,"missing value"),D(void 0!==t&&null!==t,"missing offset"),D(t<this.length,"Trying to write beyond buffer length"),B(e,127,-128)),t>=this.length?void 0:(e>=0?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n),t+1)},r.prototype.writeInt16LE=function(e,t,n){return M(this,e,t,!0,n)},r.prototype.writeInt16BE=function(e,t,n){return M(this,e,t,!1,n)},r.prototype.writeInt32LE=function(e,t,n){return A(this,e,t,!0,n)},r.prototype.writeInt32BE=function(e,t,n){return A(this,e,t,!1,n)},r.prototype.writeFloatLE=function(e,t,n){return z(this,e,t,!0,n)},r.prototype.writeFloatBE=function(e,t,n){return z(this,e,t,!1,n)},r.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},r.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},r.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),D(n>=t,"end < start"),n!==t&&0!==this.length){D(t>=0&&t<this.length,"start out of bounds"),D(n>=0&&n<=this.length,"end out of bounds");var r;if("number"==typeof e)for(r=t;n>r;r++)this[r]=e;else{var a=C(e.toString()),i=a.length;for(r=t;n>r;r++)this[r]=a[r%i]}return this}},r.prototype.inspect=function(){for(var e=[],t=this.length,r=0;t>r;r++)if(e[r]=O(this[r]),r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Y)return new r(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;n>t;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var X=r.prototype;r._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=X.get,e.set=X.set,e.write=X.write,e.toString=X.toString,e.toLocaleString=X.toString,e.toJSON=X.toJSON,e.equals=X.equals,e.compare=X.compare,e.copy=X.copy,e.slice=X.slice,e.readUInt8=X.readUInt8,e.readUInt16LE=X.readUInt16LE,e.readUInt16BE=X.readUInt16BE,e.readUInt32LE=X.readUInt32LE,e.readUInt32BE=X.readUInt32BE,e.readInt8=X.readInt8,e.readInt16LE=X.readInt16LE,e.readInt16BE=X.readInt16BE,e.readInt32LE=X.readInt32LE,e.readInt32BE=X.readInt32BE,e.readFloatLE=X.readFloatLE,e.readFloatBE=X.readFloatBE,e.readDoubleLE=X.readDoubleLE,e.readDoubleBE=X.readDoubleBE,e.writeUInt8=X.writeUInt8,e.writeUInt16LE=X.writeUInt16LE,e.writeUInt16BE=X.writeUInt16BE,e.writeUInt32LE=X.writeUInt32LE,e.writeUInt32BE=X.writeUInt32BE,e.writeInt8=X.writeInt8,e.writeInt16LE=X.writeInt16LE,e.writeInt16BE=X.writeInt16BE,e.writeInt32LE=X.writeInt32LE,e.writeInt32BE=X.writeInt32BE,e.writeFloatLE=X.writeFloatLE,e.writeFloatBE=X.writeFloatBE,e.writeDoubleLE=X.writeDoubleLE,e.writeDoubleBE=X.writeDoubleBE,e.fill=X.fill,e.inspect=X.inspect,e.toArrayBuffer=X.toArrayBuffer,e};var G=/[^+\/0-9A-z]/g},{"base64-js":2,ieee754:3}],2:[function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===o?62:t===l?63:u>t?-1:u+10>t?t-u+26+26:c+26>t?t-c:s+26>t?t-s+26:void 0}function n(e){function n(e){s[d++]=e}var r,a,o,l,u,s;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=e.length;u="="===e.charAt(c-2)?2:"="===e.charAt(c-1)?1:0,s=new i(3*e.length/4-u),o=u>0?e.length-4:e.length;var d=0;for(r=0,a=0;o>r;r+=4,a+=3)l=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&l)>>16),n((65280&l)>>8),n(255&l);return 2===u?(l=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&l)):1===u&&(l=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(l>>8&255),n(255&l)),s}function a(e){function t(e){return r.charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var a,i,o,l=e.length%3,u="";for(a=0,o=e.length-l;o>a;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],u+=n(i);switch(l){case 1:i=e[e.length-1],u+=t(i>>2),u+=t(i<<4&63),u+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],u+=t(i>>10),u+=t(i>>4&63),u+=t(i<<2&63),u+="="}return u}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="+".charCodeAt(0),l="/".charCodeAt(0),u="0".charCodeAt(0),s="a".charCodeAt(0),c="A".charCodeAt(0);e.toByteArray=n,e.fromByteArray=a}("undefined"==typeof n?this.base64js={}:n)},{}],3:[function(e,t,n){n.read=function(e,t,n,r,a){var i,o,l=8*a-r-1,u=(1<<l)-1,s=u>>1,c=-7,d=n?a-1:0,f=n?-1:1,p=e[t+d];for(d+=f,i=p&(1<<-c)-1,p>>=-c,c+=l;c>0;i=256*i+e[t+d],d+=f,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=r;c>0;o=256*o+e[t+d],d+=f,c-=8);if(0===i)i=1-s;else{if(i===u)return o?0/0:1/0*(p?-1:1);o+=Math.pow(2,r),i-=s}return(p?-1:1)*o*Math.pow(2,i-r)},n.write=function(e,t,n,r,a,i){var o,l,u,s=8*i-a-1,c=(1<<s)-1,d=c>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,h=r?1:-1,g=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(l=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),t+=o+d>=1?f/u:f*Math.pow(2,1-d),t*u>=2&&(o++,u/=2),o+d>=c?(l=0,o=c):o+d>=1?(l=(t*u-1)*Math.pow(2,a),o+=d):(l=t*Math.pow(2,d-1)*Math.pow(2,a),o=0));a>=8;e[n+p]=255&l,p+=h,l/=256,a-=8);for(o=o<<a|l,s+=a;s>0;e[n+p]=255&o,p+=h,o/=256,s-=8);e[n+p-h]|=128*g}},{}],4:[function(e,t){!function(){function e(e,t){return t>e?-1:e>t?1:e>=t?0:0/0}function n(e){return null!=e&&!isNaN(e)}function r(e){return{left:function(t,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=t.length);a>r;){var i=r+a>>>1;e(t[i],n)<0?r=i+1:a=i}return r},right:function(t,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=t.length);a>r;){var i=r+a>>>1;e(t[i],n)>0?a=i:r=i+1}return r}}}function a(e){return e.length}function i(e){for(var t=1;e*t%1;)t*=10;return t}function o(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function l(){}function u(e){return ll+e in this}function s(e){return e=ll+e,e in this&&delete this[e]}function c(){var e=[];return this.forEach(function(t){e.push(t)}),e}function d(){var e=0;for(var t in this)t.charCodeAt(0)===ul&&++e;return e}function f(){for(var e in this)if(e.charCodeAt(0)===ul)return!1;return!0}function p(){}function h(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function g(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.substring(1);for(var n=0,r=sl.length;r>n;++n){var a=sl[n]+t;if(a in e)return a}}function v(){}function m(){}function y(e){function t(){for(var t,r=n,a=-1,i=r.length;++a<i;)(t=r[a].on)&&t.apply(this,arguments);return e}var n=[],r=new l;return t.on=function(t,a){var i,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,n=n.slice(0,i=n.indexOf(o)).concat(n.slice(i+1)),r.remove(t)),a&&n.push(r.set(t,{on:a})),e)},t}function x(){Xo.event.preventDefault()}function b(){for(var e,t=Xo.event;e=t.sourceEvent;)t=e;return t}function w(e){for(var t=new m,n=0,r=arguments.length;++n<r;)t[arguments[n]]=y(t);return t.of=function(n,r){return function(a){try{var i=a.sourceEvent=Xo.event;a.target=e,Xo.event=a,t[a.type].apply(n,r)}finally{Xo.event=i}}},t}function _(e){return dl(e,vl),e}function k(e){return"function"==typeof e?e:function(){return fl(e,this)}}function M(e){return"function"==typeof e?e:function(){return pl(e,this)}}function A(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function a(){this.setAttribute(e,t)}function i(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}function l(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=Xo.ns.qualify(e),null==t?e.local?r:n:"function"==typeof t?e.local?l:o:e.local?i:a}function z(e){return e.trim().replace(/\s+/g," ")}function j(e){return new RegExp("(?:^|\\s+)"+Xo.requote(e)+"(?:\\s+|$)","g")}function E(e){return(e+"").trim().split(/^|\s+/)}function S(e,t){function n(){for(var n=-1;++n<a;)e[n](this,t)}function r(){for(var n=-1,r=t.apply(this,arguments);++n<a;)e[n](this,r)}e=E(e).map(T);var a=e.length;return"function"==typeof t?r:n}function T(e){var t=j(e);return function(n,r){if(a=n.classList)return r?a.add(e):a.remove(e);var a=n.getAttribute("class")||"";r?(t.lastIndex=0,t.test(a)||n.setAttribute("class",z(a+" "+e))):n.setAttribute("class",z(a.replace(t," ")))}}function N(e,t,n){function r(){this.style.removeProperty(e)}function a(){this.style.setProperty(e,t,n)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return null==t?r:"function"==typeof t?i:a}function O(e,t){function n(){delete this[e]}function r(){this[e]=t}function a(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==t?n:"function"==typeof t?a:r}function C(e){return"function"==typeof e?e:(e=Xo.ns.qualify(e)).local?function(){return this.ownerDocument.createElementNS(e.space,e.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,e)}}function F(e){return{__data__:e}}function q(e){return function(){return gl(this,e)}}function P(t){return arguments.length||(t=e),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function L(e,t){for(var n=0,r=e.length;r>n;n++)for(var a,i=e[n],o=0,l=i.length;l>o;o++)(a=i[o])&&t(a,o,n);return e}function I(e){return dl(e,yl),e}function V(e){var t,n;return function(r,a,i){var o,l=e[i].update,u=l.length;for(i!=n&&(n=i,t=0),a>=t&&(t=a+1);!(o=l[t])&&++t<u;);return o}}function B(){var e=this.__transition__;e&&++e.active}function U(e,t,n){function r(){var t=this[o];t&&(this.removeEventListener(e,t,t.$),delete this[o])}function a(){var a=u(t,Zo(arguments));r.call(this),this.addEventListener(e,this[o]=a,a.$=n),a._=t}function i(){var t,n=new RegExp("^__on([^.]+)"+Xo.requote(e)+"$");for(var r in this)if(t=r.match(n)){var a=this[r];this.removeEventListener(t[1],a,a.$),delete this[r]}}var o="__on"+e,l=e.indexOf("."),u=D;l>0&&(e=e.substring(0,l));var s=bl.get(e);return s&&(e=s,u=R),l?t?a:r:t?v:i}function D(e,t){return function(n){var r=Xo.event;Xo.event=n,t[0]=this.__data__;try{e.apply(this,t)}finally{Xo.event=r}}}function R(e,t){var n=D(e,t);return function(e){var t=this,r=e.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||n.call(t,e)}}function H(){var e=".dragsuppress-"+ ++_l,t="click"+e,n=Xo.select(Qo).on("touchmove"+e,x).on("dragstart"+e,x).on("selectstart"+e,x);if(wl){var r=Jo.style,a=r[wl];r[wl]="none"}return function(i){function o(){n.on(t,null)}n.on(e,null),wl&&(r[wl]=a),i&&(n.on(t,function(){x(),o()},!0),setTimeout(o,0))}}function Y(e,t){t.changedTouches&&(t=t.changedTouches[0]);var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(0>kl&&(Qo.scrollX||Qo.scrollY)){n=Xo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=n[0][0].getScreenCTM();kl=!(a.f||a.e),n.remove()}return kl?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function X(){return Xo.event.changedTouches[0].identifier}function G(){return Xo.event.target}function Z(){return Qo}function W(e){return e>0?1:0>e?-1:0}function J(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function Q(e){return e>1?0:-1>e?Ml:Math.acos(e)}function $(e){return e>1?zl:-1>e?-zl:Math.asin(e)}function K(e){return((e=Math.exp(e))-1/e)/2}function et(e){return((e=Math.exp(e))+1/e)/2}function tt(e){return((e=Math.exp(2*e))-1)/(e+1)}function nt(e){return(e=Math.sin(e/2))*e}function rt(){}function at(e,t,n){return this instanceof at?(this.h=+e,this.s=+t,void(this.l=+n)):arguments.length<2?e instanceof at?new at(e.h,e.s,e.l):yt(""+e,xt,at):new at(e,t,n)}function it(e,t,n){function r(e){return e>360?e-=360:0>e&&(e+=360),60>e?i+(o-i)*e/60:180>e?o:240>e?i+(o-i)*(240-e)/60:i}function a(e){return Math.round(255*r(e))}var i,o;return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:0>t?0:t>1?1:t,n=0>n?0:n>1?1:n,o=.5>=n?n*(1+t):n+t-n*t,i=2*n-o,new ht(a(e+120),a(e),a(e-120))}function ot(e,t,n){return this instanceof ot?(this.h=+e,this.c=+t,void(this.l=+n)):arguments.length<2?e instanceof ot?new ot(e.h,e.c,e.l):e instanceof ut?ct(e.l,e.a,e.b):ct((e=bt((e=Xo.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new ot(e,t,n)}function lt(e,t,n){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new ut(n,Math.cos(e*=Sl)*t,Math.sin(e)*t)}function ut(e,t,n){return this instanceof ut?(this.l=+e,this.a=+t,void(this.b=+n)):arguments.length<2?e instanceof ut?new ut(e.l,e.a,e.b):e instanceof ot?lt(e.l,e.c,e.h):bt((e=ht(e)).r,e.g,e.b):new ut(e,t,n)}function st(e,t,n){var r=(e+16)/116,a=r+t/500,i=r-n/200;return a=dt(a)*Bl,r=dt(r)*Ul,i=dt(i)*Dl,new ht(pt(3.2404542*a-1.5371385*r-.4985314*i),pt(-.969266*a+1.8760108*r+.041556*i),pt(.0556434*a-.2040259*r+1.0572252*i))}function ct(e,t,n){return e>0?new ot(Math.atan2(n,t)*Tl,Math.sqrt(t*t+n*n),e):new ot(0/0,0/0,e)}function dt(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ft(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function pt(e){return Math.round(255*(.00304>=e?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function ht(e,t,n){return this instanceof ht?(this.r=~~e,this.g=~~t,void(this.b=~~n)):arguments.length<2?e instanceof ht?new ht(e.r,e.g,e.b):yt(""+e,ht,it):new ht(e,t,n)}function gt(e){return new ht(e>>16,e>>8&255,255&e)}function vt(e){return gt(e)+""}function mt(e){return 16>e?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function yt(e,t,n){var r,a,i,o=0,l=0,u=0;if(r=/([a-z]+)\((.*)\)/i.exec(e))switch(a=r[2].split(","),r[1]){case"hsl":return n(parseFloat(a[0]),parseFloat(a[1])/100,parseFloat(a[2])/100);case"rgb":return t(_t(a[0]),_t(a[1]),_t(a[2]))}return(i=Yl.get(e))?t(i.r,i.g,i.b):(null==e||"#"!==e.charAt(0)||isNaN(i=parseInt(e.substring(1),16))||(4===e.length?(o=(3840&i)>>4,o=o>>4|o,l=240&i,l=l>>4|l,u=15&i,u=u<<4|u):7===e.length&&(o=(16711680&i)>>16,l=(65280&i)>>8,u=255&i)),t(o,l,u))}function xt(e,t,n){var r,a,i=Math.min(e/=255,t/=255,n/=255),o=Math.max(e,t,n),l=o-i,u=(o+i)/2;return l?(a=.5>u?l/(o+i):l/(2-o-i),r=e==o?(t-n)/l+(n>t?6:0):t==o?(n-e)/l+2:(e-t)/l+4,r*=60):(r=0/0,a=u>0&&1>u?0:r),new at(r,a,u)}function bt(e,t,n){e=wt(e),t=wt(t),n=wt(n);var r=ft((.4124564*e+.3575761*t+.1804375*n)/Bl),a=ft((.2126729*e+.7151522*t+.072175*n)/Ul),i=ft((.0193339*e+.119192*t+.9503041*n)/Dl);return ut(116*a-16,500*(r-a),200*(a-i))}function wt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function _t(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function kt(e){return"function"==typeof e?e:function(){return e}}function Mt(e){return e}function At(e){return function(t,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),zt(t,n,e,r)}}function zt(e,t,n,r){function a(){var e,t=u.status;if(!t&&u.responseText||t>=200&&300>t||304===t){try{e=n.call(i,u)}catch(r){return void o.error.call(i,r)}o.load.call(i,e)}else o.error.call(i,u)}var i={},o=Xo.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,s=null;return!Qo.XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(e)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=a:u.onreadystatechange=function(){u.readyState>3&&a()},u.onprogress=function(e){var t=Xo.event;Xo.event=e;try{o.progress.call(i,u)}finally{Xo.event=t}},i.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?l[e]:(null==t?delete l[e]:l[e]=t+"",i)},i.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",i):t},i.responseType=function(e){return arguments.length?(s=e,i):s},i.response=function(e){return n=e,i},["get","post"].forEach(function(e){i[e]=function(){return i.send.apply(i,[e].concat(Zo(arguments)))}}),i.send=function(n,r,a){if(2===arguments.length&&"function"==typeof r&&(a=r,r=null),u.open(n,e,!0),null==t||"accept"in l||(l.accept=t+",*/*"),u.setRequestHeader)for(var c in l)u.setRequestHeader(c,l[c]);return null!=t&&u.overrideMimeType&&u.overrideMimeType(t),null!=s&&(u.responseType=s),null!=a&&i.on("error",a).on("load",function(e){a(null,e)}),o.beforesend.call(i,u),u.send(null==r?null:r),i},i.abort=function(){return u.abort(),i},Xo.rebind(i,o,"on"),null==r?i:i.get(jt(r))}function jt(e){return 1===e.length?function(t,n){e(null==t?n:null)}:e}function Et(){var e=St(),t=Tt()-e;t>24?(isFinite(t)&&(clearTimeout(Wl),Wl=setTimeout(Et,t)),Zl=0):(Zl=1,Ql(Et))}function St(){var e=Date.now();for(Jl=Xl;Jl;)e>=Jl.t&&(Jl.f=Jl.c(e-Jl.t)),Jl=Jl.n;return e}function Tt(){for(var e,t=Xl,n=1/0;t;)t.f?t=e?e.n=t.n:Xl=t.n:(t.t<n&&(n=t.t),t=(e=t).n);return Gl=e,n}function Nt(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function Ot(e,t){var n=Math.pow(10,3*ol(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function Ct(e){var t=e.decimal,n=e.thousands,r=e.grouping,a=e.currency,i=r?function(e){for(var t=e.length,a=[],i=0,o=r[0];t>0&&o>0;)a.push(e.substring(t-=o,t+o)),o=r[i=(i+1)%r.length];return a.reverse().join(n)}:Mt;return function(e){var n=Kl.exec(e),r=n[1]||" ",o=n[2]||">",l=n[3]||"",u=n[4]||"",s=n[5],c=+n[6],d=n[7],f=n[8],p=n[9],h=1,g="",v="",m=!1;switch(f&&(f=+f.substring(1)),(s||"0"===r&&"="===o)&&(s=r="0",o="=",d&&(c-=Math.floor((c-1)/4))),p){case"n":d=!0,p="g";break;case"%":h=100,v="%",p="f";break;case"p":h=100,v="%",p="r";break;case"b":case"o":case"x":case"X":"#"===u&&(g="0"+p.toLowerCase());case"c":case"d":m=!0,f=0;break;case"s":h=-1,p="r"}"$"===u&&(g=a[0],v=a[1]),"r"!=p||f||(p="g"),null!=f&&("g"==p?f=Math.max(1,Math.min(21,f)):("e"==p||"f"==p)&&(f=Math.max(0,Math.min(20,f)))),p=eu.get(p)||Ft;var y=s&&d;return function(e){var n=v;if(m&&e%1)return"";var a=0>e||0===e&&0>1/e?(e=-e,"-"):l;if(0>h){var u=Xo.formatPrefix(e,f);e=u.scale(e),n=u.symbol+v}else e*=h;e=p(e,f);var x=e.lastIndexOf("."),b=0>x?e:e.substring(0,x),w=0>x?"":t+e.substring(x+1);!s&&d&&(b=i(b));var _=g.length+b.length+w.length+(y?0:a.length),k=c>_?new Array(_=c-_+1).join(r):"";return y&&(b=i(k+b)),a+=g,e=b+w,("<"===o?a+e+k:">"===o?k+a+e:"^"===o?k.substring(0,_>>=1)+a+e+k.substring(_):a+(y?e:k+e))+n}}}function Ft(e){return e+""}function qt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Pt(e,t,n){function r(t){var n=e(t),r=i(n,1);return r-t>t-n?n:r}function a(n){return t(n=e(new nu(n-1)),1),n}function i(e,n){return t(e=new nu(+e),n),e}function o(e,r,i){var o=a(e),l=[];if(i>1)for(;r>o;)n(o)%i||l.push(new Date(+o)),t(o,1);else for(;r>o;)l.push(new Date(+o)),t(o,1);return l}function l(e,t,n){try{nu=qt;var r=new qt;return r._=e,o(r,t,n)}finally{nu=Date}}e.floor=e,e.round=r,e.ceil=a,e.offset=i,e.range=o;var u=e.utc=Lt(e);return u.floor=u,u.round=Lt(r),u.ceil=Lt(a),u.offset=Lt(i),u.range=l,e}function Lt(e){return function(t,n){try{nu=qt;var r=new qt;return r._=t,e(r,n)._}finally{nu=Date}}}function It(e){function t(e){function t(t){for(var n,a,i,o=[],l=-1,u=0;++l<r;)37===e.charCodeAt(l)&&(o.push(e.substring(u,l)),null!=(a=au[n=e.charAt(++l)])&&(n=e.charAt(++l)),(i=E[n])&&(n=i(t,null==a?"e"===n?" ":"0":a)),o.push(n),u=l+1);return o.push(e.substring(u,l)),o.join("")}var r=e.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},a=n(r,e,t,0);if(a!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&nu!==qt,o=new(i?qt:nu);return"j"in r?o.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+Math.floor(r.Z/100),r.M+r.Z%100,r.S,r.L),i?o._:o
},t.toString=function(){return e},t}function n(e,t,n,r){for(var a,i,o,l=0,u=t.length,s=n.length;u>l;){if(r>=s)return-1;if(a=t.charCodeAt(l++),37===a){if(o=t.charAt(l++),i=S[o in au?t.charAt(l++):o],!i||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}function r(e,t,n){_.lastIndex=0;var r=_.exec(t.substring(n));return r?(e.w=k.get(r[0].toLowerCase()),n+r[0].length):-1}function a(e,t,n){b.lastIndex=0;var r=b.exec(t.substring(n));return r?(e.w=w.get(r[0].toLowerCase()),n+r[0].length):-1}function i(e,t,n){z.lastIndex=0;var r=z.exec(t.substring(n));return r?(e.m=j.get(r[0].toLowerCase()),n+r[0].length):-1}function o(e,t,n){M.lastIndex=0;var r=M.exec(t.substring(n));return r?(e.m=A.get(r[0].toLowerCase()),n+r[0].length):-1}function l(e,t,r){return n(e,E.c.toString(),t,r)}function u(e,t,r){return n(e,E.x.toString(),t,r)}function s(e,t,r){return n(e,E.X.toString(),t,r)}function c(e,t,n){var r=x.get(t.substring(n,n+=2).toLowerCase());return null==r?-1:(e.p=r,n)}var d=e.dateTime,f=e.date,p=e.time,h=e.periods,g=e.days,v=e.shortDays,m=e.months,y=e.shortMonths;t.utc=function(e){function n(e){try{nu=qt;var t=new nu;return t._=e,r(t)}finally{nu=Date}}var r=t(e);return n.parse=function(e){try{nu=qt;var t=r.parse(e);return t&&t._}finally{nu=Date}},n.toString=r.toString,n},t.multi=t.utc.multi=an;var x=Xo.map(),b=Bt(g),w=Ut(g),_=Bt(v),k=Ut(v),M=Bt(m),A=Ut(m),z=Bt(y),j=Ut(y);h.forEach(function(e,t){x.set(e.toLowerCase(),t)});var E={a:function(e){return v[e.getDay()]},A:function(e){return g[e.getDay()]},b:function(e){return y[e.getMonth()]},B:function(e){return m[e.getMonth()]},c:t(d),d:function(e,t){return Vt(e.getDate(),t,2)},e:function(e,t){return Vt(e.getDate(),t,2)},H:function(e,t){return Vt(e.getHours(),t,2)},I:function(e,t){return Vt(e.getHours()%12||12,t,2)},j:function(e,t){return Vt(1+tu.dayOfYear(e),t,3)},L:function(e,t){return Vt(e.getMilliseconds(),t,3)},m:function(e,t){return Vt(e.getMonth()+1,t,2)},M:function(e,t){return Vt(e.getMinutes(),t,2)},p:function(e){return h[+(e.getHours()>=12)]},S:function(e,t){return Vt(e.getSeconds(),t,2)},U:function(e,t){return Vt(tu.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Vt(tu.mondayOfYear(e),t,2)},x:t(f),X:t(p),y:function(e,t){return Vt(e.getFullYear()%100,t,2)},Y:function(e,t){return Vt(e.getFullYear()%1e4,t,4)},Z:nn,"%":function(){return"%"}},S={a:r,A:a,b:i,B:o,c:l,d:Jt,e:Jt,H:$t,I:$t,j:Qt,L:tn,m:Wt,M:Kt,p:c,S:en,U:Rt,w:Dt,W:Ht,x:u,X:s,y:Xt,Y:Yt,Z:Gt,"%":rn};return t}function Vt(e,t,n){var r=0>e?"-":"",a=(r?-e:e)+"",i=a.length;return r+(n>i?new Array(n-i+1).join(t)+a:a)}function Bt(e){return new RegExp("^(?:"+e.map(Xo.requote).join("|")+")","i")}function Ut(e){for(var t=new l,n=-1,r=e.length;++n<r;)t.set(e[n].toLowerCase(),n);return t}function Dt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Rt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n));return r?(e.U=+r[0],n+r[0].length):-1}function Ht(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n));return r?(e.W=+r[0],n+r[0].length):-1}function Yt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Xt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+2));return r?(e.y=Zt(+r[0]),n+r[0].length):-1}function Gt(e,t,n){return/^[+-]\d{4}$/.test(t=t.substring(n,n+5))?(e.Z=-t,n+5):-1}function Zt(e){return e+(e>68?1900:2e3)}function Wt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Jt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Qt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+3));return r?(e.j=+r[0],n+r[0].length):-1}function $t(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Kt(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function en(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function tn(e,t,n){iu.lastIndex=0;var r=iu.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function nn(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(ol(t)/60),a=ol(t)%60;return n+Vt(r,"0",2)+Vt(a,"0",2)}function rn(e,t,n){ou.lastIndex=0;var r=ou.exec(t.substring(n,n+1));return r?n+r[0].length:-1}function an(e){for(var t=e.length,n=-1;++n<t;)e[n][0]=this(e[n][0]);return function(t){for(var n=0,r=e[n];!r[1](t);)r=e[++n];return r[0](t)}}function on(){}function ln(e,t,n){var r=n.s=e+t,a=r-e,i=r-a;n.t=e-i+(t-a)}function un(e,t){e&&cu.hasOwnProperty(e.type)&&cu[e.type](e,t)}function sn(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function cn(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)sn(e[n],t,1);t.polygonEnd()}function dn(){function e(e,t){e*=Sl,t=t*Sl/2+Ml/4;var n=e-r,o=n>=0?1:-1,l=o*n,u=Math.cos(t),s=Math.sin(t),c=i*s,d=a*u+c*Math.cos(l),f=c*o*Math.sin(l);fu.add(Math.atan2(f,d)),r=e,a=u,i=s}var t,n,r,a,i;pu.point=function(o,l){pu.point=e,r=(t=o)*Sl,a=Math.cos(l=(n=l)*Sl/2+Ml/4),i=Math.sin(l)},pu.lineEnd=function(){e(t,n)}}function fn(e){var t=e[0],n=e[1],r=Math.cos(n);return[r*Math.cos(t),r*Math.sin(t),Math.sin(n)]}function pn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hn(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function gn(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function vn(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function mn(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function yn(e){return[Math.atan2(e[1],e[0]),$(e[2])]}function xn(e,t){return ol(e[0]-t[0])<jl&&ol(e[1]-t[1])<jl}function bn(e,t){e*=Sl;var n=Math.cos(t*=Sl);wn(n*Math.cos(e),n*Math.sin(e),Math.sin(t))}function wn(e,t,n){++hu,vu+=(e-vu)/hu,mu+=(t-mu)/hu,yu+=(n-yu)/hu}function _n(){function e(e,a){e*=Sl;var i=Math.cos(a*=Sl),o=i*Math.cos(e),l=i*Math.sin(e),u=Math.sin(a),s=Math.atan2(Math.sqrt((s=n*u-r*l)*s+(s=r*o-t*u)*s+(s=t*l-n*o)*s),t*o+n*l+r*u);gu+=s,xu+=s*(t+(t=o)),bu+=s*(n+(n=l)),wu+=s*(r+(r=u)),wn(t,n,r)}var t,n,r;Au.point=function(a,i){a*=Sl;var o=Math.cos(i*=Sl);t=o*Math.cos(a),n=o*Math.sin(a),r=Math.sin(i),Au.point=e,wn(t,n,r)}}function kn(){Au.point=bn}function Mn(){function e(e,t){e*=Sl;var n=Math.cos(t*=Sl),o=n*Math.cos(e),l=n*Math.sin(e),u=Math.sin(t),s=a*u-i*l,c=i*o-r*u,d=r*l-a*o,f=Math.sqrt(s*s+c*c+d*d),p=r*o+a*l+i*u,h=f&&-Q(p)/f,g=Math.atan2(f,p);_u+=h*s,ku+=h*c,Mu+=h*d,gu+=g,xu+=g*(r+(r=o)),bu+=g*(a+(a=l)),wu+=g*(i+(i=u)),wn(r,a,i)}var t,n,r,a,i;Au.point=function(o,l){t=o,n=l,Au.point=e,o*=Sl;var u=Math.cos(l*=Sl);r=u*Math.cos(o),a=u*Math.sin(o),i=Math.sin(l),wn(r,a,i)},Au.lineEnd=function(){e(t,n),Au.lineEnd=kn,Au.point=bn}}function An(){return!0}function zn(e,t,n,r,a){var i=[],o=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n=e[0],r=e[t];if(xn(n,r)){a.lineStart();for(var l=0;t>l;++l)a.point((n=e[l])[0],n[1]);return void a.lineEnd()}var u=new En(n,e,null,!0),s=new En(n,null,u,!1);u.o=s,i.push(u),o.push(s),u=new En(r,e,null,!1),s=new En(r,null,u,!0),u.o=s,i.push(u),o.push(s)}}),o.sort(t),jn(i),jn(o),i.length){for(var l=0,u=n,s=o.length;s>l;++l)o[l].e=u=!u;for(var c,d,f=i[0];;){for(var p=f,h=!0;p.v;)if((p=p.n)===f)return;c=p.z,a.lineStart();do{if(p.v=p.o.v=!0,p.e){if(h)for(var l=0,s=c.length;s>l;++l)a.point((d=c[l])[0],d[1]);else r(p.x,p.n.x,1,a);p=p.n}else{if(h){c=p.p.z;for(var l=c.length-1;l>=0;--l)a.point((d=c[l])[0],d[1])}else r(p.x,p.p.x,-1,a);p=p.p}p=p.o,c=p.z,h=!h}while(!p.v);a.lineEnd()}}}function jn(e){if(t=e.length){for(var t,n,r=0,a=e[0];++r<t;)a.n=n=e[r],n.p=a,a=n;a.n=n=e[0],n.p=a}}function En(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Sn(e,t,n,r){return function(a,i){function o(t,n){var r=a(t,n);e(t=r[0],n=r[1])&&i.point(t,n)}function l(e,t){var n=a(e,t);v.point(n[0],n[1])}function u(){y.point=l,v.lineStart()}function s(){y.point=o,v.lineEnd()}function c(e,t){g.push([e,t]);var n=a(e,t);b.point(n[0],n[1])}function d(){b.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),b.lineEnd();var e,t=b.clean(),n=x.buffer(),r=n.length;if(g.pop(),h.push(g),g=null,r)if(1&t){e=n[0];var a,r=e.length-1,o=-1;if(r>0){for(w||(i.polygonStart(),w=!0),i.lineStart();++o<r;)i.point((a=e[o])[0],a[1]);i.lineEnd()}}else r>1&&2&t&&n.push(n.pop().concat(n.shift())),p.push(n.filter(Tn))}var p,h,g,v=t(i),m=a.invert(r[0],r[1]),y={point:o,lineStart:u,lineEnd:s,polygonStart:function(){y.point=c,y.lineStart=d,y.lineEnd=f,p=[],h=[]},polygonEnd:function(){y.point=o,y.lineStart=u,y.lineEnd=s,p=Xo.merge(p);var e=Cn(m,h);p.length?(w||(i.polygonStart(),w=!0),zn(p,On,e,n,i)):e&&(w||(i.polygonStart(),w=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),w&&(i.polygonEnd(),w=!1),p=h=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}},x=Nn(),b=t(x),w=!1;return y}}function Tn(e){return e.length>1}function Nn(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(t,n){e.push([t,n])},lineEnd:v,buffer:function(){var n=t;return t=[],e=null,n},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function On(e,t){return((e=e.x)[0]<0?e[1]-zl-jl:zl-e[1])-((t=t.x)[0]<0?t[1]-zl-jl:zl-t[1])}function Cn(e,t){var n=e[0],r=e[1],a=[Math.sin(n),-Math.cos(n),0],i=0,o=0;fu.reset();for(var l=0,u=t.length;u>l;++l){var s=t[l],c=s.length;if(c)for(var d=s[0],f=d[0],p=d[1]/2+Ml/4,h=Math.sin(p),g=Math.cos(p),v=1;;){v===c&&(v=0),e=s[v];var m=e[0],y=e[1]/2+Ml/4,x=Math.sin(y),b=Math.cos(y),w=m-f,_=w>=0?1:-1,k=_*w,M=k>Ml,A=h*x;if(fu.add(Math.atan2(A*_*Math.sin(k),g*b+A*Math.cos(k))),i+=M?w+_*Al:w,M^f>=n^m>=n){var z=hn(fn(d),fn(e));mn(z);var j=hn(a,z);mn(j);var E=(M^w>=0?-1:1)*$(j[2]);(r>E||r===E&&(z[0]||z[1]))&&(o+=M^w>=0?1:-1)}if(!v++)break;f=m,h=x,g=b,d=e}}return(-jl>i||jl>i&&0>fu)^1&o}function Fn(e){var t,n=0/0,r=0/0,a=0/0;return{lineStart:function(){e.lineStart(),t=1},point:function(i,o){var l=i>0?Ml:-Ml,u=ol(i-n);ol(u-Ml)<jl?(e.point(n,r=(r+o)/2>0?zl:-zl),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(l,r),e.point(i,r),t=0):a!==l&&u>=Ml&&(ol(n-a)<jl&&(n-=a*jl),ol(i-l)<jl&&(i-=l*jl),r=qn(n,r,i,o),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(l,r),t=0),e.point(n=i,r=o),a=l},lineEnd:function(){e.lineEnd(),n=r=0/0},clean:function(){return 2-t}}}function qn(e,t,n,r){var a,i,o=Math.sin(e-n);return ol(o)>jl?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(n)-Math.sin(r)*(a=Math.cos(t))*Math.sin(e))/(a*i*o)):(t+r)/2}function Pn(e,t,n,r){var a;if(null==e)a=n*zl,r.point(-Ml,a),r.point(0,a),r.point(Ml,a),r.point(Ml,0),r.point(Ml,-a),r.point(0,-a),r.point(-Ml,-a),r.point(-Ml,0),r.point(-Ml,a);else if(ol(e[0]-t[0])>jl){var i=e[0]<t[0]?Ml:-Ml;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(t[0],t[1])}function Ln(e){function t(e,t){return Math.cos(e)*Math.cos(t)>i}function n(e){var n,i,u,s,c;return{lineStart:function(){s=u=!1,c=1},point:function(d,f){var p,h=[d,f],g=t(d,f),v=o?g?0:a(d,f):g?a(d+(0>d?Ml:-Ml),f):0;if(!n&&(s=u=g)&&e.lineStart(),g!==u&&(p=r(n,h),(xn(n,p)||xn(h,p))&&(h[0]+=jl,h[1]+=jl,g=t(h[0],h[1]))),g!==u)c=0,g?(e.lineStart(),p=r(h,n),e.point(p[0],p[1])):(p=r(n,h),e.point(p[0],p[1]),e.lineEnd()),n=p;else if(l&&n&&o^g){var m;v&i||!(m=r(h,n,!0))||(c=0,o?(e.lineStart(),e.point(m[0][0],m[0][1]),e.point(m[1][0],m[1][1]),e.lineEnd()):(e.point(m[1][0],m[1][1]),e.lineEnd(),e.lineStart(),e.point(m[0][0],m[0][1])))}!g||n&&xn(n,h)||e.point(h[0],h[1]),n=h,u=g,i=v},lineEnd:function(){u&&e.lineEnd(),n=null},clean:function(){return c|(s&&u)<<1}}}function r(e,t,n){var r=fn(e),a=fn(t),o=[1,0,0],l=hn(r,a),u=pn(l,l),s=l[0],c=u-s*s;if(!c)return!n&&e;var d=i*u/c,f=-i*s/c,p=hn(o,l),h=vn(o,d),g=vn(l,f);gn(h,g);var v=p,m=pn(h,v),y=pn(v,v),x=m*m-y*(pn(h,h)-1);if(!(0>x)){var b=Math.sqrt(x),w=vn(v,(-m-b)/y);if(gn(w,h),w=yn(w),!n)return w;var _,k=e[0],M=t[0],A=e[1],z=t[1];k>M&&(_=k,k=M,M=_);var j=M-k,E=ol(j-Ml)<jl,S=E||jl>j;if(!E&&A>z&&(_=A,A=z,z=_),S?E?A+z>0^w[1]<(ol(w[0]-k)<jl?A:z):A<=w[1]&&w[1]<=z:j>Ml^(k<=w[0]&&w[0]<=M)){var T=vn(v,(-m+b)/y);return gn(T,h),[w,yn(T)]}}}function a(t,n){var r=o?e:Ml-e,a=0;return-r>t?a|=1:t>r&&(a|=2),-r>n?a|=4:n>r&&(a|=8),a}var i=Math.cos(e),o=i>0,l=ol(i)>jl,u=dr(e,6*Sl);return Sn(t,n,u,o?[0,-e]:[-Ml,e-Ml])}function In(e,t,n,r){return function(a){var i,o=a.a,l=a.b,u=o.x,s=o.y,c=l.x,d=l.y,f=0,p=1,h=c-u,g=d-s;if(i=e-u,h||!(i>0)){if(i/=h,0>h){if(f>i)return;p>i&&(p=i)}else if(h>0){if(i>p)return;i>f&&(f=i)}if(i=n-u,h||!(0>i)){if(i/=h,0>h){if(i>p)return;i>f&&(f=i)}else if(h>0){if(f>i)return;p>i&&(p=i)}if(i=t-s,g||!(i>0)){if(i/=g,0>g){if(f>i)return;p>i&&(p=i)}else if(g>0){if(i>p)return;i>f&&(f=i)}if(i=r-s,g||!(0>i)){if(i/=g,0>g){if(i>p)return;i>f&&(f=i)}else if(g>0){if(f>i)return;p>i&&(p=i)}return f>0&&(a.a={x:u+f*h,y:s+f*g}),1>p&&(a.b={x:u+p*h,y:s+p*g}),a}}}}}}function Vn(e,t,n,r){function a(r,a){return ol(r[0]-e)<jl?a>0?0:3:ol(r[0]-n)<jl?a>0?2:1:ol(r[1]-t)<jl?a>0?1:0:a>0?3:2}function i(e,t){return o(e.x,t.x)}function o(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(l){function u(e){for(var t=0,n=v.length,r=e[1],a=0;n>a;++a)for(var i,o=1,l=v[a],u=l.length,s=l[0];u>o;++o)i=l[o],s[1]<=r?i[1]>r&&J(s,i,e)>0&&++t:i[1]<=r&&J(s,i,e)<0&&--t,s=i;return 0!==t}function s(i,l,u,s){var c=0,d=0;if(null==i||(c=a(i,u))!==(d=a(l,u))||o(i,l)<0^u>0){do s.point(0===c||3===c?e:n,c>1?r:t);while((c=(c+u+4)%4)!==d)}else s.point(l[0],l[1])}function c(a,i){return a>=e&&n>=a&&i>=t&&r>=i}function d(e,t){c(e,t)&&l.point(e,t)}function f(){S.point=h,v&&v.push(m=[]),M=!0,k=!1,w=_=0/0}function p(){g&&(h(y,x),b&&k&&j.rejoin(),g.push(j.buffer())),S.point=d,k&&l.lineEnd()}function h(e,t){e=Math.max(-ju,Math.min(ju,e)),t=Math.max(-ju,Math.min(ju,t));var n=c(e,t);if(v&&m.push([e,t]),M)y=e,x=t,b=n,M=!1,n&&(l.lineStart(),l.point(e,t));else if(n&&k)l.point(e,t);else{var r={a:{x:w,y:_},b:{x:e,y:t}};E(r)?(k||(l.lineStart(),l.point(r.a.x,r.a.y)),l.point(r.b.x,r.b.y),n||l.lineEnd(),A=!1):n&&(l.lineStart(),l.point(e,t),A=!1)}w=e,_=t,k=n}var g,v,m,y,x,b,w,_,k,M,A,z=l,j=Nn(),E=In(e,t,n,r),S={point:d,lineStart:f,lineEnd:p,polygonStart:function(){l=j,g=[],v=[],A=!0},polygonEnd:function(){l=z,g=Xo.merge(g);var t=u([e,r]),n=A&&t,a=g.length;(n||a)&&(l.polygonStart(),n&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),a&&zn(g,i,t,s,l),l.polygonEnd()),g=v=m=null}};return S}}function Bn(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])}),n}function Un(e){var t=0,n=Ml/3,r=rr(e),a=r(t,n);return a.parallels=function(e){return arguments.length?r(t=e[0]*Ml/180,n=e[1]*Ml/180):[t/Ml*180,n/Ml*180]},a}function Dn(e,t){function n(e,t){var n=Math.sqrt(i-2*a*Math.sin(t))/a;return[n*Math.sin(e*=a),o-n*Math.cos(e)]}var r=Math.sin(e),a=(r+Math.sin(t))/2,i=1+r*(2*a-r),o=Math.sqrt(i)/a;return n.invert=function(e,t){var n=o-t;return[Math.atan2(e,n)/a,$((i-(e*e+n*n)*a*a)/(2*a))]},n}function Rn(){function e(e,t){Su+=a*e-r*t,r=e,a=t}var t,n,r,a;Fu.point=function(i,o){Fu.point=e,t=r=i,n=a=o},Fu.lineEnd=function(){e(t,n)}}function Hn(e,t){Tu>e&&(Tu=e),e>Ou&&(Ou=e),Nu>t&&(Nu=t),t>Cu&&(Cu=t)}function Yn(){function e(e,t){o.push("M",e,",",t,i)}function t(e,t){o.push("M",e,",",t),l.point=n}function n(e,t){o.push("L",e,",",t)}function r(){l.point=e}function a(){o.push("Z")}var i=Xn(4.5),o=[],l={point:e,lineStart:function(){l.point=t},lineEnd:r,polygonStart:function(){l.lineEnd=a},polygonEnd:function(){l.lineEnd=r,l.point=e},pointRadius:function(e){return i=Xn(e),l},result:function(){if(o.length){var e=o.join("");return o=[],e}}};return l}function Xn(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Gn(e,t){vu+=e,mu+=t,++yu}function Zn(){function e(e,r){var a=e-t,i=r-n,o=Math.sqrt(a*a+i*i);xu+=o*(t+e)/2,bu+=o*(n+r)/2,wu+=o,Gn(t=e,n=r)}var t,n;Pu.point=function(r,a){Pu.point=e,Gn(t=r,n=a)}}function Wn(){Pu.point=Gn}function Jn(){function e(e,t){var n=e-r,i=t-a,o=Math.sqrt(n*n+i*i);xu+=o*(r+e)/2,bu+=o*(a+t)/2,wu+=o,o=a*e-r*t,_u+=o*(r+e),ku+=o*(a+t),Mu+=3*o,Gn(r=e,a=t)}var t,n,r,a;Pu.point=function(i,o){Pu.point=e,Gn(t=r=i,n=a=o)},Pu.lineEnd=function(){e(t,n)}}function Qn(e){function t(t,n){e.moveTo(t,n),e.arc(t,n,o,0,Al)}function n(t,n){e.moveTo(t,n),l.point=r}function r(t,n){e.lineTo(t,n)}function a(){l.point=t}function i(){e.closePath()}var o=4.5,l={point:t,lineStart:function(){l.point=n},lineEnd:a,polygonStart:function(){l.lineEnd=i},polygonEnd:function(){l.lineEnd=a,l.point=t},pointRadius:function(e){return o=e,l},result:v};return l}function $n(e){function t(e){return(l?r:n)(e)}function n(t){return tr(t,function(n,r){n=e(n,r),t.point(n[0],n[1])})}function r(t){function n(n,r){n=e(n,r),t.point(n[0],n[1])}function r(){x=0/0,M.point=i,t.lineStart()}function i(n,r){var i=fn([n,r]),o=e(n,r);a(x,b,y,w,_,k,x=o[0],b=o[1],y=n,w=i[0],_=i[1],k=i[2],l,t),t.point(x,b)}function o(){M.point=n,t.lineEnd()}function u(){r(),M.point=s,M.lineEnd=c}function s(e,t){i(d=e,f=t),p=x,h=b,g=w,v=_,m=k,M.point=i}function c(){a(x,b,y,w,_,k,p,h,d,g,v,m,l,t),M.lineEnd=o,o()}var d,f,p,h,g,v,m,y,x,b,w,_,k,M={point:n,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),M.lineStart=u},polygonEnd:function(){t.polygonEnd(),M.lineStart=r}};return M}function a(t,n,r,l,u,s,c,d,f,p,h,g,v,m){var y=c-t,x=d-n,b=y*y+x*x;if(b>4*i&&v--){var w=l+p,_=u+h,k=s+g,M=Math.sqrt(w*w+_*_+k*k),A=Math.asin(k/=M),z=ol(ol(k)-1)<jl||ol(r-f)<jl?(r+f)/2:Math.atan2(_,w),j=e(z,A),E=j[0],S=j[1],T=E-t,N=S-n,O=x*T-y*N;(O*O/b>i||ol((y*T+x*N)/b-.5)>.3||o>l*p+u*h+s*g)&&(a(t,n,r,l,u,s,E,S,z,w/=M,_/=M,k,v,m),m.point(E,S),a(E,S,z,w,_,k,c,d,f,p,h,g,v,m))}}var i=.5,o=Math.cos(30*Sl),l=16;return t.precision=function(e){return arguments.length?(l=(i=e*e)>0&&16,t):Math.sqrt(i)},t}function Kn(e){var t=$n(function(t,n){return e([t*Tl,n*Tl])});return function(e){return ar(t(e))}}function er(e){this.stream=e}function tr(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function nr(e){return rr(function(){return e})()}function rr(e){function t(e){return e=l(e[0]*Sl,e[1]*Sl),[e[0]*f+u,s-e[1]*f]}function n(e){return e=l.invert((e[0]-u)/f,(s-e[1])/f),e&&[e[0]*Tl,e[1]*Tl]}function r(){l=Bn(o=lr(m,y,x),i);var e=i(g,v);return u=p-e[0]*f,s=h+e[1]*f,a()}function a(){return c&&(c.valid=!1,c=null),t}var i,o,l,u,s,c,d=$n(function(e,t){return e=i(e,t),[e[0]*f+u,s-e[1]*f]}),f=150,p=480,h=250,g=0,v=0,m=0,y=0,x=0,b=zu,w=Mt,_=null,k=null;return t.stream=function(e){return c&&(c.valid=!1),c=ar(b(o,d(w(e)))),c.valid=!0,c},t.clipAngle=function(e){return arguments.length?(b=null==e?(_=e,zu):Ln((_=+e)*Sl),a()):_},t.clipExtent=function(e){return arguments.length?(k=e,w=e?Vn(e[0][0],e[0][1],e[1][0],e[1][1]):Mt,a()):k},t.scale=function(e){return arguments.length?(f=+e,r()):f},t.translate=function(e){return arguments.length?(p=+e[0],h=+e[1],r()):[p,h]},t.center=function(e){return arguments.length?(g=e[0]%360*Sl,v=e[1]%360*Sl,r()):[g*Tl,v*Tl]},t.rotate=function(e){return arguments.length?(m=e[0]%360*Sl,y=e[1]%360*Sl,x=e.length>2?e[2]%360*Sl:0,r()):[m*Tl,y*Tl,x*Tl]},Xo.rebind(t,d,"precision"),function(){return i=e.apply(this,arguments),t.invert=i.invert&&n,r()}}function ar(e){return tr(e,function(t,n){e.point(t*Sl,n*Sl)})}function ir(e,t){return[e,t]}function or(e,t){return[e>Ml?e-Al:-Ml>e?e+Al:e,t]}function lr(e,t,n){return e?t||n?Bn(sr(e),cr(t,n)):sr(e):t||n?cr(t,n):or}function ur(e){return function(t,n){return t+=e,[t>Ml?t-Al:-Ml>t?t+Al:t,n]}}function sr(e){var t=ur(e);return t.invert=ur(-e),t}function cr(e,t){function n(e,t){var n=Math.cos(t),l=Math.cos(e)*n,u=Math.sin(e)*n,s=Math.sin(t),c=s*r+l*a;return[Math.atan2(u*i-c*o,l*r-s*a),$(c*i+u*o)]}var r=Math.cos(e),a=Math.sin(e),i=Math.cos(t),o=Math.sin(t);return n.invert=function(e,t){var n=Math.cos(t),l=Math.cos(e)*n,u=Math.sin(e)*n,s=Math.sin(t),c=s*i-u*o;return[Math.atan2(u*i+s*o,l*r+c*a),$(c*r-l*a)]},n}function dr(e,t){var n=Math.cos(e),r=Math.sin(e);return function(a,i,o,l){var u=o*t;null!=a?(a=fr(n,a),i=fr(n,i),(o>0?i>a:a>i)&&(a+=o*Al)):(a=e+o*Al,i=e-.5*u);for(var s,c=a;o>0?c>i:i>c;c-=u)l.point((s=yn([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],s[1])}}function fr(e,t){var n=fn(t);n[0]-=e,mn(n);var r=Q(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-jl)%(2*Math.PI)}function pr(e,t,n){var r=Xo.range(e,t-jl,n).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function hr(e,t,n){var r=Xo.range(e,t-jl,n).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function gr(e){return e.source}function vr(e){return e.target}function mr(e,t,n,r){var a=Math.cos(t),i=Math.sin(t),o=Math.cos(r),l=Math.sin(r),u=a*Math.cos(e),s=a*Math.sin(e),c=o*Math.cos(n),d=o*Math.sin(n),f=2*Math.asin(Math.sqrt(nt(r-t)+a*o*nt(n-e))),p=1/Math.sin(f),h=f?function(e){var t=Math.sin(e*=f)*p,n=Math.sin(f-e)*p,r=n*u+t*c,a=n*s+t*d,o=n*i+t*l;return[Math.atan2(a,r)*Tl,Math.atan2(o,Math.sqrt(r*r+a*a))*Tl]}:function(){return[e*Tl,t*Tl]};return h.distance=f,h}function yr(){function e(e,a){var i=Math.sin(a*=Sl),o=Math.cos(a),l=ol((e*=Sl)-t),u=Math.cos(l);Lu+=Math.atan2(Math.sqrt((l=o*Math.sin(l))*l+(l=r*i-n*o*u)*l),n*i+r*o*u),t=e,n=i,r=o}var t,n,r;Iu.point=function(a,i){t=a*Sl,n=Math.sin(i*=Sl),r=Math.cos(i),Iu.point=e},Iu.lineEnd=function(){Iu.point=Iu.lineEnd=v}}function xr(e,t){function n(t,n){var r=Math.cos(t),a=Math.cos(n),i=e(r*a);return[i*a*Math.sin(t),i*Math.sin(n)]}return n.invert=function(e,n){var r=Math.sqrt(e*e+n*n),a=t(r),i=Math.sin(a),o=Math.cos(a);return[Math.atan2(e*i,r*o),Math.asin(r&&n*i/r)]},n}function br(e,t){function n(e,t){o>0?-zl+jl>t&&(t=-zl+jl):t>zl-jl&&(t=zl-jl);var n=o/Math.pow(a(t),i);return[n*Math.sin(i*e),o-n*Math.cos(i*e)]}var r=Math.cos(e),a=function(e){return Math.tan(Ml/4+e/2)},i=e===t?Math.sin(e):Math.log(r/Math.cos(t))/Math.log(a(t)/a(e)),o=r*Math.pow(a(e),i)/i;return i?(n.invert=function(e,t){var n=o-t,r=W(i)*Math.sqrt(e*e+n*n);return[Math.atan2(e,n)/i,2*Math.atan(Math.pow(o/r,1/i))-zl]},n):_r}function wr(e,t){function n(e,t){var n=i-t;return[n*Math.sin(a*e),i-n*Math.cos(a*e)]}var r=Math.cos(e),a=e===t?Math.sin(e):(r-Math.cos(t))/(t-e),i=r/a+e;return ol(a)<jl?ir:(n.invert=function(e,t){var n=i-t;return[Math.atan2(e,n)/a,i-W(a)*Math.sqrt(e*e+n*n)]},n)}function _r(e,t){return[e,Math.log(Math.tan(Ml/4+t/2))]}function kr(e){var t,n=nr(e),r=n.scale,a=n.translate,i=n.clipExtent;return n.scale=function(){var e=r.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.translate=function(){var e=a.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.clipExtent=function(e){var o=i.apply(n,arguments);if(o===n){if(t=null==e){var l=Ml*r(),u=a();i([[u[0]-l,u[1]-l],[u[0]+l,u[1]+l]])}}else t&&(o=null);return o},n.clipExtent(null)}function Mr(e,t){return[Math.log(Math.tan(Ml/4+t/2)),-e]}function Ar(e){return e[0]}function zr(e){return e[1]}function jr(e){for(var t=e.length,n=[0,1],r=2,a=2;t>a;a++){for(;r>1&&J(e[n[r-2]],e[n[r-1]],e[a])<=0;)--r;n[r++]=a}return n.slice(0,r)}function Er(e,t){return e[0]-t[0]||e[1]-t[1]}function Sr(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function Tr(e,t,n,r){var a=e[0],i=n[0],o=t[0]-a,l=r[0]-i,u=e[1],s=n[1],c=t[1]-u,d=r[1]-s,f=(l*(u-s)-d*(a-i))/(d*o-l*c);return[a+f*o,u+f*c]}function Nr(e){var t=e[0],n=e[e.length-1];return!(t[0]-n[0]||t[1]-n[1])}function Or(){Kr(this),this.edge=this.site=this.circle=null}function Cr(e){var t=Ju.pop()||new Or;return t.site=e,t}function Fr(e){Hr(e),Gu.remove(e),Ju.push(e),Kr(e)}function qr(e){var t=e.circle,n=t.x,r=t.cy,a={x:n,y:r},i=e.P,o=e.N,l=[e];Fr(e);for(var u=i;u.circle&&ol(n-u.circle.x)<jl&&ol(r-u.circle.cy)<jl;)i=u.P,l.unshift(u),Fr(u),u=i;l.unshift(u),Hr(u);for(var s=o;s.circle&&ol(n-s.circle.x)<jl&&ol(r-s.circle.cy)<jl;)o=s.N,l.push(s),Fr(s),s=o;l.push(s),Hr(s);var c,d=l.length;for(c=1;d>c;++c)s=l[c],u=l[c-1],Jr(s.edge,u.site,s.site,a);u=l[0],s=l[d-1],s.edge=Zr(u.site,s.site,null,a),Rr(u),Rr(s)}function Pr(e){for(var t,n,r,a,i=e.x,o=e.y,l=Gu._;l;)if(r=Lr(l,o)-i,r>jl)l=l.L;else{if(a=i-Ir(l,o),!(a>jl)){r>-jl?(t=l.P,n=l):a>-jl?(t=l,n=l.N):t=n=l;break}if(!l.R){t=l;break}l=l.R}var u=Cr(e);if(Gu.insert(t,u),t||n){if(t===n)return Hr(t),n=Cr(t.site),Gu.insert(u,n),u.edge=n.edge=Zr(t.site,u.site),Rr(t),void Rr(n);if(!n)return void(u.edge=Zr(t.site,u.site));Hr(t),Hr(n);var s=t.site,c=s.x,d=s.y,f=e.x-c,p=e.y-d,h=n.site,g=h.x-c,v=h.y-d,m=2*(f*v-p*g),y=f*f+p*p,x=g*g+v*v,b={x:(v*y-p*x)/m+c,y:(f*x-g*y)/m+d};Jr(n.edge,s,h,b),u.edge=Zr(s,e,null,b),n.edge=Zr(e,h,null,b),Rr(t),Rr(n)}}function Lr(e,t){var n=e.site,r=n.x,a=n.y,i=a-t;if(!i)return r;var o=e.P;if(!o)return-1/0;n=o.site;var l=n.x,u=n.y,s=u-t;if(!s)return l;var c=l-r,d=1/i-1/s,f=c/s;return d?(-f+Math.sqrt(f*f-2*d*(c*c/(-2*s)-u+s/2+a-i/2)))/d+r:(r+l)/2}function Ir(e,t){var n=e.N;if(n)return Lr(n,t);var r=e.site;return r.y===t?r.x:1/0}function Vr(e){this.site=e,this.edges=[]}function Br(e){for(var t,n,r,a,i,o,l,u,s,c,d=e[0][0],f=e[1][0],p=e[0][1],h=e[1][1],g=Xu,v=g.length;v--;)if(i=g[v],i&&i.prepare())for(l=i.edges,u=l.length,o=0;u>o;)c=l[o].end(),r=c.x,a=c.y,s=l[++o%u].start(),t=s.x,n=s.y,(ol(r-t)>jl||ol(a-n)>jl)&&(l.splice(o,0,new Qr(Wr(i.site,c,ol(r-d)<jl&&h-a>jl?{x:d,y:ol(t-d)<jl?n:h}:ol(a-h)<jl&&f-r>jl?{x:ol(n-h)<jl?t:f,y:h}:ol(r-f)<jl&&a-p>jl?{x:f,y:ol(t-f)<jl?n:p}:ol(a-p)<jl&&r-d>jl?{x:ol(n-p)<jl?t:d,y:p}:null),i.site,null)),++u)}function Ur(e,t){return t.angle-e.angle}function Dr(){Kr(this),this.x=this.y=this.arc=this.site=this.cy=null}function Rr(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,a=e.site,i=n.site;if(r!==i){var o=a.x,l=a.y,u=r.x-o,s=r.y-l,c=i.x-o,d=i.y-l,f=2*(u*d-s*c);if(!(f>=-El)){var p=u*u+s*s,h=c*c+d*d,g=(d*p-s*h)/f,v=(u*h-c*p)/f,d=v+l,m=Qu.pop()||new Dr;m.arc=e,m.site=a,m.x=g+o,m.y=d+Math.sqrt(g*g+v*v),m.cy=d,e.circle=m;for(var y=null,x=Wu._;x;)if(m.y<x.y||m.y===x.y&&m.x<=x.x){if(!x.L){y=x.P;break}x=x.L}else{if(!x.R){y=x;break}x=x.R}Wu.insert(y,m),y||(Zu=m)}}}}function Hr(e){var t=e.circle;t&&(t.P||(Zu=t.N),Wu.remove(t),Qu.push(t),Kr(t),e.circle=null)}function Yr(e){for(var t,n=Yu,r=In(e[0][0],e[0][1],e[1][0],e[1][1]),a=n.length;a--;)t=n[a],(!Xr(t,e)||!r(t)||ol(t.a.x-t.b.x)<jl&&ol(t.a.y-t.b.y)<jl)&&(t.a=t.b=null,n.splice(a,1))}function Xr(e,t){var n=e.b;if(n)return!0;var r,a,i=e.a,o=t[0][0],l=t[1][0],u=t[0][1],s=t[1][1],c=e.l,d=e.r,f=c.x,p=c.y,h=d.x,g=d.y,v=(f+h)/2,m=(p+g)/2;if(g===p){if(o>v||v>=l)return;if(f>h){if(i){if(i.y>=s)return}else i={x:v,y:u};n={x:v,y:s}}else{if(i){if(i.y<u)return}else i={x:v,y:s};n={x:v,y:u}}}else if(r=(f-h)/(g-p),a=m-r*v,-1>r||r>1)if(f>h){if(i){if(i.y>=s)return}else i={x:(u-a)/r,y:u};n={x:(s-a)/r,y:s}}else{if(i){if(i.y<u)return}else i={x:(s-a)/r,y:s};n={x:(u-a)/r,y:u}}else if(g>p){if(i){if(i.x>=l)return}else i={x:o,y:r*o+a};n={x:l,y:r*l+a}}else{if(i){if(i.x<o)return}else i={x:l,y:r*l+a};n={x:o,y:r*o+a}}return e.a=i,e.b=n,!0}function Gr(e,t){this.l=e,this.r=t,this.a=this.b=null}function Zr(e,t,n,r){var a=new Gr(e,t);return Yu.push(a),n&&Jr(a,e,t,n),r&&Jr(a,t,e,r),Xu[e.i].edges.push(new Qr(a,e,t)),Xu[t.i].edges.push(new Qr(a,t,e)),a}function Wr(e,t,n){var r=new Gr(e,null);return r.a=t,r.b=n,Yu.push(r),r}function Jr(e,t,n,r){e.a||e.b?e.l===n?e.b=r:e.a=r:(e.a=r,e.l=t,e.r=n)}function Qr(e,t,n){var r=e.a,a=e.b;this.edge=e,this.site=t,this.angle=n?Math.atan2(n.y-t.y,n.x-t.x):e.l===t?Math.atan2(a.x-r.x,r.y-a.y):Math.atan2(r.x-a.x,a.y-r.y)}function $r(){this._=null}function Kr(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function ea(e,t){var n=t,r=t.R,a=n.U;a?a.L===n?a.L=r:a.R=r:e._=r,r.U=a,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function ta(e,t){var n=t,r=t.L,a=n.U;a?a.L===n?a.L=r:a.R=r:e._=r,r.U=a,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function na(e){for(;e.L;)e=e.L;return e}function ra(e,t){var n,r,a,i=e.sort(aa).pop();for(Yu=[],Xu=new Array(e.length),Gu=new $r,Wu=new $r;;)if(a=Zu,i&&(!a||i.y<a.y||i.y===a.y&&i.x<a.x))(i.x!==n||i.y!==r)&&(Xu[i.i]=new Vr(i),Pr(i),n=i.x,r=i.y),i=e.pop();else{if(!a)break;qr(a.arc)}t&&(Yr(t),Br(t));var o={cells:Xu,edges:Yu};return Gu=Wu=Yu=Xu=null,o}function aa(e,t){return t.y-e.y||t.x-e.x}function ia(e,t,n){return(e.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-e.y)}function oa(e){return e.x}function la(e){return e.y}function ua(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function sa(e,t,n,r,a,i){if(!e(t,n,r,a,i)){var o=.5*(n+a),l=.5*(r+i),u=t.nodes;u[0]&&sa(e,u[0],n,r,o,l),u[1]&&sa(e,u[1],o,r,a,l),u[2]&&sa(e,u[2],n,l,o,i),u[3]&&sa(e,u[3],o,l,a,i)}}function ca(e,t){e=Xo.rgb(e),t=Xo.rgb(t);var n=e.r,r=e.g,a=e.b,i=t.r-n,o=t.g-r,l=t.b-a;return function(e){return"#"+mt(Math.round(n+i*e))+mt(Math.round(r+o*e))+mt(Math.round(a+l*e))}}function da(e,t){var n,r={},a={};for(n in e)n in t?r[n]=ha(e[n],t[n]):a[n]=e[n];for(n in t)n in e||(a[n]=t[n]);return function(e){for(n in r)a[n]=r[n](e);return a}}function fa(e,t){return t-=e=+e,function(n){return e+t*n}}function pa(e,t){var n,r,a,i=Ku.lastIndex=es.lastIndex=0,o=-1,l=[],u=[];for(e+="",t+="";(n=Ku.exec(e))&&(r=es.exec(t));)(a=r.index)>i&&(a=t.substring(i,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,u.push({i:o,x:fa(n,r)})),i=es.lastIndex;return i<t.length&&(a=t.substring(i),l[o]?l[o]+=a:l[++o]=a),l.length<2?u[0]?(t=u[0].x,function(e){return t(e)+""}):function(){return t}:(t=u.length,function(e){for(var n,r=0;t>r;++r)l[(n=u[r]).i]=n.x(e);return l.join("")})}function ha(e,t){for(var n,r=Xo.interpolators.length;--r>=0&&!(n=Xo.interpolators[r](e,t)););return n}function ga(e,t){var n,r=[],a=[],i=e.length,o=t.length,l=Math.min(e.length,t.length);for(n=0;l>n;++n)r.push(ha(e[n],t[n]));for(;i>n;++n)a[n]=e[n];for(;o>n;++n)a[n]=t[n];return function(e){for(n=0;l>n;++n)a[n]=r[n](e);return a}}function va(e){return function(t){return 0>=t?0:t>=1?1:e(t)}}function ma(e){return function(t){return 1-e(1-t)}}function ya(e){return function(t){return.5*(.5>t?e(2*t):2-e(2-2*t))}}function xa(e){return e*e}function ba(e){return e*e*e}function wa(e){if(0>=e)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(.5>e?n:3*(e-t)+n-.75)}function _a(e){return function(t){return Math.pow(t,e)}}function ka(e){return 1-Math.cos(e*zl)}function Ma(e){return Math.pow(2,10*(e-1))}function Aa(e){return 1-Math.sqrt(1-e*e)}function za(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/Al*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,-10*r)*Math.sin((r-n)*Al/t)}}function ja(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function Ea(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function Sa(e,t){e=Xo.hcl(e),t=Xo.hcl(t);var n=e.h,r=e.c,a=e.l,i=t.h-n,o=t.c-r,l=t.l-a;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,n=isNaN(n)?t.h:n):i>180?i-=360:-180>i&&(i+=360),function(e){return lt(n+i*e,r+o*e,a+l*e)+""}}function Ta(e,t){e=Xo.hsl(e),t=Xo.hsl(t);var n=e.h,r=e.s,a=e.l,i=t.h-n,o=t.s-r,l=t.l-a;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,n=isNaN(n)?t.h:n):i>180?i-=360:-180>i&&(i+=360),function(e){return it(n+i*e,r+o*e,a+l*e)+""}}function Na(e,t){e=Xo.lab(e),t=Xo.lab(t);var n=e.l,r=e.a,a=e.b,i=t.l-n,o=t.a-r,l=t.b-a;return function(e){return st(n+i*e,r+o*e,a+l*e)+""}}function Oa(e,t){return t-=e,function(n){return Math.round(e+t*n)}}function Ca(e){var t=[e.a,e.b],n=[e.c,e.d],r=qa(t),a=Fa(t,n),i=qa(Pa(n,t,-a))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,a*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*Tl,this.translate=[e.e,e.f],this.scale=[r,i],this.skew=i?Math.atan2(a,i)*Tl:0}function Fa(e,t){return e[0]*t[0]+e[1]*t[1]}function qa(e){var t=Math.sqrt(Fa(e,e));return t&&(e[0]/=t,e[1]/=t),t}function Pa(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function La(e,t){var n,r=[],a=[],i=Xo.transform(e),o=Xo.transform(t),l=i.translate,u=o.translate,s=i.rotate,c=o.rotate,d=i.skew,f=o.skew,p=i.scale,h=o.scale;return l[0]!=u[0]||l[1]!=u[1]?(r.push("translate(",null,",",null,")"),a.push({i:1,x:fa(l[0],u[0])},{i:3,x:fa(l[1],u[1])})):r.push(u[0]||u[1]?"translate("+u+")":""),s!=c?(s-c>180?c+=360:c-s>180&&(s+=360),a.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:fa(s,c)})):c&&r.push(r.pop()+"rotate("+c+")"),d!=f?a.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:fa(d,f)}):f&&r.push(r.pop()+"skewX("+f+")"),p[0]!=h[0]||p[1]!=h[1]?(n=r.push(r.pop()+"scale(",null,",",null,")"),a.push({i:n-4,x:fa(p[0],h[0])},{i:n-2,x:fa(p[1],h[1])})):(1!=h[0]||1!=h[1])&&r.push(r.pop()+"scale("+h+")"),n=a.length,function(e){for(var t,i=-1;++i<n;)r[(t=a[i]).i]=t.x(e);
return r.join("")}}function Ia(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function Va(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function Ba(e){for(var t=e.source,n=e.target,r=Da(t,n),a=[t];t!==r;)t=t.parent,a.push(t);for(var i=a.length;n!==r;)a.splice(i,0,n),n=n.parent;return a}function Ua(e){for(var t=[],n=e.parent;null!=n;)t.push(e),e=n,n=n.parent;return t.push(e),t}function Da(e,t){if(e===t)return e;for(var n=Ua(e),r=Ua(t),a=n.pop(),i=r.pop(),o=null;a===i;)o=a,a=n.pop(),i=r.pop();return o}function Ra(e){e.fixed|=2}function Ha(e){e.fixed&=-7}function Ya(e){e.fixed|=4,e.px=e.x,e.py=e.y}function Xa(e){e.fixed&=-5}function Ga(e,t,n){var r=0,a=0;if(e.charge=0,!e.leaf)for(var i,o=e.nodes,l=o.length,u=-1;++u<l;)i=o[u],null!=i&&(Ga(i,t,n),e.charge+=i.charge,r+=i.charge*i.cx,a+=i.charge*i.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var s=t*n[e.point.index];e.charge+=e.pointCharge=s,r+=s*e.point.x,a+=s*e.point.y}e.cx=r/e.charge,e.cy=a/e.charge}function Za(e,t){return Xo.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=ei,e}function Wa(e,t){for(var n=[e];null!=(e=n.pop());)if(t(e),(a=e.children)&&(r=a.length))for(var r,a;--r>=0;)n.push(a[r])}function Ja(e,t){for(var n=[e],r=[];null!=(e=n.pop());)if(r.push(e),(i=e.children)&&(a=i.length))for(var a,i,o=-1;++o<a;)n.push(i[o]);for(;null!=(e=r.pop());)t(e)}function Qa(e){return e.children}function $a(e){return e.value}function Ka(e,t){return t.value-e.value}function ei(e){return Xo.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function ti(e){return e.x}function ni(e){return e.y}function ri(e,t,n){e.y0=t,e.y=n}function ai(e){return Xo.range(e.length)}function ii(e){for(var t=-1,n=e[0].length,r=[];++t<n;)r[t]=0;return r}function oi(e){for(var t,n=1,r=0,a=e[0][1],i=e.length;i>n;++n)(t=e[n][1])>a&&(r=n,a=t);return r}function li(e){return e.reduce(ui,0)}function ui(e,t){return e+t[1]}function si(e,t){return ci(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ci(e,t){for(var n=-1,r=+e[0],a=(e[1]-r)/t,i=[];++n<=t;)i[n]=a*n+r;return i}function di(e){return[Xo.min(e),Xo.max(e)]}function fi(e,t){return e.value-t.value}function pi(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function hi(e,t){e._pack_next=t,t._pack_prev=e}function gi(e,t){var n=t.x-e.x,r=t.y-e.y,a=e.r+t.r;return.999*a*a>n*n+r*r}function vi(e){function t(e){c=Math.min(e.x-e.r,c),d=Math.max(e.x+e.r,d),f=Math.min(e.y-e.r,f),p=Math.max(e.y+e.r,p)}if((n=e.children)&&(s=n.length)){var n,r,a,i,o,l,u,s,c=1/0,d=-1/0,f=1/0,p=-1/0;if(n.forEach(mi),r=n[0],r.x=-r.r,r.y=0,t(r),s>1&&(a=n[1],a.x=a.r,a.y=0,t(a),s>2))for(i=n[2],bi(r,a,i),t(i),pi(r,i),r._pack_prev=i,pi(i,a),a=r._pack_next,o=3;s>o;o++){bi(r,a,i=n[o]);var h=0,g=1,v=1;for(l=a._pack_next;l!==a;l=l._pack_next,g++)if(gi(l,i)){h=1;break}if(1==h)for(u=r._pack_prev;u!==l._pack_prev&&!gi(u,i);u=u._pack_prev,v++);h?(v>g||g==v&&a.r<r.r?hi(r,a=l):hi(r=u,a),o--):(pi(r,i),a=i,t(i))}var m=(c+d)/2,y=(f+p)/2,x=0;for(o=0;s>o;o++)i=n[o],i.x-=m,i.y-=y,x=Math.max(x,i.r+Math.sqrt(i.x*i.x+i.y*i.y));e.r=x,n.forEach(yi)}}function mi(e){e._pack_next=e._pack_prev=e}function yi(e){delete e._pack_next,delete e._pack_prev}function xi(e,t,n,r){var a=e.children;if(e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r,a)for(var i=-1,o=a.length;++i<o;)xi(a[i],t,n,r)}function bi(e,t,n){var r=e.r+n.r,a=t.x-e.x,i=t.y-e.y;if(r&&(a||i)){var o=t.r+n.r,l=a*a+i*i;o*=o,r*=r;var u=.5+(r-o)/(2*l),s=Math.sqrt(Math.max(0,2*o*(r+l)-(r-=l)*r-o*o))/(2*l);n.x=e.x+u*a+s*i,n.y=e.y+u*i-s*a}else n.x=e.x+r,n.y=e.y}function wi(e,t){return e.parent==t.parent?1:2}function _i(e){var t=e.children;return t.length?t[0]:e.t}function ki(e){var t,n=e.children;return(t=n.length)?n[t-1]:e.t}function Mi(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Ai(e){for(var t,n=0,r=0,a=e.children,i=a.length;--i>=0;)t=a[i],t.z+=n,t.m+=n,n+=t.s+(r+=t.c)}function zi(e,t,n){return e.a.parent===t.parent?e.a:n}function ji(e){return 1+Xo.max(e,function(e){return e.y})}function Ei(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Si(e){var t=e.children;return t&&t.length?Si(t[0]):e}function Ti(e){var t,n=e.children;return n&&(t=n.length)?Ti(n[t-1]):e}function Ni(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Oi(e,t){var n=e.x+t[3],r=e.y+t[0],a=e.dx-t[1]-t[3],i=e.dy-t[0]-t[2];return 0>a&&(n+=a/2,a=0),0>i&&(r+=i/2,i=0),{x:n,y:r,dx:a,dy:i}}function Ci(e){var t=e[0],n=e[e.length-1];return n>t?[t,n]:[n,t]}function Fi(e){return e.rangeExtent?e.rangeExtent():Ci(e.range())}function qi(e,t,n,r){var a=n(e[0],e[1]),i=r(t[0],t[1]);return function(e){return i(a(e))}}function Pi(e,t){var n,r=0,a=e.length-1,i=e[r],o=e[a];return i>o&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function Li(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:ds}function Ii(e,t,n,r){var a=[],i=[],o=0,l=Math.min(e.length,t.length)-1;for(e[l]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<=l;)a.push(n(e[o-1],e[o])),i.push(r(t[o-1],t[o]));return function(t){var n=Xo.bisect(e,t,1,l)-1;return i[n](a[n](t))}}function Vi(e,t,n,r){function a(){var a=Math.min(e.length,t.length)>2?Ii:qi,u=r?Va:Ia;return o=a(e,t,u,n),l=a(t,e,u,ha),i}function i(e){return o(e)}var o,l;return i.invert=function(e){return l(e)},i.domain=function(t){return arguments.length?(e=t.map(Number),a()):e},i.range=function(e){return arguments.length?(t=e,a()):t},i.rangeRound=function(e){return i.range(e).interpolate(Oa)},i.clamp=function(e){return arguments.length?(r=e,a()):r},i.interpolate=function(e){return arguments.length?(n=e,a()):n},i.ticks=function(t){return Ri(e,t)},i.tickFormat=function(t,n){return Hi(e,t,n)},i.nice=function(t){return Ui(e,t),a()},i.copy=function(){return Vi(e,t,n,r)},a()}function Bi(e,t){return Xo.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Ui(e,t){return Pi(e,Li(Di(e,t)[2]))}function Di(e,t){null==t&&(t=10);var n=Ci(e),r=n[1]-n[0],a=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*a;return.15>=i?a*=10:.35>=i?a*=5:.75>=i&&(a*=2),n[0]=Math.ceil(n[0]/a)*a,n[1]=Math.floor(n[1]/a)*a+.5*a,n[2]=a,n}function Ri(e,t){return Xo.range.apply(Xo,Di(e,t))}function Hi(e,t,n){var r=Di(e,t);if(n){var a=Kl.exec(n);if(a.shift(),"s"===a[8]){var i=Xo.formatPrefix(Math.max(ol(r[0]),ol(r[1])));return a[7]||(a[7]="."+Yi(i.scale(r[2]))),a[8]="f",n=Xo.format(a.join("")),function(e){return n(i.scale(e))+i.symbol}}a[7]||(a[7]="."+Xi(a[8],r)),n=a.join("")}else n=",."+Yi(r[2])+"f";return Xo.format(n)}function Yi(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function Xi(e,t){var n=Yi(t[2]);return e in fs?Math.abs(n-Yi(Math.max(ol(t[0]),ol(t[1]))))+ +("e"!==e):n-2*("%"===e)}function Gi(e,t,n,r){function a(e){return(n?Math.log(0>e?0:e):-Math.log(e>0?0:-e))/Math.log(t)}function i(e){return n?Math.pow(t,e):-Math.pow(t,-e)}function o(t){return e(a(t))}return o.invert=function(t){return i(e.invert(t))},o.domain=function(t){return arguments.length?(n=t[0]>=0,e.domain((r=t.map(Number)).map(a)),o):r},o.base=function(n){return arguments.length?(t=+n,e.domain(r.map(a)),o):t},o.nice=function(){var t=Pi(r.map(a),n?Math:hs);return e.domain(t),r=t.map(i),o},o.ticks=function(){var e=Ci(r),o=[],l=e[0],u=e[1],s=Math.floor(a(l)),c=Math.ceil(a(u)),d=t%1?2:t;if(isFinite(c-s)){if(n){for(;c>s;s++)for(var f=1;d>f;f++)o.push(i(s)*f);o.push(i(s))}else for(o.push(i(s));s++<c;)for(var f=d-1;f>0;f--)o.push(i(s)*f);for(s=0;o[s]<l;s++);for(c=o.length;o[c-1]>u;c--);o=o.slice(s,c)}return o},o.tickFormat=function(e,t){if(!arguments.length)return ps;arguments.length<2?t=ps:"function"!=typeof t&&(t=Xo.format(t));var r,l=Math.max(.1,e/o.ticks().length),u=n?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(e){return e/i(u(a(e)+r))<=l?t(e):""}},o.copy=function(){return Gi(e.copy(),t,n,r)},Bi(o,e)}function Zi(e,t,n){function r(t){return e(a(t))}var a=Wi(t),i=Wi(1/t);return r.invert=function(t){return i(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain((n=t.map(Number)).map(a)),r):n},r.ticks=function(e){return Ri(n,e)},r.tickFormat=function(e,t){return Hi(n,e,t)},r.nice=function(e){return r.domain(Ui(n,e))},r.exponent=function(o){return arguments.length?(a=Wi(t=o),i=Wi(1/t),e.domain(n.map(a)),r):t},r.copy=function(){return Zi(e.copy(),t,n)},Bi(r,e)}function Wi(e){return function(t){return 0>t?-Math.pow(-t,e):Math.pow(t,e)}}function Ji(e,t){function n(n){return i[((a.get(n)||("range"===t.t?a.set(n,e.push(n)):0/0))-1)%i.length]}function r(t,n){return Xo.range(e.length).map(function(e){return t+n*e})}var a,i,o;return n.domain=function(r){if(!arguments.length)return e;e=[],a=new l;for(var i,o=-1,u=r.length;++o<u;)a.has(i=r[o])||a.set(i,e.push(i));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(i=e,o=0,t={t:"range",a:arguments},n):i},n.rangePoints=function(a,l){arguments.length<2&&(l=0);var u=a[0],s=a[1],c=(s-u)/(Math.max(1,e.length-1)+l);return i=r(e.length<2?(u+s)/2:u+c*l/2,c),o=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(a,l,u){arguments.length<2&&(l=0),arguments.length<3&&(u=l);var s=a[1]<a[0],c=a[s-0],d=a[1-s],f=(d-c)/(e.length-l+2*u);return i=r(c+f*u,f),s&&i.reverse(),o=f*(1-l),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(a,l,u){arguments.length<2&&(l=0),arguments.length<3&&(u=l);var s=a[1]<a[0],c=a[s-0],d=a[1-s],f=Math.floor((d-c)/(e.length-l+2*u)),p=d-c-(e.length-l)*f;return i=r(c+Math.round(p/2),f),s&&i.reverse(),o=Math.round(f*(1-l)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return o},n.rangeExtent=function(){return Ci(t.a[0])},n.copy=function(){return Ji(e,t)},n.domain(e)}function Qi(t,r){function a(){var e=0,n=r.length;for(o=[];++e<n;)o[e-1]=Xo.quantile(t,e/n);return i}function i(e){return isNaN(e=+e)?void 0:r[Xo.bisect(o,e)]}var o;return i.domain=function(r){return arguments.length?(t=r.filter(n).sort(e),a()):t},i.range=function(e){return arguments.length?(r=e,a()):r},i.quantiles=function(){return o},i.invertExtent=function(e){return e=r.indexOf(e),0>e?[0/0,0/0]:[e>0?o[e-1]:t[0],e<o.length?o[e]:t[t.length-1]]},i.copy=function(){return Qi(t,r)},a()}function $i(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(i*(t-e))))]}function a(){return i=n.length/(t-e),o=n.length-1,r}var i,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],a()):[e,t]},r.range=function(e){return arguments.length?(n=e,a()):n},r.invertExtent=function(t){return t=n.indexOf(t),t=0>t?0/0:t/i+e,[t,t+1/i]},r.copy=function(){return $i(e,t,n)},a()}function Ki(e,t){function n(n){return n>=n?t[Xo.bisect(e,n)]:void 0}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.invertExtent=function(n){return n=t.indexOf(n),[e[n-1],e[n]]},n.copy=function(){return Ki(e,t)},n}function eo(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return Ri(e,t)},t.tickFormat=function(t,n){return Hi(e,t,n)},t.copy=function(){return eo(e)},t}function to(e){return e.innerRadius}function no(e){return e.outerRadius}function ro(e){return e.startAngle}function ao(e){return e.endAngle}function io(e){function t(t){function o(){s.push("M",i(e(c),l))}for(var u,s=[],c=[],d=-1,f=t.length,p=kt(n),h=kt(r);++d<f;)a.call(this,u=t[d],d)?c.push([+p.call(this,u,d),+h.call(this,u,d)]):c.length&&(o(),c=[]);return c.length&&o(),s.length?s.join(""):null}var n=Ar,r=zr,a=An,i=oo,o=i.key,l=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(a=e,t):a},t.interpolate=function(e){return arguments.length?(o="function"==typeof e?i=e:(i=ws.get(e)||oo).key,t):o},t.tension=function(e){return arguments.length?(l=e,t):l},t}function oo(e){return e.join("L")}function lo(e){return oo(e)+"Z"}function uo(e){for(var t=0,n=e.length,r=e[0],a=[r[0],",",r[1]];++t<n;)a.push("H",(r[0]+(r=e[t])[0])/2,"V",r[1]);return n>1&&a.push("H",r[0]),a.join("")}function so(e){for(var t=0,n=e.length,r=e[0],a=[r[0],",",r[1]];++t<n;)a.push("V",(r=e[t])[1],"H",r[0]);return a.join("")}function co(e){for(var t=0,n=e.length,r=e[0],a=[r[0],",",r[1]];++t<n;)a.push("H",(r=e[t])[0],"V",r[1]);return a.join("")}function fo(e,t){return e.length<4?oo(e):e[1]+go(e.slice(1,e.length-1),vo(e,t))}function po(e,t){return e.length<3?oo(e):e[0]+go((e.push(e[0]),e),vo([e[e.length-2]].concat(e,[e[1]]),t))}function ho(e,t){return e.length<3?oo(e):e[0]+go(e,vo(e,t))}function go(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return oo(e);var n=e.length!=t.length,r="",a=e[0],i=e[1],o=t[0],l=o,u=1;if(n&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],a=e[1],u=2),t.length>1){l=t[1],i=e[u],u++,r+="C"+(a[0]+o[0])+","+(a[1]+o[1])+","+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1];for(var s=2;s<t.length;s++,u++)i=e[u],l=t[s],r+="S"+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1]}if(n){var c=e[u];r+="Q"+(i[0]+2*l[0]/3)+","+(i[1]+2*l[1]/3)+","+c[0]+","+c[1]}return r}function vo(e,t){for(var n,r=[],a=(1-t)/2,i=e[0],o=e[1],l=1,u=e.length;++l<u;)n=i,i=o,o=e[l],r.push([a*(o[0]-n[0]),a*(o[1]-n[1])]);return r}function mo(e){if(e.length<3)return oo(e);var t=1,n=e.length,r=e[0],a=r[0],i=r[1],o=[a,a,a,(r=e[1])[0]],l=[i,i,i,r[1]],u=[a,",",i,"L",wo(Ms,o),",",wo(Ms,l)];for(e.push(e[n-1]);++t<=n;)r=e[t],o.shift(),o.push(r[0]),l.shift(),l.push(r[1]),_o(u,o,l);return e.pop(),u.push("L",r),u.join("")}function yo(e){if(e.length<4)return oo(e);for(var t,n=[],r=-1,a=e.length,i=[0],o=[0];++r<3;)t=e[r],i.push(t[0]),o.push(t[1]);for(n.push(wo(Ms,i)+","+wo(Ms,o)),--r;++r<a;)t=e[r],i.shift(),i.push(t[0]),o.shift(),o.push(t[1]),_o(n,i,o);return n.join("")}function xo(e){for(var t,n,r=-1,a=e.length,i=a+4,o=[],l=[];++r<4;)n=e[r%a],o.push(n[0]),l.push(n[1]);for(t=[wo(Ms,o),",",wo(Ms,l)],--r;++r<i;)n=e[r%a],o.shift(),o.push(n[0]),l.shift(),l.push(n[1]),_o(t,o,l);return t.join("")}function bo(e,t){var n=e.length-1;if(n)for(var r,a,i=e[0][0],o=e[0][1],l=e[n][0]-i,u=e[n][1]-o,s=-1;++s<=n;)r=e[s],a=s/n,r[0]=t*r[0]+(1-t)*(i+a*l),r[1]=t*r[1]+(1-t)*(o+a*u);return mo(e)}function wo(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function _o(e,t,n){e.push("C",wo(_s,t),",",wo(_s,n),",",wo(ks,t),",",wo(ks,n),",",wo(Ms,t),",",wo(Ms,n))}function ko(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Mo(e){for(var t=0,n=e.length-1,r=[],a=e[0],i=e[1],o=r[0]=ko(a,i);++t<n;)r[t]=(o+(o=ko(a=i,i=e[t+1])))/2;return r[t]=o,r}function Ao(e){for(var t,n,r,a,i=[],o=Mo(e),l=-1,u=e.length-1;++l<u;)t=ko(e[l],e[l+1]),ol(t)<jl?o[l]=o[l+1]=0:(n=o[l]/t,r=o[l+1]/t,a=n*n+r*r,a>9&&(a=3*t/Math.sqrt(a),o[l]=a*n,o[l+1]=a*r));for(l=-1;++l<=u;)a=(e[Math.min(u,l+1)][0]-e[Math.max(0,l-1)][0])/(6*(1+o[l]*o[l])),i.push([a||0,o[l]*a||0]);return i}function zo(e){return e.length<3?oo(e):e[0]+go(e,Ao(e))}function jo(e){for(var t,n,r,a=-1,i=e.length;++a<i;)t=e[a],n=t[0],r=t[1]+xs,t[0]=n*Math.cos(r),t[1]=n*Math.sin(r);return e}function Eo(e){function t(t){function u(){g.push("M",l(e(m),d),c,s(e(v.reverse()),d),"Z")}for(var f,p,h,g=[],v=[],m=[],y=-1,x=t.length,b=kt(n),w=kt(a),_=n===r?function(){return p}:kt(r),k=a===i?function(){return h}:kt(i);++y<x;)o.call(this,f=t[y],y)?(v.push([p=+b.call(this,f,y),h=+w.call(this,f,y)]),m.push([+_.call(this,f,y),+k.call(this,f,y)])):v.length&&(u(),v=[],m=[]);return v.length&&u(),g.length?g.join(""):null}var n=Ar,r=Ar,a=0,i=zr,o=An,l=oo,u=l.key,s=l,c="L",d=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(a=i=e,t):i},t.y0=function(e){return arguments.length?(a=e,t):a},t.y1=function(e){return arguments.length?(i=e,t):i},t.defined=function(e){return arguments.length?(o=e,t):o},t.interpolate=function(e){return arguments.length?(u="function"==typeof e?l=e:(l=ws.get(e)||oo).key,s=l.reverse||l,c=l.closed?"M":"L",t):u},t.tension=function(e){return arguments.length?(d=e,t):d},t}function So(e){return e.radius}function To(e){return[e.x,e.y]}function No(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+xs;return[n*Math.cos(r),n*Math.sin(r)]}}function Oo(){return 64}function Co(){return"circle"}function Fo(e){var t=Math.sqrt(e/Ml);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function qo(e,t){return dl(e,Ts),e.id=t,e}function Po(e,t,n,r){var a=e.id;return L(e,"function"==typeof n?function(e,i,o){e.__transition__[a].tween.set(t,r(n.call(e,e.__data__,i,o)))}:(n=r(n),function(e){e.__transition__[a].tween.set(t,n)}))}function Lo(e){return null==e&&(e=""),function(){this.textContent=e}}function Io(e,t,n,r){var a=e.__transition__||(e.__transition__={active:0,count:0}),i=a[n];if(!i){var o=r.time;i=a[n]={tween:new l,time:o,ease:r.ease,delay:r.delay,duration:r.duration},++a.count,Xo.timer(function(r){function l(r){return a.active>n?s():(a.active=n,i.event&&i.event.start.call(e,c,t),i.tween.forEach(function(n,r){(r=r.call(e,c,t))&&g.push(r)}),void Xo.timer(function(){return h.c=u(r||1)?An:u,1},0,o))}function u(r){if(a.active!==n)return s();for(var o=r/p,l=d(o),u=g.length;u>0;)g[--u].call(e,l);return o>=1?(i.event&&i.event.end.call(e,c,t),s()):void 0}function s(){return--a.count?delete a[n]:delete e.__transition__,1}var c=e.__data__,d=i.ease,f=i.delay,p=i.duration,h=Jl,g=[];return h.t=f+o,r>=f?l(r-f):void(h.c=l)},0,o)}}function Vo(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function Bo(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function Uo(e){return e.toISOString()}function Do(e,t,n){function r(t){return e(t)}function a(e,n){var r=e[1]-e[0],a=r/n,i=Xo.bisect(Vs,a);return i==Vs.length?[t.year,Di(e.map(function(e){return e/31536e6}),n)[2]]:i?t[a/Vs[i-1]<Vs[i]/a?i-1:i]:[Ds,Di(e,n)[2]]}return r.invert=function(t){return Ro(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(Ro)},r.nice=function(e,t){function n(n){return!isNaN(n)&&!e.range(n,Ro(+n+1),t).length}var i=r.domain(),o=Ci(i),l=null==e?a(o,10):"number"==typeof e&&a(o,e);return l&&(e=l[0],t=l[1]),r.domain(Pi(i,t>1?{floor:function(t){for(;n(t=e.floor(t));)t=Ro(t-1);return t},ceil:function(t){for(;n(t=e.ceil(t));)t=Ro(+t+1);return t}}:e))},r.ticks=function(e,t){var n=Ci(r.domain()),i=null==e?a(n,10):"number"==typeof e?a(n,e):!e.range&&[{range:e},t];return i&&(e=i[0],t=i[1]),e.range(n[0],Ro(+n[1]+1),1>t?1:t)},r.tickFormat=function(){return n},r.copy=function(){return Do(e.copy(),t,n)},Bi(r,e)}function Ro(e){return new Date(e)}function Ho(e){return JSON.parse(e.responseText)}function Yo(e){var t=Wo.createRange();return t.selectNode(Wo.body),t.createContextualFragment(e.responseText)}var Xo={version:"3.4.9"};Date.now||(Date.now=function(){return+new Date});var Go=[].slice,Zo=function(e){return Go.call(e)},Wo=document,Jo=Wo.documentElement,Qo=window;try{Zo(Jo.childNodes)[0].nodeType}catch($o){Zo=function(e){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n}}try{Wo.createElement("div").style.setProperty("opacity",0,"")}catch(Ko){var el=Qo.Element.prototype,tl=el.setAttribute,nl=el.setAttributeNS,rl=Qo.CSSStyleDeclaration.prototype,al=rl.setProperty;el.setAttribute=function(e,t){tl.call(this,e,t+"")},el.setAttributeNS=function(e,t,n){nl.call(this,e,t,n+"")},rl.setProperty=function(e,t,n){al.call(this,e,t+"",n)}}Xo.ascending=e,Xo.descending=function(e,t){return e>t?-1:t>e?1:t>=e?0:0/0},Xo.min=function(e,t){var n,r,a=-1,i=e.length;if(1===arguments.length){for(;++a<i&&!(null!=(n=e[a])&&n>=n);)n=void 0;for(;++a<i;)null!=(r=e[a])&&n>r&&(n=r)}else{for(;++a<i&&!(null!=(n=t.call(e,e[a],a))&&n>=n);)n=void 0;for(;++a<i;)null!=(r=t.call(e,e[a],a))&&n>r&&(n=r)}return n},Xo.max=function(e,t){var n,r,a=-1,i=e.length;if(1===arguments.length){for(;++a<i&&!(null!=(n=e[a])&&n>=n);)n=void 0;for(;++a<i;)null!=(r=e[a])&&r>n&&(n=r)}else{for(;++a<i&&!(null!=(n=t.call(e,e[a],a))&&n>=n);)n=void 0;for(;++a<i;)null!=(r=t.call(e,e[a],a))&&r>n&&(n=r)}return n},Xo.extent=function(e,t){var n,r,a,i=-1,o=e.length;if(1===arguments.length){for(;++i<o&&!(null!=(n=a=e[i])&&n>=n);)n=a=void 0;for(;++i<o;)null!=(r=e[i])&&(n>r&&(n=r),r>a&&(a=r))}else{for(;++i<o&&!(null!=(n=a=t.call(e,e[i],i))&&n>=n);)n=void 0;for(;++i<o;)null!=(r=t.call(e,e[i],i))&&(n>r&&(n=r),r>a&&(a=r))}return[n,a]},Xo.sum=function(e,t){var n,r=0,a=e.length,i=-1;if(1===arguments.length)for(;++i<a;)isNaN(n=+e[i])||(r+=n);else for(;++i<a;)isNaN(n=+t.call(e,e[i],i))||(r+=n);return r},Xo.mean=function(e,t){var r,a=0,i=e.length,o=-1,l=i;if(1===arguments.length)for(;++o<i;)n(r=e[o])?a+=r:--l;else for(;++o<i;)n(r=t.call(e,e[o],o))?a+=r:--l;return l?a/l:void 0},Xo.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),a=+e[r-1],i=n-r;return i?a+i*(e[r]-a):a},Xo.median=function(t,r){return arguments.length>1&&(t=t.map(r)),t=t.filter(n),t.length?Xo.quantile(t.sort(e),.5):void 0};var il=r(e);Xo.bisectLeft=il.left,Xo.bisect=Xo.bisectRight=il.right,Xo.bisector=function(t){return r(1===t.length?function(n,r){return e(t(n),r)}:t)},Xo.shuffle=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e},Xo.permute=function(e,t){for(var n=t.length,r=new Array(n);n--;)r[n]=e[t[n]];return r},Xo.pairs=function(e){for(var t,n=0,r=e.length-1,a=e[0],i=new Array(0>r?0:r);r>n;)i[n]=[t=a,a=e[++n]];return i},Xo.zip=function(){if(!(r=arguments.length))return[];for(var e=-1,t=Xo.min(arguments,a),n=new Array(t);++e<t;)for(var r,i=-1,o=n[e]=new Array(r);++i<r;)o[i]=arguments[i][e];return n},Xo.transpose=function(e){return Xo.zip.apply(Xo,e)},Xo.keys=function(e){var t=[];for(var n in e)t.push(n);return t},Xo.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},Xo.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},Xo.merge=function(e){for(var t,n,r,a=e.length,i=-1,o=0;++i<a;)o+=e[i].length;for(n=new Array(o);--a>=0;)for(r=e[a],t=r.length;--t>=0;)n[--o]=r[t];return n};var ol=Math.abs;Xo.range=function(e,t,n){if(arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0)),(t-e)/n===1/0)throw new Error("infinite range");var r,a=[],o=i(ol(n)),l=-1;if(e*=o,t*=o,n*=o,0>n)for(;(r=e+n*++l)>t;)a.push(r/o);else for(;(r=e+n*++l)<t;)a.push(r/o);return a},Xo.map=function(e){var t=new l;if(e instanceof l)e.forEach(function(e,n){t.set(e,n)});else for(var n in e)t.set(n,e[n]);return t},o(l,{has:u,get:function(e){return this[ll+e]},set:function(e,t){return this[ll+e]=t},remove:s,keys:c,values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},size:d,empty:f,forEach:function(e){for(var t in this)t.charCodeAt(0)===ul&&e.call(this,t.substring(1),this[t])}});var ll="\x00",ul=ll.charCodeAt(0);Xo.nest=function(){function e(t,o,u){if(u>=i.length)return r?r.call(a,o):n?o.sort(n):o;for(var s,c,d,f,p=-1,h=o.length,g=i[u++],v=new l;++p<h;)(f=v.get(s=g(c=o[p])))?f.push(c):v.set(s,[c]);return t?(c=t(),d=function(n,r){c.set(n,e(t,r,u))}):(c={},d=function(n,r){c[n]=e(t,r,u)}),v.forEach(d),c}function t(e,n){if(n>=i.length)return e;var r=[],a=o[n++];return e.forEach(function(e,a){r.push({key:e,values:t(a,n)})}),a?r.sort(function(e,t){return a(e.key,t.key)}):r}var n,r,a={},i=[],o=[];return a.map=function(t,n){return e(n,t,0)},a.entries=function(n){return t(e(Xo.map,n,0),0)},a.key=function(e){return i.push(e),a},a.sortKeys=function(e){return o[i.length-1]=e,a},a.sortValues=function(e){return n=e,a},a.rollup=function(e){return r=e,a},a},Xo.set=function(e){var t=new p;if(e)for(var n=0,r=e.length;r>n;++n)t.add(e[n]);return t},o(p,{has:u,add:function(e){return this[ll+e]=!0,e},remove:function(e){return e=ll+e,e in this&&delete this[e]},values:c,size:d,empty:f,forEach:function(e){for(var t in this)t.charCodeAt(0)===ul&&e.call(this,t.substring(1))}}),Xo.behavior={},Xo.rebind=function(e,t){for(var n,r=1,a=arguments.length;++r<a;)e[n=arguments[r]]=h(e,t,t[n]);return e};var sl=["webkit","ms","moz","Moz","o","O"];Xo.dispatch=function(){for(var e=new m,t=-1,n=arguments.length;++t<n;)e[arguments[t]]=y(e);return e},m.prototype.on=function(e,t){var n=e.indexOf("."),r="";if(n>=0&&(r=e.substring(n+1),e=e.substring(0,n)),e)return arguments.length<2?this[e].on(r):this[e].on(r,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(r,null);return this}},Xo.event=null,Xo.requote=function(e){return e.replace(cl,"\\$&")};var cl=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,dl={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]},fl=function(e,t){return t.querySelector(e)},pl=function(e,t){return t.querySelectorAll(e)},hl=Jo.matches||Jo[g(Jo,"matchesSelector")],gl=function(e,t){return hl.call(e,t)};"function"==typeof Sizzle&&(fl=function(e,t){return Sizzle(e,t)[0]||null},pl=Sizzle,gl=Sizzle.matchesSelector),Xo.selection=function(){return xl};var vl=Xo.selection.prototype=[];vl.select=function(e){var t,n,r,a,i=[];e=k(e);for(var o=-1,l=this.length;++o<l;){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var u=-1,s=r.length;++u<s;)(a=r[u])?(t.push(n=e.call(a,a.__data__,u,o)),n&&"__data__"in a&&(n.__data__=a.__data__)):t.push(null)}return _(i)},vl.selectAll=function(e){var t,n,r=[];e=M(e);for(var a=-1,i=this.length;++a<i;)for(var o=this[a],l=-1,u=o.length;++l<u;)(n=o[l])&&(r.push(t=Zo(e.call(n,n.__data__,l,a))),t.parentNode=n);return _(r)};var ml={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Xo.ns={prefix:ml,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),ml.hasOwnProperty(n)?{space:ml[n],local:e}:e}},vl.attr=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node();return e=Xo.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(A(t,e[t]));return this}return this.each(A(e,t))},vl.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node(),r=(e=E(e)).length,a=-1;if(t=n.classList){for(;++a<r;)if(!t.contains(e[a]))return!1}else for(t=n.getAttribute("class");++a<r;)if(!j(e[a]).test(t))return!1;return!0}for(t in e)this.each(S(t,e[t]));return this}return this.each(S(e,t))},vl.style=function(e,t,n){var r=arguments.length;if(3>r){if("string"!=typeof e){2>r&&(t="");for(n in e)this.each(N(n,e[n],t));return this}if(2>r)return Qo.getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(N(e,t,n))},vl.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(O(t,e[t]));return this}return this.each(O(e,t))},vl.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},vl.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},vl.append=function(e){return e=C(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},vl.insert=function(e,t){return e=C(e),t=k(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},vl.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},vl.data=function(e,t){function n(e,n){var r,a,i,o=e.length,d=n.length,f=Math.min(o,d),p=new Array(d),h=new Array(d),g=new Array(o);if(t){var v,m=new l,y=new l,x=[];for(r=-1;++r<o;)v=t.call(a=e[r],a.__data__,r),m.has(v)?g[r]=a:m.set(v,a),x.push(v);for(r=-1;++r<d;)v=t.call(n,i=n[r],r),(a=m.get(v))?(p[r]=a,a.__data__=i):y.has(v)||(h[r]=F(i)),y.set(v,i),m.remove(v);for(r=-1;++r<o;)m.has(x[r])&&(g[r]=e[r])}else{for(r=-1;++r<f;)a=e[r],i=n[r],a?(a.__data__=i,p[r]=a):h[r]=F(i);for(;d>r;++r)h[r]=F(n[r]);for(;o>r;++r)g[r]=e[r]}h.update=p,h.parentNode=p.parentNode=g.parentNode=e.parentNode,u.push(h),s.push(p),c.push(g)}var r,a,i=-1,o=this.length;if(!arguments.length){for(e=new Array(o=(r=this[0]).length);++i<o;)(a=r[i])&&(e[i]=a.__data__);return e}var u=I([]),s=_([]),c=_([]);if("function"==typeof e)for(;++i<o;)n(r=this[i],e.call(r,r.parentNode.__data__,i));else for(;++i<o;)n(r=this[i],e);return s.enter=function(){return u},s.exit=function(){return c},s},vl.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},vl.filter=function(e){var t,n,r,a=[];"function"!=typeof e&&(e=q(e));for(var i=0,o=this.length;o>i;i++){a.push(t=[]),t.parentNode=(n=this[i]).parentNode;for(var l=0,u=n.length;u>l;l++)(r=n[l])&&e.call(r,r.__data__,l,i)&&t.push(r)}return _(a)},vl.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n,r=this[e],a=r.length-1,i=r[a];--a>=0;)(n=r[a])&&(i&&i!==n.nextSibling&&i.parentNode.insertBefore(n,i),i=n);return this},vl.sort=function(e){e=P.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},vl.each=function(e){return L(this,function(t,n,r){e.call(t,t.__data__,n,r)})},vl.call=function(e){var t=Zo(arguments);return e.apply(t[0]=this,t),this},vl.empty=function(){return!this.node()},vl.node=function(){for(var e=0,t=this.length;t>e;e++)for(var n=this[e],r=0,a=n.length;a>r;r++){var i=n[r];if(i)return i}return null},vl.size=function(){var e=0;return this.each(function(){++e}),e};var yl=[];Xo.selection.enter=I,Xo.selection.enter.prototype=yl,yl.append=vl.append,yl.empty=vl.empty,yl.node=vl.node,yl.call=vl.call,yl.size=vl.size,yl.select=function(e){for(var t,n,r,a,i,o=[],l=-1,u=this.length;++l<u;){r=(a=this[l]).update,o.push(t=[]),t.parentNode=a.parentNode;for(var s=-1,c=a.length;++s<c;)(i=a[s])?(t.push(r[s]=n=e.call(a.parentNode,i.__data__,s,l)),n.__data__=i.__data__):t.push(null)}return _(o)},yl.insert=function(e,t){return arguments.length<2&&(t=V(this)),vl.insert.call(this,e,t)},vl.transition=function(){for(var e,t,n=zs||++Ns,r=[],a=js||{time:Date.now(),ease:wa,delay:0,duration:250},i=-1,o=this.length;++i<o;){r.push(e=[]);for(var l=this[i],u=-1,s=l.length;++u<s;)(t=l[u])&&Io(t,u,n,a),e.push(t)}return qo(r,n)},vl.interrupt=function(){return this.each(B)},Xo.select=function(e){var t=["string"==typeof e?fl(e,Wo):e];return t.parentNode=Jo,_([t])},Xo.selectAll=function(e){var t=Zo("string"==typeof e?pl(e,Wo):e);return t.parentNode=Jo,_([t])};var xl=Xo.select(Jo);vl.on=function(e,t,n){var r=arguments.length;if(3>r){if("string"!=typeof e){2>r&&(t=!1);for(n in e)this.each(U(n,e[n],t));return this}if(2>r)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(U(e,t,n))};var bl=Xo.map({mouseenter:"mouseover",mouseleave:"mouseout"});bl.forEach(function(e){"on"+e in Wo&&bl.remove(e)});var wl="onselectstart"in Wo?null:g(Jo.style,"userSelect"),_l=0;Xo.mouse=function(e){return Y(e,b())};var kl=/WebKit/.test(Qo.navigator.userAgent)?-1:0;Xo.touches=function(e,t){return arguments.length<2&&(t=b().touches),t?Zo(t).map(function(t){var n=Y(e,t);return n.identifier=t.identifier,n}):[]},Xo.behavior.drag=function(){function e(){this.on("mousedown.drag",a).on("touchstart.drag",i)}function t(e,t,a,i,o){return function(){function l(){var e,n,r=t(f,g);r&&(e=r[0]-x[0],n=r[1]-x[1],h|=e|n,x=r,p({type:"drag",x:r[0]+s[0],y:r[1]+s[1],dx:e,dy:n}))}function u(){t(f,g)&&(m.on(i+v,null).on(o+v,null),y(h&&Xo.event.target===d),p({type:"dragend"}))}var s,c=this,d=Xo.event.target,f=c.parentNode,p=n.of(c,arguments),h=0,g=e(),v=".drag"+(null==g?"":"-"+g),m=Xo.select(a()).on(i+v,l).on(o+v,u),y=H(),x=t(f,g);r?(s=r.apply(c,arguments),s=[s.x-x[0],s.y-x[1]]):s=[0,0],p({type:"dragstart"})}}var n=w(e,"drag","dragstart","dragend"),r=null,a=t(v,Xo.mouse,Z,"mousemove","mouseup"),i=t(X,Xo.touch,G,"touchmove","touchend");return e.origin=function(t){return arguments.length?(r=t,e):r
},Xo.rebind(e,n,"on")};var Ml=Math.PI,Al=2*Ml,zl=Ml/2,jl=1e-6,El=jl*jl,Sl=Ml/180,Tl=180/Ml,Nl=Math.SQRT2,Ol=2,Cl=4;Xo.interpolateZoom=function(e,t){function n(e){var t=e*y;if(m){var n=et(g),o=i/(Ol*f)*(n*tt(Nl*t+g)-K(g));return[r+o*s,a+o*c,i*n/et(Nl*t+g)]}return[r+e*s,a+e*c,i*Math.exp(Nl*t)]}var r=e[0],a=e[1],i=e[2],o=t[0],l=t[1],u=t[2],s=o-r,c=l-a,d=s*s+c*c,f=Math.sqrt(d),p=(u*u-i*i+Cl*d)/(2*i*Ol*f),h=(u*u-i*i-Cl*d)/(2*u*Ol*f),g=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(h*h+1)-h),m=v-g,y=(m||Math.log(u/i))/Nl;return n.duration=1e3*y,n},Xo.behavior.zoom=function(){function e(e){e.on(j,s).on(Pl+".zoom",d).on(E,f).on("dblclick.zoom",p).on(T,c)}function t(e){return[(e[0]-M.x)/M.k,(e[1]-M.y)/M.k]}function n(e){return[e[0]*M.k+M.x,e[1]*M.k+M.y]}function r(e){M.k=Math.max(z[0],Math.min(z[1],e))}function a(e,t){t=n(t),M.x+=e[0]-t[0],M.y+=e[1]-t[1]}function i(){b&&b.domain(y.range().map(function(e){return(e-M.x)/M.k}).map(y.invert)),k&&k.domain(_.range().map(function(e){return(e-M.y)/M.k}).map(_.invert))}function o(e){e({type:"zoomstart"})}function l(e){i(),e({type:"zoom",scale:M.k,translate:[M.x,M.y]})}function u(e){e({type:"zoomend"})}function s(){function e(){c=1,a(Xo.mouse(r),p),l(s)}function n(){d.on(E,Qo===r?f:null).on(S,null),h(c&&Xo.event.target===i),u(s)}var r=this,i=Xo.event.target,s=N.of(r,arguments),c=0,d=Xo.select(Qo).on(E,e).on(S,n),p=t(Xo.mouse(r)),h=H();B.call(r),o(s)}function c(){function e(){var e=Xo.touches(p);return f=M.k,e.forEach(function(e){e.identifier in g&&(g[e.identifier]=t(e))}),e}function n(){var t=Xo.event.target;Xo.select(t).on(b,i).on(w,d),_.push(t);for(var n=Xo.event.changedTouches,o=0,u=n.length;u>o;++o)g[n[o].identifier]=null;var s=e(),c=Date.now();if(1===s.length){if(500>c-m){var f=s[0],p=g[f.identifier];r(2*M.k),a(f,p),x(),l(h)}m=c}else if(s.length>1){var f=s[0],y=s[1],k=f[0]-y[0],A=f[1]-y[1];v=k*k+A*A}}function i(){for(var e,t,n,i,o=Xo.touches(p),u=0,s=o.length;s>u;++u,i=null)if(n=o[u],i=g[n.identifier]){if(t)break;e=n,t=i}if(i){var c=(c=n[0]-e[0])*c+(c=n[1]-e[1])*c,d=v&&Math.sqrt(c/v);e=[(e[0]+n[0])/2,(e[1]+n[1])/2],t=[(t[0]+i[0])/2,(t[1]+i[1])/2],r(d*f)}m=null,a(e,t),l(h)}function d(){if(Xo.event.touches.length){for(var t=Xo.event.changedTouches,n=0,r=t.length;r>n;++n)delete g[t[n].identifier];for(var a in g)return void e()}Xo.selectAll(_).on(y,null),k.on(j,s).on(T,c),A(),u(h)}var f,p=this,h=N.of(p,arguments),g={},v=0,y=".zoom-"+Xo.event.changedTouches[0].identifier,b="touchmove"+y,w="touchend"+y,_=[],k=Xo.select(p).on(j,null).on(T,n),A=H();B.call(p),n(),o(h)}function d(){var e=N.of(this,arguments);v?clearTimeout(v):(B.call(this),o(e)),v=setTimeout(function(){v=null,u(e)},50),x();var n=g||Xo.mouse(this);h||(h=t(n)),r(Math.pow(2,.002*Fl())*M.k),a(n,h),l(e)}function f(){h=null}function p(){var e=N.of(this,arguments),n=Xo.mouse(this),i=t(n),s=Math.log(M.k)/Math.LN2;o(e),r(Math.pow(2,Xo.event.shiftKey?Math.ceil(s)-1:Math.floor(s)+1)),a(n,i),l(e),u(e)}var h,g,v,m,y,b,_,k,M={x:0,y:0,k:1},A=[960,500],z=ql,j="mousedown.zoom",E="mousemove.zoom",S="mouseup.zoom",T="touchstart.zoom",N=w(e,"zoomstart","zoom","zoomend");return e.event=function(e){e.each(function(){var e=N.of(this,arguments),t=M;zs?Xo.select(this).transition().each("start.zoom",function(){M=this.__chart__||{x:0,y:0,k:1},o(e)}).tween("zoom:zoom",function(){var n=A[0],r=A[1],a=n/2,i=r/2,o=Xo.interpolateZoom([(a-M.x)/M.k,(i-M.y)/M.k,n/M.k],[(a-t.x)/t.k,(i-t.y)/t.k,n/t.k]);return function(t){var r=o(t),u=n/r[2];this.__chart__=M={x:a-r[0]*u,y:i-r[1]*u,k:u},l(e)}}).each("end.zoom",function(){u(e)}):(this.__chart__=M,o(e),l(e),u(e))})},e.translate=function(t){return arguments.length?(M={x:+t[0],y:+t[1],k:M.k},i(),e):[M.x,M.y]},e.scale=function(t){return arguments.length?(M={x:M.x,y:M.y,k:+t},i(),e):M.k},e.scaleExtent=function(t){return arguments.length?(z=null==t?ql:[+t[0],+t[1]],e):z},e.center=function(t){return arguments.length?(g=t&&[+t[0],+t[1]],e):g},e.size=function(t){return arguments.length?(A=t&&[+t[0],+t[1]],e):A},e.x=function(t){return arguments.length?(b=t,y=t.copy(),M={x:0,y:0,k:1},e):b},e.y=function(t){return arguments.length?(k=t,_=t.copy(),M={x:0,y:0,k:1},e):k},Xo.rebind(e,N,"on")};var Fl,ql=[0,1/0],Pl="onwheel"in Wo?(Fl=function(){return-Xo.event.deltaY*(Xo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Wo?(Fl=function(){return Xo.event.wheelDelta},"mousewheel"):(Fl=function(){return-Xo.event.detail},"MozMousePixelScroll");Xo.color=rt,rt.prototype.toString=function(){return this.rgb()+""},Xo.hsl=at;var Ll=at.prototype=new rt;Ll.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),new at(this.h,this.s,this.l/e)},Ll.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new at(this.h,this.s,e*this.l)},Ll.rgb=function(){return it(this.h,this.s,this.l)},Xo.hcl=ot;var Il=ot.prototype=new rt;Il.brighter=function(e){return new ot(this.h,this.c,Math.min(100,this.l+Vl*(arguments.length?e:1)))},Il.darker=function(e){return new ot(this.h,this.c,Math.max(0,this.l-Vl*(arguments.length?e:1)))},Il.rgb=function(){return lt(this.h,this.c,this.l).rgb()},Xo.lab=ut;var Vl=18,Bl=.95047,Ul=1,Dl=1.08883,Rl=ut.prototype=new rt;Rl.brighter=function(e){return new ut(Math.min(100,this.l+Vl*(arguments.length?e:1)),this.a,this.b)},Rl.darker=function(e){return new ut(Math.max(0,this.l-Vl*(arguments.length?e:1)),this.a,this.b)},Rl.rgb=function(){return st(this.l,this.a,this.b)},Xo.rgb=ht;var Hl=ht.prototype=new rt;Hl.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,a=30;return t||n||r?(t&&a>t&&(t=a),n&&a>n&&(n=a),r&&a>r&&(r=a),new ht(Math.min(255,t/e),Math.min(255,n/e),Math.min(255,r/e))):new ht(a,a,a)},Hl.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new ht(e*this.r,e*this.g,e*this.b)},Hl.hsl=function(){return xt(this.r,this.g,this.b)},Hl.toString=function(){return"#"+mt(this.r)+mt(this.g)+mt(this.b)};var Yl=Xo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Yl.forEach(function(e,t){Yl.set(e,gt(t))}),Xo.functor=kt,Xo.xhr=At(Mt),Xo.dsv=function(e,t){function n(e,n,i){arguments.length<3&&(i=n,n=null);var o=zt(e,t,null==n?r:a(n),i);return o.row=function(e){return arguments.length?o.response(null==(n=e)?r:a(e)):n},o}function r(e){return n.parse(e.responseText)}function a(e){return function(t){return n.parse(t.responseText,e)}}function i(t){return t.map(o).join(e)}function o(e){return l.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var l=new RegExp('["'+e+"\n]"),u=e.charCodeAt(0);return n.parse=function(e,t){var r;return n.parseRows(e,function(e,n){if(r)return r(e,n-1);var a=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,n){return t(a(e),n)}:a})},n.parseRows=function(e,t){function n(){if(c>=s)return o;if(a)return a=!1,i;var t=c;if(34===e.charCodeAt(t)){for(var n=t;n++<s;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}c=n+2;var r=e.charCodeAt(n+1);return 13===r?(a=!0,10===e.charCodeAt(n+2)&&++c):10===r&&(a=!0),e.substring(t+1,n).replace(/""/g,'"')}for(;s>c;){var r=e.charCodeAt(c++),l=1;if(10===r)a=!0;else if(13===r)a=!0,10===e.charCodeAt(c)&&(++c,++l);else if(r!==u)continue;return e.substring(t,c-l)}return e.substring(t)}for(var r,a,i={},o={},l=[],s=e.length,c=0,d=0;(r=n())!==o;){for(var f=[];r!==i&&r!==o;)f.push(r),r=n();(!t||(f=t(f,d++)))&&l.push(f)}return l},n.format=function(t){if(Array.isArray(t[0]))return n.formatRows(t);var r=new p,a=[];return t.forEach(function(e){for(var t in e)r.has(t)||a.push(r.add(t))}),[a.map(o).join(e)].concat(t.map(function(t){return a.map(function(e){return o(t[e])}).join(e)})).join("\n")},n.formatRows=function(e){return e.map(i).join("\n")},n},Xo.csv=Xo.dsv(",","text/csv"),Xo.tsv=Xo.dsv("	","text/tab-separated-values"),Xo.touch=function(e,t,n){if(arguments.length<3&&(n=t,t=b().changedTouches),t)for(var r,a=0,i=t.length;i>a;++a)if((r=t[a]).identifier===n)return Y(e,r)};var Xl,Gl,Zl,Wl,Jl,Ql=Qo[g(Qo,"requestAnimationFrame")]||function(e){setTimeout(e,17)};Xo.timer=function(e,t,n){var r=arguments.length;2>r&&(t=0),3>r&&(n=Date.now());var a=n+t,i={c:e,t:a,f:!1,n:null};Gl?Gl.n=i:Xl=i,Gl=i,Zl||(Wl=clearTimeout(Wl),Zl=1,Ql(Et))},Xo.timer.flush=function(){St(),Tt()},Xo.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var $l=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Ot);Xo.formatPrefix=function(e,t){var n=0;return e&&(0>e&&(e*=-1),t&&(e=Xo.round(e,Nt(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),$l[8+n/3]};var Kl=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,eu=Xo.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=Xo.round(e,Nt(e,t))).toFixed(Math.max(0,Math.min(20,Nt(e*(1+1e-15),t))))}}),tu=Xo.time={},nu=Date;qt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ru.setUTCDate.apply(this._,arguments)},setDay:function(){ru.setUTCDay.apply(this._,arguments)},setFullYear:function(){ru.setUTCFullYear.apply(this._,arguments)},setHours:function(){ru.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ru.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ru.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ru.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ru.setUTCSeconds.apply(this._,arguments)},setTime:function(){ru.setTime.apply(this._,arguments)}};var ru=Date.prototype;tu.year=Pt(function(e){return e=tu.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),tu.years=tu.year.range,tu.years.utc=tu.year.utc.range,tu.day=Pt(function(e){var t=new nu(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),tu.days=tu.day.range,tu.days.utc=tu.day.utc.range,tu.dayOfYear=function(e){var t=tu.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var n=tu[e]=Pt(function(e){return(e=tu.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var n=tu.year(e).getDay();return Math.floor((tu.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});tu[e+"s"]=n.range,tu[e+"s"].utc=n.utc.range,tu[e+"OfYear"]=function(e){var n=tu.year(e).getDay();return Math.floor((tu.dayOfYear(e)+(n+t)%7)/7)}}),tu.week=tu.sunday,tu.weeks=tu.sunday.range,tu.weeks.utc=tu.sunday.utc.range,tu.weekOfYear=tu.sundayOfYear;var au={"-":"",_:" ",0:"0"},iu=/^\s*\d+/,ou=/^%/;Xo.locale=function(e){return{numberFormat:Ct(e),timeFormat:It(e)}};var lu=Xo.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Xo.format=lu.numberFormat,Xo.geo={},on.prototype={s:0,t:0,add:function(e){ln(e,this.t,uu),ln(uu.s,this.s,this),this.s?this.t+=uu.t:this.s=uu.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var uu=new on;Xo.geo.stream=function(e,t){e&&su.hasOwnProperty(e.type)?su[e.type](e,t):un(e,t)};var su={Feature:function(e,t){un(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)un(n[r].geometry,t)}},cu={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){sn(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)sn(n[r],t,0)},Polygon:function(e,t){cn(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)cn(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)un(n[r],t)}};Xo.geo.area=function(e){return du=0,Xo.geo.stream(e,pu),du};var du,fu=new on,pu={sphere:function(){du+=4*Ml},point:v,lineStart:v,lineEnd:v,polygonStart:function(){fu.reset(),pu.lineStart=dn},polygonEnd:function(){var e=2*fu;du+=0>e?4*Ml+e:e,pu.lineStart=pu.lineEnd=pu.point=v}};Xo.geo.bounds=function(){function e(e,t){x.push(b=[c=e,f=e]),d>t&&(d=t),t>p&&(p=t)}function t(t,n){var r=fn([t*Sl,n*Sl]);if(m){var a=hn(m,r),i=[a[1],-a[0],0],o=hn(i,a);mn(o),o=yn(o);var u=t-h,s=u>0?1:-1,g=o[0]*Tl*s,v=ol(u)>180;if(v^(g>s*h&&s*t>g)){var y=o[1]*Tl;y>p&&(p=y)}else if(g=(g+360)%360-180,v^(g>s*h&&s*t>g)){var y=-o[1]*Tl;d>y&&(d=y)}else d>n&&(d=n),n>p&&(p=n);v?h>t?l(c,t)>l(c,f)&&(f=t):l(t,f)>l(c,f)&&(c=t):f>=c?(c>t&&(c=t),t>f&&(f=t)):t>h?l(c,t)>l(c,f)&&(f=t):l(t,f)>l(c,f)&&(c=t)}else e(t,n);m=r,h=t}function n(){w.point=t}function r(){b[0]=c,b[1]=f,w.point=e,m=null}function a(e,n){if(m){var r=e-h;y+=ol(r)>180?r+(r>0?360:-360):r}else g=e,v=n;pu.point(e,n),t(e,n)}function i(){pu.lineStart()}function o(){a(g,v),pu.lineEnd(),ol(y)>jl&&(c=-(f=180)),b[0]=c,b[1]=f,m=null}function l(e,t){return(t-=e)<0?t+360:t}function u(e,t){return e[0]-t[0]}function s(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var c,d,f,p,h,g,v,m,y,x,b,w={point:e,lineStart:n,lineEnd:r,polygonStart:function(){w.point=a,w.lineStart=i,w.lineEnd=o,y=0,pu.polygonStart()},polygonEnd:function(){pu.polygonEnd(),w.point=e,w.lineStart=n,w.lineEnd=r,0>fu?(c=-(f=180),d=-(p=90)):y>jl?p=90:-jl>y&&(d=-90),b[0]=c,b[1]=f}};return function(e){p=f=-(c=d=1/0),x=[],Xo.geo.stream(e,w);var t=x.length;if(t){x.sort(u);for(var n,r=1,a=x[0],i=[a];t>r;++r)n=x[r],s(n[0],a)||s(n[1],a)?(l(a[0],n[1])>l(a[0],a[1])&&(a[1]=n[1]),l(n[0],a[1])>l(a[0],a[1])&&(a[0]=n[0])):i.push(a=n);for(var o,n,h=-1/0,t=i.length-1,r=0,a=i[t];t>=r;a=n,++r)n=i[r],(o=l(a[1],n[0]))>h&&(h=o,c=n[0],f=a[1])}return x=b=null,1/0===c||1/0===d?[[0/0,0/0],[0/0,0/0]]:[[c,d],[f,p]]}}(),Xo.geo.centroid=function(e){hu=gu=vu=mu=yu=xu=bu=wu=_u=ku=Mu=0,Xo.geo.stream(e,Au);var t=_u,n=ku,r=Mu,a=t*t+n*n+r*r;return El>a&&(t=xu,n=bu,r=wu,jl>gu&&(t=vu,n=mu,r=yu),a=t*t+n*n+r*r,El>a)?[0/0,0/0]:[Math.atan2(n,t)*Tl,$(r/Math.sqrt(a))*Tl]};var hu,gu,vu,mu,yu,xu,bu,wu,_u,ku,Mu,Au={sphere:v,point:bn,lineStart:_n,lineEnd:kn,polygonStart:function(){Au.lineStart=Mn},polygonEnd:function(){Au.lineStart=_n}},zu=Sn(An,Fn,Pn,[-Ml,-Ml/2]),ju=1e9;Xo.geo.clipExtent=function(){var e,t,n,r,a,i,o={stream:function(e){return a&&(a.valid=!1),a=i(e),a.valid=!0,a},extent:function(l){return arguments.length?(i=Vn(e=+l[0][0],t=+l[0][1],n=+l[1][0],r=+l[1][1]),a&&(a.valid=!1,a=null),o):[[e,t],[n,r]]}};return o.extent([[0,0],[960,500]])},(Xo.geo.conicEqualArea=function(){return Un(Dn)}).raw=Dn,Xo.geo.albers=function(){return Xo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Xo.geo.albersUsa=function(){function e(e){var i=e[0],o=e[1];return t=null,n(i,o),t||(r(i,o),t)||a(i,o),t}var t,n,r,a,i=Xo.geo.albers(),o=Xo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Xo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(e,n){t=[e,n]}};return e.invert=function(e){var t=i.scale(),n=i.translate(),r=(e[0]-n[0])/t,a=(e[1]-n[1])/t;return(a>=.12&&.234>a&&r>=-.425&&-.214>r?o:a>=.166&&.234>a&&r>=-.214&&-.115>r?l:i).invert(e)},e.stream=function(e){var t=i.stream(e),n=o.stream(e),r=l.stream(e);return{point:function(e,a){t.point(e,a),n.point(e,a),r.point(e,a)},sphere:function(){t.sphere(),n.sphere(),r.sphere()},lineStart:function(){t.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},e.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),l.precision(t),e):i.precision()},e.scale=function(t){return arguments.length?(i.scale(t),o.scale(.35*t),l.scale(t),e.translate(i.translate())):i.scale()},e.translate=function(t){if(!arguments.length)return i.translate();var s=i.scale(),c=+t[0],d=+t[1];return n=i.translate(t).clipExtent([[c-.455*s,d-.238*s],[c+.455*s,d+.238*s]]).stream(u).point,r=o.translate([c-.307*s,d+.201*s]).clipExtent([[c-.425*s+jl,d+.12*s+jl],[c-.214*s-jl,d+.234*s-jl]]).stream(u).point,a=l.translate([c-.205*s,d+.212*s]).clipExtent([[c-.214*s+jl,d+.166*s+jl],[c-.115*s-jl,d+.234*s-jl]]).stream(u).point,e},e.scale(1070)};var Eu,Su,Tu,Nu,Ou,Cu,Fu={point:v,lineStart:v,lineEnd:v,polygonStart:function(){Su=0,Fu.lineStart=Rn},polygonEnd:function(){Fu.lineStart=Fu.lineEnd=Fu.point=v,Eu+=ol(Su/2)}},qu={point:Hn,lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v},Pu={point:Gn,lineStart:Zn,lineEnd:Wn,polygonStart:function(){Pu.lineStart=Jn},polygonEnd:function(){Pu.point=Gn,Pu.lineStart=Zn,Pu.lineEnd=Wn}};Xo.geo.path=function(){function e(e){return e&&("function"==typeof l&&i.pointRadius(+l.apply(this,arguments)),o&&o.valid||(o=a(i)),Xo.geo.stream(e,o)),i.result()}function t(){return o=null,e}var n,r,a,i,o,l=4.5;return e.area=function(e){return Eu=0,Xo.geo.stream(e,a(Fu)),Eu},e.centroid=function(e){return vu=mu=yu=xu=bu=wu=_u=ku=Mu=0,Xo.geo.stream(e,a(Pu)),Mu?[_u/Mu,ku/Mu]:wu?[xu/wu,bu/wu]:yu?[vu/yu,mu/yu]:[0/0,0/0]},e.bounds=function(e){return Ou=Cu=-(Tu=Nu=1/0),Xo.geo.stream(e,a(qu)),[[Tu,Nu],[Ou,Cu]]},e.projection=function(e){return arguments.length?(a=(n=e)?e.stream||Kn(e):Mt,t()):n},e.context=function(e){return arguments.length?(i=null==(r=e)?new Yn:new Qn(e),"function"!=typeof l&&i.pointRadius(l),t()):r},e.pointRadius=function(t){return arguments.length?(l="function"==typeof t?t:(i.pointRadius(+t),+t),e):l},e.projection(Xo.geo.albersUsa()).context(null)},Xo.geo.transform=function(e){return{stream:function(t){var n=new er(t);for(var r in e)n[r]=e[r];return n}}},er.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Xo.geo.projection=nr,Xo.geo.projectionMutator=rr,(Xo.geo.equirectangular=function(){return nr(ir)}).raw=ir.invert=ir,Xo.geo.rotation=function(e){function t(t){return t=e(t[0]*Sl,t[1]*Sl),t[0]*=Tl,t[1]*=Tl,t}return e=lr(e[0]%360*Sl,e[1]*Sl,e.length>2?e[2]*Sl:0),t.invert=function(t){return t=e.invert(t[0]*Sl,t[1]*Sl),t[0]*=Tl,t[1]*=Tl,t},t},or.invert=ir,Xo.geo.circle=function(){function e(){var e="function"==typeof r?r.apply(this,arguments):r,t=lr(-e[0]*Sl,-e[1]*Sl,0).invert,a=[];return n(null,null,1,{point:function(e,n){a.push(e=t(e,n)),e[0]*=Tl,e[1]*=Tl}}),{type:"Polygon",coordinates:[a]}}var t,n,r=[0,0],a=6;return e.origin=function(t){return arguments.length?(r=t,e):r},e.angle=function(r){return arguments.length?(n=dr((t=+r)*Sl,a*Sl),e):t},e.precision=function(r){return arguments.length?(n=dr(t*Sl,(a=+r)*Sl),e):a},e.angle(90)},Xo.geo.distance=function(e,t){var n,r=(t[0]-e[0])*Sl,a=e[1]*Sl,i=t[1]*Sl,o=Math.sin(r),l=Math.cos(r),u=Math.sin(a),s=Math.cos(a),c=Math.sin(i),d=Math.cos(i);return Math.atan2(Math.sqrt((n=d*o)*n+(n=s*c-u*d*l)*n),u*c+s*d*l)},Xo.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return Xo.range(Math.ceil(i/v)*v,a,v).map(f).concat(Xo.range(Math.ceil(s/m)*m,u,m).map(p)).concat(Xo.range(Math.ceil(r/h)*h,n,h).filter(function(e){return ol(e%v)>jl}).map(c)).concat(Xo.range(Math.ceil(l/g)*g,o,g).filter(function(e){return ol(e%m)>jl}).map(d))}var n,r,a,i,o,l,u,s,c,d,f,p,h=10,g=h,v=90,m=360,y=2.5;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[f(i).concat(p(u).slice(1),f(a).reverse().slice(1),p(s).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(i=+t[0][0],a=+t[1][0],s=+t[0][1],u=+t[1][1],i>a&&(t=i,i=a,a=t),s>u&&(t=s,s=u,u=t),e.precision(y)):[[i,s],[a,u]]},e.minorExtent=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],l=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),l>o&&(t=l,l=o,o=t),e.precision(y)):[[r,l],[n,o]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(v=+t[0],m=+t[1],e):[v,m]},e.minorStep=function(t){return arguments.length?(h=+t[0],g=+t[1],e):[h,g]},e.precision=function(t){return arguments.length?(y=+t,c=pr(l,o,90),d=hr(r,n,y),f=pr(s,u,90),p=hr(i,a,y),e):y},e.majorExtent([[-180,-90+jl],[180,90-jl]]).minorExtent([[-180,-80-jl],[180,80+jl]])},Xo.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),n||a.apply(this,arguments)]}}var t,n,r=gr,a=vr;return e.distance=function(){return Xo.geo.distance(t||r.apply(this,arguments),n||a.apply(this,arguments))},e.source=function(n){return arguments.length?(r=n,t="function"==typeof n?null:n,e):r},e.target=function(t){return arguments.length?(a=t,n="function"==typeof t?null:t,e):a},e.precision=function(){return arguments.length?e:0},e},Xo.geo.interpolate=function(e,t){return mr(e[0]*Sl,e[1]*Sl,t[0]*Sl,t[1]*Sl)},Xo.geo.length=function(e){return Lu=0,Xo.geo.stream(e,Iu),Lu};var Lu,Iu={sphere:v,point:v,lineStart:yr,lineEnd:v,polygonStart:v,polygonEnd:v},Vu=xr(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(Xo.geo.azimuthalEqualArea=function(){return nr(Vu)}).raw=Vu;var Bu=xr(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},Mt);(Xo.geo.azimuthalEquidistant=function(){return nr(Bu)}).raw=Bu,(Xo.geo.conicConformal=function(){return Un(br)}).raw=br,(Xo.geo.conicEquidistant=function(){return Un(wr)}).raw=wr;var Uu=xr(function(e){return 1/e},Math.atan);(Xo.geo.gnomonic=function(){return nr(Uu)}).raw=Uu,_r.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-zl]},(Xo.geo.mercator=function(){return kr(_r)}).raw=_r;var Du=xr(function(){return 1},Math.asin);(Xo.geo.orthographic=function(){return nr(Du)}).raw=Du;var Ru=xr(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(Xo.geo.stereographic=function(){return nr(Ru)}).raw=Ru,Mr.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-zl]},(Xo.geo.transverseMercator=function(){var e=kr(Mr),t=e.center,n=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[-e[1],e[0]])},e.rotate=function(e){return e?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},e.rotate([0,0])}).raw=Mr,Xo.geom={},Xo.geom.hull=function(e){function t(e){if(e.length<3)return[];var t,a=kt(n),i=kt(r),o=e.length,l=[],u=[];for(t=0;o>t;t++)l.push([+a.call(this,e[t],t),+i.call(this,e[t],t),t]);for(l.sort(Er),t=0;o>t;t++)u.push([l[t][0],-l[t][1]]);var s=jr(l),c=jr(u),d=c[0]===s[0],f=c[c.length-1]===s[s.length-1],p=[];for(t=s.length-1;t>=0;--t)p.push(e[l[s[t]][2]]);for(t=+d;t<c.length-f;++t)p.push(e[l[c[t]][2]]);return p}var n=Ar,r=zr;return arguments.length?t(e):(t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t)},Xo.geom.polygon=function(e){return dl(e,Hu),e};var Hu=Xo.geom.polygon.prototype=[];Hu.area=function(){for(var e,t=-1,n=this.length,r=this[n-1],a=0;++t<n;)e=r,r=this[t],a+=e[1]*r[0]-e[0]*r[1];return.5*a},Hu.centroid=function(e){var t,n,r=-1,a=this.length,i=0,o=0,l=this[a-1];for(arguments.length||(e=-1/(6*this.area()));++r<a;)t=l,l=this[r],n=t[0]*l[1]-l[0]*t[1],i+=(t[0]+l[0])*n,o+=(t[1]+l[1])*n;return[i*e,o*e]},Hu.clip=function(e){for(var t,n,r,a,i,o,l=Nr(e),u=-1,s=this.length-Nr(this),c=this[s-1];++u<s;){for(t=e.slice(),e.length=0,a=this[u],i=t[(r=t.length-l)-1],n=-1;++n<r;)o=t[n],Sr(o,c,a)?(Sr(i,c,a)||e.push(Tr(i,o,c,a)),e.push(o)):Sr(i,c,a)&&e.push(Tr(i,o,c,a)),i=o;l&&e.push(e[0]),c=a}return e};var Yu,Xu,Gu,Zu,Wu,Ju=[],Qu=[];Vr.prototype.prepare=function(){for(var e,t=this.edges,n=t.length;n--;)e=t[n].edge,e.b&&e.a||t.splice(n,1);return t.sort(Ur),t.length},Qr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},$r.prototype={insert:function(e,t){var n,r,a;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=na(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(a=r.R,a&&a.C?(n.C=a.C=!1,r.C=!0,e=r):(e===n.R&&(ea(this,n),e=n,n=e.U),n.C=!1,r.C=!0,ta(this,r))):(a=r.L,a&&a.C?(n.C=a.C=!1,r.C=!0,e=r):(e===n.L&&(ta(this,n),e=n,n=e.U),n.C=!1,r.C=!0,ea(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,a=e.U,i=e.L,o=e.R;if(n=i?o?na(o):i:o,a?a.L===e?a.L=n:a.R=n:this._=n,i&&o?(r=n.C,n.C=e.C,n.L=i,i.U=n,n!==o?(a=n.U,n.U=e.U,e=n.R,a.L=e,n.R=o,o.U=n):(n.U=a,a=n,e=n.R)):(r=e.C,e=n),e&&(e.U=a),!r){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===a.L){if(t=a.R,t.C&&(t.C=!1,a.C=!0,ea(this,a),t=a.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ta(this,t),t=a.R),t.C=a.C,a.C=t.R.C=!1,ea(this,a),e=this._;break}}else if(t=a.L,t.C&&(t.C=!1,a.C=!0,ta(this,a),t=a.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,ea(this,t),t=a.L),t.C=a.C,a.C=t.L.C=!1,ta(this,a),e=this._;break}t.C=!0,e=a,a=a.U}while(!e.C);e&&(e.C=!1)}}},Xo.geom.voronoi=function(e){function t(e){var t=new Array(e.length),r=l[0][0],a=l[0][1],i=l[1][0],o=l[1][1];return ra(n(e),l).cells.forEach(function(n,l){var u=n.edges,s=n.site,c=t[l]=u.length?u.map(function(e){var t=e.start();return[t.x,t.y]}):s.x>=r&&s.x<=i&&s.y>=a&&s.y<=o?[[r,o],[i,o],[i,a],[r,a]]:[];c.point=e[l]}),t}function n(e){return e.map(function(e,t){return{x:Math.round(i(e,t)/jl)*jl,y:Math.round(o(e,t)/jl)*jl,i:t}})}var r=Ar,a=zr,i=r,o=a,l=$u;return e?t(e):(t.links=function(e){return ra(n(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return ra(n(e)).cells.forEach(function(n,r){for(var a,i,o=n.site,l=n.edges.sort(Ur),u=-1,s=l.length,c=l[s-1].edge,d=c.l===o?c.r:c.l;++u<s;)a=c,i=d,c=l[u].edge,d=c.l===o?c.r:c.l,r<i.i&&r<d.i&&ia(o,i,d)<0&&t.push([e[r],e[i.i],e[d.i]])}),t},t.x=function(e){return arguments.length?(i=kt(r=e),t):r},t.y=function(e){return arguments.length?(o=kt(a=e),t):a},t.clipExtent=function(e){return arguments.length?(l=null==e?$u:e,t):l===$u?null:l},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):l===$u?null:l&&l[1]},t)};var $u=[[-1e6,-1e6],[1e6,1e6]];Xo.geom.delaunay=function(e){return Xo.geom.voronoi().triangles(e)},Xo.geom.quadtree=function(e,t,n,r,a){function i(e){function i(e,t,n,r,a,i,o,l){if(!isNaN(n)&&!isNaN(r))if(e.leaf){var u=e.x,c=e.y;if(null!=u)if(ol(u-n)+ol(c-r)<.01)s(e,t,n,r,a,i,o,l);else{var d=e.point;e.x=e.y=e.point=null,s(e,d,u,c,a,i,o,l),s(e,t,n,r,a,i,o,l)}else e.x=n,e.y=r,e.point=t}else s(e,t,n,r,a,i,o,l)}function s(e,t,n,r,a,o,l,u){var s=.5*(a+l),c=.5*(o+u),d=n>=s,f=r>=c,p=(f<<1)+d;e.leaf=!1,e=e.nodes[p]||(e.nodes[p]=ua()),d?a=s:l=s,f?o=c:u=c,i(e,t,n,r,a,o,l,u)}var c,d,f,p,h,g,v,m,y,x=kt(l),b=kt(u);if(null!=t)g=t,v=n,m=r,y=a;else if(m=y=-(g=v=1/0),d=[],f=[],h=e.length,o)for(p=0;h>p;++p)c=e[p],c.x<g&&(g=c.x),c.y<v&&(v=c.y),c.x>m&&(m=c.x),c.y>y&&(y=c.y),d.push(c.x),f.push(c.y);else for(p=0;h>p;++p){var w=+x(c=e[p],p),_=+b(c,p);g>w&&(g=w),v>_&&(v=_),w>m&&(m=w),_>y&&(y=_),d.push(w),f.push(_)}var k=m-g,M=y-v;k>M?y=v+k:m=g+M;var A=ua();if(A.add=function(e){i(A,e,+x(e,++p),+b(e,p),g,v,m,y)},A.visit=function(e){sa(e,A,g,v,m,y)},p=-1,null==t){for(;++p<h;)i(A,e[p],d[p],f[p],g,v,m,y);--p}else e.forEach(A.add);return d=f=e=c=null,A}var o,l=Ar,u=zr;return(o=arguments.length)?(l=oa,u=la,3===o&&(a=n,r=t,n=t=0),i(e)):(i.x=function(e){return arguments.length?(l=e,i):l},i.y=function(e){return arguments.length?(u=e,i):u},i.extent=function(e){return arguments.length?(null==e?t=n=r=a=null:(t=+e[0][0],n=+e[0][1],r=+e[1][0],a=+e[1][1]),i):null==t?null:[[t,n],[r,a]]},i.size=function(e){return arguments.length?(null==e?t=n=r=a=null:(t=n=0,r=+e[0],a=+e[1]),i):null==t?null:[r-t,a-n]},i)},Xo.interpolateRgb=ca,Xo.interpolateObject=da,Xo.interpolateNumber=fa,Xo.interpolateString=pa;var Ku=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,es=new RegExp(Ku.source,"g");Xo.interpolate=ha,Xo.interpolators=[function(e,t){var n=typeof t;return("string"===n?Yl.has(t)||/^(#|rgb\(|hsl\()/.test(t)?ca:pa:t instanceof rt?ca:Array.isArray(t)?ga:"object"===n&&isNaN(t)?da:fa)(e,t)
}],Xo.interpolateArray=ga;var ts=function(){return Mt},ns=Xo.map({linear:ts,poly:_a,quad:function(){return xa},cubic:function(){return ba},sin:function(){return ka},exp:function(){return Ma},circle:function(){return Aa},elastic:za,back:ja,bounce:function(){return Ea}}),rs=Xo.map({"in":Mt,out:ma,"in-out":ya,"out-in":function(e){return ya(ma(e))}});Xo.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=ns.get(n)||ts,r=rs.get(r)||Mt,va(r(n.apply(null,Go.call(arguments,1))))},Xo.interpolateHcl=Sa,Xo.interpolateHsl=Ta,Xo.interpolateLab=Na,Xo.interpolateRound=Oa,Xo.transform=function(e){var t=Wo.createElementNS(Xo.ns.prefix.svg,"g");return(Xo.transform=function(e){if(null!=e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate()}return new Ca(n?n.matrix:as)})(e)},Ca.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var as={a:1,b:0,c:0,d:1,e:0,f:0};Xo.interpolateTransform=La,Xo.layout={},Xo.layout.bundle=function(){return function(e){for(var t=[],n=-1,r=e.length;++n<r;)t.push(Ba(e[n]));return t}},Xo.layout.chord=function(){function e(){var e,s,d,f,p,h={},g=[],v=Xo.range(i),m=[];for(n=[],r=[],e=0,f=-1;++f<i;){for(s=0,p=-1;++p<i;)s+=a[f][p];g.push(s),m.push(Xo.range(i)),e+=s}for(o&&v.sort(function(e,t){return o(g[e],g[t])}),l&&m.forEach(function(e,t){e.sort(function(e,n){return l(a[t][e],a[t][n])})}),e=(Al-c*i)/e,s=0,f=-1;++f<i;){for(d=s,p=-1;++p<i;){var y=v[f],x=m[y][p],b=a[y][x],w=s,_=s+=b*e;h[y+"-"+x]={index:y,subindex:x,startAngle:w,endAngle:_,value:b}}r[y]={index:y,startAngle:d,endAngle:s,value:(s-d)/e},s+=c}for(f=-1;++f<i;)for(p=f-1;++p<i;){var k=h[f+"-"+p],M=h[p+"-"+f];(k.value||M.value)&&n.push(k.value<M.value?{source:M,target:k}:{source:k,target:M})}u&&t()}function t(){n.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n,r,a,i,o,l,u,s={},c=0;return s.matrix=function(e){return arguments.length?(i=(a=e)&&a.length,n=r=null,s):a},s.padding=function(e){return arguments.length?(c=e,n=r=null,s):c},s.sortGroups=function(e){return arguments.length?(o=e,n=r=null,s):o},s.sortSubgroups=function(e){return arguments.length?(l=e,n=null,s):l},s.sortChords=function(e){return arguments.length?(u=e,n&&t(),s):u},s.chords=function(){return n||e(),n},s.groups=function(){return r||e(),r},s},Xo.layout.force=function(){function e(e){return function(t,n,r,a){if(t.point!==e){var i=t.cx-e.x,o=t.cy-e.y,l=a-n,u=i*i+o*o;if(u>l*l/v){if(h>u){var s=t.charge/u;e.px-=i*s,e.py-=o*s}return!0}if(t.point&&u&&h>u){var s=t.pointCharge/u;e.px-=i*s,e.py-=o*s}}return!t.charge}}function t(e){e.px=Xo.event.x,e.py=Xo.event.y,l.resume()}var n,r,a,i,o,l={},u=Xo.dispatch("start","tick","end"),s=[1,1],c=.9,d=is,f=os,p=-30,h=ls,g=.1,v=.64,m=[],y=[];return l.tick=function(){if((r*=.99)<.005)return u.end({type:"end",alpha:r=0}),!0;var t,n,l,d,f,h,v,x,b,w=m.length,_=y.length;for(n=0;_>n;++n)l=y[n],d=l.source,f=l.target,x=f.x-d.x,b=f.y-d.y,(h=x*x+b*b)&&(h=r*i[n]*((h=Math.sqrt(h))-a[n])/h,x*=h,b*=h,f.x-=x*(v=d.weight/(f.weight+d.weight)),f.y-=b*v,d.x+=x*(v=1-v),d.y+=b*v);if((v=r*g)&&(x=s[0]/2,b=s[1]/2,n=-1,v))for(;++n<w;)l=m[n],l.x+=(x-l.x)*v,l.y+=(b-l.y)*v;if(p)for(Ga(t=Xo.geom.quadtree(m),r,o),n=-1;++n<w;)(l=m[n]).fixed||t.visit(e(l));for(n=-1;++n<w;)l=m[n],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*c,l.y-=(l.py-(l.py=l.y))*c);u.tick({type:"tick",alpha:r})},l.nodes=function(e){return arguments.length?(m=e,l):m},l.links=function(e){return arguments.length?(y=e,l):y},l.size=function(e){return arguments.length?(s=e,l):s},l.linkDistance=function(e){return arguments.length?(d="function"==typeof e?e:+e,l):d},l.distance=l.linkDistance,l.linkStrength=function(e){return arguments.length?(f="function"==typeof e?e:+e,l):f},l.friction=function(e){return arguments.length?(c=+e,l):c},l.charge=function(e){return arguments.length?(p="function"==typeof e?e:+e,l):p},l.chargeDistance=function(e){return arguments.length?(h=e*e,l):Math.sqrt(h)},l.gravity=function(e){return arguments.length?(g=+e,l):g},l.theta=function(e){return arguments.length?(v=e*e,l):Math.sqrt(v)},l.alpha=function(e){return arguments.length?(e=+e,r?r=e>0?e:0:e>0&&(u.start({type:"start",alpha:r=e}),Xo.timer(l.tick)),l):r},l.start=function(){function e(e,r){if(!n){for(n=new Array(u),l=0;u>l;++l)n[l]=[];for(l=0;s>l;++l){var a=y[l];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}for(var i,o=n[t],l=-1,s=o.length;++l<s;)if(!isNaN(i=o[l][e]))return i;return Math.random()*r}var t,n,r,u=m.length,c=y.length,h=s[0],g=s[1];for(t=0;u>t;++t)(r=m[t]).index=t,r.weight=0;for(t=0;c>t;++t)r=y[t],"number"==typeof r.source&&(r.source=m[r.source]),"number"==typeof r.target&&(r.target=m[r.target]),++r.source.weight,++r.target.weight;for(t=0;u>t;++t)r=m[t],isNaN(r.x)&&(r.x=e("x",h)),isNaN(r.y)&&(r.y=e("y",g)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(a=[],"function"==typeof d)for(t=0;c>t;++t)a[t]=+d.call(this,y[t],t);else for(t=0;c>t;++t)a[t]=d;if(i=[],"function"==typeof f)for(t=0;c>t;++t)i[t]=+f.call(this,y[t],t);else for(t=0;c>t;++t)i[t]=f;if(o=[],"function"==typeof p)for(t=0;u>t;++t)o[t]=+p.call(this,m[t],t);else for(t=0;u>t;++t)o[t]=p;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return n||(n=Xo.behavior.drag().origin(Mt).on("dragstart.force",Ra).on("drag.force",t).on("dragend.force",Ha)),arguments.length?void this.on("mouseover.force",Ya).on("mouseout.force",Xa).call(n):n},Xo.rebind(l,u,"on")};var is=20,os=1,ls=1/0;Xo.layout.hierarchy=function(){function e(a){var i,o=[a],l=[];for(a.depth=0;null!=(i=o.pop());)if(l.push(i),(s=n.call(e,i,i.depth))&&(u=s.length)){for(var u,s,c;--u>=0;)o.push(c=s[u]),c.parent=i,c.depth=i.depth+1;r&&(i.value=0),i.children=s}else r&&(i.value=+r.call(e,i,i.depth)||0),delete i.children;return Ja(a,function(e){var n,a;t&&(n=e.children)&&n.sort(t),r&&(a=e.parent)&&(a.value+=e.value)}),l}var t=Ka,n=Qa,r=$a;return e.sort=function(n){return arguments.length?(t=n,e):t},e.children=function(t){return arguments.length?(n=t,e):n},e.value=function(t){return arguments.length?(r=t,e):r},e.revalue=function(t){return r&&(Wa(t,function(e){e.children&&(e.value=0)}),Ja(t,function(t){var n;t.children||(t.value=+r.call(e,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)})),t},e},Xo.layout.partition=function(){function e(t,n,r,a){var i=t.children;if(t.x=n,t.y=t.depth*a,t.dx=r,t.dy=a,i&&(o=i.length)){var o,l,u,s=-1;for(r=t.value?r/t.value:0;++s<o;)e(l=i[s],n,u=l.value*r,a),n+=u}}function t(e){var n=e.children,r=0;if(n&&(a=n.length))for(var a,i=-1;++i<a;)r=Math.max(r,t(n[i]));return 1+r}function n(n,i){var o=r.call(this,n,i);return e(o[0],0,a[0],a[1]/t(o[0])),o}var r=Xo.layout.hierarchy(),a=[1,1];return n.size=function(e){return arguments.length?(a=e,n):a},Za(n,r)},Xo.layout.pie=function(){function e(i){var o=i.map(function(n,r){return+t.call(e,n,r)}),l=+("function"==typeof r?r.apply(this,arguments):r),u=(("function"==typeof a?a.apply(this,arguments):a)-l)/Xo.sum(o),s=Xo.range(i.length);null!=n&&s.sort(n===us?function(e,t){return o[t]-o[e]}:function(e,t){return n(i[e],i[t])});var c=[];return s.forEach(function(e){var t;c[e]={data:i[e],value:t=o[e],startAngle:l,endAngle:l+=t*u}}),c}var t=Number,n=us,r=0,a=Al;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(a=t,e):a},e};var us={};Xo.layout.stack=function(){function e(l,u){var s=l.map(function(n,r){return t.call(e,n,r)}),c=s.map(function(t){return t.map(function(t,n){return[i.call(e,t,n),o.call(e,t,n)]})}),d=n.call(e,c,u);s=Xo.permute(s,d),c=Xo.permute(c,d);var f,p,h,g=r.call(e,c,u),v=s.length,m=s[0].length;for(p=0;m>p;++p)for(a.call(e,s[0][p],h=g[p],c[0][p][1]),f=1;v>f;++f)a.call(e,s[f][p],h+=c[f-1][p][1],c[f][p][1]);return l}var t=Mt,n=ai,r=ii,a=ri,i=ti,o=ni;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n="function"==typeof t?t:ss.get(t)||ai,e):n},e.offset=function(t){return arguments.length?(r="function"==typeof t?t:cs.get(t)||ii,e):r},e.x=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(o=t,e):o},e.out=function(t){return arguments.length?(a=t,e):a},e};var ss=Xo.map({"inside-out":function(e){var t,n,r=e.length,a=e.map(oi),i=e.map(li),o=Xo.range(r).sort(function(e,t){return a[e]-a[t]}),l=0,u=0,s=[],c=[];for(t=0;r>t;++t)n=o[t],u>l?(l+=i[n],s.push(n)):(u+=i[n],c.push(n));return c.reverse().concat(s)},reverse:function(e){return Xo.range(e.length).reverse()},"default":ai}),cs=Xo.map({silhouette:function(e){var t,n,r,a=e.length,i=e[0].length,o=[],l=0,u=[];for(n=0;i>n;++n){for(t=0,r=0;a>t;t++)r+=e[t][n][1];r>l&&(l=r),o.push(r)}for(n=0;i>n;++n)u[n]=(l-o[n])/2;return u},wiggle:function(e){var t,n,r,a,i,o,l,u,s,c=e.length,d=e[0],f=d.length,p=[];for(p[0]=u=s=0,n=1;f>n;++n){for(t=0,a=0;c>t;++t)a+=e[t][n][1];for(t=0,i=0,l=d[n][0]-d[n-1][0];c>t;++t){for(r=0,o=(e[t][n][1]-e[t][n-1][1])/(2*l);t>r;++r)o+=(e[r][n][1]-e[r][n-1][1])/l;i+=o*e[t][n][1]}p[n]=u-=a?i/a*l:0,s>u&&(s=u)}for(n=0;f>n;++n)p[n]-=s;return p},expand:function(e){var t,n,r,a=e.length,i=e[0].length,o=1/a,l=[];for(n=0;i>n;++n){for(t=0,r=0;a>t;t++)r+=e[t][n][1];if(r)for(t=0;a>t;t++)e[t][n][1]/=r;else for(t=0;a>t;t++)e[t][n][1]=o}for(n=0;i>n;++n)l[n]=0;return l},zero:ii});Xo.layout.histogram=function(){function e(e,i){for(var o,l,u=[],s=e.map(n,this),c=r.call(this,s,i),d=a.call(this,c,s,i),i=-1,f=s.length,p=d.length-1,h=t?1:1/f;++i<p;)o=u[i]=[],o.dx=d[i+1]-(o.x=d[i]),o.y=0;if(p>0)for(i=-1;++i<f;)l=s[i],l>=c[0]&&l<=c[1]&&(o=u[Xo.bisect(d,l,1,p)-1],o.y+=h,o.push(e[i]));return u}var t=!0,n=Number,r=di,a=si;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=kt(t),e):r},e.bins=function(t){return arguments.length?(a="number"==typeof t?function(e){return ci(e,t)}:kt(t),e):a},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},Xo.layout.pack=function(){function e(e,i){var o=n.call(this,e,i),l=o[0],u=a[0],s=a[1],c=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(l.x=l.y=0,Ja(l,function(e){e.r=+c(e.value)}),Ja(l,vi),r){var d=r*(t?1:Math.max(2*l.r/u,2*l.r/s))/2;Ja(l,function(e){e.r+=d}),Ja(l,vi),Ja(l,function(e){e.r-=d})}return xi(l,u/2,s/2,t?1:1/Math.max(2*l.r/u,2*l.r/s)),o}var t,n=Xo.layout.hierarchy().sort(fi),r=0,a=[1,1];return e.size=function(t){return arguments.length?(a=t,e):a},e.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,e):t},e.padding=function(t){return arguments.length?(r=+t,e):r},Za(e,n)},Xo.layout.tree=function(){function e(e,a){var c=o.call(this,e,a),d=c[0],f=t(d);if(Ja(f,n),f.parent.m=-f.z,Wa(f,r),s)Wa(d,i);else{var p=d,h=d,g=d;Wa(d,function(e){e.x<p.x&&(p=e),e.x>h.x&&(h=e),e.depth>g.depth&&(g=e)});var v=l(p,h)/2-p.x,m=u[0]/(h.x+l(h,p)/2+v),y=u[1]/(g.depth||1);Wa(d,function(e){e.x=(e.x+v)*m,e.y=e.depth*y})}return c}function t(e){for(var t,n={A:null,children:[e]},r=[n];null!=(t=r.pop());)for(var a,i=t.children,o=0,l=i.length;l>o;++o)r.push((i[o]=a={_:i[o],parent:t,children:(a=i[o].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=a);return n.children[0]}function n(e){var t=e.children,n=e.parent.children,r=e.i?n[e.i-1]:null;if(t.length){Ai(e);var i=(t[0].z+t[t.length-1].z)/2;r?(e.z=r.z+l(e._,r._),e.m=e.z-i):e.z=i}else r&&(e.z=r.z+l(e._,r._));e.parent.A=a(e,r,e.parent.A||n[0])}function r(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function a(e,t,n){if(t){for(var r,a=e,i=e,o=t,u=a.parent.children[0],s=a.m,c=i.m,d=o.m,f=u.m;o=ki(o),a=_i(a),o&&a;)u=_i(u),i=ki(i),i.a=e,r=o.z+d-a.z-s+l(o._,a._),r>0&&(Mi(zi(o,e,n),e,r),s+=r,c+=r),d+=o.m,s+=a.m,f+=u.m,c+=i.m;o&&!ki(i)&&(i.t=o,i.m+=d-c),a&&!_i(u)&&(u.t=a,u.m+=s-f,n=e)}return n}function i(e){e.x*=u[0],e.y=e.depth*u[1]}var o=Xo.layout.hierarchy().sort(null).value(null),l=wi,u=[1,1],s=null;return e.separation=function(t){return arguments.length?(l=t,e):l},e.size=function(t){return arguments.length?(s=null==(u=t)?i:null,e):s?null:u},e.nodeSize=function(t){return arguments.length?(s=null==(u=t)?null:i,e):s?u:null},Za(e,o)},Xo.layout.cluster=function(){function e(e,i){var o,l=t.call(this,e,i),u=l[0],s=0;Ja(u,function(e){var t=e.children;t&&t.length?(e.x=Ei(t),e.y=ji(t)):(e.x=o?s+=n(e,o):0,e.y=0,o=e)});var c=Si(u),d=Ti(u),f=c.x-n(c,d)/2,p=d.x+n(d,c)/2;return Ja(u,a?function(e){e.x=(e.x-u.x)*r[0],e.y=(u.y-e.y)*r[1]}:function(e){e.x=(e.x-f)/(p-f)*r[0],e.y=(1-(u.y?e.y/u.y:1))*r[1]}),l}var t=Xo.layout.hierarchy().sort(null).value(null),n=wi,r=[1,1],a=!1;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(a=null==(r=t),e):a?null:r},e.nodeSize=function(t){return arguments.length?(a=null!=(r=t),e):a?r:null},Za(e,t)},Xo.layout.treemap=function(){function e(e,t){for(var n,r,a=-1,i=e.length;++a<i;)r=(n=e[a]).value*(0>t?0:t),n.area=isNaN(r)||0>=r?0:r}function t(n){var i=n.children;if(i&&i.length){var o,l,u,s=d(n),c=[],f=i.slice(),h=1/0,g="slice"===p?s.dx:"dice"===p?s.dy:"slice-dice"===p?1&n.depth?s.dy:s.dx:Math.min(s.dx,s.dy);for(e(f,s.dx*s.dy/n.value),c.area=0;(u=f.length)>0;)c.push(o=f[u-1]),c.area+=o.area,"squarify"!==p||(l=r(c,g))<=h?(f.pop(),h=l):(c.area-=c.pop().area,a(c,g,s,!1),g=Math.min(s.dx,s.dy),c.length=c.area=0,h=1/0);c.length&&(a(c,g,s,!0),c.length=c.area=0),i.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var i,o=d(t),l=r.slice(),u=[];for(e(l,o.dx*o.dy/t.value),u.area=0;i=l.pop();)u.push(i),u.area+=i.area,null!=i.z&&(a(u,i.z?o.dx:o.dy,o,!l.length),u.length=u.area=0);r.forEach(n)}}function r(e,t){for(var n,r=e.area,a=0,i=1/0,o=-1,l=e.length;++o<l;)(n=e[o].area)&&(i>n&&(i=n),n>a&&(a=n));return r*=r,t*=t,r?Math.max(t*a*h/r,r/(t*i*h)):1/0}function a(e,t,n,r){var a,i=-1,o=e.length,l=n.x,s=n.y,c=t?u(e.area/t):0;if(t==n.dx){for((r||c>n.dy)&&(c=n.dy);++i<o;)a=e[i],a.x=l,a.y=s,a.dy=c,l+=a.dx=Math.min(n.x+n.dx-l,c?u(a.area/c):0);a.z=!0,a.dx+=n.x+n.dx-l,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++i<o;)a=e[i],a.x=l,a.y=s,a.dx=c,s+=a.dy=Math.min(n.y+n.dy-s,c?u(a.area/c):0);a.z=!1,a.dy+=n.y+n.dy-s,n.x+=c,n.dx-=c}}function i(r){var a=o||l(r),i=a[0];return i.x=0,i.y=0,i.dx=s[0],i.dy=s[1],o&&l.revalue(i),e([i],i.dx*i.dy/i.value),(o?n:t)(i),f&&(o=a),a}var o,l=Xo.layout.hierarchy(),u=Math.round,s=[1,1],c=null,d=Ni,f=!1,p="squarify",h=.5*(1+Math.sqrt(5));return i.size=function(e){return arguments.length?(s=e,i):s},i.padding=function(e){function t(t){var n=e.call(i,t,t.depth);return null==n?Ni(t):Oi(t,"number"==typeof n?[n,n,n,n]:n)}function n(t){return Oi(t,e)}if(!arguments.length)return c;var r;return d=null==(c=e)?Ni:"function"==(r=typeof e)?t:"number"===r?(e=[e,e,e,e],n):n,i},i.round=function(e){return arguments.length?(u=e?Math.round:Number,i):u!=Number},i.sticky=function(e){return arguments.length?(f=e,o=null,i):f},i.ratio=function(e){return arguments.length?(h=e,i):h},i.mode=function(e){return arguments.length?(p=e+"",i):p},Za(i,l)},Xo.random={normal:function(e,t){var n=arguments.length;return 2>n&&(t=1),1>n&&(e=0),function(){var n,r,a;do n=2*Math.random()-1,r=2*Math.random()-1,a=n*n+r*r;while(!a||a>1);return e+t*n*Math.sqrt(-2*Math.log(a)/a)}},logNormal:function(){var e=Xo.random.normal.apply(Xo,arguments);return function(){return Math.exp(e())}},bates:function(e){var t=Xo.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,n=0;e>n;n++)t+=Math.random();return t}}},Xo.scale={};var ds={floor:Mt,ceil:Mt};Xo.scale.linear=function(){return Vi([0,1],[0,1],ha,!1)};var fs={s:1,g:1,p:1,r:1,e:1};Xo.scale.log=function(){return Gi(Xo.scale.linear().domain([0,1]),10,!0,[1,10])};var ps=Xo.format(".0e"),hs={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};Xo.scale.pow=function(){return Zi(Xo.scale.linear(),1,[0,1])},Xo.scale.sqrt=function(){return Xo.scale.pow().exponent(.5)},Xo.scale.ordinal=function(){return Ji([],{t:"range",a:[[]]})},Xo.scale.category10=function(){return Xo.scale.ordinal().range(gs)},Xo.scale.category20=function(){return Xo.scale.ordinal().range(vs)},Xo.scale.category20b=function(){return Xo.scale.ordinal().range(ms)},Xo.scale.category20c=function(){return Xo.scale.ordinal().range(ys)};var gs=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(vt),vs=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(vt),ms=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(vt),ys=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(vt);Xo.scale.quantile=function(){return Qi([],[])},Xo.scale.quantize=function(){return $i(0,1,[0,1])},Xo.scale.threshold=function(){return Ki([.5],[0,1])},Xo.scale.identity=function(){return eo([0,1])},Xo.svg={},Xo.svg.arc=function(){function e(){var e=t.apply(this,arguments),i=n.apply(this,arguments),o=r.apply(this,arguments)+xs,l=a.apply(this,arguments)+xs,u=(o>l&&(u=o,o=l,l=u),l-o),s=Ml>u?"0":"1",c=Math.cos(o),d=Math.sin(o),f=Math.cos(l),p=Math.sin(l);return u>=bs?e?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+-e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":e?"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+s+",1 "+i*f+","+i*p+"L"+e*f+","+e*p+"A"+e+","+e+" 0 "+s+",0 "+e*c+","+e*d+"Z":"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+s+",1 "+i*f+","+i*p+"L0,0Z"}var t=to,n=no,r=ro,a=ao;return e.innerRadius=function(n){return arguments.length?(t=kt(n),e):t},e.outerRadius=function(t){return arguments.length?(n=kt(t),e):n},e.startAngle=function(t){return arguments.length?(r=kt(t),e):r},e.endAngle=function(t){return arguments.length?(a=kt(t),e):a},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,i=(r.apply(this,arguments)+a.apply(this,arguments))/2+xs;return[Math.cos(i)*e,Math.sin(i)*e]},e};var xs=-zl,bs=Al-jl;Xo.svg.line=function(){return io(Mt)};var ws=Xo.map({linear:oo,"linear-closed":lo,step:uo,"step-before":so,"step-after":co,basis:mo,"basis-open":yo,"basis-closed":xo,bundle:bo,cardinal:ho,"cardinal-open":fo,"cardinal-closed":po,monotone:zo});ws.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var _s=[0,2/3,1/3,0],ks=[0,1/3,2/3,0],Ms=[0,1/6,2/3,1/6];Xo.svg.line.radial=function(){var e=io(jo);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},so.reverse=co,co.reverse=so,Xo.svg.area=function(){return Eo(Mt)},Xo.svg.area.radial=function(){var e=Eo(jo);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},Xo.svg.chord=function(){function e(e,l){var u=t(this,i,e,l),s=t(this,o,e,l);return"M"+u.p0+r(u.r,u.p1,u.a1-u.a0)+(n(u,s)?a(u.r,u.p1,u.r,u.p0):a(u.r,u.p1,s.r,s.p0)+r(s.r,s.p1,s.a1-s.a0)+a(s.r,s.p1,u.r,u.p0))+"Z"}function t(e,t,n,r){var a=t.call(e,n,r),i=l.call(e,a,r),o=u.call(e,a,r)+xs,c=s.call(e,a,r)+xs;return{r:i,a0:o,a1:c,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(c),i*Math.sin(c)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,n){return"A"+e+","+e+" 0 "+ +(n>Ml)+",1 "+t}function a(e,t,n,r){return"Q 0,0 "+r}var i=gr,o=vr,l=So,u=ro,s=ao;return e.radius=function(t){return arguments.length?(l=kt(t),e):l},e.source=function(t){return arguments.length?(i=kt(t),e):i},e.target=function(t){return arguments.length?(o=kt(t),e):o},e.startAngle=function(t){return arguments.length?(u=kt(t),e):u},e.endAngle=function(t){return arguments.length?(s=kt(t),e):s},e},Xo.svg.diagonal=function(){function e(e,a){var i=t.call(this,e,a),o=n.call(this,e,a),l=(i.y+o.y)/2,u=[i,{x:i.x,y:l},{x:o.x,y:l},o];return u=u.map(r),"M"+u[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var t=gr,n=vr,r=To;return e.source=function(n){return arguments.length?(t=kt(n),e):t},e.target=function(t){return arguments.length?(n=kt(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},Xo.svg.diagonal.radial=function(){var e=Xo.svg.diagonal(),t=To,n=e.projection;return e.projection=function(e){return arguments.length?n(No(t=e)):t},e},Xo.svg.symbol=function(){function e(e,r){return(As.get(t.call(this,e,r))||Fo)(n.call(this,e,r))}var t=Co,n=Oo;return e.type=function(n){return arguments.length?(t=kt(n),e):t},e.size=function(t){return arguments.length?(n=kt(t),e):n},e};var As=Xo.map({circle:Fo,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Ss)),n=t*Ss;return"M0,"+-t+"L"+n+",0 0,"+t+" "+-n+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Es),n=t*Es/2;return"M0,"+n+"L"+t+","+-n+" "+-t+","+-n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Es),n=t*Es/2;return"M0,"+-n+"L"+t+","+n+" "+-t+","+n+"Z"}});Xo.svg.symbolTypes=As.keys();var zs,js,Es=Math.sqrt(3),Ss=Math.tan(30*Sl),Ts=[],Ns=0;Ts.call=vl.call,Ts.empty=vl.empty,Ts.node=vl.node,Ts.size=vl.size,Xo.transition=function(e){return arguments.length?zs?e.transition():e:xl.transition()},Xo.transition.prototype=Ts,Ts.select=function(e){var t,n,r,a=this.id,i=[];e=k(e);for(var o=-1,l=this.length;++o<l;){i.push(t=[]);for(var u=this[o],s=-1,c=u.length;++s<c;)(r=u[s])&&(n=e.call(r,r.__data__,s,o))?("__data__"in r&&(n.__data__=r.__data__),Io(n,s,a,r.__transition__[a]),t.push(n)):t.push(null)}return qo(i,a)},Ts.selectAll=function(e){var t,n,r,a,i,o=this.id,l=[];e=M(e);for(var u=-1,s=this.length;++u<s;)for(var c=this[u],d=-1,f=c.length;++d<f;)if(r=c[d]){i=r.__transition__[o],n=e.call(r,r.__data__,d,u),l.push(t=[]);for(var p=-1,h=n.length;++p<h;)(a=n[p])&&Io(a,p,o,i),t.push(a)}return qo(l,o)},Ts.filter=function(e){var t,n,r,a=[];"function"!=typeof e&&(e=q(e));for(var i=0,o=this.length;o>i;i++){a.push(t=[]);for(var n=this[i],l=0,u=n.length;u>l;l++)(r=n[l])&&e.call(r,r.__data__,l,i)&&t.push(r)}return qo(a,this.id)},Ts.tween=function(e,t){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(e):L(this,null==t?function(t){t.__transition__[n].tween.remove(e)}:function(r){r.__transition__[n].tween.set(e,t)})},Ts.attr=function(e,t){function n(){this.removeAttribute(l)}function r(){this.removeAttributeNS(l.space,l.local)}function a(e){return null==e?n:(e+="",function(){var t,n=this.getAttribute(l);return n!==e&&(t=o(n,e),function(e){this.setAttribute(l,t(e))})})}function i(e){return null==e?r:(e+="",function(){var t,n=this.getAttributeNS(l.space,l.local);return n!==e&&(t=o(n,e),function(e){this.setAttributeNS(l.space,l.local,t(e))})})}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var o="transform"==e?La:ha,l=Xo.ns.qualify(e);return Po(this,"attr."+e,t,l.local?i:a)},Ts.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(a));return r&&function(e){this.setAttribute(a,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(a.space,a.local));return r&&function(e){this.setAttributeNS(a.space,a.local,r(e))}}var a=Xo.ns.qualify(e);return this.tween("attr."+e,a.local?r:n)},Ts.style=function(e,t,n){function r(){this.style.removeProperty(e)}function a(t){return null==t?r:(t+="",function(){var r,a=Qo.getComputedStyle(this,null).getPropertyValue(e);return a!==t&&(r=ha(a,t),function(t){this.style.setProperty(e,r(t),n)})})}var i=arguments.length;if(3>i){if("string"!=typeof e){2>i&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}return Po(this,"style."+e,t,a)},Ts.styleTween=function(e,t,n){function r(r,a){var i=t.call(this,r,a,Qo.getComputedStyle(this,null).getPropertyValue(e));return i&&function(t){this.style.setProperty(e,i(t),n)}}return arguments.length<3&&(n=""),this.tween("style."+e,r)},Ts.text=function(e){return Po(this,"text",e,Lo)},Ts.remove=function(){return this.each("end.transition",function(){var e;this.__transition__.count<2&&(e=this.parentNode)&&e.removeChild(this)})},Ts.ease=function(e){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:("function"!=typeof e&&(e=Xo.ease.apply(Xo,arguments)),L(this,function(n){n.__transition__[t].ease=e}))},Ts.delay=function(e){var t=this.id;return arguments.length<1?this.node().__transition__[t].delay:L(this,"function"==typeof e?function(n,r,a){n.__transition__[t].delay=+e.call(n,n.__data__,r,a)}:(e=+e,function(n){n.__transition__[t].delay=e}))},Ts.duration=function(e){var t=this.id;return arguments.length<1?this.node().__transition__[t].duration:L(this,"function"==typeof e?function(n,r,a){n.__transition__[t].duration=Math.max(1,e.call(n,n.__data__,r,a))}:(e=Math.max(1,e),function(n){n.__transition__[t].duration=e}))},Ts.each=function(e,t){var n=this.id;if(arguments.length<2){var r=js,a=zs;zs=n,L(this,function(t,r,a){js=t.__transition__[n],e.call(t,t.__data__,r,a)}),js=r,zs=a}else L(this,function(r){var a=r.__transition__[n];(a.event||(a.event=Xo.dispatch("start","end"))).on(e,t)});return this},Ts.transition=function(){for(var e,t,n,r,a=this.id,i=++Ns,o=[],l=0,u=this.length;u>l;l++){o.push(e=[]);for(var t=this[l],s=0,c=t.length;c>s;s++)(n=t[s])&&(r=Object.create(n.__transition__[a]),r.delay+=r.duration,Io(n,s,i,r)),e.push(n)}return qo(o,i)},Xo.svg.axis=function(){function e(e){e.each(function(){var e,s=Xo.select(this),c=this.__chart__||n,d=this.__chart__=n.copy(),f=null==u?d.ticks?d.ticks.apply(d,l):d.domain():u,p=null==t?d.tickFormat?d.tickFormat.apply(d,l):Mt:t,h=s.selectAll(".tick").data(f,d),g=h.enter().insert("g",".domain").attr("class","tick").style("opacity",jl),v=Xo.transition(h.exit()).style("opacity",jl).remove(),m=Xo.transition(h.order()).style("opacity",1),y=Fi(d),x=s.selectAll(".domain").data([0]),b=(x.enter().append("path").attr("class","domain"),Xo.transition(x));g.append("line"),g.append("text");var w=g.select("line"),_=m.select("line"),k=h.select("text").text(p),M=g.select("text"),A=m.select("text");switch(r){case"bottom":e=Vo,w.attr("y2",a),M.attr("y",Math.max(a,0)+o),_.attr("x2",0).attr("y2",a),A.attr("x",0).attr("y",Math.max(a,0)+o),k.attr("dy",".71em").style("text-anchor","middle"),b.attr("d","M"+y[0]+","+i+"V0H"+y[1]+"V"+i);break;case"top":e=Vo,w.attr("y2",-a),M.attr("y",-(Math.max(a,0)+o)),_.attr("x2",0).attr("y2",-a),A.attr("x",0).attr("y",-(Math.max(a,0)+o)),k.attr("dy","0em").style("text-anchor","middle"),b.attr("d","M"+y[0]+","+-i+"V0H"+y[1]+"V"+-i);break;case"left":e=Bo,w.attr("x2",-a),M.attr("x",-(Math.max(a,0)+o)),_.attr("x2",-a).attr("y2",0),A.attr("x",-(Math.max(a,0)+o)).attr("y",0),k.attr("dy",".32em").style("text-anchor","end"),b.attr("d","M"+-i+","+y[0]+"H0V"+y[1]+"H"+-i);break;case"right":e=Bo,w.attr("x2",a),M.attr("x",Math.max(a,0)+o),_.attr("x2",a).attr("y2",0),A.attr("x",Math.max(a,0)+o).attr("y",0),k.attr("dy",".32em").style("text-anchor","start"),b.attr("d","M"+i+","+y[0]+"H0V"+y[1]+"H"+i)}if(d.rangeBand){var z=d,j=z.rangeBand()/2;c=d=function(e){return z(e)+j}}else c.rangeBand?c=d:v.call(e,d);g.call(e,c),m.call(e,d)})}var t,n=Xo.scale.linear(),r=Os,a=6,i=6,o=3,l=[10],u=null;return e.scale=function(t){return arguments.length?(n=t,e):n},e.orient=function(t){return arguments.length?(r=t in Cs?t+"":Os,e):r},e.ticks=function(){return arguments.length?(l=arguments,e):l},e.tickValues=function(t){return arguments.length?(u=t,e):u},e.tickFormat=function(n){return arguments.length?(t=n,e):t},e.tickSize=function(t){var n=arguments.length;return n?(a=+t,i=+arguments[n-1],e):a},e.innerTickSize=function(t){return arguments.length?(a=+t,e):a},e.outerTickSize=function(t){return arguments.length?(i=+t,e):i},e.tickPadding=function(t){return arguments.length?(o=+t,e):o},e.tickSubdivide=function(){return arguments.length&&e},e};var Os="bottom",Cs={top:1,right:1,bottom:1,left:1};Xo.svg.brush=function(){function e(i){i.each(function(){var i=Xo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",a).on("touchstart.brush",a),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var l=i.selectAll(".resize").data(h,Mt);l.exit().remove(),l.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Fs[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),l.style("display",e.empty()?"none":null);var c,d=Xo.transition(i),f=Xo.transition(o);u&&(c=Fi(u),f.attr("x",c[0]).attr("width",c[1]-c[0]),n(d)),s&&(c=Fi(s),f.attr("y",c[0]).attr("height",c[1]-c[0]),r(d)),t(d)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+c[+/e$/.test(e)]+","+d[+/^s/.test(e)]+")"})}function n(e){e.select(".extent").attr("x",c[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function r(e){e.select(".extent").attr("y",d[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function a(){function a(){32==Xo.event.keyCode&&(E||(y=null,T[0]-=c[1],T[1]-=d[1],E=2),x())}function h(){32==Xo.event.keyCode&&2==E&&(T[0]+=c[1],T[1]+=d[1],E=0,x())}function g(){var e=Xo.mouse(w),a=!1;b&&(e[0]+=b[0],e[1]+=b[1]),E||(Xo.event.altKey?(y||(y=[(c[0]+c[1])/2,(d[0]+d[1])/2]),T[0]=c[+(e[0]<y[0])],T[1]=d[+(e[1]<y[1])]):y=null),z&&v(e,u,0)&&(n(M),a=!0),j&&v(e,s,1)&&(r(M),a=!0),a&&(t(M),k({type:"brush",mode:E?"move":"resize"}))}function v(e,t,n){var r,a,l=Fi(t),u=l[0],s=l[1],h=T[n],g=n?d:c,v=g[1]-g[0];return E&&(u-=h,s-=v+h),r=(n?p:f)?Math.max(u,Math.min(s,e[n])):e[n],E?a=(r+=h)+v:(y&&(h=Math.max(u,Math.min(s,2*y[n]-r))),r>h?(a=r,r=h):a=h),g[0]!=r||g[1]!=a?(n?o=null:i=null,g[0]=r,g[1]=a,!0):void 0}function m(){g(),M.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),Xo.select("body").style("cursor",null),N.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),S(),k({type:"brushend"})}var y,b,w=this,_=Xo.select(Xo.event.target),k=l.of(w,arguments),M=Xo.select(w),A=_.datum(),z=!/^(n|s)$/.test(A)&&u,j=!/^(e|w)$/.test(A)&&s,E=_.classed("extent"),S=H(),T=Xo.mouse(w),N=Xo.select(Qo).on("keydown.brush",a).on("keyup.brush",h);if(Xo.event.changedTouches?N.on("touchmove.brush",g).on("touchend.brush",m):N.on("mousemove.brush",g).on("mouseup.brush",m),M.interrupt().selectAll("*").interrupt(),E)T[0]=c[0]-T[0],T[1]=d[0]-T[1];else if(A){var O=+/w$/.test(A),C=+/^n/.test(A);b=[c[1-O]-T[0],d[1-C]-T[1]],T[0]=c[O],T[1]=d[C]}else Xo.event.altKey&&(y=T.slice());M.style("pointer-events","none").selectAll(".resize").style("display",null),Xo.select("body").style("cursor",_.style("cursor")),k({type:"brushstart"}),g()}var i,o,l=w(e,"brushstart","brush","brushend"),u=null,s=null,c=[0,0],d=[0,0],f=!0,p=!0,h=qs[0];return e.event=function(e){e.each(function(){var e=l.of(this,arguments),t={x:c,y:d,i:i,j:o},n=this.__chart__||t;this.__chart__=t,zs?Xo.select(this).transition().each("start.brush",function(){i=n.i,o=n.j,c=n.x,d=n.y,e({type:"brushstart"})}).tween("brush:brush",function(){var n=ga(c,t.x),r=ga(d,t.y);return i=o=null,function(a){c=t.x=n(a),d=t.y=r(a),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=t.i,o=t.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(u=t,h=qs[!u<<1|!s],e):u
},e.y=function(t){return arguments.length?(s=t,h=qs[!u<<1|!s],e):s},e.clamp=function(t){return arguments.length?(u&&s?(f=!!t[0],p=!!t[1]):u?f=!!t:s&&(p=!!t),e):u&&s?[f,p]:u?f:s?p:null},e.extent=function(t){var n,r,a,l,f;return arguments.length?(u&&(n=t[0],r=t[1],s&&(n=n[0],r=r[0]),i=[n,r],u.invert&&(n=u(n),r=u(r)),n>r&&(f=n,n=r,r=f),(n!=c[0]||r!=c[1])&&(c=[n,r])),s&&(a=t[0],l=t[1],u&&(a=a[1],l=l[1]),o=[a,l],s.invert&&(a=s(a),l=s(l)),a>l&&(f=a,a=l,l=f),(a!=d[0]||l!=d[1])&&(d=[a,l])),e):(u&&(i?(n=i[0],r=i[1]):(n=c[0],r=c[1],u.invert&&(n=u.invert(n),r=u.invert(r)),n>r&&(f=n,n=r,r=f))),s&&(o?(a=o[0],l=o[1]):(a=d[0],l=d[1],s.invert&&(a=s.invert(a),l=s.invert(l)),a>l&&(f=a,a=l,l=f))),u&&s?[[n,a],[r,l]]:u?[n,r]:s&&[a,l])},e.clear=function(){return e.empty()||(c=[0,0],d=[0,0],i=o=null),e},e.empty=function(){return!!u&&c[0]==c[1]||!!s&&d[0]==d[1]},Xo.rebind(e,l,"on")};var Fs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qs=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ps=tu.format=lu.timeFormat,Ls=Ps.utc,Is=Ls("%Y-%m-%dT%H:%M:%S.%LZ");Ps.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Uo:Is,Uo.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},Uo.toString=Is.toString,tu.second=Pt(function(e){return new nu(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),tu.seconds=tu.second.range,tu.seconds.utc=tu.second.utc.range,tu.minute=Pt(function(e){return new nu(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),tu.minutes=tu.minute.range,tu.minutes.utc=tu.minute.utc.range,tu.hour=Pt(function(e){var t=e.getTimezoneOffset()/60;return new nu(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),tu.hours=tu.hour.range,tu.hours.utc=tu.hour.utc.range,tu.month=Pt(function(e){return e=tu.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),tu.months=tu.month.range,tu.months.utc=tu.month.utc.range;var Vs=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Bs=[[tu.second,1],[tu.second,5],[tu.second,15],[tu.second,30],[tu.minute,1],[tu.minute,5],[tu.minute,15],[tu.minute,30],[tu.hour,1],[tu.hour,3],[tu.hour,6],[tu.hour,12],[tu.day,1],[tu.day,2],[tu.week,1],[tu.month,1],[tu.month,3],[tu.year,1]],Us=Ps.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",An]]),Ds={range:function(e,t,n){return Xo.range(Math.ceil(e/n)*n,+t,n).map(Ro)},floor:Mt,ceil:Mt};Bs.year=tu.year,tu.scale=function(){return Do(Xo.scale.linear(),Bs,Us)};var Rs=Bs.map(function(e){return[e[0].utc,e[1]]}),Hs=Ls.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",An]]);Rs.year=tu.year.utc,tu.scale.utc=function(){return Do(Xo.scale.linear(),Rs,Hs)},Xo.text=At(function(e){return e.responseText}),Xo.json=function(e,t){return zt(e,"application/json",Ho,t)},Xo.html=function(e,t){return zt(e,"text/html",Yo,t)},Xo.xml=At(function(e){return e.responseXML}),"function"==typeof define&&define.amd?define(Xo):"object"==typeof t&&t.exports?t.exports=Xo:this.d3=Xo}()},{}],5:[function(e,t){t.exports=e("./lib/heap")},{"./lib/heap":6}],6:[function(e,t){(function(){var e,n,r,a,i,o,l,u,s,c,d,f,p,h,g;r=Math.floor,c=Math.min,n=function(e,t){return t>e?-1:e>t?1:0},s=function(e,t,a,i,o){var l;if(null==a&&(a=0),null==o&&(o=n),0>a)throw new Error("lo must be non-negative");for(null==i&&(i=e.length);i>a;)l=r((a+i)/2),o(t,e[l])<0?i=l:a=l+1;return[].splice.apply(e,[a,a-a].concat(t)),t},o=function(e,t,r){return null==r&&(r=n),e.push(t),h(e,0,e.length-1,r)},i=function(e,t){var r,a;return null==t&&(t=n),r=e.pop(),e.length?(a=e[0],e[0]=r,g(e,0,t)):a=r,a},u=function(e,t,r){var a;return null==r&&(r=n),a=e[0],e[0]=t,g(e,0,r),a},l=function(e,t,r){var a;return null==r&&(r=n),e.length&&r(e[0],t)<0&&(a=[e[0],t],t=a[0],e[0]=a[1],g(e,0,r)),t},a=function(e,t){var a,i,o,l,u,s;for(null==t&&(t=n),l=function(){s=[];for(var t=0,n=r(e.length/2);n>=0?n>t:t>n;n>=0?t++:t--)s.push(t);return s}.apply(this).reverse(),u=[],i=0,o=l.length;o>i;i++)a=l[i],u.push(g(e,a,t));return u},p=function(e,t,r){var a;return null==r&&(r=n),a=e.indexOf(t),-1!==a?(h(e,0,a,r),g(e,a,r)):void 0},d=function(e,t,r){var i,o,u,s,c;if(null==r&&(r=n),o=e.slice(0,t),!o.length)return o;for(a(o,r),c=e.slice(t),u=0,s=c.length;s>u;u++)i=c[u],l(o,i,r);return o.sort(r).reverse()},f=function(e,t,r){var o,l,u,d,f,p,h,g,v,m;if(null==r&&(r=n),10*t<=e.length){if(d=e.slice(0,t).sort(r),!d.length)return d;for(u=d[d.length-1],g=e.slice(t),f=0,h=g.length;h>f;f++)o=g[f],r(o,u)<0&&(s(d,o,0,null,r),d.pop(),u=d[d.length-1]);return d}for(a(e,r),m=[],l=p=0,v=c(t,e.length);v>=0?v>p:p>v;l=v>=0?++p:--p)m.push(i(e,r));return m},h=function(e,t,r,a){var i,o,l;for(null==a&&(a=n),i=e[r];r>t&&(l=r-1>>1,o=e[l],a(i,o)<0);)e[r]=o,r=l;return e[r]=i},g=function(e,t,r){var a,i,o,l,u;for(null==r&&(r=n),i=e.length,u=t,o=e[t],a=2*t+1;i>a;)l=a+1,i>l&&!(r(e[a],e[l])<0)&&(a=l),e[t]=e[a],t=a,a=2*t+1;return e[t]=o,h(e,u,t,r)},e=function(){function e(e){this.cmp=null!=e?e:n,this.nodes=[]}return e.push=o,e.pop=i,e.replace=u,e.pushpop=l,e.heapify=a,e.nlargest=d,e.nsmallest=f,e.prototype.push=function(e){return o(this.nodes,e,this.cmp)},e.prototype.pop=function(){return i(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return u(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return l(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return a(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return p(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),("undefined"!=typeof t&&null!==t?t.exports:void 0)?t.exports=e:window.Heap=e}).call(this)},{}],7:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var n,r,a,i;for("undefined"==typeof t&&(t=15),a=.5,n=new Date;;){for(a*=2,i=a;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;if(r=new Date,r-n>t)break}for(i=a;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;return r=new Date,1e3*(3*a-1)/(r-n)},numeric._myIndexOf=function(e){var t,n=this.length;for(t=0;n>t;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(0>e)return"-"+t(-e);if(isFinite(e)){var n=Math.floor(Math.log(e)/Math.log(10)),r=e/Math.pow(10,n),a=r.toPrecision(numeric.precision);return 10===parseFloat(a)&&(n++,r=1,a=r.toPrecision(numeric.precision)),parseFloat(a).toString()+"e"+n.toString()}return"Infinity"}function n(e){var a;if("undefined"==typeof e)return r.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return r.push('"'+e+'"'),!1;if("boolean"==typeof e)return r.push(e.toString()),!1;if("number"==typeof e){var i=t(e),o=e.toPrecision(numeric.precision),l=parseFloat(e.toString()).toString(),u=[i,o,l,parseFloat(o).toString(),parseFloat(l).toString()];for(a=1;a<u.length;a++)u[a].length<i.length&&(i=u[a]);return r.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===e)return r.push("null"),!1;if("function"==typeof e){r.push(e.toString());var s=!1;for(a in e)e.hasOwnProperty(a)&&(r.push(s?",\n":"\n{"),s=!0,r.push(a),r.push(": \n"),n(e[a]));return s&&r.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return r.push("...Large Array..."),!0;var s=!1;for(r.push("["),a=0;a<e.length;a++)a>0&&(r.push(","),s&&r.push("\n ")),s=n(e[a]);return r.push("]"),!0}r.push("{");var s=!1;for(a in e)e.hasOwnProperty(a)&&(s&&r.push(",\n"),s=!0,r.push(a),r.push(": \n"),n(e[a]));return r.push("}"),!0}var r=[];return n(e),r.join("")},numeric.parseDate=function(e){function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}return t(e)},numeric.parseFloat=function(e){function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}return t(e)},numeric.parseCSV=function(e){var t,n,r=e.split("\n"),a=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=function(e){return e.substr(0,e.length-1)},u=0;for(n=0;n<r.length;n++){var s,c=(r[n]+",").match(i);if(c.length>0){for(a[u]=[],t=0;t<c.length;t++)s=l(c[t]),a[u][t]=o.test(s)?parseFloat(s):s;u++}}return a},numeric.toCSV=function(e){var t,n,r,a,i,o,l=numeric.dim(e);for(r=l[0],a=l[1],o=[],t=0;r>t;t++){for(i=[],n=0;r>n;n++)i[n]=e[t][n].toString();o[t]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e){var t,n,r,a,i,o,l,u,s=e.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="";for(t=0;s>t;t+=3)n=e[t],r=e[t+1],a=e[t+2],i=n>>2,o=((3&n)<<4)+(r>>4),l=((15&r)<<2)+(a>>6),u=63&a,t+1>=s?l=u=64:t+2>=s&&(u=64),d+=c.charAt(i)+c.charAt(o)+c.charAt(l)+c.charAt(u);return d}function n(e,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=e.length);{var r,a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,o=0;e.length}for(r=t;n>r;r++)o=255&(i^e[r]),i=i>>>8^a[o];return-1^i}var r,a,i,o,l,u,s,c,d,f,p=e[0].length,h=e[0][0].length,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(f=n(g,12,29),g[29]=f>>24&255,g[30]=f>>16&255,g[31]=f>>8&255,g[32]=255&f,r=1,a=0,s=0;p>s;s++){for(g.push(p-1>s?0:1),l=3*h+1+(0===s)&255,u=3*h+1+(0===s)>>8&255,g.push(l),g.push(u),g.push(255&~l),g.push(255&~u),0===s&&g.push(0),c=0;h>c;c++)for(i=0;3>i;i++)l=e[i][s][c],l=l>255?255:0>l?0:Math.round(l),r=(r+l)%65521,a=(a+r)%65521,g.push(l);g.push(0)}return d=(a<<16)+r,g.push(d>>24&255),g.push(d>>16&255),g.push(d>>8&255),g.push(255&d),o=g.length-41,g[33]=o>>24&255,g[34]=o>>16&255,g[35]=o>>8&255,g[36]=255&o,f=n(g,37),g.push(f>>24&255),g.push(f>>16&255),g.push(f>>8&255),g.push(255&f),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+t(g)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t,n;return"object"==typeof e?(t=e[0],"object"==typeof t?(n=t[0],"object"==typeof n?numeric._dim(e):[e.length,t.length]):[e.length]):[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,n){var r,a;if(!(t instanceof Array&&n instanceof Array))return!1;if(a=t.length,a!==n.length)return!1;for(r=0;a>r;r++)if(t[r]!==n[r]){if("object"!=typeof t[r])return!1;if(!e(t[r],n[r]))return!1}return!0},numeric.rep=function(e,t,n){"undefined"==typeof n&&(n=0);var r,a=e[n],i=Array(a);if(n===e.length-1){for(r=a-2;r>=0;r-=2)i[r+1]=t,i[r]=t;return-1===r&&(i[0]=t),i}for(r=a-1;r>=0;r--)i[r]=numeric.rep(e,t,n+1);return i},numeric.dotMMsmall=function(e,t){var n,r,a,i,o,l,u,s,c,d,f;for(i=e.length,o=t.length,l=t[0].length,u=Array(i),n=i-1;n>=0;n--){for(s=Array(l),c=e[n],a=l-1;a>=0;a--){for(d=c[o-1]*t[o-1][a],r=o-2;r>=1;r-=2)f=r-1,d+=c[r]*t[r][a]+c[f]*t[f][a];0===r&&(d+=c[0]*t[0][a]),s[a]=d}u[n]=s}return u},numeric._getCol=function(e,t,n){var r,a=e.length;for(r=a-1;r>0;--r)n[r]=e[r][t],--r,n[r]=e[r][t];0===r&&(n[0]=e[0][t])},numeric.dotMMbig=function(e,t){var n,r,a,i,o=numeric._getCol,l=t.length,u=Array(l),s=e.length,c=t[0].length,d=new Array(s),f=numeric.dotVV;for(--l,--s,r=s;-1!==r;--r)d[r]=Array(c);for(--c,r=c;-1!==r;--r)for(o(t,r,u),a=s;-1!==a;--a)i=0,n=e[a],d[a][r]=f(n,u);return d},numeric.dotMV=function(e,t){var n,r=e.length,a=(t.length,Array(r)),i=numeric.dotVV;for(n=r-1;n>=0;n--)a[n]=i(e[n],t);return a},numeric.dotVM=function(e,t){var n,r,a,i,o,l,u;for(a=e.length,i=t[0].length,o=Array(i),r=i-1;r>=0;r--){for(l=e[a-1]*t[a-1][r],n=a-2;n>=1;n-=2)u=n-1,l+=e[n]*t[n][r]+e[u]*t[u][r];0===n&&(l+=e[0]*t[0][r]),o[r]=l}return o},numeric.dotVV=function(e,t){var n,r,a=e.length,i=e[a-1]*t[a-1];for(n=a-2;n>=1;n-=2)r=n-1,i+=e[n]*t[n]+e[r]*t[r];return 0===n&&(i+=e[0]*t[0]),i},numeric.dot=function(e,t){var n=numeric.dim;switch(1e3*n(e).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,n,r,a,i=e.length,o=Array(i);for(t=i-1;t>=0;t--){for(a=Array(i),n=t+2,r=i-1;r>=n;r-=2)a[r]=0,a[r-1]=0;for(r>t&&(a[r]=0),a[t]=e[t],r=t-1;r>=1;r-=2)a[r]=0,a[r-1]=0;0===r&&(a[0]=0),o[t]=a}return o},numeric.getDiag=function(e){var t,n=Math.min(e.length,e[0].length),r=Array(n);for(t=n-1;t>=1;--t)r[t]=e[t][t],--t,r[t]=e[t][t];return 0===t&&(r[0]=e[0][0]),r},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,n){"undefined"==typeof n&&(n="");var r,a,i=[],o=/\[i\]$/,l="",u=!1;for(r=0;r<e.length;r++)o.test(e[r])?(a=e[r].substring(0,e[r].length-3),l=a):a=e[r],"ret"===a&&(u=!0),i.push(a);return i[e.length]="_s",i[e.length+1]="_k",i[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+l+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(e,t,n){"undefined"==typeof n&&(n="");var r,a,i=[],o=/\[i\]$/,l="",u=!1;for(r=0;r<e.length;r++)o.test(e[r])?(a=e[r].substring(0,e[r].length-3),l=a):a=e[r],"ret"===a&&(u=!0),i.push(a);return i[e.length]="var _n = "+l+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function t(e,n,r,a,i){if(a===r.length-1)return void i(e,n);var o,l=r[a];for(o=l-1;o>=0;o--)t("object"==typeof e?e[o]:e,"object"==typeof n?n[o]:n,r,a+1,i)},numeric._biforeach2=function n(e,t,r,a,i){if(a===r.length-1)return i(e,t);var o,l=r[a],u=Array(l);for(o=l-1;o>=0;--o)u[o]=n("object"==typeof e?e[o]:e,"object"==typeof t?t[o]:t,r,a+1,i);return u},numeric._foreach=function r(e,t,n,a){if(n===t.length-1)return void a(e);var i,o=t[n];for(i=o-1;i>=0;i--)r(e[i],t,n+1,a)},numeric._foreach2=function a(e,t,n,r){if(n===t.length-1)return r(e);var i,o=t[n],l=Array(o);for(i=o-1;i>=0;i--)l[i]=a(e[i],t,n+1,r);return l},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,r,a="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(a="var "+t+" = Math."+t+";\n",n=function(e,n,r){return e+" = "+t+"("+n+","+r+")"},r=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,r){return e+" = "+n+" "+t+" "+r},r=numeric.opseq.hasOwnProperty(e+"eq")?function(e,n){return e+" "+t+"= "+n}:function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),a),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),a),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),a),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),a),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),a),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(a="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(a="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",a),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",a),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,n,r,a,i,o,l,e,u=numeric.dim(e),s=Math.abs,c=u[0],d=u[1],f=numeric.clone(e),p=numeric.identity(c);for(o=0;d>o;++o){var h=-1,g=-1;for(i=o;i!==c;++i)l=s(f[i][o]),l>g&&(h=i,g=l);for(n=f[h],f[h]=f[o],f[o]=n,a=p[h],p[h]=p[o],p[o]=a,e=n[o],l=o;l!==d;++l)n[l]/=e;for(l=d-1;-1!==l;--l)a[l]/=e;for(i=c-1;-1!==i;--i)if(i!==o){for(t=f[i],r=p[i],e=t[o],l=o+1;l!==d;++l)t[l]-=n[l]*e;for(l=d-1;l>0;--l)r[l]-=a[l]*e,--l,r[l]-=a[l]*e;0===l&&(r[0]-=a[0]*e)}}return p},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,r,a,i,o,l,u,s,c=t[0],d=1,f=numeric.clone(e);for(r=0;c-1>r;r++){for(a=r,n=r+1;c>n;n++)Math.abs(f[n][r])>Math.abs(f[a][r])&&(a=n);for(a!==r&&(u=f[a],f[a]=f[r],f[r]=u,d*=-1),i=f[r],n=r+1;c>n;n++){for(o=f[n],l=o[r]/i[r],a=r+1;c-1>a;a+=2)s=a+1,o[a]-=i[a]*l,o[s]-=i[s]*l;a!==c&&(o[a]-=i[a]*l)}if(0===i[r])return 0;d*=i[r]}return d*f[r][r]},numeric.transpose=function(e){var t,n,r,a,i,o=e.length,l=e[0].length,u=Array(l);for(n=0;l>n;n++)u[n]=Array(o);for(t=o-1;t>=1;t-=2){for(a=e[t],r=e[t-1],n=l-1;n>=1;--n)i=u[n],i[t]=a[n],i[t-1]=r[n],--n,i=u[n],i[t]=a[n],i[t-1]=r[n];0===n&&(i=u[0],i[t]=a[0],i[t-1]=r[0])}if(0===t){for(r=e[0],n=l-1;n>=1;--n)u[n][0]=r[n],--n,u[n][0]=r[n];0===n&&(u[0][0]=r[0])}return u},numeric.negtranspose=function(e){var t,n,r,a,i,o=e.length,l=e[0].length,u=Array(l);for(n=0;l>n;n++)u[n]=Array(o);for(t=o-1;t>=1;t-=2){for(a=e[t],r=e[t-1],n=l-1;n>=1;--n)i=u[n],i[t]=-a[n],i[t-1]=-r[n],--n,i=u[n],i[t]=-a[n],i[t-1]=-r[n];0===n&&(i=u[0],i[t]=-a[0],i[t-1]=-r[0])}if(0===t){for(r=e[0],n=l-1;n>=1;--n)u[n][0]=-r[n],--n,u[n][0]=-r[n];0===n&&(u[0][0]=-r[0])}return u},numeric._random=function i(e,t){var n,r,a=e[t],o=Array(a);if(t===e.length-1){for(r=Math.random,n=a-1;n>=1;n-=2)o[n]=r(),o[n-1]=r();return 0===n&&(o[0]=r()),o}for(n=a-1;n>=0;n--)o[n]=i(e,t+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,n){if("undefined"==typeof n&&(n=Math.max(Math.round(t-e)+1,1)),2>n)return 1===n?[e]:[];var r,a=Array(n);for(n--,r=n;r>=0;r--)a[r]=(r*t+(n-r)*e)/n;return a},numeric.getBlock=function(e,t,n){function r(e,i){var o,l=t[i],u=n[i]-l,s=Array(u);if(i===a.length-1){for(o=u;o>=0;o--)s[o]=e[o+l];return s}for(o=u;o>=0;o--)s[o]=r(e[o+l],i+1);return s}var a=numeric.dim(e);return r(e,0)},numeric.setBlock=function(e,t,n,r){function a(e,r,o){var l,u=t[o],s=n[o]-u;if(o===i.length-1)for(l=s;l>=0;l--)e[l+u]=r[l];for(l=s;l>=0;l--)a(e[l+u],r[l],o+1)}var i=numeric.dim(e);return a(e,r,0),e},numeric.getRange=function(e,t,n){var r,a,i,o,l=t.length,u=n.length,s=Array(l);for(r=l-1;-1!==r;--r)for(s[r]=Array(u),i=s[r],o=e[t[r]],a=u-1;-1!==a;--a)i[a]=o[n[a]];return s},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var n,r,a,i,o,l=t[0],u=t[1];for(n=0,r=0,a=0;l>a;++a)n+=e[a][0].length;for(i=0;u>i;++i)r+=e[0][i][0].length;var s=Array(n);for(a=0;n>a;++a)s[a]=Array(r);var c,d,f,p,h,g=0;for(a=0;l>a;++a){for(c=r,i=u-1;-1!==i;--i)for(o=e[a][i],c-=o[0].length,f=o.length-1;-1!==f;--f)for(h=o[f],d=s[g+f],p=h.length-1;-1!==p;--p)d[c+p]=h[p];g+=e[a][0].length}return s},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var n=numeric.dim(e),r=numeric.dim(t);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var a,i,o,l,u=n[0],s=r[0],c=Array(u);for(i=u-1;i>=0;i--){for(a=Array(s),l=e[i],o=s-1;o>=3;--o)a[o]=l*t[o],--o,a[o]=l*t[o],--o,a[o]=l*t[o],--o,a[o]=l*t[o];for(;o>=0;)a[o]=l*t[o],--o;c[i]=a}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,n,r,a){numeric.indexOf;if("string"!=typeof a){var i;a="";for(i in numeric)numeric.hasOwnProperty(i)&&(e.indexOf(i)>=0||t.indexOf(i)>=0||n.indexOf(i)>=0||r.indexOf(i)>=0)&&i.length>1&&(a+="var "+i+" = numeric."+i+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+a+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function o(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var o=numeric.div;return this.y?new numeric.T(o(this.x,e.x),o(this.y,e.x)):new numeric.T(o(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),numeric.negtranspose(n)):new numeric.T(e(t))},numeric.Tunop=function(e,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if("undefined"==typeof e.y)return new numeric.T(numeric.inv(e.x));var t,n,r,a,i,o,l,u,s,c,d,t,n,r,f,p,h,g,v,m,y,x=e.x.length,b=numeric.identity(x),w=numeric.rep([x,x],0),_=numeric.clone(e.x),k=numeric.clone(e.y);for(t=0;x>t;t++){for(h=_[t][t],g=k[t][t],f=h*h+g*g,r=t,n=t+1;x>n;n++)h=_[n][t],g=k[n][t],p=h*h+g*g,p>f&&(r=n,f=p);for(r!==t&&(y=_[t],_[t]=_[r],_[r]=y,y=k[t],k[t]=k[r],k[r]=y,y=b[t],b[t]=b[r],b[r]=y,y=w[t],w[t]=w[r],w[r]=y),a=_[t],i=k[t],u=b[t],s=w[t],h=a[t],g=i[t],n=t+1;x>n;n++)v=a[n],m=i[n],a[n]=(v*h+m*g)/f,i[n]=(m*h-v*g)/f;for(n=0;x>n;n++)v=u[n],m=s[n],u[n]=(v*h+m*g)/f,s[n]=(m*h-v*g)/f;
for(n=t+1;x>n;n++){for(o=_[n],l=k[n],c=b[n],d=w[n],h=o[t],g=l[t],r=t+1;x>r;r++)v=a[r],m=i[r],o[r]-=v*h-m*g,l[r]-=m*h+v*g;for(r=0;x>r;r++)v=u[r],m=s[r],c[r]-=v*h-m*g,d[r]-=m*h+v*g}}for(t=x-1;t>0;t--)for(u=b[t],s=w[t],n=t-1;n>=0;n--)for(c=b[n],d=w[n],h=_[n][t],g=k[n][t],r=x-1;r>=0;r--)v=u[r],m=s[r],c[r]-=h*v-g*m,d[r]-=h*m+g*v;return new numeric.T(b,w)},numeric.T.prototype.get=function(e){var t,n=this.x,r=this.y,a=0,i=e.length;if(r){for(;i>a;)t=e[a],n=n[t],r=r[t],a++;return new numeric.T(n,r)}for(;i>a;)t=e[a],n=n[t],a++;return new numeric.T(n)},numeric.T.prototype.set=function(e,t){var n,r=this.x,a=this.y,i=0,o=e.length,l=t.x,u=t.y;if(0===o)return u?this.y=u:a&&(this.y=void 0),this.x=r,this;if(u){for(a||(a=numeric.rep(numeric.dim(r),0),this.y=a);o-1>i;)n=e[i],r=r[n],a=a[n],i++;return n=e[i],r[n]=l,a[n]=u,this}if(a){for(;o-1>i;)n=e[i],r=r[n],a=a[n],i++;return n=e[i],r[n]=l,a[n]=l instanceof Array?numeric.rep(numeric.dim(l),0):0,this}for(;o-1>i;)n=e[i],r=r[n],i++;return n=e[i],r[n]=l,this},numeric.T.prototype.getRows=function(e,t){var n,r,a=t-e+1,i=Array(a),o=this.x,l=this.y;for(n=e;t>=n;n++)i[n-e]=o[n];if(l){for(r=Array(a),n=e;t>=n;n++)r[n-e]=l[n];return new numeric.T(i,r)}return new numeric.T(i)},numeric.T.prototype.setRows=function(e,t,n){var r,a=this.x,i=this.y,o=n.x,l=n.y;for(r=e;t>=r;r++)a[r]=o[r-e];if(l)for(i||(i=numeric.rep(numeric.dim(a),0),this.y=i),r=e;t>=r;r++)i[r]=l[r-e];else if(i)for(r=e;t>=r;r++)i[r]=numeric.rep([o[r-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,n=this.y;return n?new numeric.T(t[e],n[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var n=this.x,r=this.y,a=t.x,i=t.y;return n[e]=a,i?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[e]=i):r&&(r=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var n=this.x,r=this.y,a=numeric.getBlock;return r?new numeric.T(a(n,e,t),a(r,e,t)):new numeric.T(a(n,e,t))},numeric.T.prototype.setBlock=function(e,t,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,a=this.y,i=numeric.setBlock,o=n.x,l=n.y;return l?(a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),i(r,e,t,o),i(a,e,t,l),this):(i(r,e,t,o),void(a&&i(a,e,t,numeric.rep(numeric.dim(o),0))))},numeric.T.rep=function(e,t){var n=numeric.T;t instanceof n||(t=new n(t));var r=t.x,a=t.y,i=numeric.rep;return a?new n(i(e,r),i(e,a)):new n(i(e,r))},numeric.T.diag=function l(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,l=numeric.diag;return n?new numeric.T(l(t),l(n)):new numeric.T(l(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,n=this.y;return n?new e.T(e.getDiag(t),e.getDiag(n)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),n=e[0]>=0?1:-1,r=n*numeric.norm2(e);t[0]+=r;var a=numeric.norm2(t);if(0===a)throw new Error("eig: internal error");return numeric.div(t,a)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,a,i,o,l,u,s,c,d,f=t[0],p=numeric.clone(e),h=numeric.identity(f);for(r=0;f-2>r;r++){for(i=Array(f-r-1),n=r+1;f>n;n++)i[n-r-1]=p[n][r];if(numeric.norm2(i)>0){for(o=numeric.house(i),l=numeric.getBlock(p,[r+1,r],[f-1,f-1]),u=numeric.tensor(o,numeric.dot(o,l)),n=r+1;f>n;n++)for(s=p[n],c=u[n-r-1],a=r;f>a;a++)s[a]-=2*c[a-r];for(l=numeric.getBlock(p,[0,r+1],[f-1,f-1]),u=numeric.tensor(numeric.dot(l,o),o),n=0;f>n;n++)for(s=p[n],c=u[n],a=r+1;f>a;a++)s[a]-=2*c[a-r-1];for(l=Array(f-r-1),n=r+1;f>n;n++)l[n-r-1]=h[n];for(u=numeric.tensor(o,numeric.dot(o,l)),n=r+1;f>n;n++)for(d=h[n],c=u[n-r-1],a=0;f>a;a++)d[a]-=2*c[a]}}return{H:p,Q:h}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,t){"undefined"==typeof t&&(t=1e4),e=numeric.clone(e);var n,r,a,i,o,l,u,s,c,d,f,p,h,g,v,m,y,x,b=(numeric.clone(e),numeric.dim(e)),w=b[0],_=numeric.identity(w);if(3>w)return{Q:_,B:[[0,w-1]]};var k=numeric.epsilon;for(x=0;t>x;x++){for(m=0;w-1>m;m++)if(Math.abs(e[m+1][m])<k*(Math.abs(e[m][m])+Math.abs(e[m+1][m+1]))){var M=numeric.QRFrancis(numeric.getBlock(e,[0,0],[m,m]),t),A=numeric.QRFrancis(numeric.getBlock(e,[m+1,m+1],[w-1,w-1]),t);for(p=Array(m+1),v=0;m>=v;v++)p[v]=_[v];for(h=numeric.dot(M.Q,p),v=0;m>=v;v++)_[v]=h[v];for(p=Array(w-m-1),v=m+1;w>v;v++)p[v-m-1]=_[v];for(h=numeric.dot(A.Q,p),v=m+1;w>v;v++)_[v]=h[v-m-1];return{Q:_,B:M.B.concat(numeric.add(A.B,m+1))}}if(a=e[w-2][w-2],i=e[w-2][w-1],o=e[w-1][w-2],l=e[w-1][w-1],s=a+l,u=a*l-i*o,c=numeric.getBlock(e,[0,0],[2,2]),s*s>=4*u){var z,j;z=.5*(s+Math.sqrt(s*s-4*u)),j=.5*(s-Math.sqrt(s*s-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,z+j)),numeric.diag(numeric.rep([3],z*j)))}else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,s)),numeric.diag(numeric.rep([3],u)));for(n=[c[0][0],c[1][0],c[2][0]],r=numeric.house(n),p=[e[0],e[1],e[2]],h=numeric.tensor(r,numeric.dot(r,p)),v=0;3>v;v++)for(f=e[v],g=h[v],y=0;w>y;y++)f[y]-=2*g[y];for(p=numeric.getBlock(e,[0,0],[w-1,2]),h=numeric.tensor(numeric.dot(p,r),r),v=0;w>v;v++)for(f=e[v],g=h[v],y=0;3>y;y++)f[y]-=2*g[y];for(p=[_[0],_[1],_[2]],h=numeric.tensor(r,numeric.dot(r,p)),v=0;3>v;v++)for(d=_[v],g=h[v],y=0;w>y;y++)d[y]-=2*g[y];var E;for(m=0;w-2>m;m++){for(y=m;m+1>=y;y++)if(Math.abs(e[y+1][y])<k*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){var M=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),A=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[w-1,w-1]),t);for(p=Array(y+1),v=0;y>=v;v++)p[v]=_[v];for(h=numeric.dot(M.Q,p),v=0;y>=v;v++)_[v]=h[v];for(p=Array(w-y-1),v=y+1;w>v;v++)p[v-y-1]=_[v];for(h=numeric.dot(A.Q,p),v=y+1;w>v;v++)_[v]=h[v-y-1];return{Q:_,B:M.B.concat(numeric.add(A.B,y+1))}}for(E=Math.min(w-1,m+3),n=Array(E-m),v=m+1;E>=v;v++)n[v-m-1]=e[v][m];for(r=numeric.house(n),p=numeric.getBlock(e,[m+1,m],[E,w-1]),h=numeric.tensor(r,numeric.dot(r,p)),v=m+1;E>=v;v++)for(f=e[v],g=h[v-m-1],y=m;w>y;y++)f[y]-=2*g[y-m];for(p=numeric.getBlock(e,[0,m+1],[w-1,E]),h=numeric.tensor(numeric.dot(p,r),r),v=0;w>v;v++)for(f=e[v],g=h[v],y=m+1;E>=y;y++)f[y]-=2*g[y-m-1];for(p=Array(E-m),v=m+1;E>=v;v++)p[v-m-1]=_[v];for(h=numeric.tensor(r,numeric.dot(r,p)),v=m+1;E>=v;v++)for(d=_[v],g=h[v-m-1],y=0;w>y;y++)d[y]-=2*g[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var n,r,a,i,o,l,u,s,c,d,f,p,h,g,v,m,y,x=numeric.toUpperHessenberg(e),b=numeric.QRFrancis(x.H,t),w=numeric.T,_=e.length,k=b.B,M=numeric.dot(b.Q,numeric.dot(x.H,numeric.transpose(b.Q))),A=new w(numeric.dot(b.Q,x.Q)),z=k.length,j=Math.sqrt;for(r=0;z>r;r++)if(n=k[r][0],n===k[r][1]);else{if(i=n+1,o=M[n][n],l=M[n][i],u=M[i][n],s=M[i][i],0===l&&0===u)continue;c=-o-s,d=o*s-l*u,f=c*c-4*d,f>=0?(p=0>c?-.5*(c-j(f)):-.5*(c+j(f)),m=(o-p)*(o-p)+l*l,y=u*u+(s-p)*(s-p),m>y?(m=j(m),g=(o-p)/m,v=l/m):(y=j(y),g=u/y,v=(s-p)/y),a=new w([[v,-g],[g,v]]),A.setRows(n,i,a.dot(A.getRows(n,i)))):(p=-.5*c,h=.5*j(-f),m=(o-p)*(o-p)+l*l,y=u*u+(s-p)*(s-p),m>y?(m=j(m+h*h),g=(o-p)/m,v=l/m,p=0,h/=m):(y=j(y+h*h),g=u/y,v=(s-p)/y,p=h/y,h=0),a=new w([[v,-g],[g,v]],[[p,h],[h,-p]]),A.setRows(n,i,a.dot(A.getRows(n,i))))}var E=A.dot(e).dot(A.transjugate()),_=e.length,S=numeric.T.identity(_);for(i=0;_>i;i++)if(i>0)for(r=i-1;r>=0;r--){var T=E.get([r,r]),N=E.get([i,i]);numeric.neq(T.x,N.x)||numeric.neq(T.y,N.y)?(p=E.getRow(r).getBlock([r],[i-1]),h=S.getRow(i).getBlock([r],[i-1]),S.set([i,r],E.get([r,i]).neg().sub(p.dot(h)).div(T.sub(N)))):S.setRow(i,S.getRow(r))}for(i=0;_>i;i++)p=S.getRow(i),S.setRow(i,p.div(p.norm2()));return S=S.transpose(),S=A.transjugate().dot(S),{lambda:E.getDiag(),E:S}},numeric.ccsSparse=function(e){var t,n,r,a,i=e.length,o=[];for(r=i-1;-1!==r;--r){n=e[r];for(a in n){for(a=parseInt(a);a>=o.length;)o[o.length]=0;0!==n[a]&&o[a]++}}var t=o.length,l=Array(t+1);for(l[0]=0,r=0;t>r;++r)l[r+1]=l[r]+o[r];var u=Array(l[t]),s=Array(l[t]);for(r=i-1;-1!==r;--r){n=e[r];for(a in n)0!==n[a]&&(o[a]--,u[l[a]+o[a]]=r,s[l[a]+o[a]]=n[a])}return[l,u,s]},numeric.ccsFull=function(e){var t,n,r,a,i=e[0],o=e[1],l=e[2],u=numeric.ccsDim(e),s=u[0],c=u[1],d=numeric.rep([s,c],0);for(t=0;c>t;t++)for(r=i[t],a=i[t+1],n=r;a>n;++n)d[o[n]][t]=l[n];return d},numeric.ccsTSolve=function(e,t,n,r,a){function i(e){var t;if(0===n[e]){for(n[e]=1,t=o[e];t<o[e+1];++t)i(l[t]);a[d]=e,++d}}var o=e[0],l=e[1],u=e[2],s=o.length-1,c=Math.max,d=0;"undefined"==typeof r&&(n=numeric.rep([s],0)),"undefined"==typeof r&&(r=numeric.linspace(0,n.length-1)),"undefined"==typeof a&&(a=[]);var f,p,h,g,v,m,y;for(f=r.length-1;-1!==f;--f)i(r[f]);for(a.length=d,f=a.length-1;-1!==f;--f)n[a[f]]=0;for(f=r.length-1;-1!==f;--f)p=r[f],n[p]=t[p];for(f=a.length-1;-1!==f;--f){for(p=a[f],h=o[p],g=c(o[p+1],h),v=h;v!==g;++v)if(l[v]===p){n[p]/=u[v];break}for(y=n[p],v=h;v!==g;++v)m=l[v],m!==p&&(n[m]-=y*u[v])}return n},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,n,r,a,i){var o,l,u,s=0,c=a.length,d=this.k,f=this.k1,p=this.j;if(0===r[e])for(r[e]=1,p[0]=e,d[0]=l=t[e],f[0]=u=t[e+1];;)if(l>=u){if(a[c]=p[s],0===s)return;++c,--s,l=d[s],u=f[s]}else o=i[n[l]],0===r[o]?(r[o]=1,d[s]=l,++s,p[s]=o,l=t[o],f[s]=u=t[o+1]):++l},numeric.ccsLPSolve=function(e,t,n,r,a,i,o){var l,u,s,c,d,f,p,h,g,v=e[0],m=e[1],y=e[2],x=(v.length-1,t[0]),b=t[1],w=t[2];for(u=x[a],s=x[a+1],r.length=0,l=u;s>l;++l)o.dfs(i[b[l]],v,m,n,r,i);for(l=r.length-1;-1!==l;--l)n[r[l]]=0;for(l=u;l!==s;++l)c=i[b[l]],n[c]=w[l];for(l=r.length-1;-1!==l;--l){for(c=r[l],d=v[c],f=v[c+1],p=d;f>p;++p)if(i[m[p]]===c){n[c]/=y[p];break}for(g=n[c],p=d;f>p;++p)h=i[m[p]],h!==c&&(n[h]-=g*y[p])}return n},numeric.ccsLUP1=function(e,t){var n,r,a,i,o,l,u,s=e[0].length-1,c=[numeric.rep([s+1],0),[],[]],d=[numeric.rep([s+1],0),[],[]],f=c[0],p=c[1],h=c[2],g=d[0],v=d[1],m=d[2],y=numeric.rep([s],0),x=numeric.rep([s],0),b=numeric.ccsLPSolve,w=(Math.max,Math.abs),_=numeric.linspace(0,s-1),k=numeric.linspace(0,s-1),M=new numeric.ccsDFS(s);for("undefined"==typeof t&&(t=1),n=0;s>n;++n){for(b(c,e,y,x,n,k,M),i=-1,o=-1,r=x.length-1;-1!==r;--r)a=x[r],n>=a||(l=w(y[a]),l>i&&(o=a,i=l));for(w(y[n])<t*i&&(r=_[n],i=_[o],_[n]=i,k[i]=n,_[o]=r,k[r]=o,i=y[n],y[n]=y[o],y[o]=i),i=f[n],o=g[n],u=y[n],p[i]=_[n],h[i]=1,++i,r=x.length-1;-1!==r;--r)a=x[r],l=y[a],x[r]=0,y[a]=0,n>=a?(v[o]=a,m[o]=l,++o):(p[i]=_[a],h[i]=l/u,++i);f[n+1]=i,g[n+1]=o}for(r=p.length-1;-1!==r;--r)p[r]=k[p[r]];return{L:c,U:d,P:_,Pinv:k}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,n,r,a,i){var o,l,u,s=0,c=a.length,d=this.k,f=this.k1,p=this.j;if(0===r[e])for(r[e]=1,p[0]=e,d[0]=l=t[i[e]],f[0]=u=t[i[e]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=u){if(a[c]=i[p[s]],0===s)return;++c,--s,l=d[s],u=f[s]}else o=n[l],0===r[o]?(r[o]=1,d[s]=l,++s,p[s]=o,o=i[o],l=t[o],f[s]=u=t[o+1]):++l}},numeric.ccsLPSolve0=function(e,t,n,r,a,i,o,l){var u,s,c,d,f,p,h,g,v,m=e[0],y=e[1],x=e[2],b=(m.length-1,t[0]),w=t[1],_=t[2];for(s=b[a],c=b[a+1],r.length=0,u=s;c>u;++u)l.dfs(w[u],m,y,n,r,i,o);for(u=r.length-1;-1!==u;--u)d=r[u],n[o[d]]=0;for(u=s;u!==c;++u)d=w[u],n[d]=_[u];for(u=r.length-1;-1!==u;--u){for(d=r[u],g=o[d],f=m[d],p=m[d+1],h=f;p>h;++h)if(y[h]===g){n[g]/=x[h];break}for(v=n[g],h=f;p>h;++h)n[y[h]]-=v*x[h];n[g]=v}},numeric.ccsLUP0=function(e,t){var n,r,a,i,o,l,u,s=e[0].length-1,c=[numeric.rep([s+1],0),[],[]],d=[numeric.rep([s+1],0),[],[]],f=c[0],p=c[1],h=c[2],g=d[0],v=d[1],m=d[2],y=numeric.rep([s],0),x=numeric.rep([s],0),b=numeric.ccsLPSolve0,w=(Math.max,Math.abs),_=numeric.linspace(0,s-1),k=numeric.linspace(0,s-1),M=new numeric.ccsDFS0(s);for("undefined"==typeof t&&(t=1),n=0;s>n;++n){for(b(c,e,y,x,n,k,_,M),i=-1,o=-1,r=x.length-1;-1!==r;--r)a=x[r],n>=a||(l=w(y[_[a]]),l>i&&(o=a,i=l));for(w(y[_[n]])<t*i&&(r=_[n],i=_[o],_[n]=i,k[i]=n,_[o]=r,k[r]=o),i=f[n],o=g[n],u=y[_[n]],p[i]=_[n],h[i]=1,++i,r=x.length-1;-1!==r;--r)a=x[r],l=y[_[a]],x[r]=0,y[_[a]]=0,n>=a?(v[o]=a,m[o]=l,++o):(p[i]=_[a],h[i]=l/u,++i);f[n+1]=i,g[n+1]=o}for(r=p.length-1;-1!==r;--r)p[r]=k[p[r]];return{L:c,U:d,P:_,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,n){var r=numeric.ccsDim(e),a=r[0],i=r[1];"undefined"==typeof t?t=numeric.linspace(0,a-1):"number"==typeof t&&(t=[t]),"undefined"==typeof n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]);var o,l,u,s,c,d=t.length,f=n.length,p=numeric.rep([i],0),h=[],g=[],v=[p,h,g],m=e[0],y=e[1],x=e[2],b=numeric.rep([a],0),w=0,_=numeric.rep([a],0);for(l=0;f>l;++l){s=n[l];var k=m[s],M=m[s+1];for(o=k;M>o;++o)u=y[o],_[u]=1,b[u]=x[o];for(o=0;d>o;++o)c=t[o],_[c]&&(h[w]=o,g[w]=b[t[o]],++w);for(o=k;M>o;++o)u=y[o],_[u]=0;p[l+1]=w}return v},numeric.ccsDot=function(e,t){var n,r,a,i,o,l,u,s,c,d,f,p=e[0],h=e[1],g=e[2],v=t[0],m=t[1],y=t[2],x=numeric.ccsDim(e),b=numeric.ccsDim(t),w=x[0],_=(x[1],b[1]),k=numeric.rep([w],0),M=numeric.rep([w],0),A=Array(w),z=numeric.rep([_],0),j=[],E=[],S=[z,j,E];for(a=0;a!==_;++a){for(i=v[a],o=v[a+1],c=0,r=i;o>r;++r)for(d=m[r],f=y[r],l=p[d],u=p[d+1],n=l;u>n;++n)s=h[n],0===M[s]&&(A[c]=s,M[s]=1,c+=1),k[s]=k[s]+g[n]*f;for(i=z[a],o=i+c,z[a+1]=o,r=c-1;-1!==r;--r)f=i+r,n=A[r],j[f]=n,E[f]=k[n],M[n]=0,k[n]=0;z[a+1]=z[a]+c}return S},numeric.ccsLUPSolve=function(e,t){var n=e.L,r=e.U,a=(e.P,t[0]),i=!1;"object"!=typeof a&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],a=t[0],i=!0);var o,l,u,s,c,d,f=t[1],p=t[2],h=n[0].length-1,g=a.length-1,v=numeric.rep([h],0),m=Array(h),y=numeric.rep([h],0),x=Array(h),b=numeric.rep([g+1],0),w=[],_=[],k=numeric.ccsTSolve,M=0;for(o=0;g>o;++o){for(c=0,u=a[o],s=a[o+1],l=u;s>l;++l)d=e.Pinv[f[l]],x[c]=d,y[d]=p[l],++c;for(x.length=c,k(n,y,v,x,m),l=x.length-1;-1!==l;--l)y[x[l]]=0;if(k(r,v,y,m,x),i)return y;for(l=m.length-1;-1!==l;--l)v[m[l]]=0;for(l=x.length-1;-1!==l;--l)d=x[l],w[M]=d,_[M]=y[d],y[d]=0,++M;b[o+1]=M}return[b,w,_]},numeric.ccsbinop=function(e,t){return"undefined"==typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,n=e[0],r=e[1],a=e[2],i=numeric.sup(r)+1,o=n.length,l=numeric.rep([i],0),u=Array(o),s=Array(o),c=numeric.rep([i],0);for(t=0;o>t;++t)c[r[t]]++;for(t=0;i>t;++t)l[t+1]=l[t]+c[t];var d,f,p=l.slice(0);for(t=0;o>t;++t)f=r[t],d=p[f],u[d]=n[t],s[d]=a[t],p[f]=p[f]+1;return[l,u,s]},numeric.ccsGather=function(e){var t,n,r,a,i,o=e[0],l=e[1],u=e[2],s=o.length-1,c=l.length,d=Array(c),f=Array(c),p=Array(c);for(i=0,t=0;s>t;++t)for(r=o[t],a=o[t+1],n=r;n!==a;++n)f[i]=t,d[i]=l[n],p[i]=u[n],++i;return[d,f,p]},numeric.sdim=function u(e,t,n){if("undefined"==typeof t&&(t=[]),"object"!=typeof e)return t;"undefined"==typeof n&&(n=0),n in t||(t[n]=0),e.length>t[n]&&(t[n]=e.length);var r;for(r in e)e.hasOwnProperty(r)&&u(e[r],t,n+1);return t},numeric.sclone=function s(e,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=numeric.sdim(e).length);var r,a=Array(e.length);if(t===n-1){for(r in e)e.hasOwnProperty(r)&&(a[r]=e[r]);return a}for(r in e)e.hasOwnProperty(r)&&(a[r]=s(e[r],t+1,n));return a},numeric.sdiag=function(e){var t,n,r=e.length,a=Array(r);for(t=r-1;t>=1;t-=2)n=t-1,a[t]=[],a[t][t]=e[t],a[n]=[],a[n][n]=e[n];return 0===t&&(a[0]=[],a[0][0]=e[t]),a},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){{var t,n,r,a=[];e.length}for(t in e)if(e.hasOwnProperty(t)){r=e[t];for(n in r)r.hasOwnProperty(n)&&("object"!=typeof a[n]&&(a[n]=[]),a[n][t]=r[n])}return a},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var n,r,a,i,o,l,u,s=e.length,c=(t.length,numeric.stranspose(t)),d=c.length,f=Array(s);for(a=s-1;a>=0;a--){for(u=[],n=e[a],o=d-1;o>=0;o--){l=0,r=c[o];for(i in n)n.hasOwnProperty(i)&&i in r&&(l+=n[i]*r[i]);l&&(u[o]=l)}f[a]=u}return f},numeric.sdotMV=function(e,t){var n,r,a,i,o=e.length,l=Array(o);for(r=o-1;r>=0;r--){n=e[r],i=0;for(a in n)n.hasOwnProperty(a)&&t[a]&&(i+=n[a]*t[a]);i&&(l[r]=i)}return l},numeric.sdotVM=function(e,t){var n,r,a,i,o=[];for(n in e)if(e.hasOwnProperty(n)){a=t[n],i=e[n];for(r in a)a.hasOwnProperty(r)&&(o[r]||(o[r]=0),o[r]+=i*a[r])}return o},numeric.sdotVV=function(e,t){var n,r=0;for(n in e)e[n]&&t[n]&&(r+=e[n]*t[n]);return r},numeric.sdot=function(e,t){var n=numeric.sdim(e).length,r=numeric.sdim(t).length,a=1e3*n+r;switch(a){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(e){var t,n,r,a,i=e[0].length,o=e.length,l=[];for(n=i-1;n>=0;--n)if(e[o-1][n]){for(a=l,r=0;o-2>r;r++)t=e[r][n],a[t]||(a[t]=[]),a=a[t];a[e[r][n]]=e[r+1][n]}return l},numeric.sgather=function c(e,t,n){"undefined"==typeof t&&(t=[]),"undefined"==typeof n&&(n=[]);var r,a,i;r=n.length;for(a in e)if(e.hasOwnProperty(a))if(n[r]=parseInt(a),i=e[a],"number"==typeof i){if(i){if(0===t.length)for(a=r+1;a>=0;--a)t[a]=[];for(a=r;a>=0;--a)t[a].push(n[a]);t[r+1].push(i)}}else c(i,t,n);return n.length>r&&n.pop(),t},numeric.cLU=function(e){var t,n,r,a,i,o,l=e[0],u=e[1],s=e[2],c=l.length,d=0;for(t=0;c>t;t++)l[t]>d&&(d=l[t]);d++;var f,p,h,g=Array(d),v=Array(d),m=numeric.rep([d],1/0),y=numeric.rep([d],-1/0);for(r=0;c>r;r++)t=l[r],n=u[r],n<m[t]&&(m[t]=n),n>y[t]&&(y[t]=n);for(t=0;d-1>t;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=d-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);var x=0,b=0;for(t=0;d>t;t++)v[t]=numeric.rep([y[t]-m[t]+1],0),g[t]=numeric.rep([t-m[t]],0),x+=t-m[t]+1,b+=y[t]-t+1;for(r=0;c>r;r++)t=l[r],v[t][u[r]-m[t]]=s[r];for(t=0;d-1>t;t++)for(a=t-m[t],f=v[t],n=t+1;m[n]<=t&&d>n;n++)if(i=t-m[n],o=y[t]-t,p=v[n],h=p[i]/f[a]){for(r=1;o>=r;r++)p[r+i]-=h*f[r+a];g[n][t-m[n]]=h}var c,w,_,f=[],p=[],k=[],M=[],A=[],z=[];for(c=0,w=0,t=0;d>t;t++){for(a=m[t],i=y[t],_=v[t],n=t;i>=n;n++)_[n-a]&&(f[c]=t,p[c]=n,k[c]=_[n-a],c++);for(_=g[t],n=a;t>n;n++)_[n-a]&&(M[w]=t,A[w]=n,z[w]=_[n-a],w++);M[w]=t,A[w]=t,z[w]=1,w++}return{U:[f,p,k],L:[M,A,z]}},numeric.cLUsolve=function(e,t){var n,r,a=e.L,i=e.U,o=numeric.clone(t),l=a[0],u=a[1],s=a[2],c=i[0],d=i[1],f=i[2],p=c.length,h=(l.length,o.length);for(r=0,n=0;h>n;n++){for(;u[r]<n;)o[n]-=s[r]*o[u[r]],r++;r++}for(r=p-1,n=h-1;n>=0;n--){for(;d[r]>n;)o[n]-=f[r]*o[d[r]],r--;o[n]/=f[r],r--}return o},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var n,r,a,i=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=e[0]/2||n<e[1]/2};break;default:t=function(){return!0}}for(a=0,n=1;n<e[0]-1;n++)for(r=1;r<e[1]-1;r++)t(n,r)&&(i[n][r]=a,a++);return i},numeric.cdelsq=function(e){var t,n,r,a,i,o=[[-1,0],[0,-1],[0,1],[1,0]],l=numeric.dim(e),u=l[0],s=l[1],c=[],d=[],f=[];for(t=1;u-1>t;t++)for(n=1;s-1>n;n++)if(!(e[t][n]<0)){for(r=0;4>r;r++)a=t+o[r][0],i=n+o[r][1],e[a][i]<0||(c.push(e[t][n]),d.push(e[a][i]),f.push(-1));c.push(e[t][n]),d.push(e[t][n]),f.push(4)}return[c,d,f]},numeric.cdotMV=function(e,t){var n,r,a,i=e[0],o=e[1],l=e[2],u=i.length;for(a=0,r=0;u>r;r++)i[r]>a&&(a=i[r]);for(a++,n=numeric.rep([a],0),r=0;u>r;r++)n[i[r]]+=l[r]*t[o[r]];return n},numeric.Spline=function(e,t,n,r,a){this.x=e,this.yl=t,this.yr=n,this.kl=r,this.kr=a},numeric.Spline.prototype._at=function(e,t){var e,n,r,a,i=this.x,o=this.yl,l=this.yr,u=this.kl,s=this.kr,c=numeric.add,d=numeric.sub,f=numeric.mul;n=d(f(u[t],i[t+1]-i[t]),d(l[t+1],o[t])),r=c(f(s[t+1],i[t]-i[t+1]),d(l[t+1],o[t])),a=(e-i[t])/(i[t+1]-i[t]);var p=a*(1-a);return c(c(c(f(1-a,o[t]),f(a,l[t+1])),f(n,p*(1-a))),f(r,p*a))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,n,r,a=this.x,i=a.length,o=Math.floor;for(t=0,n=i-1;n-t>1;)r=o((t+n)/2),a[r]<=e?t=r:n=r;return this._at(e,t)}var l,i=e.length,u=Array(i);for(l=i-1;-1!==l;--l)u[l]=this.at(e[l]);return u},numeric.Spline.prototype.diff=function(){var e,t,n,r=this.x,a=this.yl,i=this.yr,o=this.kl,l=this.kr,u=a.length,s=o,c=l,d=Array(u),f=Array(u),p=numeric.add,h=numeric.mul,g=numeric.div,v=numeric.sub;for(e=u-1;-1!==e;--e)t=r[e+1]-r[e],n=v(i[e+1],a[e]),d[e]=g(p(h(n,6),h(o[e],-4*t),h(l[e+1],-2*t)),t*t),f[e+1]=g(p(h(n,-6),h(o[e],2*t),h(l[e+1],4*t)),t*t);return new numeric.Spline(r,s,c,d,f)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],n=this.x,r=this.yl,a=this.yr,i=this.kl,o=this.kr;"number"==typeof r[0]&&(r=[r],a=[a],i=[i],o=[o]);var l,u,s,c,d,f,p,h,g,v,m,y,x,b,w,_,k,M,A,z,j,E,S,T,N=r.length,O=n.length-1,t=Array(N),C=Math.sqrt;for(l=0;l!==N;++l){for(c=r[l],d=a[l],f=i[l],p=o[l],h=[],u=0;u!==O;u++){for(u>0&&d[u]*c[u]<0&&h.push(n[u]),_=n[u+1]-n[u],k=n[u],m=c[u],y=d[u+1],g=f[u]/_,v=p[u+1]/_,w=e(g-v+3*(m-y))+12*v*m,x=v+3*m+2*g-3*y,b=3*(v+g+2*(m-y)),0>=w?(A=x/b,M=A>n[u]&&A<n[u+1]?[n[u],A,n[u+1]]:[n[u],n[u+1]]):(A=(x-C(w))/b,z=(x+C(w))/b,M=[n[u]],A>n[u]&&A<n[u+1]&&M.push(A),z>n[u]&&z<n[u+1]&&M.push(z),M.push(n[u+1])),E=M[0],A=this._at(E,u),s=0;s<M.length-1;s++)if(S=M[s+1],z=this._at(S,u),0!==A)if(0===z||A*z>0)E=S,A=z;else{for(var F=0;;){if(T=(A*S-z*E)/(A-z),E>=T||T>=S)break;if(j=this._at(T,u),j*z>0)S=T,z=j,-1===F&&(A*=.5),F=-1;else{if(!(j*A>0))break;E=T,A=j,1===F&&(z*=.5),F=1}}h.push(T),E=M[s+1],A=this._at(E,u)}else h.push(E),E=S,A=z;0===z&&h.push(S)}t[l]=h}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,n,r){var a,i=e.length,o=[],l=[],u=[],s=numeric.sub,c=numeric.mul,d=numeric.add;for(a=i-2;a>=0;a--)l[a]=e[a+1]-e[a],u[a]=s(t[a+1],t[a]);("string"==typeof n||"string"==typeof r)&&(n=r="periodic");var f=[[],[],[]];switch(typeof n){case"undefined":o[0]=c(3/(l[0]*l[0]),u[0]),f[0].push(0,0),f[1].push(0,1),f[2].push(2/l[0],1/l[0]);break;case"string":o[0]=d(c(3/(l[i-2]*l[i-2]),u[i-2]),c(3/(l[0]*l[0]),u[0])),f[0].push(0,0,0),f[1].push(i-2,0,1),f[2].push(1/l[i-2],2/l[i-2]+2/l[0],1/l[0]);break;default:o[0]=n,f[0].push(0),f[1].push(0),f[2].push(1)}for(a=1;i-1>a;a++)o[a]=d(c(3/(l[a-1]*l[a-1]),u[a-1]),c(3/(l[a]*l[a]),u[a])),f[0].push(a,a,a),f[1].push(a-1,a,a+1),f[2].push(1/l[a-1],2/l[a-1]+2/l[a],1/l[a]);switch(typeof r){case"undefined":o[i-1]=c(3/(l[i-2]*l[i-2]),u[i-2]),f[0].push(i-1,i-1),f[1].push(i-2,i-1),f[2].push(1/l[i-2],2/l[i-2]);break;case"string":f[1][f[1].length-1]=0;break;default:o[i-1]=r,f[0].push(i-1),f[1].push(i-1),f[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var p=Array(o.length);if("string"==typeof n)for(a=p.length-1;-1!==a;--a)p[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(f)),o[a]),p[a][i-1]=p[a][0];else for(a=p.length-1;-1!==a;--a)p[a]=numeric.cLUsolve(numeric.cLU(f),o[a]);return p="number"==typeof t[0]?p[0]:numeric.transpose(p),new numeric.Spline(e,t,t,p,p)},numeric.fftpow2=function d(e,t){var n=e.length;if(1!==n){var r,a,i=Math.cos,o=Math.sin,l=Array(n/2),u=Array(n/2),s=Array(n/2),c=Array(n/2);for(a=n/2,r=n-1;-1!==r;--r)--a,s[a]=e[r],c[a]=t[r],--r,l[a]=e[r],u[a]=t[r];d(l,u),d(s,c),a=n/2;var f,p,h,g=-6.283185307179586/n;for(r=n-1;-1!==r;--r)--a,-1===a&&(a=n/2-1),f=g*r,p=i(f),h=o(f),e[r]=l[a]+p*s[a]-h*c[a],t[r]=u[a]+p*c[a]+h*s[a]}},numeric._ifftpow2=function f(e,t){var n=e.length;if(1!==n){var r,a,i=Math.cos,o=Math.sin,l=Array(n/2),u=Array(n/2),s=Array(n/2),c=Array(n/2);for(a=n/2,r=n-1;-1!==r;--r)--a,s[a]=e[r],c[a]=t[r],--r,l[a]=e[r],u[a]=t[r];f(l,u),f(s,c),a=n/2;var d,p,h,g=6.283185307179586/n;for(r=n-1;-1!==r;--r)--a,-1===a&&(a=n/2-1),d=g*r,p=i(d),h=o(d),e[r]=l[a]+p*s[a]-h*c[a],t[r]=u[a]+p*c[a]+h*s[a]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,n,r){numeric.fftpow2(e,t),numeric.fftpow2(n,r);var a,i,o,l,u,s=e.length;for(a=s-1;-1!==a;--a)i=e[a],l=t[a],o=n[a],u=r[a],e[a]=i*o-l*u,t[a]=i*u+l*o;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){{var e,t,n=this.x,r=this.y,a=n.length,i=Math.log,o=i(2),l=Math.ceil(i(2*a-1)/o),u=Math.pow(2,l),s=numeric.rep([u],0),c=numeric.rep([u],0),d=Math.cos,f=Math.sin,p=-3.141592653589793/a,h=numeric.rep([u],0),g=numeric.rep([u],0);Math.floor(a/2)}for(e=0;a>e;e++)h[e]=n[e];if("undefined"!=typeof r)for(e=0;a>e;e++)g[e]=r[e];for(s[0]=1,e=1;u/2>=e;e++)t=p*e*e,s[e]=d(t),c[e]=f(t),s[u-e]=d(t),c[u-e]=f(t);var v=new numeric.T(h,g),m=new numeric.T(s,c);return v=v.mul(m),numeric.convpow2(v.x,v.y,numeric.clone(m.x),numeric.neg(m.y)),v=v.mul(m),v.x.length=a,v.y.length=a,v},numeric.T.prototype.ifft=function(){{var e,t,n=this.x,r=this.y,a=n.length,i=Math.log,o=i(2),l=Math.ceil(i(2*a-1)/o),u=Math.pow(2,l),s=numeric.rep([u],0),c=numeric.rep([u],0),d=Math.cos,f=Math.sin,p=3.141592653589793/a,h=numeric.rep([u],0),g=numeric.rep([u],0);Math.floor(a/2)}for(e=0;a>e;e++)h[e]=n[e];if("undefined"!=typeof r)for(e=0;a>e;e++)g[e]=r[e];for(s[0]=1,e=1;u/2>=e;e++)t=p*e*e,s[e]=d(t),c[e]=f(t),s[u-e]=d(t),c[u-e]=f(t);var v=new numeric.T(h,g),m=new numeric.T(s,c);return v=v.mul(m),numeric.convpow2(v.x,v.y,numeric.clone(m.x),numeric.neg(m.y)),v=v.mul(m),v.x.length=a,v.y.length=a,v.div(a)},numeric.gradient=function(e,t){var n=t.length,r=e(t);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var a,i,o,l,u,s,c,d,f,p,h=Math.max,g=numeric.clone(t),v=Array(n),h=(numeric.div,numeric.sub,Math.max),m=.001,y=Math.abs,x=Math.min,b=0;for(a=0;n>a;a++)for(var w=h(1e-6*r,1e-8);;){if(++b,b>20)throw new Error("Numerical gradient fails");if(g[a]=t[a]+w,i=e(g),g[a]=t[a]-w,o=e(g),g[a]=t[a],isNaN(i)||isNaN(o))w/=16;else{if(v[a]=(i-o)/(2*w),u=t[a]-w,s=t[a],c=t[a]+w,d=(i-r)/w,f=(r-o)/w,p=h(y(v[a]),y(r),y(i),y(o),y(u),y(s),y(c),1e-8),l=x(h(y(d-v[a]),y(f-v[a]),y(d-f))/p,w/p),!(l>m))break;w/=16}}return v},numeric.uncmin=function(e,t,n,r,a,i,o){var l=numeric.gradient;"undefined"==typeof o&&(o={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof r&&(r=function(t){return l(e,t)}),"undefined"==typeof a&&(a=1e3),t=numeric.clone(t);var u,s,c=t.length,d=e(t);if(isNaN(d))throw new Error("uncmin: f(x0) is a NaN!");var f=Math.max,p=numeric.norm2;n=f(n,numeric.epsilon);var h,g,v,m,y,x,b,w,_,k,M=o.Hinv||numeric.identity(c),A=numeric.dot,z=(numeric.inv,numeric.sub),j=numeric.add,E=numeric.tensor,S=numeric.div,T=numeric.mul,N=numeric.all,O=numeric.isFinite,C=numeric.neg,F=0,q="";for(g=r(t);a>F;){if("function"==typeof i&&i(F,t,d,g,M)){q="Callback returned true";break}if(!N(O(g))){q="Gradient has Infinity or NaN";break}if(h=C(A(M,g)),!N(O(h))){q="Search direction has Infinity or NaN";break}if(k=p(h),n>k){q="Newton step smaller than tol";break}for(_=1,s=A(g,h),y=t;a>F&&!(n>_*k)&&(m=T(h,_),y=j(t,m),u=e(y),u-d>=.1*_*s||isNaN(u));)_*=.5,++F;if(n>_*k){q="Line search step size smaller than tol";break}if(F===a){q="maxit reached during line search";break}v=r(y),x=z(v,g),w=A(x,m),b=A(M,x),M=z(j(M,T((w+A(x,b))/(w*w),E(m,m))),S(j(E(b,m),E(m,b)),w)),t=y,d=u,g=v,++F}return{solution:t,f:d,gradient:g,invHessian:M,iterations:F,message:q}},numeric.Dopri=function(e,t,n,r,a,i,o){this.x=e,this.y=t,this.f=n,this.ymid=r,this.iterations=a,this.events=o,this.message=i},numeric.Dopri.prototype._at=function(e,t){function n(e){return e*e}var r,a,i,o,l,u,e,s,c,d,f,p=this,h=p.x,g=p.y,v=p.f,m=p.ymid,y=(h.length,Math.floor,.5),x=numeric.add,b=numeric.mul,w=numeric.sub;return r=h[t],a=h[t+1],o=g[t],l=g[t+1],s=a-r,i=r+y*s,u=m[t],c=w(v[t],b(o,1/(r-i)+2/(r-a))),d=w(v[t+1],b(l,1/(a-i)+2/(a-r))),f=[n(e-a)*(e-i)/n(r-a)/(r-i),n(e-r)*n(e-a)/n(r-i)/n(a-i),n(e-r)*(e-i)/n(a-r)/(a-i),(e-r)*n(e-a)*(e-i)/n(r-a)/(r-i),(e-a)*n(e-r)*(e-i)/n(r-a)/(a-i)],x(x(x(x(b(o,f[0]),b(u,f[1])),b(l,f[2])),b(c,f[3])),b(d,f[4]))},numeric.Dopri.prototype.at=function(e){var t,n,r,a=Math.floor;if("number"!=typeof e){var i=e.length,o=Array(i);for(t=i-1;-1!==t;--t)o[t]=this.at(e[t]);return o}var l=this.x;for(t=0,n=l.length-1;n-t>1;)r=a(.5*(t+n)),l[r]<=e?t=r:n=r;return this._at(e,t)},numeric.dopri=function(e,t,n,r,a,i,o){"undefined"==typeof a&&(a=1e-6),"undefined"==typeof i&&(i=1e3);var l,u,s,c,d,f,p,h,g,v,m,y,x,b=[e],w=[n],_=[r(e,n)],k=[],M=.2,A=[.075,.225],z=[44/45,-56/15,32/9],j=[19372/6561,-25360/2187,64448/6561,-212/729],E=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],T=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],N=[.2,.3,.8,8/9,1,1],O=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],C=0,F=(t-e)/10,q=0,P=numeric.add,L=numeric.mul,I=(Math.max,Math.min),V=Math.abs,B=numeric.norminf,U=Math.pow,D=numeric.any,R=numeric.lt,H=numeric.and,Y=(numeric.sub,new numeric.Dopri(b,w,_,k,-1,""));for("function"==typeof o&&(m=o(e,n));t>e&&i>q;)if(++q,e+F>t&&(F=t-e),l=r(e+N[0]*F,P(n,L(M*F,_[C]))),u=r(e+N[1]*F,P(P(n,L(A[0]*F,_[C])),L(A[1]*F,l))),s=r(e+N[2]*F,P(P(P(n,L(z[0]*F,_[C])),L(z[1]*F,l)),L(z[2]*F,u))),c=r(e+N[3]*F,P(P(P(P(n,L(j[0]*F,_[C])),L(j[1]*F,l)),L(j[2]*F,u)),L(j[3]*F,s))),d=r(e+N[4]*F,P(P(P(P(P(n,L(E[0]*F,_[C])),L(E[1]*F,l)),L(E[2]*F,u)),L(E[3]*F,s)),L(E[4]*F,c))),g=P(P(P(P(P(n,L(_[C],F*S[0])),L(u,F*S[2])),L(s,F*S[3])),L(c,F*S[4])),L(d,F*S[5])),f=r(e+F,g),p=P(P(P(P(P(L(_[C],F*O[0]),L(u,F*O[2])),L(s,F*O[3])),L(c,F*O[4])),L(d,F*O[5])),L(f,F*O[6])),v="number"==typeof p?V(p):B(p),v>a){if(F=.2*F*U(a/v,.25),e+F===e){Y.msg="Step size became too small";break}}else{if(k[C]=P(P(P(P(P(P(n,L(_[C],F*T[0])),L(u,F*T[2])),L(s,F*T[3])),L(c,F*T[4])),L(d,F*T[5])),L(f,F*T[6])),++C,b[C]=e+F,w[C]=g,_[C]=f,"function"==typeof o){var X,G,Z=e,W=e+.5*F;if(y=o(W,k[C-1]),x=H(R(m,0),R(0,y)),D(x)||(Z=W,W=e+F,m=y,y=o(W,g),x=H(R(m,0),R(0,y))),D(x)){for(var J,Q,$=0,K=1,et=1;;){if("number"==typeof m)G=(et*y*Z-K*m*W)/(et*y-K*m);else for(G=W,h=m.length-1;-1!==h;--h)m[h]<0&&y[h]>0&&(G=I(G,(et*y[h]*Z-K*m[h]*W)/(et*y[h]-K*m[h])));if(Z>=G||G>=W)break;X=Y._at(G,C-1),Q=o(G,X),J=H(R(m,0),R(0,Q)),D(J)?(W=G,y=Q,x=J,et=1,-1===$?K*=.5:K=1,$=-1):(Z=G,m=Q,K=1,1===$?et*=.5:et=1,$=1)}return g=Y._at(.5*(e+G),C-1),Y.f[C]=r(G,X),Y.x[C]=G,Y.y[C]=X,Y.ymid[C-1]=g,Y.events=x,Y.iterations=q,Y}}e+=F,n=g,m=y,F=I(.8*F*U(a/v,.25),4*F)}return Y.iterations=q,Y},numeric.LU=function(e,t){t=t||!1;var n,r,a,i,o,l,u,s,c,d=Math.abs,f=e.length,p=f-1,h=new Array(f);for(t||(e=numeric.clone(e)),a=0;f>a;++a){for(u=a,l=e[a],c=d(l[a]),r=a+1;f>r;++r)i=d(e[r][a]),i>c&&(c=i,u=r);for(h[a]=u,u!=a&&(e[a]=e[u],e[u]=l,l=e[a]),o=l[a],n=a+1;f>n;++n)e[n][a]/=o;for(n=a+1;f>n;++n){for(s=e[n],r=a+1;p>r;++r)s[r]-=s[a]*l[r],++r,s[r]-=s[a]*l[r];r===p&&(s[r]-=s[a]*l[r])}}return{LU:e,P:h}},numeric.LUsolve=function(e,t){var n,r,a,i,o,l=e.LU,u=l.length,s=numeric.clone(t),c=e.P;for(n=u-1;-1!==n;--n)s[n]=t[n];for(n=0;u>n;++n)for(a=c[n],c[n]!==n&&(o=s[n],s[n]=s[a],s[a]=o),i=l[n],r=0;n>r;++r)s[n]-=s[r]*i[r];
for(n=u-1;n>=0;--n){for(i=l[n],r=n+1;u>r;++r)s[n]-=s[r]*i[r];s[n]/=i[n]}return s},numeric.solve=function(e,t,n){return numeric.LUsolve(numeric.LU(e,n),t)},numeric.echelonize=function(e){var t,n,r,a,i,o,l,u,s=numeric.dim(e),c=s[0],d=s[1],f=numeric.identity(c),p=Array(c),h=Math.abs,g=numeric.diveq;for(e=numeric.clone(e),t=0;c>t;++t){for(r=0,i=e[t],o=f[t],n=1;d>n;++n)h(i[r])<h(i[n])&&(r=n);for(p[t]=r,g(o,i[r]),g(i,i[r]),n=0;c>n;++n)if(n!==t){for(l=e[n],u=l[r],a=d-1;-1!==a;--a)l[a]-=i[a]*u;for(l=f[n],a=c-1;-1!==a;--a)l[a]-=o[a]*u}}return{I:f,A:e,P:p}},numeric.__solveLP=function(e,t,n,r,a,i,o){var l,u,s,c,d=numeric.sum,f=(numeric.log,numeric.mul),p=numeric.sub,h=numeric.dot,g=numeric.div,v=numeric.add,m=e.length,y=n.length,x=!1,b=0,w=1,_=(numeric.transpose(t),numeric.svd,numeric.transpose),k=(numeric.leq,Math.sqrt),M=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),z=numeric.all,j=numeric.gt,E=Array(m),S=Array(y),T=(numeric.rep([y],1),numeric.solve),N=p(n,h(t,i)),O=h(e,e);for(s=b;a>s;++s){var C,F;for(C=y-1;-1!==C;--C)S[C]=g(t[C],N[C]);var q=_(S);for(C=m-1;-1!==C;--C)E[C]=d(q[C]);w=.25*M(O/h(e,E));var P=100*k(O/h(E,E));for((!isFinite(w)||w>P)&&(w=P),c=v(e,f(w,E)),u=h(q,S),C=m-1;-1!==C;--C)u[C][C]+=1;F=T(u,g(c,w),!0);var L=g(N,h(t,F)),I=1;for(C=y-1;-1!==C;--C)L[C]<0&&(I=A(I,-.999*L[C]));if(l=p(i,f(F,I)),N=p(n,h(t,l)),!z(j(N,0)))return{solution:i,message:"",iterations:s};if(i=l,r>w)return{solution:l,message:"",iterations:s};if(o){var V=h(e,c),B=h(t,c);for(x=!0,C=y-1;-1!==C;--C)if(V*B[C]<0){x=!1;break}}else x=i[m-1]>=0?!1:!0;if(x)return{solution:l,message:"Unbounded",iterations:s}}return{solution:i,message:"maximum iteration count exceeded",iterations:s}},numeric._solveLP=function(e,t,n,r,a){var i,o=e.length,l=n.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),s=numeric.dot,c=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),d=numeric.rep([l,1],-1),f=numeric.blockMatrix([[t,d]]),p=n,i=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),h=numeric.__solveLP(c,f,p,r,a,i,!1),g=numeric.clone(h.solution);g.length=o;var v=numeric.inf(u(n,s(t,g)));if(0>v)return{solution:0/0,message:"Infeasible",iterations:h.iterations};var m=numeric.__solveLP(e,t,n,r,a-h.iterations,g,!0);return m.iterations+=h.iterations,m},numeric.solveLP=function(e,t,n,r,a,i,o){if("undefined"==typeof o&&(o=1e3),"undefined"==typeof i&&(i=numeric.epsilon),"undefined"==typeof r)return numeric._solveLP(e,t,n,i,o);var l,u=r.length,s=r[0].length,c=t.length,d=numeric.echelonize(r),f=numeric.rep([s],0),p=d.P,h=[];for(l=p.length-1;-1!==l;--l)f[p[l]]=1;for(l=s-1;-1!==l;--l)0===f[l]&&h.push(l);var g=numeric.getRange,v=numeric.linspace(0,u-1),m=numeric.linspace(0,c-1),y=g(r,v,h),x=g(t,m,p),b=g(t,m,h),w=numeric.dot,_=numeric.sub,k=w(x,d.I),M=_(b,w(k,y)),A=_(n,w(k,a)),z=Array(p.length),j=Array(h.length);for(l=p.length-1;-1!==l;--l)z[l]=e[p[l]];for(l=h.length-1;-1!==l;--l)j[l]=e[h[l]];var E=_(j,w(z,w(d.I,y))),S=numeric._solveLP(E,M,A,i,o),T=S.solution;if(T!==T)return S;var N=w(d.I,_(a,w(y,T))),O=Array(e.length);for(l=p.length-1;-1!==l;--l)O[p[l]]=N[l];for(l=h.length-1;-1!==l;--l)O[h[l]]=T[l];return{solution:O,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(e){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+n+": "+e[n]+"\nCurrent state: "+l[o]+"\n")}e instanceof String&&e.split("\n");var n,r,a,i,o=0,l=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=e.length,s=0,c={},d=[],f=0,p={},h=0,g=[],v=[],m=[];for(n=0;u>n;++n){a=e[n];var y=a.match(/\S*/g),x=[];for(r=0;r<y.length;++r)""!==y[r]&&x.push(y[r]);if(0!==x.length){for(r=0;r<l.length&&a.substr(0,l[r].length)!==l[r];++r);if(r<l.length){if(o=r,1===r&&(i=x[1]),6===r)return{name:i,c:g,A:numeric.transpose(v),b:m,rows:c,vars:p}}else switch(o){case 0:case 1:t("Unexpected line");case 2:switch(x[0]){case"N":0===s?s=x[1]:t("Two or more N rows");break;case"L":c[x[1]]=f,d[f]=1,m[f]=0,++f;break;case"G":c[x[1]]=f,d[f]=-1,m[f]=0,++f;break;case"E":c[x[1]]=f,d[f]=0,m[f]=0,++f;break;default:t("Parse error "+numeric.prettyPrint(x))}break;case 3:p.hasOwnProperty(x[0])||(p[x[0]]=h,g[h]=0,v[h]=numeric.rep([f],0),++h);var b=p[x[0]];for(r=1;r<x.length;r+=2)if(x[r]!==s){var w=c[x[r]];v[b][w]=(d[w]<0?-1:1)*parseFloat(x[r+1])}else g[b]=parseFloat(x[r+1]);break;case 4:for(r=1;r<x.length;r+=2)m[c[x[r]]]=(d[c[x[r]]]<0?-1:1)*parseFloat(x[r+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,r,a,i,o){function l(e){var t,r,a=this,i=e.length,o=0,l=a.i=a.j=a.m=0;for(a.S=[],a.c=[],i||(e=[i++]);n>o;)a.S[o]=o++;for(o=0;n>o;o++)t=a.S[o],l=c(l+t+e[o%i]),r=a.S[l],a.S[o]=r,a.S[l]=t;a.g=function(e){var t=a.S,r=c(a.i+1),i=t[r],o=c(a.j+i),l=t[o];t[r]=l,t[o]=i;for(var u=t[c(i+l)];--e;)r=c(r+1),i=t[r],o=c(o+i),l=t[o],t[r]=l,t[o]=i,u=u*n+t[c(i+l)];return a.i=r,a.j=o,u},a.g(n)}function u(e,t,n,r,a){if(n=[],a=typeof e,t&&"object"==a)for(r in e)if(r.indexOf("S")<5)try{n.push(u(e[r],t-1))}catch(i){}return n.length?n:e+("string"!=a?"\x00":"")}function s(e,t,n,r){for(e+="",n=0,r=0;r<e.length;r++)t[c(r)]=c((n^=19*t[c(r)])+e.charCodeAt(r));e="";for(r in t)e+=String.fromCharCode(t[r]);return e}function c(e){return e&n-1}t.seedrandom=function(c,d){var f,p=[];return c=s(u(d?[c,e]:arguments.length?c:[(new Date).getTime(),e,window],3),p),f=new l(p),s(f.S,e),t.random=function(){for(var e=f.g(r),t=o,l=0;a>e;)e=(e+l)*n,t*=n,l=f.g(1);for(;e>=i;)e/=2,t/=2,l>>>=1;return(e+l)/t},c},o=t.pow(n,r),a=t.pow(2,a),i=2*a,s(t.random(),e)}([],numeric.seedrandom,256,6,52),function(e){function t(e){if("object"!=typeof e)return e;var n,r=[],a=e.length;for(n=0;a>n;n++)r[n+1]=t(e[n]);return r}function n(e){if("object"!=typeof e)return e;var t,r=[],a=e.length;for(t=1;a>t;t++)r[t-1]=n(e[t]);return r}function r(e,t,n){var r,a,i,o,l;for(i=1;n>=i;i+=1){for(e[i][i]=1/e[i][i],l=-e[i][i],r=1;i>r;r+=1)e[r][i]=l*e[r][i];if(o=i+1,o>n)break;for(a=o;n>=a;a+=1)for(l=e[i][a],e[i][a]=0,r=1;i>=r;r+=1)e[r][a]=e[r][a]+l*e[r][i]}}function a(e,t,n,r){var a,i,o,l;for(i=1;n>=i;i+=1){for(l=0,a=1;i>a;a+=1)l+=e[a][i]*r[a];r[i]=(r[i]-l)/e[i][i]}for(o=1;n>=o;o+=1)for(i=n+1-o,r[i]=r[i]/e[i][i],l=-r[i],a=1;i>a;a+=1)r[a]=r[a]+l*e[a][i]}function i(e,t,n,r){var a,i,o,l,u,s;for(i=1;n>=i;i+=1){if(r[1]=i,s=0,o=i-1,1>o){if(s=e[i][i]-s,0>=s)break;e[i][i]=Math.sqrt(s)}else{for(l=1;o>=l;l+=1){for(u=e[l][i],a=1;l>a;a+=1)u-=e[a][i]*e[a][l];u/=e[l][l],e[l][i]=u,s+=u*u}if(s=e[i][i]-s,0>=s)break;e[i][i]=Math.sqrt(s)}r[1]=0}}function o(e,t,n,o,l,u,s,c,d,f,p,h,g,v,m,y){function x(){for(v[1]=v[1]+1,z=C,M=1;f>=M;M+=1){for(z+=1,V=-c[M],A=1;o>=A;A+=1)V+=s[A][M]*l[A];if(Math.abs(V)<G&&(V=0),M>p)m[z]=V;else if(m[z]=-Math.abs(V),V>0){for(A=1;o>=A;A+=1)s[A][M]=-s[A][M];c[M]=-c[M]}}for(M=1;g>=M;M+=1)m[C+h[M]]=0;for(q=0,I=0,M=1;f>=M;M+=1)m[C+M]<I*m[L+M]&&(q=M,I=m[C+M]/m[L+M]);return 0===q?999:0}function b(){for(M=1;o>=M;M+=1){for(V=0,A=1;o>=A;A+=1)V+=e[A][M]*s[A][q];m[M]=V}for(j=T,M=1;o>=M;M+=1)m[j+M]=0;for(A=g+1;o>=A;A+=1)for(M=1;o>=M;M+=1)m[j+M]=m[j+M]+e[M][A]*m[A];for(Y=!0,M=g;M>=1;M-=1){for(V=m[M],z=O+M*(M+3)/2,j=z-M,A=M+1;g>=A;A+=1)V-=m[z]*m[N+A],z+=A;if(V/=m[j],m[N+M]=V,h[M]<p)break;if(0>V)break;Y=!1,S=M}if(!Y)for(B=m[F+S]/m[N+S],M=1;g>=M&&!(h[M]<p)&&!(m[N+M]<0);M+=1)I=m[F+M]/m[N+M],B>I&&(B=I,S=M);for(V=0,M=T+1;T+o>=M;M+=1)V+=m[M]*m[M];if(Math.abs(V)<=G){if(Y)return y[1]=1,999;for(M=1;g>=M;M+=1)m[F+M]=m[F+M]-B*m[N+M];return m[F+g+1]=m[F+g+1]+B,700}for(V=0,M=1;o>=M;M+=1)V+=m[T+M]*s[M][q];for(U=-m[C+q]/V,X=!0,Y||U>B&&(U=B,X=!1),M=1;o>=M;M+=1)l[M]=l[M]+U*m[T+M],Math.abs(l[M])<G&&(l[M]=0);for(u[1]=u[1]+U*V*(U/2+m[F+g+1]),M=1;g>=M;M+=1)m[F+M]=m[F+M]-U*m[N+M];if(m[F+g+1]=m[F+g+1]+U,!X){for(V=-c[q],A=1;o>=A;A+=1)V+=l[A]*s[A][q];if(q>p)m[C+q]=V;else if(m[C+q]=-Math.abs(V),V>0){for(A=1;o>=A;A+=1)s[A][q]=-s[A][q];c[q]=-c[q]}return 700}for(g+=1,h[g]=q,z=O+(g-1)*g/2+1,M=1;g-1>=M;M+=1)m[z]=m[M],z+=1;if(g===o)m[z]=m[o];else{for(M=o;M>=g+1&&0!==m[M]&&(D=Math.max(Math.abs(m[M-1]),Math.abs(m[M])),R=Math.min(Math.abs(m[M-1]),Math.abs(m[M])),I=m[M-1]>=0?Math.abs(D*Math.sqrt(1+R*R/(D*D))):-Math.abs(D*Math.sqrt(1+R*R/(D*D))),D=m[M-1]/I,R=m[M]/I,1!==D);M-=1)if(0===D)for(m[M-1]=R*I,A=1;o>=A;A+=1)I=e[A][M-1],e[A][M-1]=e[A][M],e[A][M]=I;else for(m[M-1]=I,H=R/(1+D),A=1;o>=A;A+=1)I=D*e[A][M-1]+R*e[A][M],e[A][M]=H*(e[A][M-1]+I)-e[A][M],e[A][M-1]=I;m[z]=m[g]}return 0}function w(){if(z=O+S*(S+1)/2+1,j=z+S,0===m[j])return 798;if(D=Math.max(Math.abs(m[j-1]),Math.abs(m[j])),R=Math.min(Math.abs(m[j-1]),Math.abs(m[j])),I=m[j-1]>=0?Math.abs(D*Math.sqrt(1+R*R/(D*D))):-Math.abs(D*Math.sqrt(1+R*R/(D*D))),D=m[j-1]/I,R=m[j]/I,1===D)return 798;if(0===D){for(M=S+1;g>=M;M+=1)I=m[j-1],m[j-1]=m[j],m[j]=I,j+=M;for(M=1;o>=M;M+=1)I=e[M][S],e[M][S]=e[M][S+1],e[M][S+1]=I}else{for(H=R/(1+D),M=S+1;g>=M;M+=1)I=D*m[j-1]+R*m[j],m[j]=H*(m[j-1]+I)-m[j],m[j-1]=I,j+=M;for(M=1;o>=M;M+=1)I=D*e[M][S]+R*e[M][S+1],e[M][S+1]=H*(e[M][S]+I)-e[M][S+1],e[M][S]=I}return 0}function _(){for(j=z-S,M=1;S>=M;M+=1)m[j]=m[z],z+=1,j+=1;return m[F+S]=m[F+S+1],h[S]=h[S+1],S+=1,g>S?797:0}function k(){return m[F+g]=m[F+g+1],m[F+g+1]=0,h[g]=0,g-=1,v[2]=v[2]+1,0}var M,A,z,j,E,S,T,N,O,C,F,q,P,L,I,V,B,U,D,R,H,Y,X,G,Z,W,J;P=Math.min(o,f),z=2*o+P*(P+5)/2+2*f+1,G=1e-60;do G+=G,Z=1+.1*G,W=1+.2*G;while(1>=Z||1>=W);for(M=1;o>=M;M+=1)m[M]=t[M];for(M=o+1;z>=M;M+=1)m[M]=0;for(M=1;f>=M;M+=1)h[M]=0;if(E=[],0===y[1]){if(i(e,n,o,E),0!==E[1])return void(y[1]=2);a(e,n,o,t),r(e,n,o)}else{for(A=1;o>=A;A+=1)for(l[A]=0,M=1;A>=M;M+=1)l[A]=l[A]+e[M][A]*t[M];for(A=1;o>=A;A+=1)for(t[A]=0,M=A;o>=M;M+=1)t[A]=t[A]+e[A][M]*l[M]}for(u[1]=0,A=1;o>=A;A+=1)for(l[A]=t[A],u[1]=u[1]+m[A]*l[A],m[A]=0,M=A+1;o>=M;M+=1)e[M][A]=0;for(u[1]=-u[1]/2,y[1]=0,T=o,N=T+o,F=N+P,O=F+P+1,C=O+P*(P+1)/2,L=C+f,M=1;f>=M;M+=1){for(V=0,A=1;o>=A;A+=1)V+=s[A][M]*s[A][M];m[L+M]=Math.sqrt(V)}for(g=0,v[1]=0,v[2]=0,J=0;;){if(J=x(),999===J)return;for(;;){if(J=b(),0===J)break;if(999===J)return;if(700===J)if(S===g)k();else{for(;;)if(w(),J=_(),797!==J)break;k()}}}}function l(e,r,a,i,l,u){e=t(e),r=t(r),a=t(a);var s,c,d,f,p,h,g=[],v=[],m=[],y=[],x=[];if(l=l||0,u=u?t(u):[void 0,0],i=i?t(i):[],c=e.length-1,d=a[1].length-1,!i)for(s=1;d>=s;s+=1)i[s]=0;for(s=1;d>=s;s+=1)v[s]=0;for(f=0,p=Math.min(c,d),s=1;c>=s;s+=1)m[s]=0;for(g[1]=0,s=1;2*c+p*(p+5)/2+2*d+1>=s;s+=1)y[s]=0;for(s=1;2>=s;s+=1)x[s]=0;return o(e,r,c,c,m,g,a,i,c,d,l,v,f,x,y,u),h="",1===u[1]&&(h="constraints are inconsistent, no solution!"),2===u[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:n(m),value:n(g),unconstrained_solution:n(r),iterations:n(x),iact:n(v),message:h}}e.solveQP=l}(numeric),numeric.svd=function(e){function t(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var n,r=numeric.epsilon,a=1e-64/r,i=50,o=0,l=0,u=0,s=0,c=0,d=numeric.clone(e),f=d.length,p=d[0].length;if(p>f)throw"Need more rows than columns";var h=new Array(p),g=new Array(p);for(l=0;p>l;l++)h[l]=g[l]=0;var v=numeric.rep([p,p],0),m=0,y=0,x=0,b=0,w=0,_=0,k=0;for(l=0;p>l;l++){for(h[l]=y,k=0,c=l+1,u=l;f>u;u++)k+=d[u][l]*d[u][l];if(a>=k)y=0;else for(m=d[l][l],y=Math.sqrt(k),m>=0&&(y=-y),x=m*y-k,d[l][l]=m-y,u=c;p>u;u++){for(k=0,s=l;f>s;s++)k+=d[s][l]*d[s][u];for(m=k/x,s=l;f>s;s++)d[s][u]+=m*d[s][l]}for(g[l]=y,k=0,u=c;p>u;u++)k+=d[l][u]*d[l][u];if(a>=k)y=0;else{for(m=d[l][l+1],y=Math.sqrt(k),m>=0&&(y=-y),x=m*y-k,d[l][l+1]=m-y,u=c;p>u;u++)h[u]=d[l][u]/x;for(u=c;f>u;u++){for(k=0,s=c;p>s;s++)k+=d[u][s]*d[l][s];for(s=c;p>s;s++)d[u][s]+=k*h[s]}}w=Math.abs(g[l])+Math.abs(h[l]),w>b&&(b=w)}for(l=p-1;-1!=l;l+=-1){if(0!=y){for(x=y*d[l][l+1],u=c;p>u;u++)v[u][l]=d[l][u]/x;for(u=c;p>u;u++){for(k=0,s=c;p>s;s++)k+=d[l][s]*v[s][u];for(s=c;p>s;s++)v[s][u]+=k*v[s][l]}}for(u=c;p>u;u++)v[l][u]=0,v[u][l]=0;v[l][l]=1,y=h[l],c=l}for(l=p-1;-1!=l;l+=-1){for(c=l+1,y=g[l],u=c;p>u;u++)d[l][u]=0;if(0!=y){for(x=d[l][l]*y,u=c;p>u;u++){for(k=0,s=c;f>s;s++)k+=d[s][l]*d[s][u];for(m=k/x,s=l;f>s;s++)d[s][u]+=m*d[s][l]}for(u=l;f>u;u++)d[u][l]=d[u][l]/y}else for(u=l;f>u;u++)d[u][l]=0;d[l][l]+=1}for(r*=b,s=p-1;-1!=s;s+=-1)for(var M=0;i>M;M++){var A=!1;for(c=s;-1!=c;c+=-1){if(Math.abs(h[c])<=r){A=!0;break}if(Math.abs(g[c-1])<=r)break}if(!A){o=0,k=1;var z=c-1;for(l=c;s+1>l&&(m=k*h[l],h[l]=o*h[l],!(Math.abs(m)<=r));l++)for(y=g[l],x=t(m,y),g[l]=x,o=y/x,k=-m/x,u=0;f>u;u++)w=d[u][z],_=d[u][l],d[u][z]=w*o+_*k,d[u][l]=-w*k+_*o}if(_=g[s],c==s){if(0>_)for(g[s]=-_,u=0;p>u;u++)v[u][s]=-v[u][s];break}if(M>=i-1)throw"Error: no convergence.";for(b=g[c],w=g[s-1],y=h[s-1],x=h[s],m=((w-_)*(w+_)+(y-x)*(y+x))/(2*x*w),y=t(m,1),m=0>m?((b-_)*(b+_)+x*(w/(m-y)-x))/b:((b-_)*(b+_)+x*(w/(m+y)-x))/b,o=1,k=1,l=c+1;s+1>l;l++){for(y=h[l],w=g[l],x=k*y,y=o*y,_=t(m,x),h[l-1]=_,o=m/_,k=x/_,m=b*o+y*k,y=-b*k+y*o,x=w*k,w*=o,u=0;p>u;u++)b=v[u][l-1],_=v[u][l],v[u][l-1]=b*o+_*k,v[u][l]=-b*k+_*o;for(_=t(m,x),g[l-1]=_,o=m/_,k=x/_,m=o*y+k*w,b=-k*y+o*w,u=0;f>u;u++)w=d[u][l-1],_=d[u][l],d[u][l-1]=w*o+_*k,d[u][l]=-w*k+_*o}h[c]=0,h[s]=m,g[s]=b}for(l=0;l<g.length;l++)g[l]<r&&(g[l]=0);for(l=0;p>l;l++)for(u=l-1;u>=0;u--)if(g[u]<g[l]){for(o=g[u],g[u]=g[l],g[l]=o,s=0;s<d.length;s++)n=d[s][l],d[s][l]=d[s][u],d[s][u]=n;for(s=0;s<v.length;s++)n=v[s][l],v[s][l]=v[s][u],v[s][u]=n;l=u}return{U:d,S:g,V:v}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t){!function(){"use strict";function e(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function n(e,t,n){var r=t.x,a=t.y,i=n.x-r,o=n.y-a;if(0!==i||0!==o){var l=((e.x-r)*i+(e.y-a)*o)/(i*i+o*o);l>1?(r=n.x,a=n.y):l>0&&(r+=i*l,a+=o*l)}return i=e.x-r,o=e.y-a,i*i+o*o}function r(t,n){for(var r,a=t[0],i=[a],o=1,l=t.length;l>o;o++)r=t[o],e(r,a)>n&&(i.push(r),a=r);return a!==r&&i.push(r),i}function a(e,t){var r,a,i,o,l=e.length,u="undefined"!=typeof Uint8Array?Uint8Array:Array,s=new u(l),c=0,d=l-1,f=[],p=[];for(s[c]=s[d]=1;d;){for(a=0,r=c+1;d>r;r++)i=n(e[r],e[c],e[d]),i>a&&(o=r,a=i);a>t&&(s[o]=1,f.push(c,o,o,d)),d=f.pop(),c=f.pop()}for(r=0;l>r;r++)s[r]&&p.push(e[r]);return p}function i(e,t,n){var i=void 0!==t?t*t:1;return e=n?e:r(e,i),e=a(e,i)}"function"==typeof define&&define.amd?define(function(){return i}):"undefined"!=typeof t?t.exports=i:"undefined"!=typeof self?self.simplify=i:window.simplify=i}()},{}],9:[function(e,t){"use strict";function n(e,t,n,r){this.points=e,this.ids=t,this.dimension=r,this.length=n}function r(e){var t,r,a;if(Array.isArray(e)){if(t=e.length,0===t)return new n(null,null,0,0);r=e[0].length,a=i(c.mallocDouble(t*(r+1)),[t,r+1]),l(e,a.hi(t,r))}else{t=e.shape[0],r=e.shape[1];var p=e.dtype;p="int8"===p||"int16"===p||"int32"===p?"int32":"uint8"===p||"uint8_clamped"===p||"buffer"===p||"uint16"===p||"uint32"===p?"uint32":"float32"===p?"float32":"float64",a=i(c.malloc(t*(r+1)),[t,r+1]),u.assign(a.hi(t,r),e)}for(var h=0;t>h;++h)a.set(h,r,h);for(var g=s.malloc([t,r],e.dtype),v=c.mallocInt32(t),m=0,y=g.data,x=a.data,b=(f.log2(f.nextPow2(t)),o.compile(a.order,!0,a.dtype)),w=[a];t>m;){var _=w.shift(),k=_,M=0|k.shape[0];if(M>1){var A,z=f.log2(m+1)%r,j=d.root(M);A=b(k,j,function(e,t){return e.get(z)-t.get(z)});for(var E=g.index(m,0),S=A.offset,h=0;r>h;++h)y[E++]=x[S++];v[m]=x[S],m+=1,w.push(k.hi(j)),M>2&&w.push(k.lo(j+1))}else{for(var S=k.offset,E=g.index(m,0),h=0;r>h;++h)y[E+h]=x[S++];v[m]=x[S],m+=1}}return c.free(a.data),new n(g,v,t,r)}function a(e){var t=e.p,r=e.i;if(t){for(var a=t.length,o=c.mallocFloat64(a),l=0;a>l;++l)o[l]=t[l];for(var u=r.length,s=c.mallocInt32(u),l=0;u>l;++l)s[l]=r[l];var d=a/u|0;return new n(i(o,[u,d]),s,u,d)}return new n(null,null,0,e.d)}t.exports=r,t.exports.deserialize=a;var i=e("ndarray"),o=e("ndarray-select"),l=e("ndarray-pack"),u=e("ndarray-ops"),s=e("ndarray-scratch"),c=e("typedarray-pool"),d=e("inorder-tree-layout"),f=e("bit-twiddle"),p=e("./lib/heap.js"),h=n.prototype;h.serialize=function(){return this.length>0?{p:Array.prototype.slice.call(this.points.data,0,this.length*this.dimension),i:Array.prototype.slice.call(this.ids,0,this.length)}:{d:this.dimension}},h.range=function(e,t,n){var r=this.length;if(!(1>r)){for(var a=this.dimension,i=0;a>i;++i)if(t[i]<e[i])return;var o,u=this.points,d=this.ids,p=s.malloc([r,2,a]),h=c.mallocInt32(r),g=p.data,v=u.data,m=1,y=0;for(h[0]=0,l(e,p.pick(0,0)),l(t,p.pick(0,1));m>y;){for(var x=h[y],b=f.log2(x+1)%a,w=p.index(y,0,0),_=p.index(y,1,0),k=u.index(x,0),M=!0,i=0;a>i;++i){var A=v[k+i];if(A<g[w+i]||g[_+i]<A){M=!1;break}}if(M&&(o=n(d[x]),void 0!==o))break;var z=v[k+b],j=g[_+b],E=g[w+b];if(z>=E){var S=2*x+1;if(r>S){h[m]=S;for(var T=p.index(m,0,0),i=0;a>i;++i)g[T+i]=g[w+i];for(var N=p.index(m,1,0),i=0;a>i;++i)g[N+i]=g[_+i];g[N+b]=Math.min(j,z),m+=1}}if(j>=z){var O=2*(x+1);if(r>O){h[m]=O;for(var T=p.index(m,0,0),i=0;a>i;++i)g[T+i]=g[w+i];for(var N=p.index(m,1,0),i=0;a>i;++i)g[N+i]=g[_+i];g[T+b]=Math.max(E,z),m+=1}}y+=1}return s.free(p),c.free(h),o}},h.rnn=function(e,t,n){if(!(0>t)){var r=this.length;if(!(1>r)){var a,i=this.dimension,o=this.points,l=this.ids,u=s.malloc([r,i]),d=c.mallocInt32(r),p=u.data,h=o.data,g=1,v=0,m=t*t;d[0]=0;for(var y=0;i>y;++y)u.set(0,y,0);for(;g>v;){for(var x=d[v],b=o.index(x,0),w=0,y=0;i>y;++y)w+=Math.pow(e[y]-h[b+y],2);if(m>=w&&(a=n(l[x]),void 0!==a))break;for(var _=f.log2(x+1)%i,k=0,M=u.index(v,0),y=0;i>y;++y)y!==_&&(k+=p[M+y]);var A=e[_],z=h[b+_],j=p[M+_],E=j,S=j;z>A?S=Math.max(j,Math.pow(z-A,2)):E=Math.max(j,Math.pow(z-A,2));var T=E+k,N=S+k;if(m>=T){var O=2*x+1;if(r>O){d[g]=O;for(var C=u.index(g,0),y=0;i>y;++y)p[C+y]=p[M+y];p[C+_]=E,g+=1}}if(m>=N){var F=2*(x+1);if(r>F){d[g]=F;for(var C=u.index(g,0),y=0;i>y;++y)p[C+y]=p[M+y];p[C+_]=S,g+=1}}v+=1}return s.free(u),c.free(d),a}}},h.nn=function(e,t){var n=this.length;if(1>n)return-1;if("number"==typeof t){if(0>t)return-1}else t=1/0;var r=this.dimension,a=this.points,i=a.data,o=c.mallocFloat64(r),l=new p(n,r+1),u=l.index,s=l.data;u[0]=0;for(var d=0;r>=d;++d)s[d]=0;l.count+=1;for(var h=-1,g=t;l.count>0&&!(s[0]>=g);){for(var v=u[0],m=a.index(v,0),y=0,d=0;r>d;++d)y+=Math.pow(e[d]-i[m+d],2);g>y&&(g=y,h=v);for(var x=f.log2(v+1)%r,b=0,d=0;r>d;++d){var w=s[d+1];d!==x&&(b+=w),o[d]=w}var _=e[x],k=i[m+x],M=o[x],A=M,z=M;k>_?z=Math.max(M,Math.pow(k-_,2)):A=Math.max(M,Math.pow(k-_,2));var j=A+b,E=z+b;if(l.pop(),g>j){var S=2*v+1;if(n>S){var T=l.count;u[T]=S;var N=T*(r+1);s[N]=j;for(var d=1;r>=d;++d)s[N+d]=o[d-1];s[N+x+1]=A,l.push()}}if(g>E){var O=2*(v+1);if(n>O){var T=l.count;u[T]=O;var N=T*(r+1);s[N]=E;for(var d=1;r>=d;++d)s[N+d]=o[d-1];s[N+x+1]=z,l.push()}}}return c.freeFloat64(o),l.dispose(),0>h?-1:this.ids[h]},h.knn=function(e,t,n){if("number"==typeof n){if(0>n)return[]}else n=1/0;var r=this.length;if(1>r)return[];if("number"==typeof t){if(0>=t)return[];t=0|Math.min(t,r)}else t=r;var a=this.ids,i=this.dimension,o=this.points,l=o.data,u=c.mallocFloat64(i),s=new p(t,1),d=s.index,h=s.data,g=new p(r,i+1),v=g.index,m=g.data;v[0]=0;for(var y=0;i>=y;++y)m[y]=0;g.count+=1;for(var x=n;g.count>0&&!(m[0]>=x);){for(var b=v[0],w=o.index(b,0),_=0,y=0;i>y;++y)_+=Math.pow(e[y]-l[w+y],2);if(x>_){s.count>=t&&s.pop();var k=s.count;d[k]=b,h[k]=-_,s.push(),s.count>=t&&(x=-h[0])}for(var M=f.log2(b+1)%i,A=0,y=0;i>y;++y){var z=m[y+1];y!==M&&(A+=z),u[y]=z}var j=e[M],E=l[w+M],S=u[M],T=S,N=S;E>j?N=Math.max(S,Math.pow(E-j,2)):T=Math.max(S,Math.pow(E-j,2));var O=T+A,C=N+A;if(g.pop(),x>O){var F=2*b+1;if(r>F){var q=g.count;v[q]=F;var P=q*(i+1);m[P]=O;for(var y=1;i>=y;++y)m[P+y]=u[y-1];m[P+M+1]=T,g.push()}}if(x>C){var L=2*(b+1);if(r>L){var q=g.count;v[q]=L;var P=q*(i+1);m[P]=C;for(var y=1;i>=y;++y)m[P+y]=u[y-1];m[P+M+1]=N,g.push()}}}c.freeFloat64(u),g.dispose();for(var I=new Array(s.count),a=this.ids,y=s.count-1;y>=0;--y)I[y]=a[d[0]],s.pop();return s.dispose(),I},h.dispose=function(){c.free(this.points.data),c.freeInt32(this.ids),this.points=null,this.ids=null,this.length=0}},{"./lib/heap.js":10,"bit-twiddle":11,"inorder-tree-layout":12,ndarray:27,"ndarray-ops":14,"ndarray-pack":19,"ndarray-scratch":25,"ndarray-select":26,"typedarray-pool":30}],10:[function(e,t){"use strict";function n(e){return 1&e?e-1>>1:(e>>1)-1}function r(e,t){this.count=0,this.dataSize=t,this.index=a.mallocInt32(e),this.data=a.mallocFloat64(e*t)}t.exports=r;var a=e("typedarray-pool"),i=r.prototype;i.heapSwap=function(e,t){var n=this.data,r=this.index,a=this.dataSize,i=r[e];r[e]=r[t],r[t]=i;for(var o=a*e,l=a*t,u=0;a>u;++u){var s=n[o];n[o]=n[l],n[l]=s,o+=1,l+=1}},i.heapUp=function(e){for(var t=this.dataSize,r=(this.index,this.data),a=r[t*e];e>0;){var i=n(e);if(i>=0){var o=r[t*i];if(o>a){this.heapSwap(e,i),e=i;continue}}break}},i.heapDown=function(e){for(var t=this.dataSize,n=(this.index,this.data),r=this.count,a=n[t*e];;){var i=a,o=2*e+1,l=2*(e+1),u=e;if(r>o){var s=n[t*o];i>s&&(u=o,i=s)}if(r>l){var c=n[t*l];i>c&&(u=l)}if(u===e)break;this.heapSwap(e,u),e=u}},i.pop=function(){this.count-=1,this.heapSwap(0,this.count),this.heapDown(0)},i.push=function(){this.heapUp(this.count),this.count+=1},i.dispose=function(){a.freeInt32(this.index),a.freeFloat64(this.data)}},{"typedarray-pool":30}],11:[function(e,t,n){"use strict";"use restrict";function r(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}var a=32;n.INT_BITS=a,n.INT_MAX=2147483647,n.INT_MIN=-1<<a-1,n.sign=function(e){return(e>0)-(0>e)},n.abs=function(e){var t=e>>a-1;return(e^t)-t},n.min=function(e,t){return t^(e^t)&-(t>e)},n.max=function(e,t){return e^(e^t)&-(t>e)},n.isPow2=function(e){return!(e&e-1||!e)},n.log2=function(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1},n.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},n.popCount=function(e){return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24},n.countTrailingZeros=r,n.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},n.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},n.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,27030>>>e&1};var i=new Array(256);!function(e){for(var t=0;256>t;++t){var n=t,r=t,a=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--a;e[t]=r<<a&255}}(i),n.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},n.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},n.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},n.interleave3=function(e,t,n){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),e|n<<2},n.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},n.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},{}],12:[function(e,t,n){"use strict";function r(e){var t=(g.nextPow2(e+1)>>>1)-1,n=e-t;return g.nextPow2(n)-1>=t?t:(t>>>1)+n}function a(){return 0}function i(e){return e-1}function o(e,t){if(0>=e)return 0;var n=r(e);return t>n?o(e-n-1,t-n-1):t===n?g.log2(e):o(n,t)}function l(e,t){return Math.max(t-1,0)}function u(e,t){return Math.min(t+1,e-1)}function s(e,t){if(0>=e)return-1;var n=r(e);if(t>n){var a=s(e-n-1,t-n-1);return 0>a?n:a+n+1}if(t===n)return-1;var a=s(n,t);return 0>a?n:a}function c(e,t){if(0>=e)return 0;var n=r(e);return t>n?c(e-n-1,t-n-1)+n+1:t===n?r(t):c(n,t)}function d(e,t){if(0>=e)return 0;var n=r(e);return t>n?d(e-n-1,t-n-1)+n+1:t===n?r(e-n-1)+n+1:d(n,t)}function f(e,t){return 0===o(e,t)}function p(e,t){e|=0,t|=0;for(var n=0;e>1;){var a=r(e);if(t>a)n+=a+1,e-=a+1,t-=a+1;else{if(t===a)break;e=a}}return n}function h(e,t){e|=0,t|=0;for(var n=0;e>1;){var a=r(e);if(t>a)n+=a+1,e-=a+1,t-=a+1;else{if(t===a){n+=e-1;break}e=a}}return n}var g=e("bit-twiddle");n.root=r,n.begin=a,n.end=i,n.height=o,n.prev=l,n.next=u,n.parent=s,n.left=c,n.right=d,n.leaf=f,n.lo=p,n.hi=h},{"bit-twiddle":13}],13:[function(e,t){t.exports=e(11)},{}],14:[function(e,t,n){"use strict";function r(e){if(!e)return l;for(var t=0;t<e.args.length;++t){var n=e.args[t];e.args[t]=0===t?{name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function a(e){return o({args:e.args,pre:r(e.pre),body:r(e.body),post:r(e.proc),funcName:e.funcName})}function i(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);var r=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return r(a(e))}var o=e("cwise-compiler"),l={body:"",args:[],thisVars:[],localVars:[]},u={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in u){var t=u[e];n[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),n[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}}();var s={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in s){var t=s[e];n[e]=i({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),n[e+"eq"]=i({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in c){var t=c[e];n[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),n[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var d=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<d.length;++e){var t=d[e];n[t]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),n[t+"eq"]=i({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var f=["max","min","atan2","pow"];!function(){for(var e=0;e<f.length;++e){var t=f[e];n[t]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),n[t+"s"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),n[t+"eq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),n[t+"seq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var p=["atan2","pow"];!function(){for(var e=0;e<p.length;++e){var t=p[e];n[t+"op"]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),n[t+"ops"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),n[t+"opeq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),n[t+"opseq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),n.any=o({args:["array"],pre:l,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),n.all=o({args:["array"],pre:l,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),n.sum=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),n.prod=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),n.norm2squared=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),n.norm2=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),n.norminf=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),n.norm1=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),n.sup=o({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.inf=o({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.argmin=o({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.argmax=o({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.random=i({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),n.assign=i({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),n.assigns=i({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),n.equals=o({args:["array","array"],pre:l,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})
},{"cwise-compiler":15}],15:[function(e,t){"use strict";function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function r(e){var t=new n;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var i=0;i<r.length;++i){var o=r[i];if("array"===o){if(t.arrayArgs.push(i),t.shimArgs.push("array"+i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(i),t.shimArgs.push("scalar"+i);else if("index"===o){if(t.indexArgs.push(i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(i),i<t.pre.args.length&&t.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<t.post.args.length&&t.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+r[i]);t.argTypes[i]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(i)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,a(t)}var a=e("./lib/thunk.js");t.exports=r},{"./lib/thunk.js":17}],16:[function(e,t){"use strict";function n(e,t,n){var r,a,i=e.length,o=t.arrayArgs.length,l=t.indexArgs.length>0,u=[],s=[],c=0,d=0;for(r=0;i>r;++r)s.push(["i",r,"=0"].join(""));for(a=0;o>a;++a)for(r=0;i>r;++r)d=c,c=e[r],s.push(0===r?["d",a,"s",r,"=t",a,"p",c].join(""):["d",a,"s",r,"=(t",a,"p",c,"-s",d,"*t",a,"p",d,")"].join(""));for(u.push("var "+s.join(",")),r=i-1;r>=0;--r)c=e[r],u.push(["for(i",r,"=0;i",r,"<s",c,";++i",r,"){"].join(""));for(u.push(n),r=0;i>r;++r){for(d=c,c=e[r],a=0;o>a;++a)u.push(["p",a,"+=d",a,"s",r].join(""));l&&(r>0&&u.push(["index[",d,"]-=s",d].join("")),u.push(["++index[",c,"]"].join(""))),u.push("}")}return u.join("\n")}function r(e,t,r,a){for(var i=t.length,o=r.arrayArgs.length,l=r.blockSize,u=r.indexArgs.length>0,s=[],c=0;o>c;++c)s.push(["var offset",c,"=p",c].join(""));for(var c=e;i>c;++c)s.push(["for(var j"+c+"=SS[",t[c],"]|0;j",c,">0;){"].join("")),s.push(["if(j",c,"<",l,"){"].join("")),s.push(["s",t[c],"=j",c].join("")),s.push(["j",c,"=0"].join("")),s.push(["}else{s",t[c],"=",l].join("")),s.push(["j",c,"-=",l,"}"].join("")),u&&s.push(["index[",t[c],"]=j",c].join(""));for(var c=0;o>c;++c){for(var d=["offset"+c],f=e;i>f;++f)d.push(["j",f,"*t",c,"p",t[f]].join(""));s.push(["p",c,"=(",d.join("+"),")"].join(""))}s.push(n(t,r,a));for(var c=e;i>c;++c)s.push("}");return s.join("\n")}function a(e){for(var t=0,n=e[0].length;n>t;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function i(e,t,n){for(var r=e.body,a=[],i=[],o=0;o<e.args.length;++o){var l=e.args[o];if(!(l.count<=0)){var u=new RegExp(l.name,"g"),s="",c=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var d=t.offsetArgIndex.indexOf(o),f=t.offsetArgs[d];c=f.array,s="+q"+d;case"array":s="p"+c+s;var p="l"+o,h="a"+c;1===l.count?"generic"===n[c]?l.lvalue?(a.push(["var ",p,"=",h,".get(",s,")"].join("")),r=r.replace(u,p),i.push([h,".set(",s,",",p,")"].join(""))):r=r.replace(u,[h,".get(",s,")"].join("")):r=r.replace(u,[h,"[",s,"]"].join("")):"generic"===n[c]?(a.push(["var ",p,"=",h,".get(",s,")"].join("")),r=r.replace(u,p),l.lvalue&&i.push([h,".set(",s,",",p,")"].join(""))):(a.push(["var ",p,"=",h,"[",s,"]"].join("")),r=r.replace(u,p),l.lvalue&&i.push([h,"[",s,"]=",p].join("")));break;case"scalar":r=r.replace(u,"Y"+t.scalarArgs.indexOf(o));break;case"index":r=r.replace(u,"index");break;case"shape":r=r.replace(u,"shape")}}}return[a.join("\n"),r,i.join("\n")].join("\n").trim()}function o(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var a=e[r],i=a.match(/\d+/);i=i?i[0]:"",t[r]=0===a.charAt(0)?"u"+a.charAt(1)+i:a.charAt(0)+i,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function l(e,t){for(var l=0|t[1].length,s=new Array(e.arrayArgs.length),c=new Array(e.arrayArgs.length),d=["SS"],f=["'use strict'"],p=[],h=0;l>h;++h)p.push(["s",h,"=SS[",h,"]"].join(""));for(var g=0;g<e.arrayArgs.length;++g){d.push("a"+g),d.push("t"+g),d.push("p"+g),c[g]=t[2*g],s[g]=t[2*g+1];for(var h=0;l>h;++h)p.push(["t",g,"p",h,"=t",g,"[",h,"]"].join(""))}for(var g=0;g<e.scalarArgs.length;++g)d.push("Y"+g);if(e.shapeArgs.length>0&&p.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var v=new Array(l),g=0;l>g;++g)v[g]="0";p.push(["index=[",v.join(","),"]"].join(""))}for(var g=0;g<e.offsetArgs.length;++g){for(var m=e.offsetArgs[g],y=[],h=0;h<m.offset.length;++h)0!==m.offset[h]&&y.push(1===m.offset[h]?["t",m.array,"p",h].join(""):[m.offset[h],"*t",m.array,"p",h].join(""));p.push(0===y.length?"q"+g+"=0":["q",g,"=",y.join("+")].join(""))}var x=u([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));p=p.concat(x),f.push("var "+p.join(","));for(var g=0;g<e.arrayArgs.length;++g)f.push("p"+g+"|=0");e.pre.body.length>3&&f.push(i(e.pre,e,c));var b=i(e.body,e,c),w=a(s);f.push(l>w?r(w,s[0],e,b):n(s[0],e,b)),e.post.body.length>3&&f.push(i(e.post,e,c)),e.debug&&console.log("Generated cwise routine for ",t,":\n\n",f.join("\n"));var _=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",w,o(c)].join(""),k=new Function(["function ",_,"(",d.join(","),"){",f.join("\n"),"} return ",_].join(""));return k()}var u=e("uniq");t.exports=l},{uniq:18}],17:[function(e,t){"use strict";function n(e){var t=["'use strict'","var CACHED={}"],n=[],a=e.funcName+"_cwise_thunk";t.push(["return function ",a,"(",e.shimArgs.join(","),"){"].join(""));for(var i=[],o=[],l=[["array",e.arrayArgs[0],".shape"].join("")],u=0;u<e.arrayArgs.length;++u){var s=e.arrayArgs[u];n.push(["t",s,"=array",s,".dtype,","r",s,"=array",s,".order"].join("")),i.push("t"+s),i.push("r"+s),o.push("t"+s),o.push("r"+s+".join()"),l.push("array"+s+".data"),l.push("array"+s+".stride"),l.push("array"+s+".offset|0")}for(var u=0;u<e.scalarArgs.length;++u)l.push("scalar"+e.scalarArgs[u]);n.push(["type=[",o.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",l.join(","),")}"].join("")),e.debug&&console.log("Generated thunk:",t.join("\n"));var c=new Function("compile",t.join("\n"));return c(r.bind(void 0,e))}var r=e("./compile.js");t.exports=n},{"./compile.js":16}],18:[function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,a=e[0],i=e[0],o=1;r>o;++o)if(i=a,a=e[o],t(a,i)){if(o===n){n++;continue}e[n++]=a}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],a=e[0],i=1;n>i;++i,a=r)if(a=r,r=e[i],r!==a){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}function a(e,t,a){return 0===e.length?e:t?(a||e.sort(t),n(e,t)):(a||e.sort(),r(e))}t.exports=a},{}],19:[function(e,t){"use strict";var n=e("ndarray"),r=e("./doConvert.js");t.exports=function(e,t){for(var a=[],i=e,o=1;i instanceof Array;)a.push(i.length),o*=i.length,i=i[0];return 0===a.length?n():(t||(t=n(new Float64Array(o),a)),r(t,e),t)}},{"./doConvert.js":20,ndarray:27}],20:[function(e,t){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":21}],21:[function(e,t){"use strict";function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function r(e){var t=new n;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r.slice(0);for(var i=0;i<r.length;++i){var o=r[i];if("array"===o){if(t.arrayArgs.push(i),t.shimArgs.push("array"+i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(i),t.shimArgs.push("scalar"+i);else if("index"===o){if(t.indexArgs.push(i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(i),i<t.pre.args.length&&t.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<t.post.args.length&&t.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+r[i]);t.argTypes[i]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(i)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,a(t)}var a=e("./lib/thunk.js");t.exports=r},{"./lib/thunk.js":23}],22:[function(e,t){"use strict";function n(e,t,n){var r,a,i=e.length,o=t.arrayArgs.length,l=t.indexArgs.length>0,u=[],s=[],c=0,d=0;for(r=0;i>r;++r)s.push(["i",r,"=0"].join(""));for(a=0;o>a;++a)for(r=0;i>r;++r)d=c,c=e[r],s.push(0===r?["d",a,"s",r,"=t",a,"[",c,"]"].join(""):["d",a,"s",r,"=(t",a,"[",c,"]-s",d,"*t",a,"[",d,"])"].join(""));for(u.push("var "+s.join(",")),r=i-1;r>=0;--r)c=e[r],u.push(["for(i",r,"=0;i",r,"<s",c,";++i",r,"){"].join(""));for(u.push(n),r=0;i>r;++r){for(d=c,c=e[r],a=0;o>a;++a)u.push(["p",a,"+=d",a,"s",r].join(""));l&&(r>0&&u.push(["index[",d,"]-=s",d].join("")),u.push(["++index[",c,"]"].join(""))),u.push("}")}return u.join("\n")}function r(e,t,r,a){for(var i=t.length,o=r.arrayArgs.length,l=r.blockSize,u=r.indexArgs.length>0,s=[],c=0;o>c;++c)s.push(["var offset",c,"=p",c].join(""));for(var c=e;i>c;++c)s.push(["for(var j"+c+"=SS[",t[c],"]|0;j",c,">0;){"].join("")),s.push(["if(j",c,"<",l,"){"].join("")),s.push(["s",t[c],"=j",c].join("")),s.push(["j",c,"=0"].join("")),s.push(["}else{s",t[c],"=",l].join("")),s.push(["j",c,"-=",l,"}"].join("")),u&&s.push(["index[",t[c],"]=j",c].join(""));for(var c=0;o>c;++c){for(var d=["offset"+c],f=e;i>f;++f)d.push(["j",f,"*t",c,"[",t[f],"]"].join(""));s.push(["p",c,"=(",d.join("+"),")"].join(""))}s.push(n(t,r,a));for(var c=e;i>c;++c)s.push("}");return s.join("\n")}function a(e){for(var t=0,n=e[0].length;n>t;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function i(e,t,n){for(var r=e.body,a=[],i=[],o=0;o<e.args.length;++o){var l=e.args[o];if(!(l.count<=0)){var u=new RegExp(l.name,"g"),s="",c=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var d=t.offsetArgIndex.indexOf(o),f=t.offsetArgs[d];c=f.array,s="+q"+d;case"array":s="p"+c+s;var p="l"+o,h="a"+c;1===l.count?"generic"===n[c]?l.lvalue?(a.push(["var ",p,"=",h,".get(",s,")"].join("")),r=r.replace(u,p),i.push([h,".set(",s,",",p,")"].join(""))):r=r.replace(u,[h,".get(",s,")"].join("")):r=r.replace(u,[h,"[",s,"]"].join("")):"generic"===n[c]?(a.push(["var ",p,"=",h,".get(",s,")"].join("")),r=r.replace(u,p),l.lvalue&&i.push([h,".set(",s,",",p,")"].join(""))):(a.push(["var ",p,"=",h,"[",s,"]"].join("")),r=r.replace(u,p),l.lvalue&&i.push([h,"[",s,"]=",p].join("")));break;case"scalar":r=r.replace(u,"Y"+t.scalarArgs.indexOf(o));break;case"index":r=r.replace(u,"index");break;case"shape":r=r.replace(u,"shape")}}}return[a.join("\n"),r,i.join("\n")].join("\n").trim()}function o(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var a=e[r],i=a.match(/\d+/);i=i?i[0]:"",t[r]=0===a.charAt(0)?"u"+a.charAt(1)+i:a.charAt(0)+i,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function l(e,t){for(var l=0|t[1].length,s=new Array(e.arrayArgs.length),c=new Array(e.arrayArgs.length),d=["SS"],f=["'use strict'"],p=[],h=0;l>h;++h)p.push(["s",h,"=SS[",h,"]"].join(""));for(var g=0;g<e.arrayArgs.length;++g)d.push("a"+g),d.push("t"+g),d.push("p"+g),c[g]=t[2*g],s[g]=t[2*g+1];for(var g=0;g<e.scalarArgs.length;++g)d.push("Y"+g);if(e.shapeArgs.length>0&&p.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var v=new Array(l),g=0;l>g;++g)v[g]="0";p.push(["index=[",v.join(","),"]"].join(""))}for(var g=0;g<e.offsetArgs.length;++g){for(var m=e.offsetArgs[g],y=[],h=0;h<m.offset.length;++h)0!==m.offset[h]&&y.push(1===m.offset[h]?["t",m.array,"[",h,"]"].join(""):[m.offset[h],"*t",m.array,"[",h,"]"].join(""));p.push(0===y.length?"q"+g+"=0":["q",g,"=(",y.join("+"),")|0"].join(""))}var x=u([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));p=p.concat(x),f.push("var "+p.join(","));for(var g=0;g<e.arrayArgs.length;++g)f.push("p"+g+"|=0");e.pre.body.length>3&&f.push(i(e.pre,e,c));var b=i(e.body,e,c),w=a(s);f.push(l>w?r(w,s[0],e,b):n(s[0],e,b)),e.post.body.length>3&&f.push(i(e.post,e,c)),e.debug&&console.log("Generated cwise routine for ",t,":\n\n",f.join("\n"));var _=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",w,o(c)].join(""),k=new Function(["function ",_,"(",d.join(","),"){",f.join("\n"),"} return ",_].join(""));return k()}var u=e("uniq");t.exports=l},{uniq:24}],23:[function(e,t,n){arguments[4][17][0].apply(n,arguments)},{"./compile.js":22}],24:[function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,a=e[0],i=e[0],o=1;r>o;++o)if(i=a,a=e[o],t(a,i)){if(o===n){n++;continue}e[n++]=a}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],a=e[0],i=1;n>i;++i,a=r)if(a=r,r=e[i],r!==a){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}function a(e,t,a){return 0===e.length?[]:t?(a||e.sort(t),n(e,t)):(a||e.sort(),r(e))}t.exports=a},{}],25:[function(e,t,n){"use strict";function r(e){var t=e.dtype;("generic"===t||"array"===t)&&(t="double");var n=s.malloc(e.size,t),r=l(n,e.shape);return u.assign(r,e),r}function a(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];return l(s.malloc(n,t),e,r,0)}function i(e){"generic"!==e.dtype&&"array"!==e.dtype&&s.free(e.data)}function o(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];for(var i=s.malloc(n,t),a=0;n>a;++a)i[a]=0;return l(i,e,r,0)}var l=e("ndarray"),u=e("ndarray-ops"),s=e("typedarray-pool");n.clone=r,n.malloc=a,n.free=i,n.zeros=o},{ndarray:27,"ndarray-ops":14,"typedarray-pool":30}],26:[function(e,t){"use strict";function n(e){return"s"+e}function r(e){return"t"+e}function a(e){return"u"+e}function i(e){return"v"+e}function o(e){return"i"+e}function l(e){return"p"+e}function u(e){return"x"+e}function s(e){var t=e.slice();return t.splice(e.indexOf(0),1),t.unshift(0),t}function c(e,t,c){function d(a,s,c){if(t)z.push(l(0),".offset=",m,"+",r(e[0]),"*(",s,");",l(1),".offset=",m,"+",r(e[0]),"*(",c,");",a,"=",g,"(",l(0),",",l(1),");");else{z.push(u(0),"=",m,"+",r(0),"*(",s,");",u(1),"=",m,"+",r(0),"*(",c,");"),k>1&&z.push("_cmp:");for(var d=k-1;d>0;--d)z.push("for(",o(d),"=0;",o(d),"<",n(d),";",o(d),"++){");M?z.push(a,"=",v,".get(",u(0),")-",v,".get(",u(1),");"):z.push(a,"=",v,"[",u(0),"]-",v,"[",u(1),"];"),k>1&&z.push("if(",a,")break _cmp;");for(var d=1;k>d;++d)z.push(u(0),"+=",i(d),";",u(1),"+=",i(d),"}")}}function f(t,i){z.push(u(0),"=",m,"+",r(e[0]),"*(",t,");",u(1),"=",m,"+",r(e[0]),"*(",i,");");for(var l=k-1;l>0;--l)z.push("for(",o(e[l]),"=0;",o(e[l]),"<",n(e[l]),";",o(e[l]),"++){");M?z.push(x,"=",v,".get(",u(0),");",v,".set(",u(0),",",v,".get(",u(1),"));",v,".set(",u(1),",",x,");"):z.push(x,"=",v,"[",u(0),"];",v,"[",u(0),"]=",v,"[",u(1),"];",v,"[",u(1),"]=",x,";");for(var l=1;k>l;++l)z.push(u(0),"+=",a(e[l]),";",u(1),"+=",a(e[l]),"}")}e=s(e);var k=e.length,M="generic"===c,A="ndSelect"+c+e.join("_")+"_"+(t?"cmp":"lex"),z=[],j=[p,h];t&&j.push(g);for(var E=[v+"="+p+".data",m+"="+p+".offset|0",y+"=Math.random",x],S=0;2>S;++S)E.push(u(S)+"=0");for(var S=0;k>S;++S)E.push(n(S)+"="+p+".shape["+S+"]|0",r(S)+"="+p+".stride["+S+"]|0",o(S)+"=0");for(var S=1;k>S;++S)k-1>S?E.push(i(S)+"=("+r(S)+"-"+n(S+1)+"*"+r(S+1)+")|0",a(e[S])+"=("+r(e[S])+"-"+n(e[S+1])+"*"+r(e[S+1])+")|0"):E.push(i(S)+"="+r(S),a(e[S])+"="+r(e[S]));if(t)for(var S=0;2>S;++S)E.push(l(S)+"="+p+".pick(0)");E.push(_+"=0",b+"=0",w+"="+n(e[0])+"-1"),z.push("while(",b,"<",w,"){",_,"=(",y,"()*(",w,"-",b,"+1)+",b,")|0;"),f(_,w),z.push(_,"=",b,";","for(",o(0),"=",b,";",o(0),"<",w,";",o(0),"++){"),d(x,o(0),w),z.push("if(",x,"<0){"),f(_,o(0)),z.push(_,"++;"),z.push("}}"),f(_,w),z.push("if(",_,"===",h,"){",b,"=",_,";","break;","}else if(",h,"<",_,"){",w,"=",_,"-1;","}else{",b,"=",_,"+1;","}","}"),t?z.push(l(0),".offset=",m,"+",b,"*",r(0),";","return ",l(0),";"):z.push("return ",p,".pick(",b,");");var T=["'use strict';function ",A,"(",j,"){","var ",E.join(),";",z.join(""),"};return ",A].join(""),N=new Function(T);return N()}function d(e,t,n){var r=e.join()+t+n,a=k[r];return a?a:k[r]=c(e,t,n)}function f(e,t,n){if(t|=0,0===e.dimension||e.shape[0]<=t||0>t)return null;var r=!!n,a=d(e.order,r,e.dtype);return r?a(e,t,n):a(e,t)}t.exports=f,t.exports.compile=d;var p="a",h="K",g="C",v="d",m="o",y="R",x="T",b="L",w="H",_="X",k={}},{}],27:[function(e,t){(function(n){function r(e,t){return e[0]-t[0]}function a(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(r);var a=new Array(n.length);for(e=0;e<a.length;++e)a[e]=n[e][1];return a}function i(e,t){var n=["View",t,"d",e].join("");0>t&&(n="View_Nil"+e);var r="generic"===e;if(-1===t){var i="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}",o=new Function(i);return o()}if(0===t){var i="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",o=new Function("TrivialArray",i);return o(f[e][0])}var i=["'use strict'"],l=u(t),c=l.map(function(e){return"i"+e}),d="this.offset+"+l.map(function(e){return"this._stride"+e+"*i"+e}).join("+");i.push("function "+n+"(a,"+l.map(function(e){return"b"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",d){this.data=a");for(var p=0;t>p;++p)i.push("this._shape"+p+"=b"+p+"|0");for(var p=0;t>p;++p)i.push("this._stride"+p+"=c"+p+"|0");i.push("this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t);var h="VStride"+t+"d"+e,g="VShape"+t+"d"+e,v={stride:h,shape:g};for(var m in v){var y=v[m];i.push("function "+y+"(v) {this._v=v} var aproto="+y+".prototype","aproto.length="+t);for(var x=[],p=0;t>p;++p)x.push(["this._v._",m,p].join(""));i.push("aproto.toJSON=function "+y+"_toJSON(){return ["+x.join(",")+"]}","aproto.valueOf=aproto.toString=function "+y+"_toString(){return ["+x.join(",")+"].join()}");for(var p=0;t>p;++p)i.push("Object.defineProperty(aproto,"+p+",{get:function(){return this._v._"+m+p+"},set:function(v){return this._v._"+m+p+"=v|0},enumerable:true})");for(var p=0;p<s.length;++p)s[p]in Array.prototype&&i.push("aproto."+s[p]+"=Array.prototype."+s[p]);i.push(["Object.defineProperty(proto,'",m,"',{get:function ",y,"_get(){return new ",y,"(this)},set: function ",y,"_set(v){"].join(""));for(var p=0;t>p;++p)i.push("this._"+m+p+"=v["+p+"]|0");i.push("return v}})")}i.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+l.map(function(e){return"this._shape"+e}).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),4>t?(i.push("function "+n+"_order(){"),2===t?i.push("return (Math.abs(this._stride0)>Math.abs(this._stride1))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this._stride0),s1=Math.abs(this._stride1),s2=Math.abs(this._stride2);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i.push(r?"return this.data.set("+d+",v)}":"return this.data["+d+"]=v}"),i.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i.push(r?"return this.data.get("+d+")}":"return this.data["+d+"]}"),i.push("proto.index=function "+n+"_index(",c.join(),"){return "+d+"}"),i.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+l.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this._shape",e,":i",e,"|0"].join("")}).join(",")+","+l.map(function(e){return"this._stride"+e}).join(",")+",this.offset)}");var b=l.map(function(e){return"a"+e+"=this._shape"+e}),w=l.map(function(e){return"c"+e+"=this._stride"+e});i.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+b.join(",")+","+w.join(","));for(var p=0;t>p;++p)i.push("if(typeof i"+p+"==='number'&&i"+p+">=0){d=i"+p+"|0;b+=c"+p+"*d;a"+p+"-=d}");i.push("return new "+n+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",b)}"),i.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+l.map(function(e){return"a"+e+"=this._shape"+e}).join(",")+","+l.map(function(e){return"b"+e+"=this._stride"+e}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var p=0;t>p;++p)i.push("if(typeof i"+p+"==='number'){d=i"+p+"|0;if(d<0){c+=b"+p+"*(a"+p+"-1);a"+p+"=ceil(-a"+p+"/d)}else{a"+p+"=ceil(a"+p+"/d)}b"+p+"*=d}");i.push("return new "+n+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"b"+e}).join(",")+",c)}");for(var _=new Array(t),k=new Array(t),p=0;t>p;++p)_[p]="a[i"+p+"]",k[p]="b[i"+p+"]";i.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+_.join(",")+","+k.join(",")+",this.offset)}"),i.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(var p=0;t>p;++p)i.push("if(typeof i"+p+"==='number'&&i"+p+">=0){c=(c+this._stride"+p+"*i"+p+")|0}else{a.push(this._shape"+p+");b.push(this._stride"+p+")}");i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+l.map(function(e){return"shape["+e+"]"}).join(",")+","+l.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",i.join("\n"));return o(f[e],a)}function o(e){if(d&&n.isBuffer(e))return"buffer";if(c)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}function l(e,t,n,r){if(void 0===e){var a=f.array[0];return a([])}"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var l=t.length;if(void 0===n){n=new Array(l);for(var u=l-1,s=1;u>=0;--u)n[u]=s,s*=t[u]}if(void 0===r){r=0;for(var u=0;l>u;++u)n[u]<0&&(r-=(t[u]-1)*n[u])}for(var c=o(e),d=f[c];d.length<=l+1;)d.push(i(c,d.length-1));var a=d[l+1];return a(e,t,n,r)}var u=e("iota-array"),s=["concat","join","slice","toString","indexOf","lastIndexOf","forEach","every","some","filter","map","reduce","reduceRight"],c="undefined"!=typeof Float64Array,d="undefined"!=typeof n,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=l}).call(this,e("buffer").Buffer)},{buffer:1,"iota-array":28}],28:[function(e,t){"use strict";function n(e){for(var t=new Array(e),n=0;e>n;++n)t[n]=n;return t}t.exports=n},{}],29:[function(e,t){"use strict";function n(e,t,r){var a=0|e[r];if(0>=a)return[];var i,o=new Array(a);if(r===e.length-1)for(i=0;a>i;++i)o[i]=t;else for(i=0;a>i;++i)o[i]=n(e,t,r+1);return o}function r(e,t){var n,r;for(n=new Array(e),r=0;e>r;++r)n[r]=t;return n}function a(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(e>0)return r(0|e,t);break;case"object":if("number"==typeof e.length)return n(e,t,0)}return[]}t.exports=a},{}],30:[function(e,t,n){(function(t,r){var a=e("bit-twiddle"),i=e("dup");t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])});var o="undefined"!=typeof Uint8ClampedArray,l=t.__TYPEDARRAY_POOL;l.UINT8C||(l.UINT8C=i([32,0])),l.BUFFER||(l.BUFFER=i([32,0]));var u=l.UINT8,s=l.UINT16,c=l.UINT32,d=l.INT8,f=l.INT16,p=l.INT32,h=l.FLOAT,g=l.DOUBLE,v=l.DATA,m=l.UINT8C,y=l.BUFFER;n.free=function(e){var t=0|e.length,n=a.log2(t);if(r.isBuffer(e))y[n].push(e);else switch(Object.prototype.toString.call(e)){case"[object Uint8Array]":u[n].push(e);break;case"[object Uint16Array]":s[n].push(e);break;case"[object Uint32Array]":c[n].push(e);break;case"[object Int8Array]":d[n].push(e);break;case"[object Int16Array]":f[n].push(e);break;case"[object Int32Array]":p[n].push(e);break;case"[object Uint8ClampedArray]":m[n].push(e);break;case"[object Float32Array]":h[n].push(e);break;case"[object Float64Array]":g[n].push(e);break;case"[object ArrayBuffer]":v[n].push(e);break;default:throw new Error("typedarray-pool: Unspecified array type")}},n.freeUint8=function(e){u[a.log2(e.length)].push(e)},n.freeUint16=function(e){s[a.log2(e.length)].push(e)},n.freeUint32=function(e){c[a.log2(e.length)].push(e)},n.freeInt8=function(e){d[a.log2(e.length)].push(e)},n.freeInt16=function(e){f[a.log2(e.length)].push(e)},n.freeInt32=function(e){p[a.log2(e.length)].push(e)},n.freeFloat32=n.freeFloat=function(e){h[a.log2(e.length)].push(e)},n.freeFloat64=n.freeDouble=function(e){g[a.log2(e.length)].push(e)},n.freeArrayBuffer=function(e){v[a.log2(e.length)].push(e)},n.freeUint8Clamped=o?function(e){m[a.log2(e.length)].push(e)}:n.freeUint8,n.freeBuffer=function(e){y[a.log2(e.length)].push(e)},n.malloc=function(e,t){e=a.nextPow2(e);var n=a.log2(e);if(void 0===t||"arraybuffer"===t){var i=v[n];if(i.length>0){var l=i[i.length-1];return i.pop(),l}return new ArrayBuffer(e)}switch(t){case"uint8":var x=u[n];return x.length>0?x.pop():new Uint8Array(e);case"uint16":var b=s[n];return b.length>0?b.pop():new Uint16Array(e);case"uint32":var w=c[n];return w.length>0?w.pop():new Uint32Array(e);case"int8":var _=d[n];return _.length>0?_.pop():new Int8Array(e);case"int16":var k=f[n];return k.length>0?k.pop():new Int16Array(e);case"int32":var M=p[n];return M.length>0?M.pop():new Int32Array(e);case"float":case"float32":var A=h[n];return A.length>0?A.pop():new Float32Array(e);case"double":case"float64":var z=g[n];return z.length>0?z.pop():new Float64Array(e);case"uint8_clamped":if(o){var j=m[n];return j.length>0?j.pop():new Uint8ClampedArray(e)}var x=u[n];return x.length>0?x.pop():new Uint8Array(e);case"buffer":var E=y[n];return E.length>0?E.pop():new r(e);default:return null}return null},n.mallocUint8=function(e){e=a.nextPow2(e);var t=a.log2(e),n=u[t];return n.length>0?n.pop():new Uint8Array(e)},n.mallocUint16=function(e){e=a.nextPow2(e);var t=a.log2(e),n=s[t];return n.length>0?n.pop():new Uint16Array(e)},n.mallocUint32=function(e){e=a.nextPow2(e);var t=a.log2(e),n=c[t];return n.length>0?n.pop():new Uint32Array(e)},n.mallocInt8=function(e){e=a.nextPow2(e);var t=a.log2(e),n=d[t];return n.length>0?n.pop():new Int8Array(e)},n.mallocInt16=function(e){e=a.nextPow2(e);var t=a.log2(e),n=f[t];return n.length>0?n.pop():new Int16Array(e)},n.mallocInt32=function(e){e=a.nextPow2(e);var t=a.log2(e),n=p[t];return n.length>0?n.pop():new Int32Array(e)},n.mallocFloat32=n.mallocFloat=function(e){e=a.nextPow2(e);var t=a.log2(e),n=h[t];return n.length>0?n.pop():new Float32Array(e)},n.mallocFloat64=n.mallocDouble=function(e){e=a.nextPow2(e);var t=a.log2(e),n=g[t];return n.length>0?n.pop():new Float64Array(e)},n.mallocArrayBuffer=function(e){e=a.nextPow2(e);var t=a.log2(e),n=v[t];return n.length>0?n.pop():new ArrayBuffer(e)},n.mallocUint8Clamped=o?function(e){e=a.nextPow2(e);var t=a.log2(e),n=m[t];return n.length>0?n.pop():new Uint8ClampedArray(e)}:n.mallocUint8,n.mallocBuffer=function(e){e=a.nextPow2(e);var t=a.log2(e),n=y[t];return n.length>0?n.pop():new r(e)},n.clearCache=function(){for(var e=0;32>e;++e)u[e].length=0,s[e].length=0,c[e].length=0,d[e].length=0,f[e].length=0,p[e].length=0,h[e].length=0,g[e].length=0,v[e].length=0,m[e].length=0,y[e].length=0}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"bit-twiddle":11,buffer:1,dup:29}],31:[function(e,t){var n=t.exports=e("./topojson");n.topology=e("./lib/topojson/topology"),n.simplify=e("./lib/topojson/simplify"),n.clockwise=e("./lib/topojson/clockwise"),n.filter=e("./lib/topojson/filter"),n.prune=e("./lib/topojson/prune"),n.stitch=e("./lib/topojson/stitch"),n.scale=e("./lib/topojson/scale")},{"./lib/topojson/clockwise":34,"./lib/topojson/filter":38,"./lib/topojson/prune":42,"./lib/topojson/scale":44,"./lib/topojson/simplify":45,"./lib/topojson/stitch":47,"./lib/topojson/topology":48,"./topojson":60}],32:[function(e,t){t.exports=function(e){function t(e){e&&s.hasOwnProperty(e.type)&&s[e.type](e)}function n(e){var t=e[0],n=e[1];
i>t&&(i=t),t>l&&(l=t),o>n&&(o=n),n>u&&(u=n)}function r(e){e.forEach(n)}function a(e){e.forEach(r)}var i=1/0,o=1/0,l=-1/0,u=-1/0,s={GeometryCollection:function(e){e.geometries.forEach(t)},Point:function(e){n(e.coordinates)},MultiPoint:function(e){e.coordinates.forEach(n)},LineString:function(e){r(e.coordinates)},MultiLineString:function(e){e.coordinates.forEach(r)},Polygon:function(e){e.coordinates.forEach(r)},MultiPolygon:function(e){e.coordinates.forEach(a)}};for(var c in e)t(e[c]);return[i,o,l,u]}},{}],33:[function(e,t,n){function r(e){return e.toString()}function a(e){for(var t,n=-1,r=e.length,a=e[r-1],i=0;++n<r;)t=a,a=e[n],i+=t[0]*a[1]-t[1]*a[0];return.5*i}function i(e){return Math.abs((e[0][0]-e[2][0])*(e[1][1]-e[0][1])-(e[0][0]-e[1][0])*(e[2][1]-e[0][1]))}function o(e,t,n,r){var a=e-n,i=t-r;return Math.sqrt(a*a+i*i)}n.name="cartesian",n.formatDistance=r,n.ringArea=a,n.absoluteArea=Math.abs,n.triangleArea=i,n.distance=o},{}],34:[function(e,t){function n(e,t){function n(e){e.reverse()}var r=null;t&&"coordinate-system"in t&&(r=l[t["coordinate-system"]]);var u=a(r.ringArea,n);o({LineString:i,MultiLineString:i,Point:i,MultiPoint:i,Polygon:function(e){u(e.coordinates)},MultiPolygon:function(e){e.coordinates.forEach(u)}}).object(e)}function r(e,t){function n(t){return s.ringArea(u.feature(e,{type:"Polygon",arcs:[t]}).geometry.coordinates[0])}function r(e){var t=-1,n=e.length;for(e.reverse();++t<n;)e[t]=~e[t]}var s=null;t&&"coordinate-system"in t&&(s=l[t["coordinate-system"]]);var c=a(n,r),d=o({LineString:i,MultiLineString:i,Point:i,MultiPoint:i,Polygon:function(e){c(e.arcs)},MultiPolygon:function(e){e.arcs.forEach(c)}});for(var f in e.objects)d.object(e.objects[f])}function a(e,t){return function(n){if(r=n.length){for(var r,a,i,o,l=new Array(r),u=-1/0,s=0;r>s;++s){var i=Math.abs(l[s]=e(n[s]));i>u&&(u=i,a=s)}a&&(o=n[a],n[a]=n[0],n[0]=o,o=l[a],l[a]=l[0],l[0]=o),l[0]<0&&t(n[0]);for(var s=1;r>s;++s)l[s]>0&&t(n[s])}}}function i(){}var o=e("./type"),l=e("./coordinate-systems"),u=e("../../topojson");t.exports=function(e,t){"Topology"===e.type?r(e,t):n(e,t)}},{"../../topojson":60,"./coordinate-systems":36,"./type":59}],35:[function(e,t){t.exports=function(e,t){function n(e){e&&a.hasOwnProperty(e.type)&&a[e.type](e)}function r(e){var n=t(e);null==n?delete e.id:e.id=n}arguments.length<2&&(t=function(e){return e.id});var a={Feature:r,FeatureCollection:function(e){e.features.forEach(r)}};for(var i in e)n(e[i]);return e}},{}],36:[function(e,t){t.exports={cartesian:e("./cartesian"),spherical:e("./spherical")}},{"./cartesian":33,"./spherical":46}],37:[function(e,t){t.exports=function(e){for(var t=e.arcs,n=-1,r=t.length;++n<r;)for(var a,i,o=t[n],l=0,u=o.length,s=o[0],c=s[0],d=s[1];++l<u;)s=o[l],a=s[0],i=s[1],o[l]=[a-c,i-d],c=a,d=i;return e}},{}],38:[function(e,t){function n(){}function r(){return!1}var a=e("./type"),i=e("./prune"),o=e("./clockwise"),l=e("./coordinate-systems"),u=e("../../topojson");t.exports=function(e,t){function s(e){return e.length&&c(e[0])?[e.shift()].concat(e.filter(d)):null}function c(e){return m(e)||h.absoluteArea(f(e))>=p}function d(e){return m(e)||h.absoluteArea(-f(e))>=p}function f(t){return h.ringArea(u.feature(e,{type:"Polygon",arcs:[t]}).geometry.coordinates[0])}var p,h=null,g=!0,v=!0,m=r;if(t&&("coordinate-system"in t&&(h=l[t["coordinate-system"]]),"minimum-area"in t&&(p=+t["minimum-area"]),"preserve-attached"in t&&(v=!!t["preserve-attached"]),"force-clockwise"in t&&(g=!!t["force-clockwise"])),g&&o(e,t),p>0||(p=Number.MIN_VALUE),v){var y={},x=0,b=a({LineString:n,MultiLineString:n,Point:n,MultiPoint:n,MultiPolygon:function(e){for(var t=e.arcs,n=-1,r=t.length;++n<r;)this.polygon(t[n])},Polygon:function(e){this.polygon(e.arcs)},polygon:function(e){for(var t=0,n=e.length;n>t;++t,++x)for(var r=e[t],a=0,i=r.length;i>a;++a){var o=r[a];0>o&&(o=~o);var l=y[o];y[o]=l>=0&&l!==x?-1:x}}});m=function(e){for(var t=0,n=e.length;n>t;++t){var r=e[t];if(y[0>r?~r:r]<0)return!0}};for(var w in e.objects)b.object(e.objects[w])}var _=a({LineString:n,MultiLineString:n,Point:n,MultiPoint:n,Polygon:function(e){e.arcs=s(e.arcs),e.arcs&&e.arcs.length||(e.type=null,delete e.arcs)},MultiPolygon:function(e){e.arcs=e.arcs.map(s).filter(function(e){return e&&e.length}),e.arcs.length||(e.type=null,delete e.arcs)},GeometryCollection:function(e){this.defaults.GeometryCollection.call(this,e),e.geometries=e.geometries.filter(function(e){return null!=e.type}),e.geometries.length||(e.type=null,delete e.geometries)}});for(var w in e.objects)_.object(e.objects[w]);i(e,t)}},{"../../topojson":60,"./clockwise":34,"./coordinate-systems":36,"./prune":42,"./type":59}],39:[function(e,t){t.exports=function(e){function t(e){return(e&&a.hasOwnProperty(e.type)?a[e.type]:r)(e)}function n(e){var t=e.geometry;return null==t?e.type=null:(r(t),e.type=t.type,t.geometries?e.geometries=t.geometries:t.coordinates&&(e.coordinates=t.coordinates)),delete e.geometry,e}function r(e){return e?(i.hasOwnProperty(e.type)&&i[e.type](e),e):{type:null}}var a={Feature:n,FeatureCollection:function(e){return e.type="GeometryCollection",e.geometries=e.features,e.features.forEach(n),delete e.features,e}},i={GeometryCollection:function(e){for(var t=e.geometries,n=-1,a=t.length;++n<a;)t[n]=r(t[n])},MultiPoint:function(e){e.coordinates.length?e.coordinates.length<2&&(e.type="Point",e.coordinates=e.coordinates[0]):(e.type=null,delete e.coordinates)},LineString:function(e){e.coordinates.length||(e.type=null,delete e.coordinates)},MultiLineString:function(e){for(var t=e.coordinates,n=0,r=0,a=t.length;a>n;++n){var i=t[n];i.length&&(t[r++]=i)}r?2>r?(e.type="LineString",e.coordinates=t[0]):e.coordinates.length=r:(e.type=null,delete e.coordinates)},Polygon:function(e){for(var t=e.coordinates,n=0,r=0,a=t.length;a>n;++n){var i=t[n];i.length&&(t[r++]=i)}r?e.coordinates.length=r:(e.type=null,delete e.coordinates)},MultiPolygon:function(e){for(var t=e.coordinates,n=0,r=0,a=t.length;a>n;++n){for(var i=t[n],o=0,l=0,u=i.length;u>o;++o){var s=i[o];s.length&&(i[l++]=s)}l&&(i.length=l,t[r++]=i)}r?2>r?(e.type="Polygon",e.coordinates=t[0]):t.length=r:(e.type=null,delete e.coordinates)}};for(var o in e)e[o]=t(e[o]);return e}},{}],40:[function(e,t){var n=e("./quantize");t.exports=function(e,t,r){function a(e){e&&h.hasOwnProperty(e.type)&&h[e.type](e)}if(t){if(r===t||!e.bbox.every(isFinite))return e;var i=r/t,o=n(0,0,i,i);e.transform.scale[0]/=i,e.transform.scale[1]/=i}else{var l=e.bbox,u=isFinite(l[0])?l[0]:0,s=isFinite(l[1])?l[1]:0,c=isFinite(l[2])?l[2]:0,d=isFinite(l[3])?l[3]:0,f=c-u?(r-1)/(c-u):1,p=d-s?(r-1)/(d-s):1,o=n(-u,-s,f,p);e.transform=o.transform}var h={GeometryCollection:function(e){e.geometries.forEach(a)},Point:function(e){o.point(e.coordinates)},MultiPoint:function(e){e.coordinates.forEach(o.point)}};for(var g in e.objects)a(e.objects[g]);return e.arcs=e.arcs.map(function(e){return o.line(e=e.map(function(e){return e.slice()})),e.length<2&&e.push(e[0]),e}),e}},{"./quantize":43}],41:[function(e,t){var n=e("./quantize");t.exports=function(e,t,r,a){function i(e){e&&p.hasOwnProperty(e.type)&&p[e.type](e)}arguments.length<4&&(a=r);var o=isFinite(t[0])?t[0]:0,l=isFinite(t[1])?t[1]:0,u=isFinite(t[2])?t[2]:0,s=isFinite(t[3])?t[3]:0,c=u-o?(a-1)/(u-o)*r/a:1,d=s-l?(a-1)/(s-l)*r/a:1,f=n(-o,-l,c,d),p={GeometryCollection:function(e){e.geometries.forEach(i)},Point:function(e){f.point(e.coordinates)},MultiPoint:function(e){e.coordinates.forEach(f.point)},LineString:function(e){var t=e.coordinates;f.line(t),t.length<2&&(t[1]=t[0])},MultiLineString:function(e){for(var t=e.coordinates,n=0,r=t.length;r>n;++n){var a=t[n];f.line(a),a.length<2&&(a[1]=a[0])}},Polygon:function(e){for(var t=e.coordinates,n=0,r=t.length;r>n;++n){var a=t[n];for(f.line(a);a.length<4;)a.push(a[0])}},MultiPolygon:function(e){for(var t=e.coordinates,n=0,r=t.length;r>n;++n)for(var a=t[n],i=0,o=a.length;o>i;++i){var l=a[i];for(f.line(l);l.length<4;)l.push(l[0])}}};for(var h in e)i(e[h]);return f.transform}},{"./quantize":43}],42:[function(e,t){t.exports=function(e,t){function n(e){e&&f.hasOwnProperty(e.type)&&f[e.type](e)}function r(e){for(var t=0,n=e.length;n>t;++t){var r,a=e[t],i=0>a&&(a=~a,!0);null==(r=d[a])&&(d[a]=r=c++,s[r]=l[a]),e[t]=i?~r:r}}function a(e){e.forEach(r)}var i=!1,o=e.objects,l=e.arcs,u=l.length,s=e.arcs=[],c=0,d=new Array(l.length);t&&"verbose"in t&&(i=!!t.verbose);var f={GeometryCollection:function(e){e.geometries.forEach(n)},LineString:function(e){r(e.arcs)},MultiLineString:function(e){e.arcs.forEach(r)},Polygon:function(e){e.arcs.forEach(r)},MultiPolygon:function(e){e.arcs.forEach(a)}};for(var p in o)n(o[p]);return i&&console.warn("prune: retained "+c+" / "+u+" arcs ("+Math.round(c/u*100)+"%)"),e}},{}],43:[function(e,t){t.exports=function(e,t,n,r){function a(a){return a[0]=Math.round((a[0]+e)*n),a[1]=Math.round((a[1]+t)*r),a}function i(e){for(var t,n,r,i=0,o=1,l=e.length,u=a(e[0]),s=u[0],c=u[1];++i<l;)u=a(e[i]),n=u[0],r=u[1],(n!==s||r!==c)&&(t=e[o++],t[0]=s=n,t[1]=c=r);e.length=o}return{point:a,line:i,transform:{scale:[1/n,1/r],translate:[-e,-t]}}}},{}],44:[function(e,t){function n(){}var r=e("./type");t.exports=function(e,t){function a(e){return[e[0]*s+(i/2-p*s)+l,e[1]*v+(o/2-h*v)+l]}var i,o,l=0,u=!0;t&&("width"in t&&(i=+t.width),"height"in t&&(o=+t.height),"margin"in t&&(l=+t.margin),"invert"in t&&(u=!!t.invert));var s,c=e.bbox,d=c[2]-c[0],f=c[3]-c[1],p=(c[2]+c[0])/2,h=(c[3]+c[1])/2;i=Math.max(0,i-2*l),o=Math.max(0,o-2*l),i&&o?s=Math.min(i/d,o/f):i?(s=i/d,o=s*f):(s=o/f,i=s*d);var g,v=u?-s:s,m=a([c[0],c[1]]),y=a([c[2],c[3]]);if(e.bbox=u?[m[0],y[1],y[0],m[1]]:[m[0],m[1],y[0],y[1]],g=e.transform)g.scale[0]*=s,g.scale[1]*=v,g.translate[0]=i/2+l-(p-g.translate[0])*s,g.translate[1]=o/2+l-(h-g.translate[1])*v;else{var x=r({LineString:n,MultiLineString:n,Point:function(e){e.coordinates=a(e.coordinates)},MultiPoint:function(e){e.coordinates=e.coordinates.map(a)},Polygon:n,MultiPolygon:n});for(var b in e.objects)x.object(e.objects[b]);e.arcs=e.arcs.map(function(e){return e.map(a)})}return e}},{"./type":59}],45:[function(e,t){var n=e("../../topojson"),r=e("./coordinate-systems");t.exports=function(e,t){var a,i=0,o=!1,l=null,u=e.arcs.reduce(function(e,t){return e+t.length},0),s=0;if(t&&("minimum-area"in t&&(i=+t["minimum-area"]),"coordinate-system"in t&&(l=r[t["coordinate-system"]]),"retain-proportion"in t&&(a=+t["retain-proportion"]),"verbose"in t&&(o=!!t.verbose)),n.presimplify(e,l.triangleArea),a){var c=[];e.arcs.forEach(function(e){e.forEach(function(e){isFinite(e[2])&&c.push(e[2])})}),t["minimum-area"]=i=u?c.sort(function(e,t){return t-e})[Math.ceil((u-1)*a)]:0,o&&console.warn("simplification: effective minimum area "+i.toPrecision(3))}return e.arcs.forEach(e.transform?function(e){for(var t,n,r=0,a=0,o=-1,l=-1,u=e.length;++o<u;)t=e[o],t[2]>=i?(n=e[++l],n[0]=t[0]+r,n[1]=t[1]+a,r=a=0):(r+=t[0],a+=t[1]);e.length=++l}:function(e){for(var t,n=-1,r=-1,a=e.length;++n<a;)t=e[n],t[2]>=i&&(e[++r]=t);e.length=++r}),e.arcs.forEach(e.transform?function(e){var t=0,n=0,r=e.length,a=e[0];for(a.length=2;++t<r;)a=e[t],a.length=2,(a[0]||a[1])&&(e[++n]=a);s+=e.length=(n||1)+1}:function(e){var t,n,r=0,a=0,i=e.length,o=e[0],l=o[0],u=o[1];for(o.length=2;++r<i;)o=e[r],t=o[0],n=o[1],o.length=2,(l!==t||u!==n)&&(e[++a]=o,l=t,u=n);s+=e.length=(a||1)+1}),o&&console.warn("simplification: retained "+s+" / "+u+" points ("+Math.round(s/u*100)+"%)"),e}},{"../../topojson":60,"./coordinate-systems":36}],46:[function(e,t,n){function r(e){var t=e*f*6371;return(t>1?t.toFixed(3)+"km":(1e3*t).toPrecision(3)+"m")+" ("+e.toPrecision(3)+")"}function a(e){if(!e.length)return 0;for(var t=0,n=e[0],r=n[0]*f,a=n[1]*f/2+d,i=r,o=Math.cos(a),l=Math.sin(a),u=1,s=e.length;s>u;++u){n=e[u],r=n[0]*f,a=n[1]*f/2+d;var p=r-i,h=Math.cos(a),g=Math.sin(a),v=l*g,m=o*h+v*Math.cos(p),y=v*Math.sin(p);t+=Math.atan2(y,m),i=r,o=h,l=g}return 2*(t>c?t-2*c:-c>t?t+2*c:t)}function i(e){return 0>e?e+4*c:e}function o(e){var t=l(e[0],e[1]),n=l(e[1],e[2]),r=l(e[2],e[0]),a=(t+n+r)/2;return 4*Math.atan(Math.sqrt(Math.max(0,Math.tan(a/2)*Math.tan((a-t)/2)*Math.tan((a-n)/2)*Math.tan((a-r)/2))))}function l(e,t){var n,r=(t[0]-e[0])*f,a=Math.sin(r),i=Math.cos(r),o=Math.sin(e[1]*f),l=Math.cos(e[1]*f),u=Math.sin(t[1]*f),s=Math.cos(t[1]*f);return Math.atan2(Math.sqrt((n=s*a)*n+(n=l*u-o*s*i)*n),o*u+l*s*i)}function u(e,t,n,r){return e*=f,t*=f,n*=f,r*=f,2*Math.asin(Math.sqrt(s(r-t)+Math.cos(t)*Math.cos(r)*s(n-e)))}function s(e){return(e=Math.sin(e/2))*e}var c=Math.PI,d=c/4,f=c/180;n.name="spherical",n.formatDistance=r,n.ringArea=a,n.absoluteArea=i,n.triangleArea=o,n.distance=u},{}],47:[function(e,t){var n=e("./type");t.exports=function(e,t){function r(e){return d>=e?[0,c]:e>=p?[0,f]:[o,e]}function a(e){for(var t=[],n=0,a=e.length;a>n;++n){for(var i=e[n],o=0,u=i.length;u>o;++o){var c=i[o];c.polygon=i,t.push(c);for(var f=0,h=c.length;h>f;++f){var g=c[f],v=g[0],m=g[1];if(l>=v||v>=s||d>=m||m>=p){for(var y=f+1;h>y;++y){var x=c[y],b=x[0],w=x[1];if(b>l&&s>b&&w>d&&p>w)break}if(y===f+1)continue;if(f){var _=c.slice(0,f+1);_.polygon=i,_[_.length-1]=r(m),t[t.length-1]=_}else t.pop();if(y>=h)break;t.push(c=c.slice(y-1)),c[0]=r(c[0][1]),c.polygon=i,f=-1,h=c.length}}}i.length=0}for(var k={},M={},f=0,h=t.length;h>f;++f){var A=t[f],z=A[0],j=A[A.length-1];z[0]!==j[0]||z[1]!==j[1]?(A.index=f,k[z]=M[j]=A):(A.polygon.push(A),t[f]=null)}for(var f=0;h>f;++f){var A=t[f];if(A){var z=A[0],j=A[A.length-1],E=M[z],S=k[j];if(delete k[z],delete M[j],z[0]===j[0]&&z[1]===j[1]){A.polygon.push(A);continue}E?(delete M[z],delete k[E[0]],E.pop(),t[E.index]=null,A=E.concat(A),A.polygon=E.polygon,E===S?A.polygon.push(A):(A.index=h++,t.push(k[A[0]]=M[A[A.length-1]]=A))):S?(delete k[j],delete M[S[S.length-1]],A.pop(),A=A.concat(S),A.polygon=S.polygon,A.index=h++,t[S.index]=null,t.push(k[A[0]]=M[A[A.length-1]]=A)):(A.push(A[0]),A.polygon.push(A))}}}var i=.01,o=-180,l=o+i,u=180,s=u-i,c=-90,d=c+i,f=90,p=f-i;if(t){var h=t.scale[0],g=t.scale[1],v=t.translate[0],m=t.translate[1];o=Math.round((o-v)/h),u=Math.round((u-v)/h),c=Math.round((c-m)/g),f=Math.round((f-m)/g),l=Math.round((l-v)/h),s=Math.round((s-v)/h),d=Math.round((d-m)/g),p=Math.round((p-m)/g)}var y=n({Polygon:function(e){a([e.coordinates])},MultiPolygon:function(e){a(e.coordinates)}});for(var x in e)y.object(e[x])}},{"./type":59}],48:[function(e,t){var n=(e("./type"),e("./stitch")),r=e("./coordinate-systems"),a=e("./topology/index"),i=e("./delta"),o=e("./geomify"),l=e("./pre-quantize"),u=e("./post-quantize"),s=e("./bounds"),c=e("./compute-id"),d=e("./transform-properties"),f=1e-6;t.exports=function(e,t){var p,h=1e4,g=1e4,v=function(e){return e.id},m=function(){},y=0,x=!0,b=!1,w=null;if(t&&("verbose"in t&&(b=!!t.verbose),"stitch-poles"in t&&(x=!!t["stitch-poles"]),"coordinate-system"in t&&(w=r[t["coordinate-system"]]),"minimum-area"in t&&(y=+t["minimum-area"]),"quantization"in t&&(h=g=+t.quantization),"pre-quantization"in t&&(h=+t["pre-quantization"]),"post-quantization"in t&&(g=+t["post-quantization"]),"id"in t&&(v=t.id),"property-transform"in t&&(m=t["property-transform"])),h/g%1)throw new Error("post-quantization is not a divisor of pre-quantization");if(h&&!g)throw new Error("post-quantization is required when input is already quantized");c(e,v),d(e,m),o(e);var _=s(e),k=_[0]<-180-f||_[1]<-90-f||_[2]>180+f||_[3]>90+f;if(w||(w=r[k?"cartesian":"spherical"],t&&(t["coordinate-system"]=w.name)),w===r.spherical){if(k)throw new Error("spherical coordinates outside of [180, 90]");_[0]<-180+f&&(_[0]=-180),_[1]<-90+f&&(_[1]=-90),_[2]>180-f&&(_[2]=180),_[3]>90-f&&(_[3]=90)}b&&console.warn("bounds: "+_.join(" ")+" ("+w.name+")"),h&&(p=l(e,_,h,g),b&&console.warn("pre-quantization: "+p.scale.map(function(e){return w.formatDistance(e)}).join(" "))),w===r.spherical&&x&&n(e,p);var M=a(e);return h&&(M.transform=p),M.bbox=_,b&&console.warn("topology: "+M.arcs.length+" arcs, "+M.arcs.reduce(function(e,t){return e+t.length},0)+" points"),g&&g!==h&&(u(M,h,g),p=M.transform,b&&console.warn("post-quantization: "+p.scale.map(function(e){return w.formatDistance(e)}).join(" "))),g&&i(M),M}},{"./bounds":32,"./compute-id":35,"./coordinate-systems":36,"./delta":37,"./geomify":39,"./post-quantize":40,"./pre-quantize":41,"./stitch":47,"./topology/index":54,"./transform-properties":58,"./type":59}],49:[function(e,t){function n(e,t,n,a){r(e,t,n),r(e,t,t+a),r(e,t+a,n)}function r(e,t,n){for(var r,a=t+(n-- -t>>1);a>t;++t,--n)r=e[t],e[t]=e[n],e[n]=r}var a=e("./join");t.exports=function(e){for(var t=a(e),r=e.coordinates,i=e.lines,o=e.rings,l=0,u=i.length;u>l;++l)for(var s=i[l],c=s[0],d=s[1];++c<d;)if(t.has(r[c])){var f={0:c,1:s[1]};s[1]=c,s=s.next=f}for(var l=0,u=o.length;u>l;++l)for(var p=o[l],h=p[0],g=h,v=p[1],m=t.has(r[h]);++g<v;)if(t.has(r[g]))if(m){var f={0:g,1:p[1]};p[1]=g,p=p.next=f}else n(r,h,v,v-g),r[v]=r[h],m=!0,g=h;return e}},{"./join":55}],50:[function(e,t){var n=(e("./join"),e("./hashmap")),r=e("./point-hash"),a=e("./point-equal");t.exports=function(e){function t(e){var t,n,r,a;if(r=x.get(t=d[e[0]]))for(var i=0,u=r.length;u>i;++i){var s=r[i];if(o(s,e))return e[0]=s[0],void(e[1]=s[1])}if(a=x.get(n=d[e[1]]))for(var i=0,u=a.length;u>i;++i){var c=a[i];if(l(c,e))return e[1]=c[0],void(e[0]=c[1])}r?r.push(e):x.set(t,[e]),a?a.push(e):x.set(n,[e]),b.push(e)}function i(e){var t,n;if(n=x.get(t=d[e[0]]))for(var r=0,a=n.length;a>r;++r){var i=n[r];if(u(i,e))return e[0]=i[0],void(e[1]=i[1]);if(s(i,e))return e[0]=i[1],void(e[1]=i[0])}if(n=x.get(t=d[e[0]+c(e)]))for(var r=0,a=n.length;a>r;++r){var i=n[r];if(u(i,e))return e[0]=i[0],void(e[1]=i[1]);if(s(i,e))return e[0]=i[1],void(e[1]=i[0])}n?n.push(e):x.set(t,[e]),b.push(e)}function o(e,t){var n=e[0],r=t[0],i=e[1],o=t[1];if(n-i!==r-o)return!1;for(;i>=n;++n,++r)if(!a(d[n],d[r]))return!1;return!0}function l(e,t){var n=e[0],r=t[0],i=e[1],o=t[1];if(n-i!==r-o)return!1;for(;i>=n;++n,--o)if(!a(d[n],d[o]))return!1;return!0}function u(e,t){var n=e[0],r=t[0],i=e[1],o=t[1],l=i-n;if(l!==o-r)return!1;for(var u=c(e),s=c(t),f=0;l>f;++f)if(!a(d[n+(f+u)%l],d[r+(f+s)%l]))return!1;return!0}function s(e,t){var n=e[0],r=t[0],i=e[1],o=t[1],l=i-n;if(l!==o-r)return!1;for(var u=c(e),s=l-c(t),f=0;l>f;++f)if(!a(d[n+(f+u)%l],d[o-(f+s)%l]))return!1;return!0}function c(e){for(var t=e[0],n=e[1],r=t,a=r,i=d[r];++r<n;){var o=d[r];(o[0]<i[0]||o[0]===i[0]&&o[1]<i[1])&&(a=r,i=o)}return a-t}var d=e.coordinates,f=e.lines,p=e.rings,h=f.length+p.length;delete e.lines,delete e.rings;for(var g=0,v=f.length;v>g;++g)for(var m=f[g];m=m.next;)++h;for(var g=0,v=p.length;v>g;++g)for(var y=p[g];y=y.next;)++h;for(var x=n(2*h*1.4,r,a),b=e.arcs=[],g=0,v=f.length;v>g;++g){var m=f[g];do t(m);while(m=m.next)}for(var g=0,v=p.length;v>g;++g){var y=p[g];if(y.next){do t(y);while(y=y.next)}else i(y)}return e}},{"./hashmap":52,"./join":55,"./point-equal":56,"./point-hash":57}],51:[function(e,t){t.exports=function(e){function t(e){e&&s.hasOwnProperty(e.type)&&s[e.type](e)}function n(e){for(var t=0,n=e.length;n>t;++t)u[++i]=e[t];var r={0:i-n+1,1:i};return o.push(r),r}function r(e){for(var t=0,n=e.length;n>t;++t)u[++i]=e[t];var r={0:i-n+1,1:i};return l.push(r),r}function a(e){return e.map(r)}var i=-1,o=[],l=[],u=[],s={GeometryCollection:function(e){e.geometries.forEach(t)},LineString:function(e){e.arcs=n(e.coordinates),delete e.coordinates},MultiLineString:function(e){e.arcs=e.coordinates.map(n),delete e.coordinates},Polygon:function(e){e.arcs=e.coordinates.map(r),delete e.coordinates},MultiPolygon:function(e){e.arcs=e.coordinates.map(a),delete e.coordinates}};for(var c in e)t(e[c]);return{type:"Topology",coordinates:u,lines:o,rings:l,objects:e}}},{}],52:[function(e,t){t.exports=function(e,t,n,r,a,i){function o(r,i){for(var o=t(r)&f,l=c[o],u=0;l!=a;){if(n(l,r))return d[o]=i;if(++u>=e)throw new Error("full hashmap");l=c[o=o+1&f]}return c[o]=r,d[o]=i,--p,i}function l(r,i){for(var o=t(r)&f,l=c[o],u=0;l!=a;){if(n(l,r))return d[o];if(++u>=e)throw new Error("full hashmap");l=c[o=o+1&f]}return c[o]=r,d[o]=i,--p,i}function u(r,i){for(var o=t(r)&f,l=c[o],u=0;l!=a;){if(n(l,r))return d[o];if(++u>=e)break;l=c[o=o+1&f]}return i}function s(){for(var e=[],t=0,n=c.length;n>t;++t){var r=c[t];r!=a&&e.push(r)}return e}3===arguments.length&&(r=i=Array,a=null);for(var c=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),d=new i(e),f=e-1,p=e,h=0;e>h;++h)c[h]=a;return{set:o,maybeSet:l,get:u,keys:s}}},{}],53:[function(e,t){t.exports=function(e,t,n,r,a){function i(r){for(var i=t(r)&s,o=u[i],l=0;o!=a;){if(n(o,r))return!0;if(++l>=e)throw new Error("full hashset");o=u[i=i+1&s]}return u[i]=r,--c,!0}function o(r){for(var i=t(r)&s,o=u[i],l=0;o!=a;){if(n(o,r))return!0;if(++l>=e)break;o=u[i=i+1&s]}return!1}function l(){for(var e=[],t=0,n=u.length;n>t;++t){var r=u[t];r!=a&&e.push(r)}return e}3===arguments.length&&(r=Array,a=null);for(var u=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=e-1,c=e,d=0;e>d;++d)u[d]=a;return{add:i,has:o,values:l}}},{}],54:[function(e,t){function n(e){var t,n=e[0],r=e[1];return n>r&&(t=n,n=r,r=t),n+31*r}function r(e,t){var n,r=e[0],a=e[1],i=t[0],o=t[1];return r>a&&(n=r,r=a,a=n),i>o&&(n=i,i=o,o=n),r===i&&a===o}var a=e("./hashmap"),i=e("./extract"),o=e("./cut"),l=e("./dedup");t.exports=function(e){function t(e){e&&p.hasOwnProperty(e.type)&&p[e.type](e)}function u(e){var t=[];do{var n=f.get(e);t.push(e[0]<e[1]?n:~n)}while(e=e.next);return t}function s(e){return e.map(u)}var c=l(o(i(e))),d=c.coordinates,f=a(1.4*c.arcs.length,n,r);e=c.objects,c.arcs=c.arcs.map(function(e,t){return f.set(e,t),d.slice(e[0],e[1]+1)}),delete c.coordinates,d=null;var p={GeometryCollection:function(e){e.geometries.forEach(t)},LineString:function(e){e.arcs=u(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(u)},Polygon:function(e){e.arcs=e.arcs.map(u)},MultiPolygon:function(e){e.arcs=e.arcs.map(s)}};for(var h in e)t(e[h]);return c}},{"./cut":49,"./dedup":50,"./extract":51,"./hashmap":52}],55:[function(e,t){var n=e("./hashset"),r=e("./hashmap"),a=e("./point-hash"),i=e("./point-equal");t.exports=function(e){function t(e,t,n,r){if(p[n]!==e){p[n]=e;var a=h[n];if(a>=0){var i=g[n];a===t&&i===r||a===r&&i===t||(++m,v[n]=1)}else h[n]=t,g[n]=r}}function o(){for(var e=r(1.4*s.length,l,u,Int32Array,-1,Int32Array),t=new Int32Array(s.length),n=0,a=s.length;a>n;++n)t[n]=e.maybeSet(n,n);return t}function l(e){return a(s[e])}function u(e,t){return i(s[e],s[t])}for(var s=e.coordinates,c=e.lines,d=e.rings,f=o(),p=new Int32Array(s.length),h=new Int32Array(s.length),g=new Int32Array(s.length),v=new Int8Array(s.length),m=0,y=0,x=s.length;x>y;++y)p[y]=h[y]=g[y]=-1;for(var y=0,x=c.length;x>y;++y){var b,w=c[y],_=w[0],k=w[1],M=f[_],A=f[++_];for(++m,v[M]=1;++_<=k;)t(y,b=M,M=A,A=f[_]);++m,v[A]=1}for(var y=0,x=s.length;x>y;++y)p[y]=-1;for(var y=0,x=d.length;x>y;++y){var z=d[y],j=z[0]+1,E=z[1],b=f[E-1],M=f[j-1],A=f[j];for(t(y,b,M,A);++j<=E;)t(y,b=M,M=A,A=f[j])}p=h=g=null;for(var S,T=n(1.4*m,a,i),y=0,x=s.length;x>y;++y)v[S=f[y]]&&T.add(s[S]);return T}},{"./hashmap":52,"./hashset":53,"./point-equal":56,"./point-hash":57}],56:[function(e,t){t.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},{}],57:[function(e,t){var n=new ArrayBuffer(16),r=new Float64Array(n),a=new Uint32Array(n);t.exports=function(e){r[0]=e[0],r[1]=e[1];var t=a[0]^a[1];return t=t<<5^t>>7^a[2]^a[3],2147483647&t}},{}],58:[function(e,t){t.exports=function(e,t){function n(e){e&&a.hasOwnProperty(e.type)&&a[e.type](e)}function r(e){null==e.properties&&(e.properties={});var n=e.properties=t(e);if(n)for(var r in n)return;delete e.properties}arguments.length<2&&(t=function(){});var a={Feature:r,FeatureCollection:function(e){e.features.forEach(r)}};for(var i in e)n(e[i]);return e}},{}],59:[function(e,t){t.exports=function(e){for(var t in n)t in e||(e[t]=n[t]);return e.defaults=n,e};var n={Feature:function(e){e.geometry&&this.geometry(e.geometry)},FeatureCollection:function(e){for(var t=e.features,n=-1,r=t.length;++n<r;)this.Feature(t[n])},GeometryCollection:function(e){for(var t=e.geometries,n=-1,r=t.length;++n<r;)this.geometry(t[n])},LineString:function(e){this.line(e.coordinates)},MultiLineString:function(e){for(var t=e.coordinates,n=-1,r=t.length;++n<r;)this.line(t[n])},MultiPoint:function(e){for(var t=e.coordinates,n=-1,r=t.length;++n<r;)this.point(t[n])},MultiPolygon:function(e){for(var t=e.coordinates,n=-1,r=t.length;++n<r;)this.polygon(t[n])},Point:function(e){this.point(e.coordinates)},Polygon:function(e){this.polygon(e.coordinates)},object:function(e){return null==e?null:a.hasOwnProperty(e.type)?this[e.type](e):this.geometry(e)},geometry:function(e){return null==e?null:r.hasOwnProperty(e.type)?this[e.type](e):null},point:function(){},line:function(e){for(var t=-1,n=e.length;++t<n;)this.point(e[t])},polygon:function(e){for(var t=-1,n=e.length;++t<n;)this.line(e[t])}},r={LineString:1,MultiLineString:1,MultiPoint:1,MultiPolygon:1,Point:1,Polygon:1,GeometryCollection:1},a={Feature:1,FeatureCollection:1}},{}],60:[function(e,t){!function(){function e(e,t){function n(t){var n,r=e.arcs[0>t?~t:t],a=r[0];return e.transform?(n=[0,0],r.forEach(function(e){n[0]+=e[0],n[1]+=e[1]})):n=r[r.length-1],0>t?[n,a]:[a,n]}function r(e,t){for(var n in e){var r=e[n];delete t[r.start],delete r.start,delete r.end,r.forEach(function(e){a[0>e?~e:e]=1}),l.push(r)}}var a={},i={},o={},l=[],u=-1;return t.forEach(function(n,r){var a,i=e.arcs[0>n?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(a=t[++u],t[u]=n,t[r]=a)}),t.forEach(function(e){var t,r,a=n(e),l=a[0],u=a[1];if(t=o[l])if(delete o[t.end],t.push(e),t.end=u,r=i[u]){delete i[r.start];var s=r===t?t:t.concat(r);i[s.start=t.start]=o[s.end=r.end]=s}else i[t.start]=o[t.end]=t;else if(t=i[u])if(delete i[t.start],t.unshift(e),t.start=l,r=o[l]){delete o[r.end];var c=r===t?t:r.concat(t);i[c.start=r.start]=o[c.end=t.end]=c}else i[t.start]=o[t.end]=t;else t=[e],i[t.start=l]=o[t.end=u]=t}),r(o,i),r(i,o),t.forEach(function(e){a[0>e?~e:e]||l.push([e])}),l}function r(t,n,r){function a(e){var t=0>e?~e:e;(c[t]||(c[t]=[])).push({i:e,g:s})}function i(e){e.forEach(a)}function o(e){e.forEach(i)}function l(e){"GeometryCollection"===e.type?e.geometries.forEach(l):e.type in d&&(s=e,d[e.type](e.arcs))}var u=[];if(arguments.length>1){var s,c=[],d={LineString:i,MultiLineString:o,Polygon:o,MultiPolygon:function(e){e.forEach(o)}};l(n),c.forEach(arguments.length<3?function(e){u.push(e[0].i)}:function(e){r(e[0].g,e[e.length-1].g)&&u.push(e[0].i)})}else for(var f=0,p=t.arcs.length;p>f;++f)u.push(f);return{type:"MultiLineString",arcs:e(t,u)}}function a(t,r){function a(e){e.forEach(function(t){t.forEach(function(t){(o[t=0>t?~t:t]||(o[t]=[])).push(e)})}),u.push(e)}function i(e){return f(l(t,{type:"Polygon",arcs:[e]}).coordinates[0])>0}var o={},u=[],s=[];return r.forEach(function(e){"Polygon"===e.type?a(e.arcs):"MultiPolygon"===e.type&&e.arcs.forEach(a)}),u.forEach(function(e){if(!e._){var t=[],n=[e];for(e._=1,s.push(t);e=n.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){o[0>e?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}}),u.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:s.map(function(r){var a=[];if(r.forEach(function(e){e.forEach(function(e){e.forEach(function(e){o[0>e?~e:e].length<2&&a.push(e)})})}),a=e(t,a),(n=a.length)>1)for(var l,u=i(r[0][0]),s=0;n>s;++s)if(u===i(a[s])){l=a[0],a[0]=a[s],a[s]=l;break}return a})}}function i(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return o(e,t)})}:o(e,t)}function o(e,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:l(e,t)};return null==t.id&&delete n.id,n}function l(e,t){function n(e,t){t.length&&t.pop();for(var n,r=c[0>e?~e:e],a=0,i=r.length;i>a;++a)t.push(n=r[a].slice()),s(n,a);0>e&&u(t,i)}function r(e){return e=e.slice(),s(e,0),e}function a(e){for(var t=[],r=0,a=e.length;a>r;++r)n(e[r],t);return t.length<2&&t.push(t[0].slice()),t}function i(e){for(var t=a(e);t.length<4;)t.push(t[0].slice());return t}function o(e){return e.map(i)}function l(e){var t=e.type;return"GeometryCollection"===t?{type:t,geometries:e.geometries.map(l)}:t in d?{type:t,coordinates:d[t](e)}:null}var s=v(e.transform),c=e.arcs,d={Point:function(e){return r(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(r)},LineString:function(e){return a(e.arcs)},MultiLineString:function(e){return e.arcs.map(a)},Polygon:function(e){return o(e.arcs)},MultiPolygon:function(e){return e.arcs.map(o)}};return l(t)}function u(e,t){for(var n,r=e.length,a=r-t;a<--r;)n=e[a],e[a++]=e[r],e[r]=n}function s(e,t){for(var n=0,r=e.length;r>n;){var a=n+r>>>1;e[a]<t?n=a+1:r=a}return n}function c(e){function t(e,t){e.forEach(function(e){0>e&&(e=~e);var n=a[e];n?n.push(t):a[e]=[t]})}function n(e,n){e.forEach(function(e){t(e,n)})}function r(e,t){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,t)}):e.type in o&&o[e.type](e.arcs,t)}var a={},i=e.map(function(){return[]}),o={LineString:t,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach(function(e){n(e,t)})}};e.forEach(r);for(var l in a)for(var u=a[l],c=u.length,d=0;c>d;++d)for(var f=d+1;c>f;++f){var p,h=u[d],g=u[f];(p=i[h])[l=s(p,g)]!==g&&p.splice(l,0,g),(p=i[g])[l=s(p,h)]!==h&&p.splice(l,0,h)}return i}function d(e,t){function n(e){o.remove(e),e[1][2]=t(e),o.push(e)}var r,a=v(e.transform),i=m(e.transform),o=g(),l=0;for(t||(t=p),e.arcs.forEach(function(e){var n=[];e.forEach(a);for(var i=1,l=e.length-1;l>i;++i)r=e.slice(i-1,i+2),r[1][2]=t(r),n.push(r),o.push(r);e[0][2]=e[l][2]=1/0;for(var i=0,l=n.length;l>i;++i)r=n[i],r.previous=n[i-1],r.next=n[i+1]});r=o.pop();){var u=r.previous,s=r.next;r[1][2]<l?r[1][2]=l:l=r[1][2],u&&(u.next=s,u[2]=r[2],n(u)),s&&(s.previous=u,s[0]=r[0],n(s))}return e.arcs.forEach(function(e){e.forEach(i)}),e}function f(e){for(var t,n=-1,r=e.length,a=e[r-1],i=0;++n<r;)t=a,a=e[n],i+=t[0]*a[1]-t[1]*a[0];return.5*i}function p(e){var t=e[0],n=e[1],r=e[2];return Math.abs((t[0]-r[0])*(n[1]-t[1])-(t[0]-n[0])*(r[1]-t[1]))}function h(e,t){return e[1][2]-t[1][2]}function g(){function e(e,t){for(;t>0;){var n=(t+1>>1)-1,a=r[n];if(h(e,a)>=0)break;r[a._=t]=a,r[e._=t=n]=e}}function t(e,t){for(;;){var n=t+1<<1,i=n-1,o=t,l=r[o];if(a>i&&h(r[i],l)<0&&(l=r[o=i]),a>n&&h(r[n],l)<0&&(l=r[o=n]),o===t)break;r[l._=t]=l,r[e._=t=o]=e}}var n={},r=[],a=0;return n.push=function(t){return e(r[t._=a]=t,a++),a},n.pop=function(){if(!(0>=a)){var e,n=r[0];return--a>0&&(e=r[a],t(r[e._=0]=e,0)),n}},n.remove=function(n){var i,o=n._;if(r[o]===n)return o!==--a&&(i=r[a],(h(i,n)<0?e:t)(r[i._=o]=i,o)),o},n}function v(e){if(!e)return y;var t,n,r=e.scale[0],a=e.scale[1],i=e.translate[0],o=e.translate[1];return function(e,l){l||(t=n=0),e[0]=(t+=e[0])*r+i,e[1]=(n+=e[1])*a+o}}function m(e){if(!e)return y;var t,n,r=e.scale[0],a=e.scale[1],i=e.translate[0],o=e.translate[1];return function(e,l){l||(t=n=0);var u=(e[0]-i)/r|0,s=(e[1]-o)/a|0;e[0]=u-t,e[1]=s-n,t=u,n=s}}function y(){}var x={version:"1.6.14",mesh:function(e){return l(e,r.apply(this,arguments))},meshArcs:r,merge:function(e){return l(e,a.apply(this,arguments))},mergeArcs:a,feature:i,neighbors:c,presimplify:d};"function"==typeof define&&define.amd?define(x):"object"==typeof t&&t.exports?t.exports=x:this.topojson=x}()},{}],61:[function(e){var t=e("../core/fetch/value.js"),n=e("../core/fetch/color.js"),r=e("../core/fetch/text.js");d3plus.array.sort=function(e,a,i,o,l){function u(e,u){for(var s=0,c=0;c<a.length;c++){var d=a[c];if(l){var f=e.d3plus?l.id.nesting[e.d3plus.depth]:void 0,p=e.d3plus?e.d3plus.depth:void 0;e=d===l.color.value?n(l,e,f):d===l.text.value?r(l,e,p):t(l,e,d,f);var f=u.d3plus?l.id.nesting[u.d3plus.depth]:void 0,p=u.d3plus?u.d3plus.depth:void 0;u=d===l.color.value?n(l,u,f):d===l.text.value?r(l,u,p):t(l,u,d,f)}else e=e[d],u=u[d];if(e=e instanceof Array?e=e[0]:"string"==typeof e?e=e.toLowerCase():e,u=u instanceof Array?u=u[0]:"string"==typeof u?u=u.toLowerCase():u,s=o.indexOf(d)>=0?d3plus.color.sort(e,u):u>e?-1:1,0!==s||c===a.length-1)break}return"asc"===i?s:-s}if(!e||e.length<=1||!a)return e||[];if(!i)var i="asc";if(a instanceof Array||(a=[a]),o)o instanceof Array||(o=[o]);else var o=["color"];return 2===e.length?u(e[0],e[1]):e.sort(u)}},{"../core/fetch/color.js":78,"../core/fetch/text.js":80,"../core/fetch/value.js":81}],62:[function(){d3plus.array.update=function(e,t){return e instanceof Array||(e=[]),t instanceof Array?e=t:e.indexOf(t)>=0?e.splice(e.indexOf(t),1):e.push(t),e
}},{}],63:[function(){d3plus.color.legible=function(e){var t;return t=d3.hsl(e),t.l>.45&&(t.s>.8&&(t.s=.8),t.l=.45),t.toString()}},{}],64:[function(){d3plus.color.lighter=function(e,t){var n;return void 0===t&&(t=.5),n=d3.hsl(e),n.l+=(1-n.l)*t,n.toString()}},{}],65:[function(){d3plus.color.mix=function(e,t,n,r){var a,i,o;return n||(n=1),r||(r=1),e=d3.rgb(e),t=d3.rgb(t),o=(n*e.r+r*t.r-n*r*t.r)/(n+r-n*r),i=(n*e.g+r*t.g-n*r*t.g)/(n+r-n*r),a=(n*e.b+r*t.b-n*r*t.b)/(n+r-n*r),d3.rgb(o,i,a).toString()}},{}],66:[function(){d3plus.color.random=function(e,t){var n;return n=e||Math.floor(20*Math.random()),(t=t||d3plus.color.scale)(n)}},{}],67:[function(){d3plus.color.scale=d3.scale.ordinal().range(["#b22200","#EACE3F","#282F6B","#B35C1E","#224F20","#5F487C","#759143","#419391","#993F88","#e89c89","#ffee8d","#afd5e8","#f7ba77","#a5c697","#c5b5e5","#d1d392","#bbefd0","#e099cf"])},{}],68:[function(){d3plus.color.sort=function(e,t){var n,r;return n=d3.hsl(e),r=d3.hsl(t),e=0===n.s?361:n.h,t=0===r.s?361:r.h,e===t?n.l-r.l:e-t}},{}],69:[function(){d3plus.color.text=function(e){var t,n,r,a,i;return a=d3.rgb(e),r=a.r,n=a.g,t=a.b,i=(299*r+587*n+114*t)/1e3,i>=128?"#444444":"#f7f7f7"}},{}],70:[function(){d3plus.color.validate=function(e){var t,n,r;return e+="",e=e.replace(RegExp(" ","g"),""),0===e.indexOf("rgb")&&(e=e.split("(")[1].split(")")[0].split(",").slice(0,3).join(",")),0===e.indexOf("hsl")&&(e=e.split(",")[2].split(")")[0]),n=d3.rgb(e).toString(),t=["black","#000","#000000","0%","0,0,0"],r=t.indexOf(e)>=0,"#000000"!==n||r}},{}],71:[function(e,t){var n=e("../fetch/value.js");t.exports=function(e){e.dev.value&&d3plus.console.time("getting color data range");var t=[];if(e.data.pool.forEach(function(r){var a=parseFloat(n(e,r,e.color.value));"number"==typeof a&&!isNaN(a)&&t.indexOf(a)<0&&t.push(a)}),e.dev.value&&d3plus.console.timeEnd("getting color data range"),t.length>1){if(e.dev.value&&d3plus.console.time("calculating color scale"),t=d3.extent(t),t[0]<0&&t[1]>0){var r=e.color.range;3==r.length&&(t.push(t[1]),t[1]=0)}else if(t[1]>0&&t[0]>=0){var r=e.color.heatmap;t=d3plus.util.buckets(t,r.length)}else{var r=e.color.range.slice(0);t[0]<0?r.pop():r.shift()}e.color.valueScale=d3.scale.sqrt().domain(t).range(r).interpolate(d3.interpolateRgb),e.dev.value&&d3plus.console.timeEnd("calculating color scale")}else e.color.valueScale=null}},{"../fetch/value.js":81}],72:[function(e,t){var n=e("../fetch/value.js");t.exports=function(e,t){e.dev.value&&d3plus.console.time("filtering data");var r=d3.keys(e.data.keys||{});"attrs"in e&&(r=r.concat(d3.keys(e.attrs.keys||{}))),t=t.filter(function(t){return e.id.value in t}),e.data.filters.forEach(function(a){r.indexOf(e[a].value)>=0&&(t=t.filter(function(t){var r=n(e,t,e[a].value);return"size"===a?"number"==typeof r:null!==r}))});var a=e.data.solo.length?"solo":"mute";return e.data[a].forEach(function(r){function i(t){var n=e[r][a].value,i=!1;return n.forEach(function(e){"function"==typeof e?i=e(t):e===t&&(i=!0)}),i}function o(t){var o=!1;if(e[r].nesting){var l=e[r].nesting;d3plus.object.validate(l)&&(l=d3.keys(l)),l.forEach(function(r){o||(o=i(n(e,t,r)))})}else o=i(n(e,t,e[r].value));return"solo"===a?o:!o}t=t.filter(o),"id"===r&&("nodes"in e&&e.nodes.value&&(e.dev.value&&d3plus.console.log("Filtering Nodes"),e.nodes.restricted=e.nodes.value.filter(o)),"edges"in e&&e.edges.value&&(e.dev.value&&d3plus.console.log("Filtering Connections"),e.edges.restricted=e.edges.value.filter(function(t){var n=o(t[e.edges.source]),r=o(t[e.edges.target]);return n&&r})))}),e.dev.value&&d3plus.console.timeEnd("filtering data"),t}},{"../fetch/value.js":81}],73:[function(e,t){var n=e("./nest.js"),r=e("../fetch/value.js");t.exports=function(e){if(e.data.time={values:[]},e.time&&e.time.value){if(e.dev.value){var t="analyzing time periods";d3plus.console.time(t)}for(var a=d3plus.util.uniques(e.data.value,e.time.value),i=0;i<a.length;i++){var o=new Date(a[i].toString());"Invalid Date"!==o&&(o.setTime(o.getTime()+60*o.getTimezoneOffset()*1e3),e.data.time.values.push(o))}e.data.time.values.sort(function(e,t){return e-t});var l=[];e.data.time.values.forEach(function(t,n){if(0!=n){var r=e.data.time.values[n-1];l.push(t-r),n===e.data.time.values.length-1&&(e.data.time.total=t-e.data.time.values[0])}}),e.data.time.step=d3.min(l);var u=["Milliseconds","Seconds","Minutes","Hours","Date","Month","FullYear"],s=[1e3,60,60,24,30,12,1],c=function(t,n,r){return e.data.time.stepDivider||(e.data.time.stepDivider=s.slice(0,r).reduce(function(e,t){return e*t})),Math.round(Math.floor(n-t)/e.data.time.stepDivider)},l=e.data.time.step,d=e.data.time.total;u.forEach(function(t,n){if(!e.data.time.stepType&&(n===u.length-1||Math.round(l)<s[n])){e.data.time.stepType=t;var r=e.data.time.values[0],a=e.data.time.values[e.data.time.values.length-1];e.data.time.stepIntervals=c(r,a,n)}!e.data.time.totalType&&(n===u.length-1||Math.round(d)<s[n])&&(e.data.time.totalType=t),l/=s[n],d/=s[n]}),e.data.time.values.forEach(function(t,n){if(0!=n){var r=e.data.time.values[0];e.data.time.dataSteps.push(c(r,t,u.indexOf(e.data.time.stepType)))}else e.data.time.dataSteps=[0]});for(var f=e.data.time.stepType,p=e.data.time.totalType,h=e.format.locale.value,g=function(e,t,n){if(e===t)return n&&h.timeFormat[e+"Small"]?h.timeFormat[e+"Small"]:h.timeFormat[e];if(u.indexOf(e)>=4||u.indexOf(t)<=3)return h.timeFormat[t+"-"+e];if("Date"===t)var r=h.timeFormat[t];else var r=h.timeFormat[t+"-Date"];return"Hours"===e?r+" "+h.timeFormat[e]:r+" "+h.timeFormat["Hours-"+e]},v=[],m=[,function(e){return e.getMilliseconds()},function(e){return e.getSeconds()},function(e){return e.getMinutes()},function(e){return e.getHours()},function(e){return 1!=e.getDate()},function(e){return e.getMonth()},function(){return!0}],i=u.indexOf(f);i<=u.indexOf(p);i++){var y=i-1<u.indexOf(f)?u[i]:u[i-1],x=u[i]===y&&f!==p,b=g(y,u[i],x);v.push([b,m[i+1]])}e.data.time.format=d3.locale(h.format).timeFormat(g(f,p)),e.data.time.multiFormat=d3.locale(h.format).timeFormat.multi(v),e.data.time.ticks=[];for(var w=d3.min(e.data.time.values),i=0;i<=e.data.time.stepIntervals;i++){var o=new Date(w);o["set"+e.data.time.stepType](o["get"+e.data.time.stepType]()+i),e.data.time.ticks.push(o)}e.dev.value&&d3plus.console.timeEnd(t)}if(e.dev.value){var t="nesting data by time and depths";d3plus.console.time(t)}e.data.nested={},0===e.data.time.values.length?(e.data.nested.all={},e.id.nesting.forEach(function(t,r){var a=e.id.nesting.slice(0,r+1);e.data.nested.all[t]=n(e,e.data.value,a)})):e.data.time.values.forEach(function(t){var a=t.getTime();e.data.nested[a]={};var i=e.data.value.filter(function(t){var t=new Date(r(e,t,e.time.value).toString());return t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3),t.getTime()===a});e.id.nesting.forEach(function(t,r){var o=e.id.nesting.slice(0,r+1);e.data.nested[a][t]=n(e,i,o)})}),e.dev.value&&d3plus.console.timeEnd(t)}},{"../fetch/value.js":81,"./nest.js":76}],74:[function(e,t){t.exports=function(e,t){function n(r){if(r instanceof Array)r.forEach(function(e){n(e)});else if(d3plus.object.validate(r))for(var a in r)d3plus.object.validate(r[a])?n(r[a]):!(a in e[t].keys)&&a in r&&(e[t].keys[a]=typeof r[a])}if(e.dev.value){var r=t+" key analysis";console.time(r)}if(e[t].keys={},d3plus.object.validate(e[t].value))for(var a in e[t].value)n(e[t].value[a]);else n(e[t].value);e.dev.value&&console.time(r)}},{}],75:[function(e,t){t.exports=function(e,t,n){var r,a,i;return e.dev.value&&d3plus.console.time("loading "+t),i=e[t].url,e[t].filetype.value?r=e[t].filetype.value:(r=i.slice(i.length-5).split("."),r=r.length>1?r[1]:!1,r?("txt"===r&&(r="text"),e[t].filetype.accepted.indexOf(r)<0&&(r="json")):r="json"),(a="dsv"===r?d3.dsv(e[t].delimiter.value,"text/plain"):d3[r])(i,function(a,o){var l,u;if(!a&&o){if("function"==typeof e[t].callback){if(u=e[t].callback(o))if(d3plus.object.validate(u)&&t in u)for(l in u)l in e&&(e[l].value=u[l]);else e[t].value=u}else e[t].value=o;["json"].indexOf(r)<0&&e[t].value.forEach(function(e){var t;t=[];for(l in e)t.push(isNaN(e[l])?"false"===e[l].toLowerCase()?e[l]=!1:"true"===e[l].toLowerCase()?e[l]=!0:"null"===e[l].toLowerCase()?e[l]=null:"undefined"===e[l].toLowerCase()?e[l]=void 0:void 0:e[l]=parseFloat(e[l]));return t}),e[t].changed=!0,e[t].loaded=!0}else e.internal_error='Could not load data from: "'+i+'"';return e.dev.value&&d3plus.console.time("loading "+t),n()})}},{}],76:[function(e,t){var n=e("../fetch/value.js"),r=function(e,t,a,i){var o=d3.nest(),l=[],u="viz"===e.shell?["active","temp","total"]:[],i=i||e.types[e.type.value].requirements||[],s="viz"===e.shell?[e.time.value,e.icon.value]:[],c=function(){i&&i.length&&e.axes.values.forEach(function(t){var r=e[t].value;i.indexOf(t)>=0&&r&&"continuous"===e[t].scale.value&&(s.push(r),o.key(function(t){return n(e,t,r)}))})};i instanceof Array||(i=[i]),a.forEach(function(t){o.key(function(r){return"function"==typeof t?t(r):n(e,r,t)}),c()}),a.length||(o.key(function(){return!0}),c());var d=a.length?a.length-1:0;o.rollup(function(t){function i(e){for(var t=0;t<e.length;t++){var n=e[t];void 0!==n&&(n.constructor===Date?y.push(n):n.constructor===Array?i(n):(n=new Date(n.toString()),"Invalid Date"!==n&&(n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3),y.push(n))))}}function o(e){e instanceof Array?e.forEach(o):d3plus.object.validate(e)&&c in e&&(e[c]instanceof Array?e[c].forEach(o):x.push(e))}if(1===t.length&&"d3plus"in t[0])return l.push(t[0]),t[0];var s={d3plus:{depth:d}};"d3plus"in t[0]&&t.forEach(function(e){"d3plus"in e&&(e.d3plus.merged instanceof Array&&(s.d3plus.merged||(s.d3plus.merged=[]),s.d3plus.merged=s.d3plus.merged.concat(e.d3plus.merged)),e.d3plus.text&&(s.d3plus.text=e.d3plus.text))}),u.forEach(function(r){var a=e[r].value||r;s.d3plus[a]=d3.sum(t,function(t){if(e[r].value){var a=n(e,t,e[r].value);"number"!=typeof a&&(a=a?1:0)}else if("total"===r)var a=1;else var a=0;return a})});for(var c in e.data.keys){var f=e.aggs.value[c]||"sum",p=typeof f,h=e.data.keys[c],g=e.id.nesting.indexOf(c)>=0,v="time"in e&&c===e.time.value;if(c in s.d3plus)s[c]=s.d3plus[c];else if("function"===p)s[c]=e.aggs.value[c](t);else if(v){var m=d3plus.util.uniques(t,c),y=[];i(m),s[c]=1===y.length?y[0]:m.length?y:null}else if("number"!==h||"string"!==p||g){var x=[];o(t);var b=1===x.length?x[0][c]:d3plus.util.uniques(x,c);if(void 0!==b&&null!==b){if(b instanceof Array||(b=[b]),b.length)if(g&&e.id.nesting.indexOf(c)>d&&x.length>1){if("id"==c&&1==a.length&&x.length>t.length){var w=a.concat(c);x=r(e,x,w)}s[c]=1===x.length?x[0]:x}else s[c]=1===b.length?b[0]:b}else if(g){var _=e.id.nesting.indexOf(c)-1;_>=d&&(!("endPoint"in s.d3plus)||s.d3plus.endPoint>d)&&(s.d3plus.endPoint=d)}}else{var m=d3plus.util.uniques(t,c);s[c]=m.length?d3[f](m):null}}return l.push(s),s});var f=function(e){return e.values&&e.values.length?(e.children=e.values.map(function(e){return f(e)}),delete e.values,e):e.values?e.values:e},p=function(t,n,r){if(t.children){"number"==e.data.keys[a[n]]&&(t.key=parseFloat(t.key)),r[a[n]]=t.key,delete t.key;for(var i in r)t[i]=r[i];n++,t.children.forEach(function(e){p(e,n,r)})}};return o=o.entries(t).map(f).map(function(e){return p(e,0,{}),e}),l};t.exports=r},{"../fetch/value.js":81}],77:[function(e,t){var n=e("./nest.js"),r=e("../fetch/value.js"),a=(e("../fetch/color.js"),e("../fetch/text.js"));t.exports=function(e,t,i){if(e.size.threshold===!1)var o=0;else if("number"==typeof e.size.threshold)var o=e.size.threshold;else if("number"==typeof e.types[e.type.value].threshold)var o=e.types[e.type.value].threshold;else if("function"==typeof e.types[e.type.value].threshold)var o=e.types[e.type.value].threshold(e);else var o=.02;if("number"==typeof o&&o>0){var l=[],u=0==e.depth.value?0:{},s=[],c={},d=d3.nest();i&&d.key(function(t){return r(e,t,i)}),d.rollup(function(t){var n=t.length;e.aggs[e.size.value]?"function"==typeof e.aggs[e.size.value]?n=e.aggs[e.size.value](t):"string"==typeof e.aggs[e.size.value]&&(n=d3[e.aggs[e.size.value]](t,function(t){return r(e,t,e.size.value)})):n=d3.sum(t,function(t){return r(e,t,e.size.value)});var a=i?r(e,t[0],i):"all";return c[a]=n,n}).entries(t);var f=t.filter(function(t){var n=r(e,t,e.id.value),a=r(e,t,e.size.value),d=i?r(e,t,i):"all";if(l.indexOf(n)<0&&a/c[d]>=o&&l.push(n),l.indexOf(n)<0){if(0==e.depth.value)a>u&&(u=a);else{var f=t[e.id.nesting[e.depth.value-1]];f in u||(u[f]=0),a>u[f]&&(u[f]=a)}return s.push(t),!1}return!0});if(s.length>1){s=d3plus.array.sort(s,e.size.value,"desc",[],e);var p=e.id.nesting.slice(0,e.depth.value),h=n(e,s,p);h.forEach(function(t){var n=e.id.nesting[e.depth.value-1];if(e.id.nesting.forEach(function(n,r){if(e.depth.value==r){var a=t[e.id.nesting[r-1]];t[n]="string"==typeof a?"d3plus_other_"+a:"d3plus_other"}else r>e.depth.value&&delete t[n]}),e.color.value&&"string"===e.color.type&&(t[e.color.value]=0==e.depth.value?e.color.missing:r(e,t[n],e.color.value,n)),e.icon.value&&(t[e.icon.value]=r(e,t[n],e.icon.value,n)),t[n]&&(t.d3plus.depth=e.depth.value),0==e.depth.value){var i=e.format.value(e.format.locale.value.ui.values);i+=" < "+e.format.value(u)}else{var i=a(e,t,e.depth.value-1);i=i.length?i[0].split(" < ")[0]:e.format.value(e.format.locale.value.ui.values),i+=" < "+e.format.value(u[t[n]],e.size.value)}i+=" ("+e.format.value(100*o)+"%)",t.d3plus.threshold=u,n?(t.d3plus.merged=[],s.forEach(function(e){t[n]==e[n]&&t.d3plus.merged.push(e)})):t.d3plus.merged=s,e.text.value?t[e.text.value]=i:t.d3plus.text=i})}else h=s;return f.concat(h)}return t}},{"../fetch/color.js":78,"../fetch/text.js":80,"../fetch/value.js":81,"./nest.js":76}],78:[function(e,t){var n=e("./value.js");t.exports=function(e,t,r){function a(t){return d3plus.object.validate(t)&&(t=t[r]),t instanceof Array&&(t=t[0]),d3plus.color.random(t,e.color.scale.value)}if(!r)var r=e.id.value;if(e.color.value){for(var i=e.id.nesting.indexOf(r);i>=0;i--){var o=e.id.nesting[i],l=d3plus.object.validate(t)&&!(e.color.value in t)&&t[r]instanceof Array?t[r][0]:n(e,t,o),u=n(e,l,e.color.value,o);if(u)break}return u?e.color.valueScale?e.color.valueScale(u):d3plus.color.validate(u)?u:a(u):e.color.value||"function"==typeof e.color.valueScale?e.color.missing:a(t)}return a(t)}},{"./value.js":81}],79:[function(e,t){var n=e("../data/filter.js"),r=e("../data/nest.js");t.exports=function(e,t){if(!e.data.value)return[];if(!t&&"time"in e){var a=e.time.solo.value.length?"solo":"mute",t=[];if(e.time[a].value.length){var t=[];e.time[a].value.forEach(function(n){if("function"==typeof n)e.data.time.values.forEach(function(e){n(e.getTime())&&t.push(e.getTime())});else if(n.constructor===Date)t.push(new Date(n).getTime());else{var r=new Date(n.toString());"Invalid Date"!==r&&(r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3),t.push(r.getTime()))}}),"mute"===a&&(t=e.data.time.values.filter(function(e){return t.indexOf(e.getTime())<0}))}else t.push("all")}else t=["all"];if(t.indexOf("all")>=0&&e.data.time.values.length){t=e.data.time.values.slice(0);for(var i=0;i<t.length;i++)t[i]=t[i].getTime()}var o=[e.type.value,e.id.value,e.depth.value].concat(e.data.filters).concat(t),l=e.data.solo.length?"solo":"mute",u=d3.keys(e.data.cache),s="viz"===e.shell?e.types[e.type.value].filter:null;e.data[l].length&&e.data[l].forEach(function(t){var n=e[t][l].value.slice(0);n.unshift(t),o=o.concat(n)}),o=o.join("_");for(var i=0;i<u.length;i++){var c=u[i].split("_").slice(1).join("_");if(c===o){o=(new Date).getTime()+"_"+o,e.data.cache[o]=e.data.cache[u[i]],delete e.data.cache[u[i]];break}}if(e.data.cache[o]){e.dev.value&&d3plus.console.comment("data already cached");var d=e.data.cache[o];return"function"==typeof s&&(d=s(e,d)),d}var f=[],d=[];if(e.data.value&&e.data.value.length&&t.forEach(function(t){e.data.nested[t]?d=d.concat(e.data.nested[t][e.id.value]):f.push(t)}),0===d.length&&f.length&&!e.internal_error){var p=e.time.format.value||e.data.time.format;f.length>1&&(f=d3.extent(f)),f=f.map(function(e){return p(new Date(e))}),f=f.join(" - ");var h=e.format.locale.value.error.dataYear,g=e.format.locale.value.ui.and;f=d3plus.string.list(f,g),e.internal_error=d3plus.string.format(h,f),e.time.missing=!0}else{if(e.time&&(e.time.missing=!1),t.length>1){var v=!1;if(e.axes.values.forEach(function(t){e[t].value===e.time.value&&"continuous"===e[t].scale.value&&(v=!0)}),!v){var m=e.id.nesting.slice(0,e.depth.value+1);d=r(e,d,m)}}d=d?n(e,d):[];var u=d3.keys(e.data.cache);20===u.length&&(u.sort(),delete e.data.cache(u[0])),o=(new Date).getTime()+"_"+o,e.data.cache[o]=d,"function"==typeof s&&(d=s(e,d)),e.dev.value&&d3plus.console.comment("storing data in cache")}return d}},{"../data/filter.js":72,"../data/nest.js":76}],80:[function(e,t){var n=e("./value.js");t.exports=function(e,t,r){if("number"!=typeof r)var r=e.depth.value;var a=e.id.nesting[r];if(e.text.nesting&&d3plus.object.validate(e.text.nesting))if(e.text.nesting[a])var i=e.text.nesting[a];else var i=e.text.value;else{var i=[];e.text.value&&r===e.depth.value&&i.push(e.text.value),i.push(a)}i instanceof Array||(i=[i]);var o=[];if(d3plus.object.validate(t)&&"d3plus"in t&&t.d3plus.text)o.push(t.d3plus.text.toString());else{var l=d3plus.object.validate(t)&&a in t?t[a]:n(e,t,a);l instanceof Array?d3plus.object.validate(l[0])&&(l=d3plus.util.uniques(l,a)):l=[l],i.forEach(function(t){var r=[];l.forEach(function(i){var o=n(e,i,t,a);o&&(o instanceof Array&&d3plus.object.validate(o[0])&&(o=d3plus.util.uniques(o,t)),r=r.concat(o))}),r.length&&(r=r.map(function(n){return n instanceof Array?n.map(function(n){return e.format.value(n.toString(),t)}):n?e.format.value(n.toString(),t):void 0}),1===r.length&&(r=r[0]),o.push(r))})}return o}},{"./value.js":81}],81:[function(e,t){t.exports=function(e,t,n,r){function a(e){if(t instanceof Array){var n=d3plus.util.uniques(t,r);return e.filter(function(e){return n.indexOf(e[r])>=0})}return e.filter(function(e){return e[r]===t})}function i(e){var t=d3plus.util.uniques(e,n);return 1===t.length?t[0]:void 0}if(n&&"function"==typeof n)return n(t);if(!n)return null;if(!r)if(d3plus.object.validate(n)){if(n[e.id.value])var r=e.id.value;else var r=d3.keys(n)[0];n=n[r]}else var r=e.id.value;if(n===r){if(d3plus.object.validate(t)&&n in t)return t[n];if(!(t instanceof Array))return t}if(d3plus.object.validate(t)&&n in t)return t[n];if(d3plus.object.validate(t)&&r in t){var o=i(t);if(o)return o;t=t[r]}if(t instanceof Array){var o=i(t);if(o)return o}if(e.data.app instanceof Array){var o=i(a(e.data.app));if(o)return o}if("attrs"in e&&e.attrs.value)if(e.attrs.value instanceof Array)var l=a(e.attrs.value);else if(r in e.attrs.value)if(e.attrs.value[r]instanceof Array)var l=a(e.attrs.value[r]);else var l=e.attrs.value[r];else var l=e.attrs.value;if(d3plus.object.validate(l)){var u=[];t instanceof Array?(d3plus.object.validate(t[0])&&(t=d3plus.util.uniques(t,r)),t.forEach(function(e){u.push(l[e])})):u.push(l[t]),l=u}if(l&&l.length){var s=d3plus.util.uniques(l,n);if(1===s.length)return s[0];if(s.length)return s}return null}},{}],82:[function(e,t){t.exports=function(e){var t,n;return["div","svg"].indexOf(e)<0&&(e="div"),t={position:"absolute",left:"-9999px",top:"-9999px",visibility:"hidden",display:"block"},n=d3.select("body").selectAll(e+".d3plus_tester").data(["d3plus_tester"]),n.enter().append(e).attr("class","d3plus_tester").style(t),n}},{}],83:[function(e,t){var n=function(e,t){e.changed&&(e.changed=!1),"draw"===t&&(e.frozen=!1,e.update=!0,e.first=!1);for(var r in e)d3plus.object.validate(e[r])&&n(e[r],r)};t.exports=n},{}],84:[function(e,t){t.exports=function(e){if(e.dev.value){var t="analyzing edges list";d3plus.console.time(t)}var n=e.types[e.type.value].requirements;n instanceof Array||(n=[n]);var r=n.indexOf("nodes")>=0&&!e.nodes.value;if(r){e.nodes.value=[];var a=[];e.nodes.changed=!0}e.edges.value.forEach(function(t){if("object"!=typeof t[e.edges.source]){var n={};n[e.id.value]=t[e.edges.source],t[e.edges.source]=n}if("object"!=typeof t[e.edges.target]){var n={};n[e.id.value]=t[e.edges.target],t[e.edges.target]=n}"keys"in e.data||(e.data.keys={}),e.id.value in e.data.keys||(e.data.keys[e.id.value]=typeof t[e.edges.source][e.id.value]),r&&(a.indexOf(t[e.edges.source][e.id.value])<0&&(a.push(t[e.edges.source][e.id.value]),e.nodes.value.push(t[e.edges.source])),a.indexOf(t[e.edges.target][e.id.value])<0&&(a.push(t[e.edges.target][e.id.value]),e.nodes.value.push(t[e.edges.target])))}),e.edges.value=e.edges.value.filter(function(t){var n=t[e.edges.source][e.id.value],r=t[e.edges.target][e.id.value];if(n===r){var a=e.format.locale.value.dev.sameEdge;return d3plus.console.warning(d3plus.string.format(a,'"'+n+'"'),"edges"),!1}return!0}),e.edges.linked=!0,e.dev.value&&d3plus.console.timeEnd(t)}},{}],85:[function(e,t){t.exports=function(e){function t(e,t){[].forEach.call(t.attributes,function(t){if(/^data-/.test(t.name)){var n=t.name.substr(5).replace(/-(.)/g,function(e,t){return t.toUpperCase()});e[n]=t.value}}),r.forEach(function(n){null!==t.getAttribute(n)&&(e[n]=t.getAttribute(n))})}function n(e){e.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}var r=[e.color.value,e.icon.value,e.keywords.value,e.alt.value,"style"];e.text.value||e.self.text("text"),r=r.concat(e.id.nesting),e.self.data({element:e.data.value});var a=e.data.element.value.node().tagName.toLowerCase(),i=e.data.element.value.attr("type"),o=[];if("select"===a){var l=e.data.element.value.node().id;l&&e.self.container({id:l}),e.data.element.value.selectAll("option").each(function(n,r){var a={};if(a.text=this.innerHTML,t(a,this),o.push(a),this.selected)for(var r=e.id.nesting.length-1;r>=0;r--){var i=e.id.nesting[r];if(i in a){e.self.focus(a[i]);break}}})}else if("input"===a&&"radio"===i){var u=e.data.element.value.node().getAttribute("name");u&&e.self.container({id:u}),e.data.element.value.each(function(){var r={};t(r,this);var a=r[e.id.value]||this.id||!1;if(a&&isNaN(parseFloat(a))){var i=d3.select("label[for="+a+"]");i.empty()||(r.text=i.html(),i.call(n))}o.push(r),this.checked&&(e.focus.value[0]=r[e.id.value])})}!e.focus.value.length&&o.length&&(e.data.element.value.node().selectedIndex=0,e.self.focus(o[0][e.id.value]));var s=d3.select("legend[for="+e.container.id+"]");s.empty()||(e.self.title(s.html()),s.call(n));var c=e.container.value?e.container.value.node().tagName.toLowerCase():!1;return(e.container.value===!1||"body"===c)&&(e.container.value=d3.select(e.data.element.value.node().parentNode)),o}},{}],86:[function(e,t){t.exports=function(e){if(e.dev.value){var t="analyzing node positions";d3plus.console.time(t)}var n=e.nodes.value.filter(function(e){return"number"==typeof e.x&&"number"==typeof e.y}).length;if(n==e.nodes.value.length)e.nodes.positions=!0;else{var r=d3.layout.force().size([e.width.viz,e.height.viz]).nodes(e.nodes.value).links(e.edges.value),a=50,i=.01;r.start();for(var o=a;o>0&&(r.tick(),!(r.alpha()<i));--o);r.stop(),e.nodes.positions=!0}e.dev.value&&d3plus.console.timeEnd(t)}},{}],87:[function(e){var t;t=e("numeric"),d3plus.data.bestRegress=function(e,n){var r,a,i,o,l,u,s,c,d,f,p,h,g,v,m,y,x,b,w,_,k,M,A,z,j;for(null==n&&(n={}),null==n.maxDegree&&(n.maxDegree=5),r=e.length,m=Number.MAX_VALUE,l=null,i=function(){var t,r,a;for(a=[],c=t=1,r=n.maxDegree+1;r>=1?r>t:t>r;c=r>=1?++t:--t)a.push(function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)v=e[t],r.push(Math.pow(v[0],c));return r}());return a}(),_=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)v=e[t],r.push(v[1]);return r}(),f=M=0,z=1<<n.maxDegree;z>=0?z>M:M>z;f=z>=0?++M:--M){for(o=[function(){var e,t;for(t=[],y=e=0;r>=0?r>e:e>r;y=r>=0?++e:--e)t.push(1);return t}()],d=[0],p=A=0,j=n.maxDegree;j>=0?j>A:A>j;p=j>=0?++A:--A)(f&1<<p)>0&&(o.push(i[p]),d.push(p+1));a=t.transpose(o),h=d.length,u=t.dot(t.dot(t.inv(t.dot(o,a)),o),_),k=t.dot(a,u),x=t.sub(_,k),w=t.dot(x,x),b=w/(r-h),g=-.5*r*Math.log(2*Math.PI)-.5*r*Math.log(b)-w/(2*b),s=-2*g+h*(Math.log(r)-Math.log(2*Math.PI)),m>s&&(m=s,l=[d,u,k])}return l}},{numeric:7}],88:[function(e){var t;t=e("static-kdtree"),d3plus.data.lof=function(e,n){var r,a,i,o,l,u,s,c,d,f,p,h;return null==n&&(n=10),h=t(e),s=function(){var t,r,a;for(a=[],t=0,r=e.length;r>t;t++)c=e[t],a.push(h.knn(c,n+1).slice(1));return a}(),p=function(t,n){var r,a,i,o,l,u;for(r=e[t],a=e[n],o=0,t=l=0,u=r.length;u>=0?u>l:l>u;t=u>=0?++l:--l)i=r[t]-a[t],o+=i*i;return o},o=function(){var t,r,i;for(i=[],a=t=0,r=e.length;r>=0?r>t:t>r;a=r>=0?++t:--t)i.push(p(a,s[a][n-1]));return i}(),d=function(e,t){return Math.max(p(e,t),o[t])},l=function(e){var t,r,a,i,o;for(r=0,o=s[e],a=0,i=o.length;i>a;a++)t=o[a],r+=d(e,t);return n/r},u=function(){var t,n,r;for(r=[],a=t=0,n=e.length;n>=0?n>t:t>n;a=n>=0?++t:--t)r.push(l(a));return r}(),f=function(){var t,o,l,c,d,f;for(f=[],a=t=0,c=e.length;c>=0?c>t:t>c;a=c>=0?++t:--t){for(r=0,d=s[a],o=0,l=d.length;l>o;o++)i=d[o],r+=u[i];r/=n,f.push([a,r/u[a]])}return f}(),f.sort(function(e,t){return t[1]-e[1]}),f}},{"static-kdtree":9}],89:[function(){d3plus.data.mad=function(e){var t,n,r;return n=d3.median(e),t=d3.median(e.map(function(e){return Math.abs(e-n)})),r=e.map(function(e,r){return[r,Math.abs(e-n)/t]}),r.sort(function(e,t){return t[1]-e[1]}),r}},{}],90:[function(e){var t;t=e("../style/sheet.coffee"),d3plus.font.awesome=t("font-awesome")},{"../style/sheet.coffee":229}],91:[function(e){var t;t=e("../core/font/tester.coffee"),d3plus.font.sizes=function(e,n,r){var a,i,o,l;return o=r||t("svg").append("text"),n=n||{},i=[],e instanceof Array||(e=[e]),l=o.selectAll("tspan.d3plus_testFontSize").data(e),a={x:0,y:0},l.enter().append("tspan").attr("class","d3plus_testFontSize").text(String).style(n).attr(a).each(function(e){return i.push({height:this.offsetHeight||this.getBoundingClientRect().height,text:e,width:this.getComputedTextLength()})}),l.remove(),o||o.remove(),i}},{"../core/font/tester.coffee":82}],92:[function(e){var t=e("../core/font/tester.coffee");d3plus.font.validate=function(e){function n(e){return o.append("span").style("font-family",e).style("font-size","32px").style("padding","0px").style("margin","0px").text("abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890")}function r(e,t){var n=e.node().offsetWidth,r=t.node().offsetWidth;return n!==r}e instanceof Array||(e=e.split(","));var a=e.join(", "),i=d3plus.font.validate.complete;if(a in i)return i[a];var o=t("div"),l=n("monospace"),u=n("sans-serif");for(var s in e){var c=e[s].trim(),d=n(c+",monospace"),f=r(d,l);if(d.remove(),!f){var d=n(c+",sans-serif");f=r(d,u),d.remove()}if(f){f=c;break}}return f||(f="sans-serif"),l.remove(),u.remove(),i[a]=f,f},d3plus.font.validate.complete={}},{"../core/font/tester.coffee":82}],93:[function(e){var t=e("../core/data/format.js"),n=e("../core/data/keys.js"),r=e("../core/data/load.coffee"),a=e("../core/fetch/data.js"),i=e("../core/method/reset.js");d3plus.form=function(){var o={types:{auto:e("./types/auto.js"),button:e("./types/button/button.js"),drop:e("./types/drop/drop.js"),toggle:e("./types/toggle.js")},shell:"form"};o.self=function(){function e(t,n){var n="number"!=typeof n?1===o.id.nesting.length?0:o.id.nesting.length-1:n,r=o.id.nesting[n];return n>0&&(!(r in t)||t[r]instanceof Array)?e(t,n-1):r}var l=o.data.value instanceof Array&&o.data.value.length>o.data.large;if(o.draw.timing=o.draw.first||l||d3plus.ie?0:o.timing.ui,o.data.value instanceof Array){if(o.dev.value&&d3plus.console.groupCollapsed('drawing "'+o.type.value+'"'),o.data.changed&&(o.data.cache={},n(o,"data"),t(o)),o.data.app=a(o),(o.data.changed||o.order.changed||o.order.sort.changed)&&d3plus.array.sort(o.data.app,o.order.value||o.text.value,o.order.sort.value,o.color.value,o),!o.focus.value.length){var u=o.data.element.value;if(u&&"select"===u.node().tagName.toLowerCase()){var s=u.property("selectedIndex");s=0>s?0:s;var c=u.selectAll("option")[0][s],d=c.getAttribute("data-"+o.id.value)||c.getAttribute(o.id.value);d&&(o.focus.value[0]=d)}!o.focus.value.length&&o.data.app.length&&(o.focus.value[0]=o.data.app[0][o.id.value]),o.dev.value&&o.focus.value.length&&d3plus.console.log('"value" set to "'+o.focus+'"')}if(o.data.changed){"auto"===o.search.value?o.data.app.length>10?(o.search.enabled=!0,o.dev.value&&d3plus.console.log("Search enabled.")):(o.search.enabled=!1,o.dev.value&&d3plus.console.log("Search disabled.")):o.search.enabled=o.search.value;var f=o.data.element.value?o.data.element.value.node().tagName.toLowerCase():"";if(o.data.element.value&&"select"===f){var p=[];for(var h in o.data.nested.all)p=p.concat(o.data.nested.all[h]);options=o.data.element.value.selectAll("option").data(p,function(t){var n=e(t);return t&&n in t?t[n]:!1}),options.exit().remove(),options.enter().append("option"),options.each(function(t){var n=e(t),r=n===o.id.value?o.text.value||o.id.value:o.text.nesting!==!0&&n in o.text.nesting?o.text.nesting[n]:n;for(var a in t)"object"!=typeof t[a]&&(a===r&&d3.select(this).html(t[a]),["alt","value"].indexOf(a)>=0?d3.select(this).attr(a,t[a]):d3.select(this).attr("data-"+a,t[a]));this.selected=t[n]===o.focus.value[0]?!0:!1})}}else if(o.focus.changed&&o.data.element.value){var f=o.data.element.value.node().tagName.toLowerCase();"select"===f&&o.data.element.value.selectAll("option").each(function(t){var n=e(t);this.selected=t[n]===o.focus.value[0]?!0:!1})}if("auto"!==o.type.value){if(!o.container.ui){o.container.ui=o.container.value.selectAll("div#d3plus_"+o.type.value+"_"+o.container.id).data(["container"]);var g=o.data.element.value?o.data.element.value[0][0]:null;if(g)if(g.id)g="#"+g.id;else{var v=g.getAttribute(o.id.value)?o.id.value:"data-"+o.id.value;g=g.getAttribute(v)?"["+v+"="+g.getAttribute(v)+"]":null}o.container.ui.enter().insert("div",g).attr("id","d3plus_"+o.type.value+"_"+o.container.id).style("position","relative").style("overflow","visible").style("vertical-align","top")}o.container.ui.style("display",o.ui.display.value),o.container.ui.transition().duration(o.draw.timing).style("margin",o.ui.margin+"px");var m=o.container.ui.selectAll("div.d3plus_title").data(o.title.value?[o.title.value]:[]);m.enter().insert("div","#d3plus_"+o.type.value+"_"+o.container.id).attr("class","d3plus_title").style("display","inline-block"),m.style("color",o.font.color).style("font-family",o.font.family.value).style("font-size",o.font.size+"px").style("font-weight",o.font.weight).style("padding",o.ui.padding+"px").style("border-color","transparent").style("border-style","solid").style("border-width",o.ui.border+"px").text(String).each(function(){o.margin.left=this.offsetWidth})}if(o.data.value.length){var y=o.format.locale.value.visualization[o.type.value];o.dev.value&&d3plus.console.time("drawing "+y),o.types[o.type.value](o),o.dev.value&&d3plus.console.timeEnd("drawing "+y)}else!o.data.url||o.data.loaded&&!o.data.stream||r(o,"data",o.self.draw);i(o),o.methodGroup=!1,o.dev.value&&d3plus.console.groupEnd()}};var l=["active","aggs","alt","color","container","depth","dev","data","draw","focus","format","height","history","hover","icon","id","keywords","margin","open","order","remove","search","select","selectAll","text","title","type","width"],u=["data","font","icon","timing","title","ui"];return d3plus.method(o,l,u),o.self}},{"../core/data/format.js":73,"../core/data/keys.js":74,"../core/data/load.coffee":75,"../core/fetch/data.js":79,"../core/method/reset.js":83,"./types/auto.js":94,"./types/button/button.js":95,"./types/drop/drop.js":100,"./types/toggle.js":117}],94:[function(e,t){t.exports=function(e){var t=e.data.value.length;1===t?e.self.type("button").draw():5>t?e.self.type("toggle").draw():e.self.type("drop").draw()}},{}],95:[function(e,t){t.exports=function(t){var n=e("./functions/color.js"),r=e("./functions/icons.js"),a=e("./functions/mouseevents.js"),i=e("./functions/style.js"),o=t.container.ui.selectAll("div.d3plus_node").data(t.data.app,function(e){return e[t.id.value]});if(t.dev.value&&d3plus.console.time("enter"),o.enter().append("div").attr("class","d3plus_node").call(n,t).call(i,t).call(r,t).call(a,t,n),t.dev.value&&d3plus.console.timeEnd("enter"),t.draw.update||t.draw.timing){t.dev.value&&d3plus.console.time("ordering"),o.order(),t.dev.value&&d3plus.console.timeEnd("ordering");
var l=o}else var u=[t.focus.previous,t.focus.value[0],t.hover.previous,t.hover.value].filter(function(e){return e}),l=o.filter(function(e){return u.indexOf(e[t.id.value])>=0});t.dev.value&&d3plus.console.time("update"),t.draw.timing?l.transition().duration(t.draw.timing).call(n,t).call(i,t):l.call(n,t).call(i,t),l.call(r,t).call(a,t,n),t.dev.value&&d3plus.console.timeEnd("update"),o.exit().remove()}},{"./functions/color.js":96,"./functions/icons.js":97,"./functions/mouseevents.js":98,"./functions/style.js":99}],96:[function(e,t){t.exports=function(e,t){e.style("background-color",function(e){return t.focus.value[0]!==e[t.id.value]?t.hover.value===e[t.id.value]?d3plus.color.lighter(t.ui.color.secondary.value,.25):t.ui.color.secondary.value:t.hover.value===e[t.id.value]?d3.rgb(t.ui.color.primary.value).darker(.15).toString():t.ui.color.primary.value}).style("color",function(e){var n=e[t.icon.value]&&t.data.app.length<t.data.large;if(t.focus.value[0]===e[t.id.value])var r=1;else var r=.75;if(t.focus.value[0]===e[t.id.value]&&e[t.color.value]&&!n)var a=d3plus.color.legible(e[t.color.value]);else if(t.focus.value[0]===e[t.id.value])var a=d3plus.color.text(t.ui.color.primary.value);else var a=d3plus.color.text(t.ui.color.secondary.value);var a=d3.rgb(a);return"rgba("+a.r+","+a.g+","+a.b+","+r+")"}).style("border-color",t.ui.color.secondary.value)}},{}],97:[function(e,t){t.exports=function(e,t){var n="right"===t.font.align.value&&!d3plus.rtl||d3plus.rtl&&"right"===t.font.align.value;e.each(function(e){var r=["label"];e[t.icon.value]&&t.data.app.length<=t.data.large&&r.push("icon");var a=t.icon.button.value;e[t.id.value]===t.focus.value[0]&&t.icon.select.value?(a=t.icon.select.value,r.push("selected")):a&&e.d3plus.icon!==!1&&r.push("selected");var i=0,o=d3.select(this).selectAll("div.d3plus_button_element").data(r,function(e){return e});o.enter().append("div").style("display",function(e){return"label"===e?"block":"absolute"}),o.order().attr("class",function(e){var t="";return"selected"===e&&0===a.indexOf("fa-")&&(t=" fa "+a),"d3plus_button_element d3plus_button_"+e+t}).html(function(n){if("label"===n){var r=t.text.value&&t.text.value in e&&!(e[t.text.value]instanceof Array)?t.text.value:t.id.value;return t.format.value(e[r])}return"selected"===n&&a.indexOf("fa-")<0?a:""}).style("background-image",function(n){return"icon"===n?"url('"+e[t.icon.value]+"')":"none"}).style("background-color",function(n){return"icon"===n&&"knockout"===e.style?e[t.color.value]||t.ui.color.primary.value:"transparent"}).style("background-size","100%").style("text-align",function(e){return"label"===e?t.font.align.value:"center"}).style("position",function(e){return"label"==e?"static":"absolute"}).style("width",function(e){return"label"===e?"auto":(i=t.height.value?t.height.value-2*t.ui.padding-2*t.ui.border:t.font.size+t.ui.padding+t.ui.border,i+"px")}).style("height",function(e){return"icon"===e?i+"px":"auto"}).style("margin-top",function(e){if("label"===e)return"0px";if(this.offsetHeight||this.getBoundingClientRect().height)var n=this.offsetHeight||this.getBoundingClientRect().height;else if("selected"===e)var n=t.font.size;else var n=i;return-n/2+"px"}).style("top",function(e){return"label"===e?"auto":"50%"}).style("left",function(e){return"icon"===e&&!n||"selected"===e&&n?t.ui.padding+"px":"auto"}).style("right",function(e){return"icon"===e&&n||"selected"===e&&!n?t.ui.padding+"px":"auto"}).style(d3plus.prefix()+"transition",function(e){return"selected"===e?t.draw.timing/1e3+"s":"none"}).style(d3plus.prefix()+"transform",function(e){var n="selected"===e?t.icon.select.rotate:"none";return"rotate("+n+"deg)"}).style("opacity",function(e){return"selected"===e?t.icon.select.opacity:1}),o.exit().remove();var l=d3.select(this).selectAll(".d3plus_button_label");if(i>0){i+=2*t.ui.padding;var u=t.ui.padding;if(3===r.length)var s=u+"px "+i+"px";else if(r.indexOf("icon")>=0&&!d3plus.rtl||r.indexOf("selected")>=0&&d3plus.rtl)var s=u+"px "+u+"px "+u+"px "+i+"px";else var s=u+"px "+i+"px "+u+"px "+u+"px";l.style("padding",s)}else l.style("padding",t.ui.padding+"px");if("number"==typeof t.width.value){var c=t.width.value;c-=parseFloat(l.style("padding-left"),10),c-=parseFloat(l.style("padding-right"),10),c-=2*t.ui.border,c+="px"}else var c="auto";l.style("width",c)})}},{}],98:[function(e,t){t.exports=function(e,t,n){e.on(d3plus.evt.over,function(e){t.self.hover(e[t.id.value]),d3plus.ie||!t.draw.timing?d3.select(this).style("cursor","pointer").call(n,t):d3.select(this).style("cursor","pointer").transition().duration(t.timing.mouseevents).call(n,t)}).on(d3plus.evt.out,function(){t.self.hover(!1),d3plus.ie||!t.draw.timing?d3.select(this).style("cursor","auto").call(n,t):d3.select(this).style("cursor","auto").transition().duration(t.timing.mouseevents).call(n,t)}).on(d3plus.evt.click,function(e){t.id.value in e&&t.self.focus(e[t.id.value]).draw()})}},{}],99:[function(e,t){t.exports=function(e,t){e.style("position","relative").style("margin",t.ui.margin+"px").style("display",t.ui.display.value).style("border-style","solid").style("border-width",t.ui.border+"px").style("font-family",t.font.family.value).style("font-size",t.font.size+"px").style("font-weight",t.font.weight).style("letter-spacing",t.font.spacing+"px")}},{}],100:[function(e,t){t.exports=function(t){var n=e("./functions/element.js"),r=e("./functions/keyboard.js"),a=e("./functions/window.js"),i=e("./functions/width.js"),o=e("./functions/button.js"),l=e("./functions/selector.js"),u=e("./functions/title.js"),s=e("./functions/search.js"),c=e("./functions/list.js"),d=e("./functions/data.js"),f=e("./functions/update.js");t.margin.top=0,t.margin.title=0,n(t),r(t),a(t),i(t),o(t),l(t),u(t),s(t),c(t),d(t),f(t)}},{"./functions/button.js":103,"./functions/data.js":104,"./functions/element.js":105,"./functions/keyboard.js":108,"./functions/list.js":109,"./functions/search.js":111,"./functions/selector.js":112,"./functions/title.js":113,"./functions/update.js":114,"./functions/width.js":115,"./functions/window.js":116}],101:[function(e,t){t.exports=function(e,t,n){var r=[],n=n||e.active.value;if(n instanceof Array)for(var a=0;a<n.length;a++)r.push(this(e,t,n[a]));else{var i=typeof n;r.push("number"===i?e.depth.value===n:"function"===i?n(t):t===n)}return r.indexOf(!0)>=0}},{}],102:[function(e,t){t.exports=function(e){e.dev.value&&d3plus.console.time("rotating arrow");var t="&#x276f;"===e.icon.drop.value?90:0;if(e.open.value!=e.open.flipped.value)var n=180+t;else var n=t;e.container.button.icon({select:{opacity:e.open.value?.5:1,rotate:n}}).draw(),e.dev.value&&d3plus.console.timeEnd("rotating arrow")}},{}],103:[function(e,t){t.exports=function(e){if("button"in e.container||(e.dev.value&&d3plus.console.time("creating main button"),e.container.button=d3plus.form().container(e.container.ui).type("button").ui({margin:0}),e.dev.value&&d3plus.console.timeEnd("creating main button")),e.focus.changed||e.data.changed||e.depth.changed){var t=e.depth.value,n=d3plus.util.copy(e.data.value.filter(function(n){for(var r=!1,a=0;a<e.id.nesting.length;a++){var i=e.id.nesting[a];if(r=i in n&&n[i]===e.focus.value[0]){t=a;break}}return r})[0]);n||(n=e.container.button.data()[0]||e.data.app[0]),e.container.button.data([n]).id(e.id.nesting).depth(t)}e.container.button.draw({update:e.draw.update}).focus(e.focus.value[0]).font(e.font).icon({button:e.icon.drop.value,select:e.icon.drop.value,value:e.icon.value}).text(e.text.value).timing({ui:e.draw.timing}).ui({color:e.ui.color,padding:e.ui.padding}).width(e.width.value).draw();var r=e.container.button.container(Object).ui;e.margin.top+=r.node().offsetHeight||r.node().getBoundingClientRect().height,r.on(d3plus.evt.click,function(){e.self.open(!e.open.value).draw()})}},{}],104:[function(e,n){n.exports=function(e){if(e.data.url&&!e.data.loaded){var n={};n[e.text.value||e.id.value]=e.format.value(e.format.locale.value.ui.loading),e.data.filtered=[n]}else if(e.open.value){var r=e.text.solo.value.length?e.text.solo.value[0].toLowerCase():"",a=d3plus.string.strip(r).split("_"),i=[e.id.value,e.text.value,e.alt.value,e.keywords.value];if(i=i.filter(function(e){return e}),a=a.filter(function(e){return""!=e}),e.text.solo.value.length&&""!==e.text.solo.value[0]){var o=[],l=[],u=[],c=[];e.id.nesting.forEach(function(t){c=c.concat(e.data.nested.all[t])}),c.forEach(function(n){var c=!1;i.forEach(function(i){if(!c&&i in n&&"string"==typeof n[i]){var d=n[i].toLowerCase();if([e.text.value,e.id.value].indexOf(i)>=0&&0==d.indexOf(r))o.push(n),c=!0;else if(d.indexOf(r)>=0)l.push(n),c=!0;else{var f=d3plus.string.strip(d).split("_");for(t in f){if(c)break;for(s in a)if(0===f[t].indexOf(a[s])){u.push(n),c=!0;break}}}}})}),e.data.filtered=d3.merge([o,l,u]),e.data.filtered.forEach(function(e,t){e.d3plus_order=t})}else e.data.filtered=e.data.app,e.id.nesting.length>1&&e.depth.value<e.id.nesting.length-1&&(e.data.filtered=e.data.filtered.filter(function(t){return"endPoint"in t.d3plus&&t.d3plus.endPoint===e.depth.value&&(t.d3plus.icon=!1),!0}));if(0===e.data.filtered.length){var d={},f=e.format.value(e.format.locale.value.ui.noResults);d[e.text.value||e.id.value]=d3plus.string.format(f,'"'+r+'"'),e.data.filtered=[d]}}else e.data.filtered=[]}},{}],105:[function(e,t){t.exports=function(e){e.data.element.value&&(e.data.element.value.on("focus."+e.container.id,function(){e.self.draw({update:!1}).draw()}),e.data.element.value.on("blur."+e.container.id,function(){var t=e.search.enabled?d3.event.relatedTarget!=e.container.value.select("input").node():!0;t&&e.self.draw({update:!1}).draw()}),e.data.element.value.on("change."+e.container.id,function(){e.self.focus(this.value).draw()}),e.data.element.value.on("keydown.cancel_"+e.container.id,function(){var e=d3.event.keyCode;9!=e&&d3.event.preventDefault()}))}},{}],106:[function(e,t){t.exports=function(e){var t=e.container.button.container().node().getBoundingClientRect();e.height.secondary=window.innerHeight-t.bottom-e.ui.margin-2*e.ui.padding-2*e.ui.border,e.height.secondary<3*t.height?(e.height.secondary=t.top-10,e.self.open({flipped:!0})):e.self.open({flipped:!1});e.height.secondary>e.height.max&&(e.height.secondary=e.height.max)}},{}],107:[function(e,t){t.exports=function(t){var n=e("./active.js");if(t.open.value){t.dev.value&&d3plus.console.time("updating list items"),"items"in t.container||(t.container.items=d3plus.form().container(t.container.list).type("button").ui({border:0,display:"block",margin:0}).width(!1));var r=t.draw.timing?t.data.large:1,a=d3plus.util.copy(t.order),i=t.depth.value===t.id.nesting.length-1;a.value=t.text.solo.value.length&&""!==t.text.solo.value[0]?"d3plus_order":t.order.value,(t.focus.changed||!t.container.items.focus().length)&&t.container.items.focus(t.focus.value[0],function(e){e=e[0];var r=e!==t.focus.value[0];r&&t.active.value&&(r=n(t,e)),r&&t.self.focus(e);var a=t.data.filtered.filter(function(n){return n[t.id.value]===e})[0];if(t.depth.value<t.id.nesting.length-1&&t.id.nesting[t.depth.value+1]in a){var i=t.depth.value,o=t.id.solo.value;t.history.states.push(function(){t.self.depth(i).id({solo:o}).draw()}),t.self.depth(t.depth.value+1).id({solo:[e]}).draw()}else t.depth.changed?r&&t.self.draw():t.self.open(!1).draw()}),t.container.items.active(t.active.value).data({large:r,value:t.data.filtered}).draw({update:t.draw.update}).font(t.font.secondary).id(t.id.value).icon({button:i?!1:t.icon.next,select:i?t.icon.select:!1}).order(a).text(t.text.secondary.value||t.text.value).timing({ui:t.draw.timing}).ui({color:{primary:1===t.id.nesting.length?t.ui.color.primary.value:t.ui.color.secondary.value,secondary:t.ui.color.secondary.value},padding:t.ui.padding}).draw(),t.dev.value&&d3plus.console.timeEnd("updating list items")}}},{"./active.js":101}],108:[function(e,t){t.exports=function(e){d3.select(document).on("keydown."+e.container.id,function(){if(e.open.value||e.hover===!0){var t=d3.event.keyCode,n=e.container.list.select("div").selectAll("div.d3plus_node"),r=0;if(n.each("boolean"==typeof e.hover?function(t,n){t.value==e.focus&&(r=n)}:function(t,n){t.value==e.hover&&(r=n)}),[9].indexOf(t)>=0&&(!e.search.enabled||e.search.enabled&&!d3.event.shiftKey))e.self.draw({update:!1}).disable();else if([40].indexOf(t)>=0){if(e.open.value&&(r>=n.size()-1?r=0:r+=1),"boolean"!=typeof e.hover)var a=n.data()[r].value;else var a=e.focus;e.open.value?e.self.draw({update:!1}).hover(a).draw(60):e.self.draw({update:!1}).hover(a).enable()}else if([38].indexOf(t)>=0){if(e.open.value&&(0>=r?r=n.size()-1:r-=1),"boolean"!=typeof e.hover)var a=n.data()[r].value;else var a=e.focus;e.open.value?e.self.draw({update:!1}).hover(a).draw(60):e.self.draw({update:!1}).hover(a).enable()}else[13].indexOf(t)>=0?"boolean"!=typeof e.hover?e.self.value(e.hover).draw():e.self.hover(e.focus).toggle():[27].indexOf(t)>=0&&(e.open.value?e.self.disable():e.hover===!0&&e.self.hover(!1).draw())}})}},{}],109:[function(e,t){t.exports=function(e){e.dev.value&&d3plus.console.time("populating list"),e.container.list=e.container.selector.selectAll("div.d3plus_drop_list").data(["list"]),e.container.list.enter().append("div").attr("class","d3plus_drop_list").attr("id","d3plus_drop_list_"+e.container.id).style("overflow-y","auto").style("overflow-x","hidden"),e.dev.value&&d3plus.console.timeEnd("populating list")}},{}],110:[function(e,t){t.exports=function(e){if(e.open.value){e.dev.value&&d3plus.console.time("calculating height");var t=!1;if("none"==e.container.selector.style("display"))var t=!0;t&&e.container.selector.style("display","block");var n=e.search.enabled?e.container.search.node().offsetHeight||e.container.search.node().getBoundingClientRect().height:0,r=e.container.selector.style("height"),a=e.container.selector.property("scrollTop"),i=e.container.list.style("max-height"),o=e.container.list.property("scrollTop");e.container.selector.style("height","auto"),e.container.list.style("max-height","200000px"),e.container.listHeight=parseFloat(e.container.selector.style("height"),10),e.container.list.style("max-height",i).property("scrollTop",o),e.container.selector.style("height",r).property("scrollTop",a);var l=!1;if(e.container.listHeight>e.height.secondary&&(e.container.listHeight=e.height.secondary,l=!0),t&&e.container.selector.style("display","none"),e.dev.value&&d3plus.console.timeEnd("calculating height"),l){e.dev.value&&d3plus.console.time("calculating scroll position");var u=e.container.list.select("div").selectAll("div.d3plus_node"),s=u[0][0];u.each(function(t){t[e.id.value]==e.focus.value[0]&&(s=this)});var t=!1;"none"===e.container.selector.style("display")&&(t=!0,e.container.selector.style("display","block"));var c=s.offsetTop,d=s.offsetHeight||s.getBoundingClientRect().height,f=e.container.list.property("scrollTop");t&&e.container.selector.style("display","none"),t||e.data.changed||e.depth.changed?e.container.listScroll=c:(e.container.listScroll=f,f>c?e.container.listScroll=c:c+d>f+e.height.secondary-n&&(e.container.listScroll=c-(e.height.secondary-d-n))),e.dev.value&&d3plus.console.timeEnd("calculating scroll position")}else e.container.listScroll=0}else e.container.listScroll=e.container.list.property("scrollTop"),e.container.listHeight=0}},{}],111:[function(e,t){t.exports=function(t){function n(e){e.style("padding",t.ui.padding+"px").style("display","block").style("background-color",t.ui.color.secondary.value)}function r(e){var n=t.width.secondary-4*t.ui.padding-2*t.ui.border;e.style("padding",t.ui.padding+"px").style("width",n+"px").style("border-style","solid").style("border-width","0px").style("font-family",t.font.secondary.family.value).style("font-size",t.font.secondary.size+"px").style("font-weight",t.font.secondary.weight).style("text-align",t.font.secondary.align).style("outline","none").style(d3plus.prefix()+"border-radius","0").attr("placeholder",t.format.value(t.format.locale.value.method.search))}t.dev.value&&d3plus.console.time("creating search");var a=e("./data.js"),i=e("./items.js"),o=e("./update.js");t.container.search=t.container.selector.selectAll("div.d3plus_drop_search").data(t.search.enabled?["search"]:[]),t.draw.timing?(t.container.search.transition().duration(t.draw.timing).call(n),t.container.search.select("input").transition().duration(t.draw.timing).call(r)):(t.container.search.call(n),t.container.search.select("input").call(r)),t.container.search.enter().insert("div","#d3plus_drop_list_"+t.container.id).attr("class","d3plus_drop_search").attr("id","d3plus_drop_search_"+t.container.id).call(n).append("input").attr("id","d3plus_drop_input_"+t.container.id).style("-webkit-appearance","none").call(r),t.container.search.select("input").on("keyup."+t.container.id,function(){t.text.solo[0]!==this.value&&(t.self.text({solo:[this.value]}),a(t),i(t),o(t))}),t.container.search.exit().remove(),t.search.enabled&&(t.margin.title+=t.container.search.node().offsetHeight||t.container.search.node().getBoundingClientRect().height),t.dev.value&&d3plus.console.timeEnd("creating search")}},{"./data.js":104,"./items.js":107,"./update.js":114}],112:[function(e,t){t.exports=function(e){e.container.selector=e.container.ui.selectAll("div.d3plus_drop_selector").data(["selector"]),e.container.selector.enter().append("div").attr("class","d3plus_drop_selector").style("position","absolute").style("top","0px").style("z-index","-1").style("overflow","hidden"),e.container.selector.style("padding",e.ui.border+"px")}},{}],113:[function(e,t){t.exports=function(e){function t(t){t.style("padding",e.ui.padding+"px").style("display","block").style("background-color",e.ui.color.secondary.value).style("font-family",e.font.secondary.family.value).style("font-size",e.font.secondary.size+"px").style("font-weight",e.font.secondary.weight).style("text-align",e.font.secondary.align).style("color",d3plus.color.text(e.ui.color.secondary.value))}function n(t){if(!t.empty()){var n=0===e.icon.back.value.indexOf("fa-")?" fa "+e.icon.back.value:"";n="d3plus_drop_back"+n;var r=0===e.icon.back.value.indexOf("fa-")?"":e.icon.back.value;t.style("position","absolute").attr("class",n).style("top",e.ui.padding+e.font.secondary.size/2/2.5+"px").html(r)}}function r(t){var n=i?e.focus.value.length:e.format.locale.value.ui.back;t.text(e.format.value(n)).style("padding","0px "+2*e.ui.padding+"px")}if(e.open.value){e.dev.value&&d3plus.console.time("creating title and back button");var a=1===e.id.solo.value.length&&e.depth.value>0,i=a,o=e.container.button.data(Object).app[0];i=!0;for(var l=0;l<e.id.nesting.length;l++){var u=e.id.nesting[l];if(u in o&&o[u]===e.focus.value[0]){i=!1;break}}e.container.title=e.container.selector.selectAll("div.d3plus_drop_title").data(a?["title"]:[]),e.draw.timing?(e.container.title.transition().duration(e.draw.timing).call(t),e.container.title.select("div.d3plus_drop_title_text").transition().duration(e.draw.timing).call(r)):(e.container.title.call(t),e.container.title.select("div.d3plus_drop_title_text").call(r)),e.container.title.select("span.d3plus_drop_back").call(n);var s=e.container.title.enter().insert("div","#d3plus_drop_list_"+e.container.id).attr("class","d3plus_drop_title").attr("id","d3plus_drop_title_"+e.container.id).call(t);s.append("span").attr("id","d3plus_drop_back_"+e.container.id).attr("class","d3plus_drop_back").call(n),s.append("div").attr("id","d3plus_drop_title_text_"+e.container.id).attr("class","d3plus_drop_title_text").call(r),e.container.title.on(d3plus.evt.over,function(){var t=d3plus.color.lighter(e.ui.color.secondary.value);d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("background-color",t).style("color",d3plus.color.text(t))}).on(d3plus.evt.out,function(){var t=e.ui.color.secondary.value;d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("background-color",t).style("color",d3plus.color.text(t))}).on(d3plus.evt.click,function(){e.history.back()}),e.container.title.exit().remove(),a&&(e.margin.title+=e.container.title.node().offsetHeight||e.container.title.node().getBoundingClientRect().height),e.dev.value&&d3plus.console.timeEnd("creating title and back button")}}},{}],114:[function(e,t){t.exports=function(t){function n(e){e.style("left",function(){return"left"===t.font.align.value?t.margin.left+"px":"center"===t.font.align.value?t.margin.left-(t.width.secondary-t.width.value)/2+"px":"auto"}).style("right",function(){return"right"===t.font.align.value?"0px":"auto"}).style("height",t.container.listHeight+"px").style("padding",t.ui.border+"px").style("background-color",t.ui.color.secondary.value).style("z-index",function(){return t.open.value?"9999":"-1"}).style("width",t.width.secondary-2*t.ui.border+"px").style("top",function(){return t.open.flipped.value?"auto":t.margin.top+"px"}).style("bottom",function(){return t.open.flipped.value?t.margin.top+"px":"auto"}).style("opacity",t.open.value?1:0)}function r(e){e.style("top",function(){return t.open.flipped.value?"auto":t.margin.top+"px"}).style("bottom",function(){return t.open.flipped.value?t.margin.top+"px":"auto"}).style("display",t.open.value?null:"none"),t.search.enabled&&t.open.value&&t.container.selector.select("div.d3plus_drop_search input").node().focus()}function a(e){return function(){var t=d3.interpolateNumber(this.scrollTop,e);return function(e){this.scrollTop=t(e)}}}var i=e("./items.js"),o=e("./height.js"),l=e("./scroll.js"),u=e("./arrow.js");t.draw.timing?t.container.ui.transition().duration(t.draw.timing).each("start",function(){t.open.value&&d3.select(this).style("z-index",9999)}).style("margin",t.ui.margin+"px").each("end",function(){t.open.value||d3.select(this).style("z-index","auto")}):t.container.ui.style("margin",t.ui.margin+"px").style("z-index",function(){return t.open.value?9999:"auto"}),i(t),o(t),l(t),u(t),t.dev.value&&d3plus.console.time("drawing list");var s=t.open.value?t.height.secondary-t.margin.title:0;t.draw.timing?(t.container.selector.transition().duration(t.draw.timing).each("start",function(){d3.select(this).style("display",t.open.value?"block":null)}).call(n).each("end",function(){d3.select(this).transition().duration(t.draw.timing).call(r)}),t.container.list.transition().duration(t.draw.timing).style("width",t.width.secondary-2*t.ui.border+"px").style("max-height",s+"px").tween("scroll",a(t.container.listScroll))):(t.container.selector.call(n).call(r),t.container.list.style("width",t.width.secondary-2*t.ui.border+"px").style("max-height",s+"px").property("scrollTop",t.container.listScroll)),t.dev.value&&d3plus.console.timeEnd("drawing list")}},{"./arrow.js":102,"./height.js":106,"./items.js":107,"./scroll.js":110}],115:[function(e,t){var n=e("../../../../core/font/tester.coffee");t.exports=function(e){function t(t){var a="primary"===t?"value":t,i="value"===a?e.icon.drop.value:e.icon.select.value||e.icon.drop.value,o="value"===a?e.text.value:e.text.secondary.value||e.text.value,l="value"===a?e.font:e.font.secondary;e.dev.value&&d3plus.console.time("calculating "+t+" width");var u=d3plus.form().container(n()).data({large:9999,value:r}).draw({update:!1}).font(l).icon({button:i,value:e.icon.value}).id(e.id.value).timing({ui:0}).text(o||e.id.value).type("button").ui({border:"primary"===t?e.ui.border:0,display:"inline-block",margin:0,padding:e.ui.padding}).width(!1).draw(),s=[];u.selectAll("div.d3plus_node").each(function(){s.push(this.offsetWidth)}).remove();var c={};c[a]=d3.max(s),e.self.width(c),e.dev.value&&d3plus.console.timeEnd("calculating "+t+" width")}var r=[];for(var a in e.data.nested.all){var i=e.data.nested.all[a],o=d3plus.object.validate(e.text.nesting)&&a in e.text.nesting?e.text.nesting[a][0]:a;[e.id.value,e.text.value].indexOf(o)<0&&(i=d3plus.util.copy(i),i.forEach(function(t){t[e.text.value||e.id.value]=t[o]})),r=r.concat(i)}"number"!=typeof e.width.value&&t("primary"),"number"!=typeof e.width.secondary&&(e.text.secondary.value&&e.text.value!==e.text.secondary.value?t("secondary"):e.self.width({secondary:e.width.value}))}},{"../../../../core/font/tester.coffee":82}],116:[function(e,t){var n=function(e,t){if(void 0===t)var t=window;d3.select(t).on("click."+e.container.id,function(){var t=d3.event.target||d3.event.toElement,n=t.parentNode;n&&["d3plus_node","d3plus_drop_title"].indexOf(n.className)>=0&&(t=n.parentNode),t&&n&&!d3plus.util.child(e.container.ui,t)&&e.open.value&&e.self.open(!e.open.value).draw()});try{var r=window.parent.location.host===window.location.host}catch(a){var r=!1}r&&t.self!==window.top&&n(e,t.parent)};t.exports=n},{}],117:[function(e,t){t.exports=function(e){"buttons"in e.container||(e.container.buttons=d3plus.form().container(e.container.ui).type("button"));var t=e.data.app.length,n=e.width.value?e.width.value/t:!1,r=e.container.ui.selectAll("div.d3plus_toggle").data(e.data.app,function(t){return t[e.id.value]});r.enter().append("div").attr("class","d3plus_toggle").style("display","inline-block").style("vertical-align","top"),r.order().each(function(t){"form"in t.d3plus||(t.d3plus.form=d3plus.form().container(d3.select(this)));var r=e.id.nesting.length>e.depth.value?e.id.nesting[e.depth.value+1]:e.id.value;t[r]instanceof Array?t.d3plus.form.container({id:e.container.id+"_"+t[e.id.value]}).data(t[r]).id(e.id.nesting.slice(1)).type("drop"):t.d3plus.form.data([t]).id(e.id.value).type("button"),t.d3plus.form.color(e.color).focus(e.focus.value[0],function(t){t[0]!==e.focus.value[0]&&e.self.focus(t[0]).draw()}).icon({select:!1,value:e.icon.value}).font(e.font).format(e.format).order(e.order).text(e.text.value).ui({border:e.ui.border,color:e.ui.color,display:"inline-block",margin:0,padding:e.ui.padding}).width(n).draw()})}},{}],118:[function(e,t){var n;n=e("./wiki.coffee"),d3plus.console=function(e,t,n){n=n||"",d3plus.ie||"undefined"!=typeof InstallTrigger?console.log("[ D3plus ] "+t):"groupCollapsed"===e?window.chrome&&navigator.onLine?console[e]("%c%c "+t,"padding:3px 10px;line-height:25px;background-size:20px;background-position:top left;background-image:url('http://d3plus.org/assets/img/favicon.ico');","font-weight:200;"+n):console[e]("%cD3plus%c "+t,"line-height:25px;font-weight:800;color:#b35c1e;margin-left:0px;","font-weight:200;"+n):console[e]("%c"+t,n+"font-weight:200;")},d3plus.console.comment=function(e){this("log",e,"color:#aaa;")},d3plus.console.error=function(e,t){this("groupCollapsed","ERROR: "+e,"font-weight:800;color:#D74B03;"),this.stack(),this.wiki(t),this.groupEnd()},d3plus.console.group=function(e){this("group",e,"color:#888;")},d3plus.console.groupCollapsed=function(e){this("groupCollapsed",e,"color:#888;")},d3plus.console.groupEnd=function(){d3plus.ie||console.groupEnd()},d3plus.console.log=function(e){this("log",e,"color:#444444;")},d3plus.console.stack=function(){var e,t,n,r,a,i,o;d3plus.ie||(e=new Error,e.stack&&(i=e.stack.split("\n"),i=i.filter(function(e){return 0!==e.indexOf("Error")&&e.indexOf("d3plus.js:")<0&&e.indexOf("d3plus.min.js:")<0}),i.length&&(a=window.chrome?"at ":"@",o=i[0].split(a)[1],i=o.split(":"),3===i.length&&i.pop(),t=i.pop(),r=i.join(":").split("/"),r=r[r.length-1],n="line "+t+" of "+r+": "+o,this("log",n,"color:#D74B03;"))))},d3plus.console.time=function(e){d3plus.ie||console.time(e)},d3plus.console.timeEnd=function(e){d3plus.ie||console.timeEnd(e)},d3plus.console.warning=function(e,t){this("groupCollapsed",e,"color:#888;"),this.stack(),this.wiki(t),this.groupEnd()},d3plus.console.wiki=function(e){e&&(e in n&&(e=d3plus.repo+"wiki/"+n[e]),this("log","documentation: "+e,"color:#aaa;"))},t.exports=d3plus.console},{"./wiki.coffee":124}],119:[function(){d3plus.touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?!0:!1,d3plus.evt=d3plus.touch?{click:"click",down:"touchstart",up:"touchend",over:"touchstart",out:"touchend",move:"touchmove"}:{click:"click",down:"mousedown",up:"mouseup",over:d3plus.ie?"mouseenter":"mouseover",out:d3plus.ie?"mouseleave":"mouseout",move:"mousemove"}},{}],120:[function(){d3plus.ie=!1},{}],121:[function(){d3plus.prefix=function(){var e;return e="-webkit-transform"in document.body.style?"-webkit-":"-moz-transform"in document.body.style?"-moz-":"-ms-transform"in document.body.style?"-ms-":"-o-transform"in document.body.style?"-o-":"",d3plus.prefix=function(){return e},e}},{}],122:[function(){d3plus.rtl="rtl"==d3.select("html").attr("dir")},{}],123:[function(){d3plus.scrollbar=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;n==r&&(r=t.clientWidth),document.body.removeChild(t);var a=n-r;return d3plus.scrollbar=function(){return a},a}},{}],124:[function(e,t){d3plus.wiki={active:"Segmenting-Data#active",aggs:"Custom-Aggregations",alt:"Alt-Text-Parameters",attrs:"Attribute-Data#axes",axes:"Axis-Parameters",background:"Background",color:"Color-Parameters",container:"Container-Element",coords:"Geography-Data",csv:"CSV-Export",data:"Data-Points",depth:"Visible-Depth",descs:"Value-Definitions",dev:"Verbose-Mode",draw:"Draw",edges:"Edges-List",error:"Custom-Error-Message",focus:"Focus-Element",font:"Font-Styles",footer:"Custom-Footer",format:"Value-Formatting",height:"Height",history:"User-History",hover:"Hover-Element",icon:"Icon-Parameters",id:"Unique-ID",keywords:"Keyword-Parameters",labels:"Data-Labels",legend:"Legend",links:"Link-Styles",margin:"Outer-Margins",messages:"Status-Messages",method:"Methods",nodes:"Node-Positions",open:"Open",order:"Data-Ordering",remove:"Remove",search:"Search-Box",select:"Selecting-Elements#select",selectAll:"Selecting-Elements#selectall",shape:"Data-Shapes",size:"Size-Parameters",temp:"Segmenting-Data#temp",text:"Text-Parameters",time:"Time-Parameters",timeline:"Timeline",timing:"Animation-Timing",title:"Custom-Titles",tooltip:"Tooltip-Parameters",total:"Segmenting-Data#total",type:"Output-Type",ui:"Custom-Interface",width:"Width",x:"Axis-Parameters",y:"Axis-Parameters",zoom:"Zooming"},t.exports=d3plus.wiki},{}],125:[function(e){var t,n,r,a,i,o,l,u,s,c,d;c=e("simplify-js"),d3plus.geom.largestRect=function(e,n){var a,o,l,s,f,p,h,g,v,m,y,x,b,w,_,k,M,A,z,j,E,S,T,N,O,C,F,q,P,L,I,V,B,U,D,R,H,Y,X,G,Z,W,J,Q,$,K,et,tt,nt,rt,at,it,ot,lt,ut,st,ct,dt,ft,pt,ht,gt,vt,mt,yt,xt,bt;if(e.length<3)return d3plus.console.error("polygon has to have at least 3 points"),null;if(w=[],g=.5,f=5,null==n&&(n={}),null==n.maxAspectRatio&&(n.maxAspectRatio=15),null==n.minWidth&&(n.minWidth=0),null==n.minHeight&&(n.minHeight=0),null==n.tolerance&&(n.tolerance=.02),null==n.nTries&&(n.nTries=20),null!=n.angle&&(n.angle instanceof Array?p=n.angle:"number"==typeof n.angle?p=[n.angle]:"string"!=typeof n.angle||isNaN(n.angle)||(p=[Number(n.angle)])),null==p&&(p=d3.range(-90,90+f,f)),null!=n.aspectRatio&&(n.aspectRatio instanceof Array?v=n.aspectRatio:"number"==typeof n.aspectRatio?v=[n.aspectRatio]:"string"!=typeof n.aspectRatio||isNaN(n.aspectRatio)||(v=[Number(n.aspectRatio)])),null!=n.origin&&n.origin instanceof Array&&(U=n.origin[0]instanceof Array?n.origin:[n.origin]),h=Math.abs(d3.geom.polygon(e).area()),0===h)return d3plus.console.error("polygon has 0 area"),null;if(ft=d3.extent(e,function(e){return e[0]}),P=ft[0],N=ft[1],pt=d3.extent(e,function(e){return e[1]}),L=pt[0],O=pt[1],K=Math.min(N-P,O-L)*n.tolerance,$=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)D=e[t],r.push({x:D[0],y:D[1]});return r}(),K>0&&($=c($,K),e=function(){var e,t,n;for(n=[],e=0,t=$.length;t>e;e++)D=$[e],n.push([D.x,D.y]);return n}()),n.vdebug&&w.push({type:"simplify",poly:e}),ht=d3.extent(e,function(e){return e[0]}),P=ht[0],N=ht[1],gt=d3.extent(e,function(e){return e[1]}),L=gt[0],O=gt[1],m=[[P,L],[N,L],[N,O],[P,O]],vt=[N-P,O-L],x=vt[0],y=vt[1],tt=Math.min(x,y)/50,null==U)for(U=[],b=d3.geom.polygon(e).centroid(),r(b,e)&&U.push(b);U.length<n.nTries;)J=Math.random()*x+P,Q=Math.random()*y+L,W=[J,Q],r(W,e)&&U.push(W);for(n.vdebug&&w.push({type:"origins",points:U}),z=0,S=null,at=0,ut=p.length;ut>at;at++)for(l=p[at],s=-l*Math.PI/180,n.vdebug&&w.push({type:"angle",angle:l}),k=it=0,st=U.length;st>it;k=++it)for(V=U[k],mt=t(e,V,s),H=mt[0],X=mt[1],yt=t(e,V,s+Math.PI/2),R=yt[0],Y=yt[1],I=[],null!=H&&null!=X&&I.push([(H[0]+X[0])/2,(H[1]+X[1])/2]),null!=R&&null!=Y&&I.push([(R[0]+Y[0])/2,(R[1]+Y[1])/2]),n.vdebug&&w.push({type:"modifOrigin",idx:k,p1W:H,p2W:X,p1H:R,p2H:Y,modifOrigins:I}),ot=0,ct=I.length;ct>ot;ot++)if(B=I[ot],n.vdebug&&w.push({type:"origin",cx:B[0],cy:B[1]}),xt=t(e,B,s),H=xt[0],X=xt[1],q=Math.min(d(B,H),d(B,X)),T=2*Math.sqrt(q),bt=t(e,B,s+Math.PI/2),R=bt[0],Y=bt[1],F=Math.min(d(B,R),d(B,Y)),E=2*Math.sqrt(F),!(z>T*E))for(null!=v?o=v:(C=Math.max(1,n.minWidth/E,z/(E*E)),j=Math.min(n.maxAspectRatio,T/n.minHeight,T*T/z),o=d3.range(C,j+g,g)),lt=0,dt=o.length;dt>lt;lt++)if(a=o[lt],A=Math.max(n.minWidth,Math.sqrt(z*a)),Z=Math.min(T,E*a),!(z>Z*E))for(Z-A>=tt&&n.vdebug&&w.push({type:"aRatio",aRatio:a});Z-A>=tt;)et=(A+Z)/2,_=et/a,nt=B[0],rt=B[1],G=[[nt-et/2,rt-_/2],[nt+et/2,rt-_/2],[nt+et/2,rt+_/2],[nt-et/2,rt+_/2]],G=u(G,s,B),i(G,e)?(M=!0,z=et*_,S={cx:nt,cy:rt,width:et,height:_,angle:l},A=et):(M=!1,Z=et),n.vdebug&&w.push({type:"rectangle",cx:nt,cy:rt,width:et,height:_,areaFraction:et*_/h,angle:l,insidePoly:M});
return[S,z,w]},d=function(e,t){var n,r;return n=t[0]-e[0],r=t[1]-e[1],n*n+r*r},o=function(e,t,n){var r,a,i,o,l;return l=t[1]<n[1]?[t,n]:[n,t],r=l[0],a=l[1],(e[1]===a[1]||e[1]===r[1])&&(e[1]+=Number.MIN_VALUE),e[1]>a[1]||e[1]<r[1]?!1:e[0]>r[0]&&e[0]>a[0]?!1:e[0]<r[0]&&e[0]<a[0]?!0:(i=(a[1]-r[1])/(a[0]-r[0]),o=(e[1]-r[1])/(e[0]-r[0]),o>i)},r=function(e,t){var n,r,a,i,l;for(i=-1,l=t.length,r=t[l-1],a=0;++i<l;)n=r,r=t[i],o(e,n,r)&&a++;return a%2!==0},a=function(e,t,n){var r,a,i;return r=1e-9,a=e[0],i=e[1],a<Math.min(t[0],n[0])-r||a>Math.max(t[0],n[0])+r||i<Math.min(t[1],n[1])-r||i>Math.max(t[1],n[1])+r?!1:!0},n=function(e,t,n,r){var a,i,o,l,u,s,c,d,f,p;return d=1e-9,l=e[0]-t[0],s=e[1]-t[1],u=n[0]-r[0],c=n[1]-r[1],o=l*c-s*u,Math.abs(o)<d?null:(a=e[0]*t[1]-e[1]*t[0],i=n[0]*r[1]-n[1]*r[0],f=(a*u-i*l)/o,p=(a*c-i*s)/o,[f,p])},s=function(e,t,r,i){var o;return o=n(e,t,r,i),null==o?!1:a(o,e,t)&&a(o,r,i)},i=function(e,t){var n,a,i,o,l,u,c,d;for(l=-1,c=e.length,d=t.length,i=e[c-1];++l<c;)for(n=i,i=e[l],u=-1,o=t[d-1];++u<d;)if(a=o,o=t[u],s(n,i,a,o))return!1;return r(e[0],t)},l=function(e,t,n){var r,a,i,o;return null==n&&(n=[0,0]),i=e[0]-n[0],o=e[1]-n[1],r=Math.cos(t),a=Math.sin(t),[r*i-a*o+n[0],a*i+r*o+n[1]]},u=function(e,t,n){var r,a,i,o;for(o=[],a=0,i=e.length;i>a;a++)r=e[a],o.push(l(r,t,n));return o},t=function(e,t,r){var i,o,l,u,s,c,f,p,h,g,v,m,y,x,b;for(s=1e-9,t=[t[0]+s*Math.cos(r),t[1]+s*Math.sin(r)],x=t[0],b=t[1],m=[x+Math.cos(r),b+Math.sin(r)],f=0,Math.abs(m[0]-x)<s&&(f=1),c=-1,g=e.length,o=e[g-1],p=Number.MAX_VALUE,h=Number.MAX_VALUE,l=null,u=null;++c<g;)i=o,o=e[c],v=n(t,m,i,o),null!=v&&a(v,i,o)&&(y=d(t,v),v[f]<t[f]?p>y&&(p=y,l=v):v[f]>t[f]&&h>y&&(h=y,u=v));return[l,u]}},{"simplify-js":8}],126:[function(e){var t,n,r;t=window.d3plus||{},window.d3plus=t,t.version="1.5.0 - Aqua",t.repo="https://github.com/alexandersimoes/d3plus/",t.array={},t.color={},t.data={},t.draw={},t.font={},t.geom={},t.locale={},t.method={},t.network={},t.number={},t.object={},t.shape={},t.string={},t.style={},t.tooltip={},t.ui={},t.util={},t.zoom={},r=e("./style/sheet.coffee"),n=e("./general/console.coffee"),r("d3plus.css")&&n.warning("d3plus.css has been deprecated, you do not need to load this file.","https://github.com/alexandersimoes/d3plus/releases/tag/v1.4.0")},{"./general/console.coffee":118,"./style/sheet.coffee":229}],127:[function(e){window.d3=e("d3"),window.topojson=e("topojson")},{d3:4,topojson:31}],128:[function(){d3plus.locale.en_US={dev:{accepted:"{0} is not an accepted value for {1}, please use one of the following: {2}.",deprecated:"the {0} method has been removed, please update your code to use {1}.",noChange:"{0} was not updated because it did not change.",noContainer:"cannot find a container on the page matching {0}.",of:"of",oldStyle:"style properties for {0} have now been embedded directly into .{1}().",sameEdge:"edges cannot link to themselves. automatically removing self-referencing edge {0}.",set:"{0} has been set.",setLong:"{0} has been set to {1}.",setContainer:"please define a container div using .container()"},error:{accepted:"{0} is not an accepted {1} for {2} visualizations, please use one of the following: {3}.",connections:"no connections available for {0}.",data:"no data available",dataYear:"no data available for {0}.",lib:"{0} visualizations require loading the {1} library.",libs:"{0} visualizations require loading the following libraries: {1}.",method:"{0} visualizations require setting the {1} method.",methods:"{0} visualizations require setting the following methods: {1}."},format:{decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%A, %B %-d, %Y %X",date:"%-m/%-d/%Y",time:"%I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},lowercase:["a","and","at","but","in","of","or","the","to","with"],message:{data:"analyzing data",draw:"drawing visualization",initializing:"initializing {0}",loading:"loading data",tooltipReset:"resetting tooltips",ui:"updating ui"},method:{active:"active segments",color:"color",depth:"depth",dev:"verbose",focus:"focus",icon:"icon",id:"id",height:"height",labels:"labels",legend:"legend",margin:"margin",messages:"status messages",mode:"mode",order:"order",search:"search",shape:"shape",size:"size",style:"style",temp:"temporary segments",text:"text",time:"time",timeline:"timeline",total:"total segments",type:"type",width:"width",x:"x axis",y:"y axis",zoom:"zoom"},time:["date","day","month","time","year"],timeFormat:{FullYear:"%Y",Month:"%B",MonthSmall:"%b",Date:"%A %-d",DateSmall:"%-d",Hours:"%I %p",Minutes:"%I:%M",Seconds:"%Ss",Milliseconds:"%Lms","FullYear-Month":"%b %Y","FullYear-Date":"%-m/%-d/%Y","Month-Date":"%b %-d","Hours-Minutes":"%I:%M %p","Hours-Seconds":"%I:%M:%S %p","Hours-Milliseconds":"%H:%M:%S.%L"},ui:{and:"and",back:"back",collapse:"click to collapse",error:"error",expand:"click to expand",including:"including",loading:"loading...",more:"{0} more",moreInfo:"click for more info",noResults:"no results matching {0}.",primary:"primary connections",share:"share",total:"total",values:"values"},uppercase:["tv","ui"],visualization:{bubbles:"Bubbles",chart:"Chart",geo_map:"Geo Map",line:"Line Plot",network:"Network",rings:"Rings",scatter:"Scatter Plot",stacked:"Stacked Area",tree_map:"Tree Map"}}},{}],129:[function(){d3plus.locale.mk_MK={dev:{accepted:"{0}   a   {1},    a   : {2}.",deprecated:"{0}   ,           {1}.",noChange:"{0}   ,   .",noContainer:" e           {0}.",of:"",oldStyle:"    {0}     . {1} ().",sameEdge:"        .       - {0}.",set:"{0}  .",setLong:"{0}    {1}.",setContainer:"    div  .container()"},error:{accepted:"{0}     {1} {2} ,      : {3}.",connections:"     {0}.",data:" ",dataYear:"    {0}.",lib:"{0}      {1} .",libs:"{0}      : {1}.",method:"{0}     {1} .",methods:"{0}      : {1}."},format:{decimal:",",thousands:".",grouping:[3],currency:[""," ."],dateTime:"%A, %e %B %Y . %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["","","","","","",""],shortDays:["","","","","","",""],months:["","","","","","","","","","","",""],shortMonths:["","","","","","","","","","","",""]},lowercase:["a","","","","","","","",""],method:{active:" ",color:"",depth:"",dev:"",focus:"",icon:"",id:"ID",height:"",labels:"",legend:"",margin:"",messages:"  ",order:"",search:"",shape:"",size:"",style:"",temp:" ",text:"",time:"",timeline:"",total:" ",type:"",width:"",x:"x ",y:"y ",zoom:"",mode:""},time:["","","","",""],visualization:{bubbles:"",chart:"",geo_map:" ",line:" ",network:"",rings:"",scatter:" ",stacked:" ",tree_map:"    "},ui:{and:"",back:"",collapse:"    ",error:"",expand:"    ",loading:"  ...",more:"{0} ",moreInfo:"   ",noResults:"     {0}.",primary:" ",share:"",total:"",values:"",including:""},message:{data:"  ",draw:"  ",initializing:" {0}",loading:"  ",tooltipReset:"  ",ui:"   "},uppercase:["TV","UI"]}},{}],130:[function(){d3plus.locale.pt_BR={dev:{accepted:"{0} no  um valor aceito para {1}, por favor, use um dos seguintes procedimentos: {2}.",deprecated:"{0} mtodo foi removido, por favor atualize seu cdigo para utilizar {1}.",noChange:"{0} no foi atualizado porque ele no mudou.",noContainer:"No foi possvel encontrar um local na pgina correspondente a {0}.",of:"de",oldStyle:"propriedades de estilo para {0} j foram incorporados diretamente no. {1} ().",sameEdge:"bordas no podem vincular a si mesmos. removendo automaticamente borda de auto-referncia {0}.",set:"{0} foi definida.",setLong:"{0} foi definida para {1}.",setContainer:"por favor, defina um div utilizando .container()"},error:{accepted:"{0} no  um reconhecido {1} para {2} visualizaes, por favor, use um dos seguintes procedimentos: {3}.",connections:"No h conexes disponveis para {0}.",data:"No h dados disponveis",dataYear:"No h dados disponveis para {0}.",lib:"A visualizao {0} necessita que seja carregado a biblioteca {1}.",libs:"A visualizao {0} necessita que seja carregado as bibliotecas {1}.",method:"A visualizao {0} exige a definio do mtodo {1}.",methods:"A visualizao {0} exige a definio dos mtodos {1}."},format:{decimal:",",thousands:".",grouping:[3],currency:["R$",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},lowercase:["a","com","de","e","em","mas","ou","para","um"],method:{active:"segmentos ativos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"cone",id:"id",height:"altura",labels:"rtulos",legend:"legenda",margin:"margem",messages:"mensagens de status",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",style:"estilo",temp:"segmentos temporrios",text:"texto",time:"tempo",timeline:"cronograma",total:"segmentos totais",type:"tipo",width:"largura",x:"eixo x",y:"eixo y",zoom:"zoom",mode:"modo"},time:["ano","data","dia","hora","ms"],visualization:{bubbles:"Bolhas",chart:"Grfico",geo_map:"Mapa",line:"Grfico de Linha",network:"Rede",rings:"Anis",scatter:"Disperso",stacked:"Evoluo",tree_map:"Tree Map"},ui:{and:"e",back:"de volta",collapse:"Clique para fechar",error:"erro",expand:"clique para expandir",loading:"carregando ...",more:"mais {0}",moreInfo:"clique para mais informaes",noResults:"nenhum resultado para {0}.",primary:"conexes primrias",share:"participao",total:"total",values:"valores",including:"incluindo"},message:{data:"analisando dados",draw:"desenhando visualizao",initializing:"inicializando {0}",loading:"carregando dados",tooltipReset:"redefinindo as dicas",ui:"atualizando interface"},uppercase:["TV"]}},{}],131:[function(){d3plus.locale.zh_CN={dev:{accepted:"{0}{1}, :{2}",deprecated:"{0}, {1}",noChange:"{0}, ",noContainer:"{0}",of:"",oldStyle:"{0}{1}",sameEdge:"{0}",set:"{0}",setLong:"{0}{1}",setContainer:"()div"},error:{accepted:"{0}{2}{1}, {3}.",connections:"{0}",data:"",dataYear:"{0}",lib:"{0}{1}",libs:"{0}{1}",method:"{0}{1}",methods:"{0}{1}"},format:{decimal:".",thousands:",",grouping:[3],currency:["",""],dateTime:"%A %B %e %Y %X",date:"%Y/%-m/%-d",time:"%H:%M:%S",periods:["",""],days:["","","","","","",""],shortDays:["","","","","","",""],months:["","","","","","","","","","","",""],shortMonths:["","","","","","","","","","","",""]},lowercase:["","","","","...","","","","","..."],method:{active:"",color:"",depth:"",dev:"",focus:"",icon:"",id:"",height:"",labels:"",legend:"",margin:"",messages:"",order:"",search:"",shape:"",size:"",style:"",temp:"",text:"",time:"",timeline:"",total:"",type:"",width:"",x:"X",y:"Y",zoom:"",mode:""},time:["","","","",""],visualization:{bubbles:"",chart:"",geo_map:"",line:"",network:"",rings:"",scatter:"",stacked:"",tree_map:""},ui:{and:"",back:"",collapse:"",error:"",expand:"",loading:"...",more:"{0}",moreInfo:"",noResults:"{0}",primary:"",share:"",total:"",values:"",including:""},message:{data:"",draw:"",initializing:"{0}",loading:"",tooltipReset:"",ui:"UI"},uppercase:["","",""]}},{}],132:[function(){d3plus.method.axis=function(e){var e=e||"x";return{accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,deprecates:[e+"axis",e+"axis_val",e+"axis_var"],domain:!1,lines:[],mute:d3plus.method.filter(!0),range:!1,reset:["range"],scale:{accepted:["linear","log","continuous","share"],value:"linear",deprecates:["layout","unique_axis","yaxis_scale"]},solo:d3plus.method.filter(!0),stacked:{accepted:[Boolean],value:!1},value:!1,zerofill:{accepted:[Boolean],value:!1}}}},{}],133:[function(){d3plus.method.filter=function(e){var e=e||!1;return{accepted:[Array,Boolean,Function,Number,Object,String],global:e,process:Array,value:[]}}},{}],134:[function(){d3plus.method.function=function(e,t){return function(n,r){function a(e){if(d3plus.object.validate(e))if("family"in e)e.family.value=e.family.process(n.family);else for(var t in e)a(e[t])}var i=e in t&&d3plus.object.validate(t[e])&&"accepted"in t[e]?t[e].accepted:e in t?typeof t[e]:null;if("function"==typeof i&&(i=i(t)),null===i||i instanceof Array||(i=[i]),n===Object)return t[e];if(!arguments.length&&(null===i&&!("value"in t)||void 0!==i&&i.indexOf(void 0)<0))return"value"in t[e]?t[e].value:t[e];if("style"===e&&"object"==typeof n){var o=t.format.locale.value.dev.oldStyle;(t.dev.value||"dev"===e&&n)&&!t.methodGroup&&"wait"!==t.methodGroup&&(t.methodGroup=!0,d3plus.console.groupCollapsed("method behavior"));for(var l in n)d3plus.console.warning(d3plus.string.format(o,'"'+l+'"',l),l),t.self[l](n[l]);return t.self}return"font"===e&&d3plus.object.validate(n)&&"family"in n&&"string"==typeof n.family&&a(t),d3plus.method.object(t,e,t,e,n),"function"==typeof r&&(t[e].callback=r),t[e].chainable===!1?t[e].value:t.self}}},{}],135:[function(){d3plus.method.init=function(e,t,n){t.previous=!1,t.changed=!1,t.initialized=!1,t.getVars=function(){return e},"init"in t&&!("value"in t)&&(t.value=t.init(e),delete t.init),"process"in t&&(t.value=d3plus.method.process(t,t.value));for(var r in t)if("deprecates"===r){var a=t[r]instanceof Array?t[r]:[t[r]];a.forEach(function(t){e.self[t]=function(t,n){return function(){e.dev.value&&e.methodGroup&&(d3plus.console.groupEnd(),e.methodGroup=!1);var r=e.format.locale.value.dev.deprecated;return t="."+t+"()",d3plus.console.error(d3plus.string.format(r,t,"."+n+"()"),n),e.self}}(t,n)})}else"global"===r?n in e||(e[n]=[]):d3plus.object.validate(t[r])&&d3plus.method.init(e,t[r],r);t.initialized=!0}},{}],136:[function(){d3plus.method.object=function(e,t,n,r,a){if(["accepted","getVars"].indexOf(r)<0){var i=d3plus.object.validate(a),o=!(!i||"value"in a||d3.keys(a)[0]in n[r]);if(null===a||!i||o)o?d3plus.method.set(e,t,n[r],"value",a):d3plus.method.set(e,t,n,r,a);else if(i)for(d in a)d3plus.method.object(e,t,n[r],d,a[d])}}},{}],137:[function(){d3plus.method.process=function(e,t){return e.process===Array?d3plus.array.update(d3plus.util.copy(e.value),t):"object"==typeof e.process&&"string"==typeof t?e.process[t]:"function"==typeof e.process?e.process(t):t}},{}],138:[function(){d3plus.method.processData=function(e,t){if("string"==typeof e||d3plus.util.d3selection(e)){if(void 0===t)var t=this;var n=(t.getVars(),e.indexOf("/")>=0);return!n&&d3plus.util.d3selection(e)?e:n||d3.selectAll(e).empty()?(t.url=e,[]):d3.selectAll(e)}return e}},{}],139:[function(){d3plus.method.set=function(e,t,n,r,a){if("value"!==r&&r&&r!==t)var i=e.format.locale.value.dev.of,o='"'+r+'" '+i+" ."+t+"()";else var o="."+t+"()";if("value"===r&&"accepted"in n)var l=n.accepted;else if(d3plus.object.validate(n[r])&&"accepted"in n[r])var l=n[r].accepted;else var l=null;"function"==typeof l&&(l=l(e)),null===l||l instanceof Array||(l=[l]);var u=!0;if(l instanceof Array){var s=void 0===a?a:a.constructor;u=l.indexOf(a)>=0||l.indexOf(s)>=0}if(u===!1){if(void 0!==a){var c=e.format.locale.value.dev.accepted,d=[],f=JSON.stringify(a),p=e.format.locale.value.ui.and;"string"!=typeof a&&(f='"'+f+'"'),l.forEach(function(e){d.push("string"==typeof e?'"'+e+'"':"function"==typeof e?e.toString().split("()")[0].substring(9):e.toString())}),d=d3plus.string.list(d,p),d3plus.console.warning(d3plus.string.format(c,f,o,d),t)}}else{if(d3plus.object.validate(n[r])&&"value"in n[r]){var h=r;n=n[r],r="value"}if("value"===r&&"process"in n&&(a=d3plus.method.process(n,a)),n[r]instanceof Array||n[r]!==a||void 0===a){if(n.changed=!0,"history"in e&&"draw"!==t){var g=d3plus.util.copy(n);g.method=t,e.history.chain.push(g)}if(n.previous=n[r],"id"in e&&"value"===r&&"nesting"in n)if("id"!==t){if("object"!=typeof n.nesting&&(n.nesting={}),d3plus.object.validate(a)){for(var v in a)"string"==typeof a[v]&&(a[v]=[a[v]]);n.nesting=d3plus.object.merge(n.nesting,a),e.id.value in n.nesting||(n.nesting[e.id.value]=a[d3.keys(a)[0]])}else n.nesting[e.id.value]=a instanceof Array?a:[a];n[r]=n.nesting[e.id.value][0]}else a instanceof Array?(n.nesting=a,"depth"in e&&e.depth.value<a.length?n[r]=a[e.depth.value]:(n[r]=a[0],"depth"in e&&(e.depth.value=0))):(n[r]=a,n.nesting=[a],"depth"in e&&(e.depth.value=0));else if("depth"===t){if(e.depth.value=a>=e.id.nesting.length?e.id.nesting.length-1:0>a?0:a,e.id.value=e.id.nesting[e.depth.value],"object"==typeof e.text.nesting){var m=e.text.nesting[e.id.value];m&&(e.text.nesting[e.id.value]="string"==typeof m?[m]:m,e.text.value=m instanceof Array?m[0]:m)}}else n[r]=d3plus.object.validate(n[r])&&d3plus.object.validate(a)?d3plus.object.merge(n[r],a):a;if("value"===r&&n.global){var y=n[r].length>0,x=h||r;x in e&&(y&&e.data[x].indexOf(t)<0||!y&&e.data[x].indexOf(t)>=0)&&(e.data[x]=d3plus.array.update(e.data[x],t))}if("value"===r&&n.dataFilter&&e.data&&e.data.filters.indexOf(t)<0&&e.data.filters.push(t),"value"===r&&n.reset){var b="string"==typeof n.reset?[n.reset]:n.reset;b.forEach(function(e){n[e]=!1})}if((e.dev.value||"dev"===r)&&n.changed&&void 0!==n[r]){var w=n[r]instanceof Array&&n[r].length>10,_=d3plus.util.d3selection(n[r]),k="function"==typeof n[r],M=w||_||k?null:"string"==typeof n[r]?n[r]:JSON.stringify(n[r]);if((e.dev.value||"dev"===r&&user)&&!e.methodGroup&&"wait"!==e.methodGroup&&(e.methodGroup=!0,d3plus.console.groupCollapsed("method behavior")),null!==M&&M.length<260){var c=e.format.locale.value.dev.setLong;d3plus.console.log(d3plus.string.format(c,o,'"'+M+'"'))}else{var c=e.format.locale.value.dev.set;d3plus.console.log(d3plus.string.format(c,o))}}}else{var c=e.format.locale.value.dev.noChange;e.dev.value&&d3plus.console.comment(d3plus.string.format(c,o))}"value"===r&&n.callback&&!n.url&&n.callback(a)}}},{}],140:[function(){d3plus.method=function(e,t,n){var t=t||[],n=n||[],r=d3plus.style[d3plus.method.style.value];t.forEach(function(t){t in e||(e[t]={}),e[t]=d3plus.object.merge(d3plus.method[t],e[t]),n.indexOf(t)>=0&&(e[t]=d3plus.object.merge(r[t],e[t]),n.splice(n.indexOf(t),1)),d3plus.method.init(e,e[t],t),e.self[t]=d3plus.method.function(t,e)}),n.forEach(function(t){e[t]=d3plus.object.merge(e[t]||{},r[t]),d3plus.method.init(e,e[t],t),e.self[t]=d3plus.method.function(t,e)})}},{}],141:[function(){d3plus.method.active={accepted:[!1,Array,Function,Number,Object,String],deprecates:"active_var",mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),spotlight:{accepted:[Boolean],deprecates:"spotlight",value:!1},value:!1}},{}],142:[function(){d3plus.method.aggs={accepted:[Object],deprecated:"nesting_aggs",value:{}}},{}],143:[function(){d3plus.method.alt={accepted:[!1,Array,Function,Object,String],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:"alt"}},{}],144:[function(){d3plus.method.attrs={accepted:[!1,Array,Object,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},process:d3plus.method.processData,value:!1}},{}],145:[function(){d3plus.method.axes={mirror:{accepted:[Boolean],deprecates:["mirror_axis","mirror_axes"],value:!1},values:["x","y"]}},{}],146:[function(){d3plus.method.color={accepted:[!1,Array,Function,Object,String],deprecates:"color_var",init:function(e){return"form"===e.shell?"color":!1},mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0)}},{}],147:[function(){d3plus.method.container={accepted:[Array,Object,String],element:!1,id:"default",process:function(e){if(e===!1){var t=this.getVars().shell;return"form"===t?d3.select("body"):e}return d3plus.util.d3selection(e)?e:d3.select(e instanceof Array?e[0][0]:e)},value:!1}},{}],148:[function(){d3plus.method.coords={accepted:[!1,Array,Function,Object,String],filetype:{accepted:["json"],value:"json"},mute:d3plus.method.filter(!1),process:d3plus.method.processData,solo:d3plus.method.filter(!1),value:!1}},{}],149:[function(e){var t=e("../../core/fetch/value.js");d3plus.method.csv={accepted:[void 0,Array,String],chainable:!1,data:[],process:function(e){var n=this.getVars();if(void 0===n.returned)return[];if(e instanceof Array)var r=e;else if("string"==typeof e)var r=[e];var a=[],i=[],o=n.title.value||"My D3plus App Data";if(o=d3plus.string.strip(o),!r){var r=[n.id.value];n.time.value&&r.push(n.time.value),n.size.value&&r.push(n.size.value),n.text.value&&r.push(n.text.value)}r.forEach(function(e){i.push(n.format.value(e))}),a.push(i),n.returned.nodes.forEach(function(e){var i=[];r.forEach(function(r){i.push(t(n,e,r))}),a.push(i)});var l="data:text/csv;charset=utf-8,";if(a.forEach(function(e,t){dataString=e.join(","),l+=t<a.length?dataString+"\n":dataString}),d3plus.ie){var u=new Blob([l],{type:"text/csv;charset=utf-8;"});navigator.msSaveBlob(u,o+".csv")}else{var s=encodeURI(l),c=document.createElement("a");c.setAttribute("href",s),c.setAttribute("download",o+".csv"),c.click()}return this.data=a,r},value:void 0}},{"../../core/fetch/value.js":81}],150:[function(){d3plus.method.data={accepted:[!1,Array,Function,String],cache:{},delimiter:{accepted:[String],value:"|"},element:{process:function(e){if(d3plus.util.d3selection(e))var t=e;else if("string"!=typeof e||d3.select(e).empty())var t=!1;else var t=d3.select(e);if(t){var n=this.getVars();n.self.container(d3.select(t.node().parentNode)),t.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}return t},value:!1},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],mute:[],process:function(e){var t=this.getVars();return"default"===t.container.id&&e.length&&t.self.container({id:"default"+e.length}),d3plus.method.processData(e,this)},solo:[],value:!1}},{}],151:[function(){d3plus.method.depth={accepted:[Function,Number],value:0}},{}],152:[function(){d3plus.method.descs={accepted:[!1,Function,Object],value:!1}},{}],153:[function(){d3plus.method.dev={accepted:[Boolean],value:!1}},{}],154:[function(e){var t=e("../../core/parse/element.js");d3plus.method.draw={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e){if(this.initialized===!1)return this.initialized=!0,e;var n=this.getVars(),r="history"in n?n.history.chain:[];if("data"in n&&n.data.value&&d3plus.util.d3selection(n.data.value)&&(n.data.value=t(n)),void 0===e&&"function"==typeof this.value&&(e=this.value),n.container.value===!1){var a=n.format.locale.value.dev.setContainer;d3plus.console.warning(a,"container")}else if(n.container.value.empty()){var a=n.format.locale.value.dev.noContainer;d3plus.console.warning(d3plus.string.format(a,'"'+n.container.value+'"'),"container")}else n.dev.value&&(n.methodGroup&&(n.methodGroup="wait",d3plus.console.groupEnd()),d3plus.console.time("total draw time")),n.container.value.call(n.self);if("function"==typeof e&&r.length){var i={};r.forEach(function(e){var t=e.method;delete e.method,i[t]=e}),e(i),n.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/parse/element.js":85}],155:[function(){d3plus.method.edges={accepted:[!1,Array,Function,String],connections:function(e,t,n){var r=this;if(!r.value)return[];if(!t)var t="id";var a=r.restricted||r.value,i=[];if(!e)return a;var o=a.filter(function(a){var o=!1;return a[r.source][t]==e?(o=!0,n&&i.push(a[r.target])):a[r.target][t]==e&&(o=!0,n&&i.push(a[r.source])),o});return n?i:o},delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},interpolate:{accepted:["basis","cardinal","linear","monotone","step"],value:"basis"},label:!1,limit:{accepted:[!1,Function,Number],value:!1},process:d3plus.method.processData,size:!1,source:"source",target:"target",value:!1}},{}],156:[function(){d3plus.method.error={accepted:[Boolean,String],value:!1}},{}],157:[function(){d3plus.method.focus={accepted:[!1,Array,Function,Number,String],deprecates:"highlight",process:function(e){if(e===!1)return[];e instanceof Array||(e=[e]);var t=this.getVars();if(["string","number"].indexOf(typeof e[0])>=0&&t.data.element.value){var n=t.data.element.value.node().tagName.toLowerCase(),r=t.data.element.value.attr("type");"select"===n?t.data.element.value.selectAll("option").each(function(n,r){n&&n[t.id.value]===e[0]&&(t.data.element.value.node().selectedIndex=r)}):"input"===n&&"radio"===r&&t.data.element.value.each(function(n){this.checked=n&&n[t.id.value]===e[0]?!0:!1})}return e},tooltip:{accepted:[Boolean],value:!0},value:[]}},{}],158:[function(){d3plus.method.footer={accepted:[!1,Number,String],link:!1,value:!1}},{}],159:[function(){d3plus.method.format={accepted:[Function,String],deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(d3plus.locale)},process:function(e){var t="en_US",n=d3plus.locale[t];return e!==t&&(n=d3plus.object.merge(n,d3plus.locale[e])),this.language=e,n},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e){if("string"==typeof e){var t=this.getVars();t.self.format({locale:e})}else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var n=this.getVars();if(n.time&&n.time.value&&t===n.time.value){var r=n.time.format.value||n.data.time.format,a=e.constructor===Date?e:new Date(e);return r(a)}if("number"==typeof e){var r=this.number.value||d3plus.number.format;return r(e,t)}if("string"==typeof e){var r=this.text.value||d3plus.string.title;return r(e,t)}return JSON.stringify(e)}}},{}],160:[function(){d3plus.method.height={accepted:[!1,Number],secondary:!1,value:!1}},{}],161:[function(){d3plus.method.history={accepted:[Boolean],back:function(){if(this.states.length>0){var e=this.states.pop();e()}},chain:[],states:[],value:!0}},{}],162:[function(){d3plus.method.hover={accepted:[!1,Number,String],value:!1}},{}],163:[function(){d3plus.method.icon={accepted:[!1,Array,Function,Object,String],deprecates:"icon_var",style:{accepted:[Object,String],deprecates:"icon_style",value:"default"},value:"icon"}},{}],164:[function(){d3plus.method.id={accepted:[Array,String],dataFilter:!0,deprecates:["id_var","nesting"],init:function(e){return"form"===e.shell?(this.nesting=["value"],"value"):(this.nesting=["id"],"id")},mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0)}},{}],165:[function(){d3plus.method.keywords={accepted:[!1,Array,Function,Object,String],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:"keywords"}},{}],166:[function(){d3plus.method.labels={accepted:[Boolean],resize:{accepted:[Boolean],value:!0},value:!0}},{}],167:[function(){d3plus.method.legend={accepted:[Boolean],value:!0}},{}],168:[function(){d3plus.method.margin={accepted:[Number,Object,String],process:function(e){var t=this,n=["top","right","bottom","left"];if(void 0===e)var e=t.value;var r=e;if("string"==typeof e&&(e=e.split(" "),e.forEach(function(t,n){e[n]=parseFloat(t,10)}),e=1===e.length?e[0]:2===e.length?{top:e[0],right:e[1],bottom:e[0],left:e[1]}:3===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[1]}:4===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[3]}:0),"number"==typeof e)n.forEach(function(n){t[n]=e});else{for(var a in e){var i=n.indexOf(a);i>=0&&(n.splice(i,1),t[a]=e[a])}n.forEach(function(e){t[e]=0})}return r},value:0}},{}],169:[function(){d3plus.method.messages={accepted:[Boolean,String],value:!0}},{}],170:[function(){d3plus.method.nodes={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},process:d3plus.method.processData,value:!1}},{}],171:[function(){d3plus.method.open={accepted:[Boolean],flipped:{accepted:[Boolean],value:!1},value:!1}},{}],172:[function(){d3plus.method.order={accepted:[!1,Function,String],sort:{accepted:["asc","desc"],value:"asc",deprecates:["sort"]},value:!1}},{}],173:[function(){d3plus.method.remove={accepted:void 0,process:function(e){if(!this.initialized)return e;var t=this.getVars();t.container.value.remove()},value:void 0}},{}],174:[function(){d3plus.method.resize={accepted:[Boolean],value:!1}},{}],175:[function(){d3plus.method.search={accepted:["auto",Boolean],process:function(e){return"Boolean"==typeof e&&(this.enabled=e),e},value:"auto"}},{}],176:[function(){d3plus.method.select={accepted:[String],chainable:!1,process:function(e){var t=this.getVars();return t.container.value&&e?t.container.value.select(e):e},value:void 0}},{}],177:[function(){d3plus.method.selectAll={accepted:[String],chainable:!1,process:function(e){var t=this.getVars();return t.container.value&&e?t.container.value.selectAll(e):e},value:void 0}},{}],178:[function(){d3plus.method.shape={accepted:function(e){return"textwrap"===e.shell?["circle","square"]:["circle","donut","line","square","area","coordinates"]},value:!1}},{}],179:[function(){d3plus.method.size={accepted:function(e){return"textwrap"===e.shell?[Array,!1]:[Array,Boolean,Function,Object,String]},dataFilter:!0,deprecates:["value","value_var"],mute:d3plus.method.filter(!0),scale:{accepted:[Function],deprecates:"size_scale",value:d3.scale.sqrt()},solo:d3plus.method.filter(!0),threshold:!0,value:!1}},{}],180:[function(){d3plus.method.style={accepted:function(){return d3.keys(d3plus.style).filter(function(e){return"object"==typeof d3plus.style[e]})},value:"default"}},{}],181:[function(){d3plus.method.temp={accepted:[!1,Array,Function,Object,String],deprecates:["else_var","else"],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:!1}},{}],182:[function(){d3plus.method.text={accepted:[Array,Boolean,Function,Object,String],deprecates:["name_array","text_var"],html:{accepted:[Boolean],value:!1},init:function(e){if("textwrap"===e.shell){var t=this.split;this.break=new RegExp("[^\\s\\"+t.join("\\")+"]+\\"+t.join("?\\")+"?","g")
}return!1},nesting:!0,mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),secondary:{accepted:[Array,Boolean,Function,Object,String],nesting:!0,value:!1},split:["-","/",";",":","&"]}},{}],183:[function(){d3plus.method.time={accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,deprecates:["year","year_var"],fixed:{accepted:[Boolean],deprecates:["static_axis","static_axes"],value:!0},format:{accepted:[!1,String],value:!1},mute:d3plus.method.filter(!1),solo:d3plus.method.filter(!1),value:!1}},{}],184:[function(){d3plus.method.timeline={accepted:[Boolean],value:!0}},{}],185:[function(){d3plus.method.title={accepted:[!1,Function,String],link:!1,sub:{accepted:[!1,String],deprecates:"sub_title",link:!1,value:!1},total:{accepted:[Boolean,Object],deprecates:"total_bar",link:!1,value:!1},process:function(e){var t=this.getVars();if(0===t.container.id.indexOf("default")&&e){var n=d3plus.string.strip(e).toLowerCase();t.self.container({id:n})}return e},value:!1}},{}],186:[function(){d3plus.method.tooltip={accepted:[!1,Array,Function,Object,String],deprecates:"tooltip_info",html:{accepted:[!1,Function,String],deprecates:"click_function",value:!1},value:!1}},{}],187:[function(){d3plus.method.total={accepted:[!1,Array,Function,Object,String],deprecates:["total_var"],mute:d3plus.method.filter(!0),solo:d3plus.method.filter(!0),value:!1}},{}],188:[function(){d3plus.method.type={accepted:function(e){return d3.keys(e.types)},init:function(e){var t=e.shell;return"viz"===t?"tree_map":"form"===t?"auto":void 0},mode:{accepted:function(e){return e.types[e.type.value].modes||[!1]},value:!1}}},{}],189:[function(){d3plus.method.ui={accepted:[Array,Boolean],value:!1}},{}],190:[function(){d3plus.method.width={accepted:[!1,Number],secondary:!1,value:!1}},{}],191:[function(){d3plus.method.x=d3plus.method.axis("x")},{}],192:[function(){d3plus.method.y=d3plus.method.axis("y")},{}],193:[function(){d3plus.method.zoom={accepted:[Boolean],behavior:d3.behavior.zoom().scaleExtent([1,1]),click:{accepted:[Boolean],value:!0},direction:function(e){var t=this.getVars(),n=t.id.nesting.length-1,r=t.depth.value,a=t.types[t.type.value].nesting===!1;return a?0:e.d3plus.merged||n>r&&(!e||t.id.nesting[t.depth.value+1]in e)?1:r!==n&&(!e||t.id.nesting[t.depth.value+1]in e)||!t.small&&t.tooltip.html.value?0:-1},pan:{accepted:[Boolean],value:!0},scroll:{accepted:[Boolean],deprecates:"scroll_zoom",value:!0},touchEvent:function(){var e=this.getVars(),t=e.zoom.scale>e.zoom.behavior.scaleExtent()[0],n=e.types[e.type.value].zoom&&e.zoom.value&&e.zoom.scroll.value,r=d3.event.touches.length>1&&n;r||t||d3.event.stopPropagation()},value:!0}},{}],194:[function(){d3plus.network.cluster=function(e,t){var n,r,a,i,o,l,u,s,c,d,f,p,h,g,v,m,y,x,b,w,_,k,M,A,z,j,E,S,T,N,O,C;if(h=[],null==t&&(t={}),(null==t.nodes||"object"!=typeof t.nodes)&&(O=d3plus.network.normalize(e,t),e=O[0],t=O[1],null===t))return null;d=t.distance,k=t.nodeid,j=t.startpoint,p=t.endpoint,M=t.nodes,A={};for(g in M)A[g]={node:M[g].node,degree:0};for(x=0,y={},E=0,T=e.length;T>E;E++)f=e[E],r=k(j(f)),a=k(p(f)),r in y||(y[r]={}),a in y||(y[a]={}),a in y[r]||(y[r][a]=0,y[a][r]=0,x++,A[r].degree+=1,A[a].degree+=1);u={},n=0;for(g in A)_=A[g],u[g]={score:_.degree/(2*x),nodes:[g]};for(r in y)for(a in y[r])y[r][a]=1/(2*x)-A[r].degree*A[a].degree/(4*x*x);for(v=0;1e3>v;){c=-1,b=void 0,w=void 0;for(r in y)for(a in y[r])y[r][a]>c&&(c=y[r][a],b=r,w=a);if(0>c)break;for(m in y[b])m!==w&&(m in y[w]?y[w][m]+=y[b][m]:y[w][m]=y[b][m]-2*u[w].score*u[m].score,y[m][w]=y[w][m]),delete y[m][b];for(m in y[w])m in y[b]||m===w||(y[w][m]-=2*u[b].score*u[m].score,y[m][w]=y[w][m]);for(C=u[b].nodes,S=0,N=C.length;N>S;S++)_=C[S],u[w].nodes.push(_);u[w].score+=u[b].score,t.vdebug&&h.push({type:"merge",father:w,child:b,nodes:u[w].nodes}),delete u[b],delete y[b],n+=c,v++}return l=function(){var e;e=[];for(i in u)s=u[i],e.push([i,s.nodes.length]);return e}(),l.sort(function(e,t){return t[1]-e[1]}),z=function(){var e,t,n;for(n=[],e=0,t=l.length;t>e;e++)o=l[e],n.push(u[o[0]].nodes);return n}(),[z,h]}},{}],195:[function(){d3plus.network.normalize=function(e,t){var n,r,a,i,o,l,u,s,c,d,f,p,h,g,v,m,y,x,b,w,_,k,M,A,z,j,E,S,T,N,O;if(w=t.source,k=t.target,i=t.directed,o=t.distance,x=t.nodeid,_=t.startpoint,s=t.endpoint,n=t.K,M=t.vdebug,i||(i=!1),null==n&&(n=1),null==x?x=function(e){return e}:"string"==typeof x&&(x=function(e){return function(t){return t[e]}}(x)),null!=w&&"object"==typeof w&&(w=x(w)),null!=k&&"object"==typeof k&&(k=x(k)),null==_?_=function(e){return e.source}:"string"==typeof _&&(_=function(e){return function(t){return t[e]}}(_)),null==s?s=function(e){return e.target}:"string"==typeof s&&(s=function(e){return function(t){return t[e]}}(s)),null==o)o=function(){return 1};else if("number"==typeof o)o=function(e){return function(){return e}}(o);else if("string"==typeof o)o=function(e){return function(t){return t[e]}}(o);else if(o instanceof Array){for(u={},d=A=0,E=e.length;E>A;d=++A)l=e[d],r=x(_(l)),a=x(s(l)),u[r+"_"+a]=o[d];o=function(e){return r=x(_(e)),a=x(s(e)),u[r+"_"+a]}}for(b={},z=0,S=e.length;S>z;z++){for(l=e[z],m=_(l),y=s(l),h=x(m),g=x(y),N=[m,y],j=0,T=N.length;T>j;j++)v=N[j],f=x(v),f in b||(b[f]={node:v,outedges:[]});b[h].outedges.push(l),i||b[g].outedges.push(l)}return c=null,0===e.length?c="The length of edges is 0":0>n?c="K can not have negative value":null==o(e[0])?c="Check the distance function/attribute":null==_(e[0])?c="Check the startpoint function/attribute":null==s(e[0])?c="Check the endpoint function/attribute":(p=x(_(e[0])),null==p||"string"!=(O=typeof p)&&"number"!==O?c="Check the nodeid function/attribute":null==w||w in b?null==k||k in b||(c="The target is not in the graph"):c="The source is not in the graph"),null!=c?(d3plus.console.error(c),null):[e,{source:w,target:k,directed:i,distance:o,nodeid:x,startpoint:_,endpoint:s,K:n,nodes:b,vdebug:M}]}},{}],196:[function(e,t){var n;n=e("heap"),d3plus.network.shortestPath=function(e,t,r){var a,i,o,l,u,s,c,d,f,p,h,g,v,m,y,x,b,w,_,k,M,A,z,j,E,S,T,N,O;if(null==r&&(r={}),r.source=t,(null==r.nodes||"object"!=typeof r.nodes)&&(T=d3plus.network.normalize(e,r),e=T[0],r=T[1],null===r))return null;t=r.source,k=r.target,u=r.directed,s=r.distance,m=r.nodeid,_=r.startpoint,d=r.endpoint,a=r.K,y=r.nodes;for(h in y)v=y[h],v.count=0;for(p=new n(function(e,t){return e.distance-t.distance}),A={},null==k&&(A[t]=!0),p.push({edge:null,target:t,distance:0}),g=0,w=[];!p.empty()&&(g=Math.max(g,p.size()),x=p.pop(),M=x.target,y[M].count++,null==k?w.push(x):M===k&&w.push(x),w.length!==a);)if(y[M].count<=a)for(N=y[M].outedges,z=0,E=N.length;E>z;z++){if(c=N[z],i=m(_(c)),l=m(d(c)),u||l!==M||(O=[l,i],i=O[0],l=O[1]),null==k){if(A[l])continue;A[l]=!0}o=x.distance+s(c),p.push({edge:c,previous:x,target:l,distance:o})}for(f=function(t){for(e=[];null!=t.edge;)e.push(t.edge),t=t.previous;return e.reverse()},j=0,S=w.length;S>j;j++)b=w[j],null!=k&&(delete b.target,b.edges=f(b)),delete b.edge,delete b.previous;return w},t.exports=d3plus.network.shortestPath},{heap:5}],197:[function(){d3plus.network.subgraph=function(e,t,n){var r,a,i,o,l,u,s,c,d,f,p,h;return null==n&&(n={}),n.source=t,null!=n.nodes&&"object"==typeof n.nodes||(h=d3plus.network.normalize(e,n),e=h[0],n=h[1],null!==n)?(t=n.source,i=n.directed,o=n.distance,c=n.nodeid,f=n.startpoint,u=n.endpoint,r=n.K,d=n.nodes,p={},p[t]=!0,a=function(e,t){var n,l,s,h,g,v,m,y,x;for(m=d[e].outedges,x=[],g=0,v=m.length;v>g;g++)s=m[g],n=c(f(s)),l=c(u(s)),i||l!==e||(y=[l,n],n=y[0],l=y[1]),l in p?x.push(void 0):(h=t+o(s),r>=h?(p[l]=!0,x.push(a(l,h))):x.push(void 0));return x},a(t,0),{nodes:function(){var e;e=[];for(s in p)e.push(d[s].node);return e}(),edges:function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)l=e[t],c(f(l))in p&&c(u(l))in p&&r.push(l);return r}()}):null}},{}],198:[function(){d3plus.number.format=function(e,t,n){if(!n&&"getVars"in this)var n=this.getVars();if(n&&t&&(t===n.x.value&&"log"===n.x.scale.value||t===n.y.value&&"log"===n.y.scale.value)){var r="",a=function(e){return(e+"").split("").map(function(e){return r[e]}).join("")};return"10"+a(Math.round(Math.log(e)/Math.LN10))}if("locale"in this)var i=this.locale.value,o=i.time;else var i=d3plus.locale.en_US,o=i.time;if(n&&"string"==typeof n.time.value&&o.push(n.time.value),t&&o.indexOf(t.toLowerCase())>=0)return e;if(10>e&&e>-10)return d3.round(e,2);if(e.toString().split(".")[0].length>4){var l=d3.formatPrefix(e).symbol;return l=l.replace("G","B"),e=d3.formatPrefix(e).scale(e),e=parseFloat(d3.format(".3g")(e)),e+l}return"share"==t?d3.format(".2f")(e):d3.format(",f")(e)}},{}],199:[function(e,t){var n;n=e("../util/d3selection.js"),d3plus.object.merge=function(e,t){var r,a;return r=function(e,t){var a,i;i=[];for(a in e)"undefined"!=typeof e[a]?d3plus.object.validate(e[a])?("object"!=typeof t[a]&&(t[a]={}),i.push(r(e[a],t[a]))):i.push(!n(e[a])&&e[a]instanceof Array?t[a]=e[a].slice(0):t[a]=e[a]):i.push(void 0);return i},a={},e&&r(e,a),t&&r(t,a),a},t.exports=d3plus.object.merge},{"../util/d3selection.js":249}],200:[function(e,t){d3plus.object.validate=function(e){return null!==e&&"object"==typeof e&&!(e instanceof Array)},t.exports=d3plus.object.validate},{}],201:[function(){d3plus.string.format=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.unkeyed_index=0,t.replace(/\{(\w*)\}/g,function(n,r){if(""===r&&(r=t.unkeyed_index,t.unkeyed_index++),r==+r)return"undefined"!==e[r]?e[r]:n;for(var a=0;a<e.length;a++)if("object"==typeof e[a]&&"undefined"!=typeof e[a][r])return e[a][r];return n}.bind(t))}},{}],202:[function(){d3plus.string.list=function(e,t,n,r){var a;return e instanceof Array?(e=e.slice(0),t||(t=d3plus.locale.en_US.ui.and),r||(r=d3plus.locale.en_US.ui.moreText),2===e.length?e.join(" "+t+" "):(n&&e.length>n&&(a=e.length-n+1,e=e.slice(0,n-1),e[n-1]=d3plus.string.format(r,a)),e.length>1&&(e[e.length-1]=t+" "+e[e.length-1]),e.join(", "))):e}},{}],203:[function(){d3plus.string.strip=function(e){var t=["!","@","#","$","%","^","&","*","(",")","[","]","{","}",".",",","/","\\","|","'",'"',";",":","<",">","?","=","+"];return e+="",""+e.replace(/[^A-Za-z0-9\-_]/g,function(e){if(" "==e)return"_";if(t.indexOf(e)>=0)return"";var n=[[/[\300-\306]/g,"A"],[/[\340-\346]/g,"a"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\322-\330]/g,"O"],[/[\362-\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\307]/g,"C"],[/[\347]/g,"c"]],r="";for(var a in n)if(n[a][0].test(e)){r=n[a][1];break}return r})}},{}],204:[function(){d3plus.string.title=function(e){var t,n,r;return e?("locale"in this?(n=this.locale.value,"string"==typeof n&&(n=n in d3plus.locale?d3plus.locale[n]:d3plus.locale.en_US)):n=d3plus.locale.en_US,"."===e.charAt(e.length-1)?e.charAt(0).toUpperCase()+e.substr(1):(r=n.lowercase,t=n.uppercase,e.replace(/\S*/g,function(n,a){return t.indexOf(n.toLowerCase())>=0?n.toUpperCase():r.indexOf(n.toLowerCase())>=0&&0!==a&&a!==e.length-1?n.toLowerCase():n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()}))):""}},{}],205:[function(){d3plus.style.default={},d3plus.style.default.fontFamily=["Helvetica Neue","HelveticaNeue","Helvetica","Arial","sans-serif"]},{}],206:[function(){d3plus.style.default.axes={ticks:{color:"#ccc",font:{color:"#888",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:10,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},size:10,width:1}}},{}],207:[function(){d3plus.style.default.background={accepted:[String],value:"#ffffff"}},{}],208:[function(){d3plus.style.default.color={heatmap:["#27366c","#7b91d3","#9ed3e3","#f3d261","#c9853a","#d74b03"],focus:"#444444",missing:"#eeeeee",primary:"#d74b03",range:["#d74b03","#eeeeee","#94b153"],scale:{accepted:[Array,"d3plus","category10","category20","category20b","category20c"],process:function(e){return e instanceof Array?d3.scale.ordinal().range(e):"d3plus"===e?d3plus.color.scale:(console.log("Here!"),d3.scale[e]())},value:"d3plus"},secondary:"#e5b3bb"}},{}],209:[function(){d3plus.style.default.coords={center:[0,0],fit:{accepted:["auto","height","width"],value:"auto"},padding:20,projection:{accepted:["mercator","equirectangular"],value:"mercator"},threshold:.1}},{}],210:[function(){d3plus.style.default.data={donut:{size:.35},large:400,opacity:.9,stroke:{width:1}}},{}],211:[function(){d3plus.style.default.edges={arrows:{accepted:[Boolean,Number],direction:{accepted:["source","target"],value:"target"},value:!1},color:"#d0d0d0",large:100,limit:!1,opacity:1,width:1}},{}],212:[function(){d3plus.style.default.font={align:{accepted:["left","center","right"],process:function(e){return d3plus.rtl?"left"===e?"right":"right"===e?"left":e:e},value:"left"},color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),secondary:{align:{accepted:["left","center","right"],process:function(e){return d3plus.rtl?"left"===e?"right":"right"===e?"left":e:e},value:"left"},color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,spacing:0,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},size:12,spacing:0,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200}},{}],213:[function(){d3plus.style.default.footer={font:{align:"center",color:"#444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:11,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:0,position:"bottom"}},{}],214:[function(){d3plus.style.default.height={small:300,max:600}},{}],215:[function(){d3plus.style.default.icon={back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-angle-left"},button:{accepted:[!1,String],fallback:!1,opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:!1},drop:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-angle-down"},fontCheck:function(e,t){return e===!1||0===e.indexOf("fa-")&&d3plus.font.awesome||e.indexOf("fa-")<0?e:t},next:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-angle-right"},select:{accepted:[!1,String],fallback:"&#x2713;",opacity:1,process:function(e){var t=this.fallback;return d3plus.style.default.icon.fontCheck(e,t)},rotate:0,value:"fa-check"}}},{}],216:[function(){d3plus.style.default.labels={align:"middle",font:{decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:11,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:7,segments:2}},{}],217:[function(){d3plus.style.default.legend={align:"middle",font:{align:"middle",color:"#444444",family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:10,weight:200},gradient:{height:10},order:{accepted:["color","id","size","text"],sort:{accepted:["asc","desc"],value:"asc"},value:"color"},size:[8,30]}},{}],218:[function(){d3plus.style.default.links={font:{color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},hover:{color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"underline"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200}}},{}],219:[function(){d3plus.style.default.messages={font:{color:"#444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:16,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:5}},{}],220:[function(){d3plus.style.default.nodes={overlap:.6}},{}],221:[function(){d3plus.style.default.shape={interpolate:{accepted:["basis","basis-open","cardinal","cardinal-open","linear","monotone","step","step-before","step-after"],deprecates:"stack_type",value:"linear"},rendering:{accepted:["auto","optimizeSpeed","crispEdges","geometricPrecision"],value:"auto"}}},{}],222:[function(){d3plus.style.default.timeline={align:"middle",hover:{accepted:["all-scroll","col-resize","crosshair","default","grab","grabbing","move","pointer"],value:"pointer"},handles:{accepted:[Boolean],color:"#e5e5e5",hover:"#cccccc",opacity:1,size:2,stroke:"#818181",value:!0},height:{accepted:[Number],value:23},tick:"#818181"}},{}],223:[function(){d3plus.style.default.timing={mouseevents:60,transitions:600,ui:200}},{}],224:[function(){d3plus.style.default.title={font:{align:"center",color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:16,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:400},height:!1,padding:2,position:"top",sub:{font:{align:"center",color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:1,position:"top"},total:{font:{align:"center",color:"#444444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},padding:1,position:"top"},width:!1}},{}],225:[function(){d3plus.style.default.tooltip={anchor:"top center",background:"#ffffff",children:{accepted:[Boolean],value:!0},connections:{accepted:[Boolean],value:!0},curtain:{color:"#ffffff",opacity:.8},font:{color:"#444",family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:12,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},large:250,share:{accepted:[Boolean],value:!0},size:{accepted:[Boolean],value:!0},small:225}},{}],226:[function(){d3plus.style.default.ui={align:{accepted:["left","center","right"],process:function(e){return d3plus.rtl?"left"===e?"right":"right"===e?"left":e:e},value:"center"},border:1,color:{primary:{process:function(e){var t=this.getVars(),n=this.value,r=t.ui.color.secondary.value;return r&&r!==d3.rgb(n).darker(2).toString()||(t.ui.color.secondary.value=d3.rgb(e).darker(2).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:"center",color:"#444",decoration:{accepted:["line-through","none","overline","underline"],value:"none"},family:d3plus.style.fontFamily(d3plus.style.default.fontFamily),size:11,transform:{accepted:["capitalize","lowercase","none","uppercase"],value:"none"},weight:200},margin:5,padding:5,position:{accepted:["top","right","bottom","left"],value:"bottom"}}},{}],227:[function(){d3plus.style.default.width={small:400}},{}],228:[function(){d3plus.style.fontFamily=function(e){return{process:d3plus.font.validate,value:e}}},{}],229:[function(e,t){d3plus.style.sheet=function(e){var t,n,r;for(t=0,n=!1;t<document.styleSheets.length;){if(r=document.styleSheets[t],r.href&&r.href.indexOf(e)>=0){n=!0;break}t++}return n},t.exports=d3plus.style.sheet},{}],230:[function(){d3plus.textwrap.flow=function(e){e.text.html.value?this.foreign(e):this.tspan(e)}},{}],231:[function(){d3plus.textwrap.foreign=function(e){var t=e.container.value,n=t.attr("font-family")||t.style("font-family"),r=t.attr("text-anchor")||t.style("text-anchor"),a=t.attr("fill")||t.style("fill"),i=t.attr("opacity")||t.style("opacity");r="end"===r?"right":"middle"===r?"center":"left",d3.select(t.node().parentNode).append("foreignObject").attr("width",e.width.value+"px").attr("height",e.height.value+"px").attr("x","0px").attr("y","0px").append("xhtml:div").style("font-family",n).style("font-size",e.size.value[1]).style("color",a).style("text-align",r).style("opacity",i).text(e.text.current)}},{}],232:[function(){d3plus.textwrap.getDimensions=function(e){if(!e.width.value||!e.height.value){var t=d3.select(e.container.value.node().parentNode),n=t.select("rect"),r=t.select("circle");if(n.empty())if(r.empty())e.width.value||e.self.width(500),e.height.value||e.self.height(500);else{var a=r.attr("r");e.width.value||e.self.width(parseFloat(2*a,10)),e.height.value||e.self.height(parseFloat(2*a,10))}else{if(!e.width.value){var i=n.attr("width")||n.style("width");e.self.width(parseFloat(i,10))}if(!e.height.value){var o=n.attr("height")||n.style("height");e.self.height(parseFloat(o,10))}}}}},{}],233:[function(){d3plus.textwrap.getSize=function(e){var t=e.container.value.attr("font-size")||e.container.value.style("font-size");e.size.value||(t=parseFloat(t,10),e.self.size(e.resize.value?[t,2*t]:[t/2,t])),e.container.fontSize=t}},{}],234:[function(){d3plus.textwrap.getText=function(e){if(!e.text.value){var t=e.container.value.text();t&&(t.indexOf("tspan")>=0&&(t.replace(/\<\/tspan\>\<tspan\>/g," "),t.replace(/\<\/tspan\>/g,""),t.replace(/\<tspan\>/g,"")),e.self.text(t))}e.text.phrases=e.text.value instanceof Array?e.text.value.filter(function(e){return["string","number"].indexOf(typeof e)>=0}):[e.text.value+""],e.container.value.text("")}},{}],235:[function(){d3plus.textwrap.resize=function(e){if(e.resize.value){for(var t=[],n=0;n<e.text.words.length;n++){var r=n===e.text.words.length-1?"":" ";t.push(e.text.words[n]+r)}var a=Math.floor(e.size.value[1]),i="circle"===e.shape.value?.785*e.width.value:e.width.value,o=d3plus.font.sizes(t,{"font-size":a+"px"},e.container.value),l=d3.max(o,function(e){return e.width}),u=1.165+e.width.value/e.height.value*.037,s=d3.sum(o,function(e){return e.width*e.height})*u,c="circle"===e.shape.value?Math.PI*Math.pow(e.width.value/2,2):i*e.height.value;if(l>i||s>c){var d=Math.sqrt(c/s),f=i/l,p=d3.min([d,f]);a=d3.max([e.size.value[0],Math.floor(a*p)])}var h=Math.floor(.8*e.height.value);a>h&&(a=h),l*(a/e.size.value[1])<=i?(a!==e.size.value[1]&&e.self.size([e.size.value[0],a]),e.container.value.attr("font-size",e.size.value[1]+"px"),this.flow(e)):this.wrap(e)}}},{}],236:[function(){d3plus.textwrap.tspan=function(e){var t=e.container.value.attr("x")||"0px",n=e.text.words.slice(0),r=!1,a=e.resize.value?e.size.value[1]:e.container.fontSize||e.size.value[0],i=e.container.value.append("tspan").text(n[0]).attr("dy",a+"px"),o=i.node().offsetHeight||i.node().getBoundingClientRect().height,l=1,u=function(){return e.container.value.append("tspan").attr("x",t).attr("dy",a+"px")},s=function(){i.empty()||(n=i.text().match(/[^\s-]+-?/g),c())},c=function(){if(n&&n.length){var t=n.pop(),r=t.charAt(t.length-1);if(1===t.length&&e.text.split.indexOf(t)>=0)c();else{e.text.split.indexOf(r)>=0&&(t=t.substr(0,t.length-1)),i.text(n.join(" ")+" "+t+" ...");var a=(l-1)*o,u="circle"===e.shape.value?2*Math.sqrt(a*(2*(e.width.value/2)-a)):e.width.value;i.node().getComputedTextLength()>u&&c()}}else i.remove(),i=d3.select(e.container.value.node().lastChild),i.empty()||(l--,s())};"circle"===e.shape.value&&e.container.value.attr("text-anchor","middle");for(var d=1;d<n.length;d++){if(l*o>e.height.value){i.remove(),1!==d&&(i=d3.select(e.container.value.node().lastChild),i.empty()||s());break}var f=i.text(),p=(f.slice(-1),e.text.current.charAt(e.text.current.indexOf(f)+f.length)),h=" "==p?" ":"";i.text(f+h+n[d]);var g=(l-1)*o,v="circle"===e.shape.value?2*Math.sqrt(g*(2*(e.width.value/2)-g)):e.width.value;i.node().getComputedTextLength()>v&&(r||(i.text(""),i=u()),i.text(f),i=u(),i.text(n[d]),l++)}}},{}],237:[function(){d3plus.textwrap.wrap=function(e){e.text.phrases.length&&(e.text.current=e.text.phrases.shift()+"",e.text.words=e.text.current.match(e.text.break),e.resize.value?this.resize(e):this.flow(e))}},{}],238:[function(){d3plus.textwrap=function(){var e={shell:"textwrap"};e.self=function(t){return t.each(function(){d3plus.textwrap.getDimensions(e),d3plus.textwrap.getSize(e),e.size.value[0]<=e.height.value&&(d3plus.textwrap.getText(e),d3plus.textwrap.wrap(e))}),e.self};var t=["container","dev","draw","format","height","resize","text","shape","size","width"];return d3plus.method(e,t),e.self}},{}],239:[function(e){var t=e("../core/fetch/value.js"),n=e("../core/fetch/color.js"),r=e("../core/fetch/text.js");d3plus.tooltip.app=function(e){function a(a){var c={},g={},v=i.id.nesting[l+1]in o?l+1:l,m=i.id.nesting[v],_="merged"in o.d3plus?o.d3plus.merged:o[m],k=t(i,o,i.size.value),M=(!(_ instanceof Array)||_ instanceof Array&&1===_.length)&&v===i.depth.value;if(!M&&i.tooltip.children.value)if(_ instanceof Array){if(_=_.slice(0),i.size.value&&d3plus.object.validate(_[0])){var A=_.filter(function(e){return i.size.value in e}),z=_.filter(function(e){return!(i.size.value in e)});d3plus.array.sort(A,i.size.value,"desc",[],i),_=A.concat(z)}for(var j="short"===h?3:i.data.large,E=d3.min([_.length,j]),S=0;E>S;S++){var T=_[S],N=r(i,T,v)[0],O=t(i,T,i.size.value,m),C=n(i,T,m);g[N]=O?i.format.value(O,i.size.value):"",C&&(g.d3plus_colors||(g.d3plus_colors={}),g.d3plus_colors[N]=C)}_.length>E&&(g.d3plusMore=_.length-E)}else if(_&&"null"!==_){var N=r(i,_,v)[0];g[N]=k?i.format.value(k,i.size.value):""}i.size.value&&i.tooltip.size.value&&k&&(M||!_||_ instanceof Array)&&(c[i.size.value]=k);var F=i.active.value?t(i,o,i.active.value):o.d3plus.active,q=i.temp.value?t(i,o,i.temp.value):o.d3plus.temp,P=i.total.value?t(i,o,i.total.value):o.d3plus.total;if("number"==typeof F&&F>0&&P){var L=i.active.value||"active";c[L]=F+"/"+P+" ("+i.format.value(F/P*100,"share")+"%)"}if("number"==typeof q&&q>0&&P){var L=i.temp.value||"temp";c[L]=q+"/"+P+" ("+i.format.value(q/P*100,"share")+"%)"}i.tooltip.share.value&&o.d3plus.share&&(c.share=i.format.value(100*o.d3plus.share,"share")+"%");var v="depth"in e?e.depth:l,I=e.title||r(i,o,v)[0],V=t(i,o,i.icon.value,i.id.nesting[v]),B=d3plus.tooltip.data(i,o,h,c,g,v);if("null"===V&&(V=!1),B.length>0||y||!o.d3plus_label&&"short"==h&&I||o.d3plus_label&&(!("visible"in o.d3plus_label)||"visible"in o.d3plus_label&&o.d3plus_label.visible===!1)){I||(I=T);var v="d3plus"in o&&"merged"in o.d3plus?l-1:l;if(0>v&&(v=0),v=i.id.nesting[v],"string"==typeof i.icon.style.value)var U=i.icon.style.value;else if("object"==typeof i.icon.style.value&&i.icon.style.value[v])var U=i.icon.style.value[v];else var U="default";if(e.width)var D=e.width;else if(f||0!=B.length)var D=i.tooltip.small;else var D="auto";d3plus.tooltip.create({align:p,arrow:s,locale:i.format.locale.value,background:i.tooltip.background,curtain:i.tooltip.curtain.color,curtainopacity:i.tooltip.curtain.opacity,fontcolor:i.tooltip.font.color,fontfamily:i.tooltip.font.family.value,fontsize:i.tooltip.font.size,fontweight:i.tooltip.font.weight,data:B,color:n(i,o),allColors:!0,footer:e.footer===!1?e.footer:y,fullscreen:f,html:a,icon:V,id:d,max_height:e.maxheight,max_width:i.tooltip.small,mouseevents:u,offset:w,parent:i.container.value,style:U,title:I,width:D,x:x,y:b})}else d3plus.tooltip.remove(d)}"d3plus"in e.data||(e.data.d3plus={});var i=e.vars,o=e.data,l="d3plus"in o&&"depth"in o.d3plus?o.d3plus.depth:i.depth.value,u=(e.ex,e.mouseevents?e.mouseevents:!1),s="arrow"in e?e.arrow:!0,c=t(i,o,i.id.value),d=e.id||i.type.value;if(!d3.event||"click"!=d3.event.type||!i.tooltip.html.value&&!i.tooltip.value.long||"fullscreen"in e){var f=!1,p=e.anchor||i.tooltip.anchor,h=e.length||"short",g=i.zoom.direction(o);if(-1===g){var v=i.id.nesting[l-1];t(i,c,v)}if(1===g&&i.zoom.value)var m=i.format.value(i.format.locale.value.ui.expand);else if(-1===g&&i.zoom.value&&i.history.states.length)var m=i.format.value(i.format.locale.value.ui.collapse);else if(i.small||"short"!=h||!i.tooltip.html.value&&!i.tooltip.value.long||1===i.focus.value.length&&i.focus.value[0]==c)if("long"==h)var m=i.footer.value||"";else var m="";else var m=i.format.locale.value.ui.moreInfo;var y=m.length?i.format.value(m,"footer"):!1}else{var f=!0,s=!1,u=!0,h="long",y=i.footer.value;i.covered=!0}if("x"in e)var x=e.x;else if("follow"==i.types[i.type.value].tooltip)var x=d3.mouse(i.container.value.node())[0];else{var x=o.d3plus.x;i.zoom.translate&&i.zoom.scale&&(x=i.zoom.translate[0]+x*i.zoom.scale),x+=i.margin.left}if("y"in e)var b=e.y;else if("follow"==i.types[i.type.value].tooltip)var b=d3.mouse(i.container.value.node())[1];else{var b=o.d3plus.y;i.zoom.translate&&i.zoom.scale&&(b=i.zoom.translate[1]+b*i.zoom.scale),b+=i.margin.top}if("offset"in e)var w=e.offset;else if("follow"==i.types[i.type.value].tooltip)var w=3;else{var w=o.d3plus.r?o.d3plus.r:o.d3plus.height/2;i.zoom.scale&&(w*=i.zoom.scale)}f?"string"==typeof i.tooltip.html.value?a(i.tooltip.html.value):"function"==typeof i.tooltip.html.value?a(i.tooltip.html.value(c)):i.tooltip.html.value&&"object"==typeof i.tooltip.html.value&&i.tooltip.html.value.url?d3.json(i.tooltip.html.value.url,function(e){var t=i.tooltip.html.value.callback?i.tooltip.html.value.callback(e):e;a(t)}):a(""):a("")}},{"../core/fetch/color.js":78,"../core/fetch/text.js":80,"../core/fetch/value.js":81}],240:[function(){d3plus.tooltip.arrow=function(e){e.style("bottom",function(e){return"center"==e.anchor.y||e.flip?"auto":"-5px"}).style("top",function(e){return"center"!=e.anchor.y&&e.flip?"-5px":"center"==e.anchor.y?"50%":"auto"}).style("left",function(e){return"center"==e.anchor.y&&e.flip?"-5px":"center"!=e.anchor.y?"50%":"auto"}).style("right",function(e){return"center"!=e.anchor.y||e.flip?"auto":"-5px"}).style("margin-left",function(e){if("center"==e.anchor.y)return"auto";if("right"==e.anchor.x)var t=-e.width/2+e.arrow_offset/2;else if("left"==e.anchor.x)var t=e.width/2-2*e.arrow_offset-5;else var t=-5;if(e.cx-e.width/2-5<t)t=e.cx-e.width/2-5,t<2-e.width/2&&(t=2-e.width/2);else if(-(e.limit[0]-e.cx-e.width/2+5)>t){var t=-(e.limit[0]-e.cx-e.width/2+5);t>e.width/2-11&&(t=e.width/2-11)}return t+"px"}).style("margin-top",function(e){if("center"!=e.anchor.y)return"auto";if("bottom"==e.anchor.y)var t=-e.height/2+e.arrow_offset/2-1;else if("top"==e.anchor.y)var t=e.height/2-2*e.arrow_offset-2;else var t=-9;if(e.cy-e.height/2-e.arrow_offset<t)t=e.cy-e.height/2-e.arrow_offset,t<4-e.height/2&&(t=4-e.height/2);else if(-(e.limit[1]-e.cy-e.height/2+e.arrow_offset)>t){var t=-(e.limit[1]-e.cy-e.height/2+e.arrow_offset);t>e.height/2-22&&(t=e.height/2-22)}return t+"px"})}},{}],241:[function(){d3plus.tooltip.create=function(e){var t=e.fullscreen?250:200,n=d3plus.prefix();e.width=e.width||t,e.max_width=e.max_width||386,e.id=e.id||"default",e.size=e.fullscreen||e.html?"large":"small",e.offset=e.offset||0,e.arrow_offset=e.arrow?8:0,e.x=e.x||0,e.y=e.y||0,e.parent=e.parent||d3.select("body"),e.curtain=e.curtain||"#fff",e.curtainopacity=e.curtainopacity||.8,e.background=e.background||"#fff",e.fontcolor=e.fontcolor||"#444",e.fontfamily=e.fontfamily||"sans-serif",e.fontweight=e.fontweight||"normal",e.fontsize=e.fontsize||"12px",e.style=e.style||"default",e.zindex="small"==e.size?2e3:500,e.locale=e.locale||d3plus.locale.en_US;var r=e.parent?e.parent.node().offsetHeight||e.parent.node().getBoundingClientRect().height:0;if(e.iconsize||(e.iconsize="small"==e.size?22:50),e.limit=[parseFloat(e.parent.style("width"),10),parseFloat(e.parent.style("height"),10)],e.title instanceof Array){var a=e.locale.ui.and,i=e.locale.ui.more;e.title=d3plus.string.list(e.title,a,3,i)
}var o=function(){d3.selectAll("div.d3plus_tooltip_data_desc").style("height","0px"),d3.selectAll("div.d3plus_tooltip_data_help").style("background-color","#ccc")};if(d3plus.tooltip.remove(e.id),e.anchor={},e.fullscreen)e.anchor.x="center",e.anchor.y="center",e.x=e.parent?e.parent.node().offsetWidth/2:window.innerWidth/2,e.y=e.parent?r/2:window.innerHeight/2;else if(e.align){var l=e.align.split(" ");e.anchor.y=l[0],e.anchor.x=l[1]?l[1]:"center"}else e.anchor.x="center",e.anchor.y="top";var u=e.width-30;if(e.fullscreen){e.parent.append("div").attr("id","d3plus_tooltip_curtain_"+e.id).attr("class","d3plus_tooltip_curtain").style("background-color",e.curtain).style("opacity",e.curtainopacity).style("position","absolute").style("z-index",499).style("top","0px").style("right","0px").style("bottom","0px").style("left","0px").on(d3plus.evt.click,function(){d3plus.tooltip.remove(e.id)})}var s=e.parent.append("div").datum(e).attr("id","d3plus_tooltip_id_"+e.id).attr("class","d3plus_tooltip d3plus_tooltip_"+e.size).style("color",e.fontcolor).style("font-family",e.fontfamily).style("font-weight",e.fontweight).style("font-size",e.fontsize+"px").style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("z-index",e.zindex).on(d3plus.evt.out,function(){o()});e.max_height&&s.style("max-height",e.max_height+"px"),e.fixed?(s.style("z-index",500),e.mouseevents=!0):s.style("z-index",2e3);var c=s.append("div").datum(e).attr("class","d3plus_tooltip_container").style("background-color",e.background).style("padding","6px");if(e.fullscreen&&e.html){f=e.parent?.75*e.parent.node().offsetWidth:.75*window.innerWidth,A=e.parent?.75*r:.75*window.innerHeight,c.style("width",f+"px").style("height",A+"px");var d=c.append("div").attr("class","d3plus_tooltip_body").style("padding-right","6px").style("display","inline-block").style("z-index",1).style("width",e.width+"px")}else{if("auto"==e.width){var f="auto";c.style("max-width",e.max_width+"px")}else var f=e.width-14+"px";var d=c.style("width",f)}if(e.title||e.icon)var p=d.append("div").attr("class","d3plus_tooltip_header").style("position","relative").style("z-index",1);if(e.fullscreen){s.append("div").attr("class","d3plus_tooltip_close").style("background-color",e.color).style("color",d3plus.color.text(e.color)).style("position","absolute").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)").style("font-size","20px").style("height","18px").style("line-height","14px").style("text-align","center").style("right","16px").style("top","-10px").style("width","18px").style("z-index",10).html("&times;").on(d3plus.evt.over,function(){d3.select(this).style("cursor","pointer").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.5)")}).on(d3plus.evt.out,function(){d3.select(this).style("cursor","auto").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)")}).on(d3plus.evt.click,function(){d3plus.tooltip.remove(e.id)})}if(e.mouseevents){if(e.mouseevents!==!0){var h=d3.select(e.mouseevents).on(d3plus.evt.out),g=function(){var t=d3.event.toElement||d3.event.relatedTarget;if(t)var n="string"==typeof t.className?t.className:t.className.baseVal,r=0==n.indexOf("d3plus_tooltip");else var r=!1;t&&(v(s.node(),t)||v(e.mouseevents,t)||r)||(h(d3.select(e.mouseevents).datum()),o(),d3.select(e.mouseevents).on(d3plus.evt.out,h))},v=function(e,t){for(var n=t.parentNode;null!==n;){if(n==e)return!0;n=n.parentNode}return!1};d3.select(e.mouseevents).on(d3plus.evt.out,g),s.on(d3plus.evt.out,g);var m=d3.select(e.mouseevents).on(d3plus.evt.move);m&&s.on(d3plus.evt.move,m)}}else s.style("pointer-events","none");if(e.arrow){s.append("div").attr("class","d3plus_tooltip_arrow").style("background-color",e.background).style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("bottom","-5px").style("height","10px").style("left","50%").style("margin-left","-5px").style("width","10px").style(n+"transform","rotate(45deg)").style("z-index",-1)}if(e.icon){var y=p.append("div").attr("class","d3plus_tooltip_icon").style("width",e.iconsize+"px").style("height",e.iconsize+"px").style("z-index",1).style("background-position","50%").style("background-size","100%").style("background-image","url("+e.icon+")").style("display","inline-block").style("margin","0px 3px 3px 0px");"knockout"==e.style&&y.style("background-color",e.color),u-=y.node().offsetWidth}if(e.title){var x=e.max_width-6;e.icon&&(x-=e.iconsize+6),x+="px";{p.append("div").attr("class","d3plus_tooltip_title").style("max-width",x).style("color",e.icon?e.fontcolor:d3plus.color.legible(e.color)).style("vertical-align","top").style("width",u+"px").style("display","inline-block").style("overflow","hidden").style("text-overflow","ellipsis").style("word-wrap","break-word").style("z-index",1).style("font-size","large"===e.size?"18px":"16px").style("line-height","large"===e.size?"20px":"17px").style("padding","large"===e.size?"3px 6px":"3px").text(e.title)}}if(e.description){d.append("div").attr("class","d3plus_tooltip_description").style("font-size","12px").style("padding","6px").text(e.description)}if(e.data||e.html&&!e.fullscreen)var b=d.append("div").attr("class","d3plus_tooltip_data_container").style("overflow-y","auto").style("z-index",-1);if(e.data){var w=0,_={},k=null;e.data.forEach(function(t,r){t.group&&k!=t.group&&(k=t.group,b.append("div").attr("class","d3plus_tooltip_data_title").style("font-size","12px").style("font-weight","bold").style("padding","6px 3px 0px 3px").text(t.group));var a=b.append("div").attr("class","d3plus_tooltip_data_block").style("font-size","12px").style("padding","3px 6px").style("position","relative").datum(t);t.highlight===!0?a.style("color",d3plus.color.legible(e.color)):(t.allColors||t.highlight!==e.color)&&a.style("color",d3plus.color.legible(t.highlight));var i=a.append("div").attr("class","d3plus_tooltip_data_name").style("display","inline-block").html(t.name).on(d3plus.evt.out,function(){d3.event.stopPropagation()});if(t.value instanceof Array){var l=e.locale.ui.and,u=e.locale.ui.more;t.value=d3plus.string.list(t.value,l,3,u)}var s=a.append("div").attr("class","d3plus_tooltip_data_value").style("display","block").style("position","absolute").style("text-align","right").style("top","3px").text(t.value).on(d3plus.evt.out,function(){d3.event.stopPropagation()});if(d3plus.rtl?s.style("left","6px"):s.style("right","6px"),e.mouseevents&&t.desc){var c=a.append("div").attr("class","d3plus_tooltip_data_desc").style("color","#888").style("overflow","hidden").style(n+"transition","height 0.5s").style("width","85%").text(t.desc).on(d3plus.evt.out,function(){d3.event.stopPropagation()}),d=c.node().offsetHeight||c.node().getBoundingClientRect().height;c.style("height","0px");var f=i.append("div").attr("class","d3plus_tooltip_data_help").style("background-color","#ccc").style(n+"border-radius","5px").style("color","#fff").style("cursor","pointer").style("display","inline-block").style("font-size","8px").style("font-weight","bold").style("height","10px").style("margin","3px 0px 0px 3px").style("padding-right","1px").style("text-align","center").style("width","10px").style("vertical-align","top").style(prefix+"transition","background-color 0.5s").text("?").on(d3plus.evt.over,function(){var e=d3.select(this.parentNode.parentNode).style("color");d3.select(this).style("background-color",e),c.style("height",d+"px")}).on(d3plus.evt.out,function(){d3.event.stopPropagation()});i.style("cursor","pointer").on(d3plus.evt.over,function(){o();var e=d3.select(this.parentNode).style("color");f.style("background-color",e),c.style("height",d+"px")}),a.on(d3plus.evt.out,function(){d3.event.stopPropagation(),o()})}var p=parseFloat(s.style("width"),10);p>e.width/2&&(p=e.width/2),p>w&&(w=p),r!=e.data.length-1&&(t.group&&t.group==e.data[r+1].group||!t.group&&!e.data[r+1].group)&&b.append("div").attr("class","d3plus_tooltip_data_seperator").style("background-color","#ddd").style("display","block").style("height","1px").style("margin","0px 3px")}),b.selectAll(".d3plus_tooltip_data_name").style("width",function(){var e=parseFloat(d3.select(this.parentNode).style("width"),10);return e-w-30+"px"}),b.selectAll(".d3plus_tooltip_data_value").style("width",w+"px").each(function(e){var t=parseFloat(d3.select(this).style("height"),10);_[e.name]=t}),b.selectAll(".d3plus_tooltip_data_name").style("min-height",function(e){return _[e.name]+"px"})}e.html&&!e.fullscreen&&b.append("div").html(e.html);var M=d.append("div").attr("class","d3plus_tooltip_footer").style("font-size","10px").style("position","relative").style("text-align","center");if(e.footer&&M.html(e.footer),e.height=s.node().offsetHeight||s.node().getBoundingClientRect().height,e.html&&e.fullscreen){var A=e.height-12,f=s.node().offsetWidth-e.width-44;c.append("div").attr("class","d3plus_tooltip_html").style("width",f+"px").style("height",A+"px").style("display","inline-block").style("vertical-align","top").style("overflow-y","auto").style("padding","0px 12px").style("position","absolute").html(e.html)}if(e.width=s.node().offsetWidth,"center"!=e.anchor.y?e.height+=e.arrow_offset:e.width+=e.arrow_offset,e.data||!e.fullscreen&&e.html){if(e.fullscreen)var A=e.height;else var z=e.fixed?r-e.y-10:r-10,A=e.height<z?e.height:z;A-=parseFloat(c.style("padding-top"),10),A-=parseFloat(c.style("padding-bottom"),10),p&&(A-=p.node().offsetHeight||p.node().getBoundingClientRect().height,A-=parseFloat(p.style("padding-top"),10),A-=parseFloat(p.style("padding-bottom"),10)),M&&(A-=M.node().offsetHeight||M.node().getBoundingClientRect().height,A-=parseFloat(M.style("padding-top"),10),A-=parseFloat(M.style("padding-bottom"),10)),b.style("max-height",A+"px")}e.height=s.node().offsetHeight||s.node().getBoundingClientRect().height,d3plus.tooltip.move(e.x,e.y,e.id)}},{}],242:[function(e){var t=e("../core/fetch/value.js"),n=e("../core/fetch/color.js"),r=e("../core/fetch/text.js");d3plus.tooltip.data=function(e,a,i,o,l,u){function s(n,r){if(e.attrs.value[r])var i=r;else var i=null;r&&(r=e.format.value(r));var o=d[n]||t(e,a,n,i);if(null!=o&&"undefined"!=o&&!(o instanceof Array)&&("string"==typeof o&&o.indexOf("d3plus_other")<0||"string"!=typeof o)){var l=e.format.value(e.format.locale.value.ui[n]?e.format.locale.value.ui[n]:n),u=p.indexOf(n)>=0;o instanceof Array?o.forEach(function(t){t=e.format.value(t,n)}):o=e.format.value(o,n);var s={name:l,value:o,highlight:u,group:r};if(e.descs.value)if("function"==typeof e.descs.value){var c=e.descs.value(n);"string"==typeof c&&(s.desc=c)}else n in e.descs.value&&(s.desc=e.descs.value[n]);g.push(s)}}if(e.small)return[];if(!i)var i="long";if("long"==i)var c="short";else var c="long";var d={};if(o&&"string"==typeof o)o=[o];else if(o&&"object"==typeof o){d=d3plus.object.merge(d,o);var o=[];for(var f in d)o.push(f)}else if(!o)var o=[];var p=[];if(e.tooltip.value instanceof Array)var h=e.tooltip.value;else if("string"==typeof e.tooltip.value)var h=[e.tooltip.value];else{if(e.tooltip.value[e.id.nesting[u]])var h=e.tooltip.value[e.id.nesting[u]];else var h=e.tooltip.value;h instanceof Array||(h=h[i]?h[i]:h[c]?[]:d3plus.object.merge({"":[]},h)),"string"==typeof h?h=[h]:h instanceof Array||(h=d3plus.object.merge({"":[]},h))}var g=[];if(h instanceof Array)o.forEach(function(e){h.indexOf(e)<0&&h.push(e)}),h.forEach(function(e){s(e)});else{if(e.id.nesting.length&&u<e.id.nesting.length-1){var h=d3plus.util.copy(h);e.id.nesting.forEach(function(e,t){t>u&&h[e]&&delete h[e]})}if(e.tooltip.value.long&&"object"==typeof e.tooltip.value.long){var v=[];for(var m in e.tooltip.value.long)o.forEach(function(t){e.tooltip.value.long[m].indexOf(t)>=0&&(h[m]&&h[m].indexOf(t)<0||!h[m])?(h[m]||(h[m]=[]),h[m].push(t),v.push(t)):h[m]&&h[m].indexOf(t)>=0&&v.push(t)});o.forEach(function(e){v.indexOf(e)<0&&(h[""]||(h[""]=[]),h[""].push(e))})}else{var y=[];for(var m in h)o.forEach(function(e){h[m]instanceof Array&&h[m].indexOf(e)>=0?y.push(e):"string"==typeof h[m]&&h[m]==e&&y.push(e)});y.length!=o.length&&(h[""]||(h[""]=[]),o.forEach(function(e){y.indexOf(e)<0&&h[""].push(e)}))}h[""]&&(h[""].forEach(function(e){s(e,"")}),delete h[""]);for(var m in h)h[m]instanceof Array?h[m].forEach(function(e){s(e,m)}):"string"==typeof h[m]&&s(h[m],m)}if(l){var x=e.format.locale.value.ui.including,b=l.d3plus_colors;for(var w in l)if("d3plus_colors"!==w){if("d3plusMore"===w){var _=e.format.locale.value.ui.more,k=d3plus.string.format(_,l[w]),M=!0;l[w]=""}else var k=w,M=b&&b[k]?b[k]:!1;g.push({group:e.format.value(x),highlight:M,name:k,value:l[w]})}}if(e.tooltip.connections.value&&"long"===i){var A=e.edges.connections(a[e.id.value],e.id.value,!0);A.length&&A.forEach(function(t){var a=r(e,t)[0],i=n(e,t),o=e.tooltip.font.size,l="square"==e.shape.value?0:o;styles=["background-color: "+i,"border-color: "+d3plus.color.legible(i),"border-style: solid","border-width: "+e.data.stroke.width+"px","display: inline-block","height: "+o+"px","left: 0px","position: absolute","width: "+o+"px","top: 0px",d3plus.prefix()+"border-radius: "+l+"px"],node="<div style='"+styles.join("; ")+";'></div>",g.push({group:e.format.value(e.format.locale.value.ui.primary),highlight:!1,name:"<div style='position:relative;padding-left:"+1.5*o+"px;'>"+node+a+"</div>",value:""})})}return g}},{"../core/fetch/color.js":78,"../core/fetch/text.js":80,"../core/fetch/value.js":81}],243:[function(){d3plus.tooltip.move=function(e,t,n){if(n)var r=d3.select("div#d3plus_tooltip_id_"+n);else var r=d3.select("div#d3plus_tooltip_id_default");if(r.node()){var a=r.datum();a.cx=e,a.cy=t,a.fixed||("center"!=a.anchor.y?("right"==a.anchor.x?a.x=a.cx-a.arrow_offset-4:"center"==a.anchor.x?a.x=a.cx-a.width/2:"left"==a.anchor.x&&(a.x=a.cx-a.width+a.arrow_offset+2),"bottom"==a.anchor.y?a.flip=a.cy+a.height+a.offset<=a.limit[1]:"top"==a.anchor.y&&(a.flip=a.cy-a.height-a.offset<0),a.y=a.flip?a.cy+a.offset+a.arrow_offset:a.cy-a.height-a.offset-a.arrow_offset):(a.y=a.cy-a.height/2,"right"==a.anchor.x?a.flip=a.cx+a.width+a.offset<=a.limit[0]:"left"==a.anchor.x&&(a.flip=a.cx-a.width-a.offset<0),"center"==a.anchor.x?(a.flip=!1,a.x=a.cx-a.width/2):a.x=a.flip?a.cx+a.offset+a.arrow_offset:a.cx-a.width-a.offset),a.x<0?a.x=0:a.x+a.width>a.limit[0]&&(a.x=a.limit[0]-a.width),a.y<0?a.y=0:a.y+a.height>a.limit[1]&&(a.y=a.limit[1]-a.height)),r.style("top",a.y+"px").style("left",a.x+"px"),a.arrow&&r.selectAll(".d3plus_tooltip_arrow").call(d3plus.tooltip.arrow)}}},{}],244:[function(){d3plus.tooltip.remove=function(e){e?(d3.selectAll("div#d3plus_tooltip_curtain_"+e).remove(),d3.selectAll("div#d3plus_tooltip_id_"+e).remove()):(d3.selectAll("div#d3plus_tooltip_curtain").remove(),d3.selectAll("div.d3plus_tooltip").remove())}},{}],245:[function(){d3plus.util.buckets=function(e,t){for(var n=[],r=1/(t-1)*(e[1]-e[0]),a=r,a=e[0];a<=e[1];a+=r)n.push(a);return n.length<t&&(n[t-1]=e[1]),n[n.length-1]<e[1]&&(n[n.length-1]=e[1]),n}},{}],246:[function(e){var t;t=e("./d3selection.js"),d3plus.util.child=function(e,n){var r;if(!e||!n)return!1;for(t(e)&&(e=e.node()),t(e)&&(n=n.node()),r=n.parentNode;null!==r;){if(r===e)return!0;r=r.parentNode}return!1}},{"./d3selection.js":249}],247:[function(){d3plus.util.closest=function(e,t){var n;return n=e[0],e.forEach(function(e){return Math.abs(t-e)<Math.abs(t-n)?n=e:void 0}),n}},{}],248:[function(e){var t,n;t=e("../object/merge.coffee"),n=e("../object/validate.coffee"),d3plus.util.copy=function(e){var r;return n(e)?t(e):e instanceof Array?(r=[],e.forEach(function(e){return r.push(d3plus.util.copy(e))}),r):e}},{"../object/merge.coffee":199,"../object/validate.coffee":200}],249:[function(e,t){d3plus.util.d3selection=function(e){return d3plus.ie?"object"==typeof e&&e instanceof Array:e instanceof d3.selection},t.exports=d3plus.util.d3selection},{}],250:[function(){d3plus.util.dataurl=function(e,t){var n=new Image;n.src=e,n.crossOrigin="Anonymous",n.onload=function(){var e=document.createElement("canvas");e.width=this.width,e.height=this.height;var n=e.getContext("2d");n.drawImage(this,0,0),t.call(this,e.toDataURL("image/png")),e=null}}},{}],251:[function(){d3plus.util.distances=function(e,t){var n,r;return r=[],n=[],e.forEach(function(a){var i;return i=t?t(a):[a.x,a.y],n.push(a),e.forEach(function(e){var a,o,l;return n.indexOf(e)<0?(a=t?t(e):[e.x,e.y],o=Math.abs(i[0]-a[0]),l=Math.abs(i[1]-a[1]),r.push(Math.sqrt(o*o+l*l))):void 0})}),r.sort(function(e,t){return e-t}),r}},{}],252:[function(){d3plus.util.offset=function(e,t,n){var r,a,i,o;return a={x:0,y:0},0>e&&(e=2*Math.PI+e),"square"===n?(i=45*(Math.PI/180),e<=Math.PI?e<Math.PI/2?i>e?(a.x+=t,o=Math.tan(e)*t,a.y+=o):(a.y+=t,r=t/Math.tan(e),a.x+=r):e<Math.PI-i?(a.y+=t,r=t/Math.tan(Math.PI-e),a.x-=r):(a.x-=t,o=Math.tan(Math.PI-e)*t,a.y+=o):e<3*Math.PI/2?e<i+Math.PI?(a.x-=t,o=Math.tan(e-Math.PI)*t,a.y-=o):(a.y-=t,r=t/Math.tan(e-Math.PI),a.x-=r):e<2*Math.PI-i?(a.y-=t,r=t/Math.tan(2*Math.PI-e),a.x+=r):(a.x+=t,o=Math.tan(2*Math.PI-e)*t,a.y-=o)):(a.x+=t*Math.cos(e),a.y+=t*Math.sin(e)),a}},{}],253:[function(e){var t;t=e("../object/validate.coffee"),d3plus.util.uniques=function(e,n){var r,a,i,o,l,u,s;if(void 0===e||void 0===n)return[];for(e instanceof Array||(e=[e]),l=[],i=[],u=0,s=e.length;s>u;u++)r=e[u],t(r)&&(o="function"==typeof n?n(r):r[n],a=["number","string"].indexOf(typeof o)>=0?o:JSON.stringify(o),i.indexOf(a)<0&&(l.push(o),i.push(a)));return l.sort(function(e,t){return e-t})}},{"../object/validate.coffee":200}],254:[function(){d3plus.draw.app=function(e){if(e.group=e.g.apps[e.type.value],e.mouse={},e.internal_error)var t=null;else{var n=e.format.locale.value.visualization[e.type.value];e.dev.value&&d3plus.console.time("running "+n);var t=e.types[e.type.value](e);e.dev.value&&d3plus.console.timeEnd("running "+n)}e.returned={nodes:[],edges:null},t instanceof Array?e.returned.nodes=t:t&&(t.nodes&&(e.returned.nodes=t.nodes),t.edges&&(e.returned.edges=t.edges))}},{}],255:[function(){d3plus.draw.container=function(e){if(e.container.changed){e.container.value.style("position",function(){var e=d3.select(this).style("position"),t=["absolute","fixed"].indexOf(e)>=0;return t?e:"relative"}).html("");var t=["width","height"];t.forEach(function(t){function n(r){if(void 0===r.tagName||["BODY","HTML"].indexOf(r.tagName)>=0){var a=window["inner"+t.charAt(0).toUpperCase()+t.slice(1)],i=document!=r?d3.select(r):null;i&&"width"==t?(a-=parseFloat(i.style("margin-left"),10),a-=parseFloat(i.style("margin-right"),10),a-=parseFloat(i.style("padding-left"),10),a-=parseFloat(i.style("padding-right"),10)):i&&"height"==t&&(a-=parseFloat(i.style("margin-top"),10),a-=parseFloat(i.style("margin-bottom"),10),a-=parseFloat(i.style("padding-top"),10),a-=parseFloat(i.style("padding-bottom"),10)),1==d3.selectAll("body > *:not(script)").size()&&d3.select("body").style("overflow","hidden"),20>=a&&(a=e[t].small),e[t].value=a}else{var a=parseFloat(d3.select(r).style(t),10);"number"==typeof a&&a>0?e[t].value=a:"BODY"!=r.tagName&&n(r.parentNode)}}e[t].value||n(e.container.value.node())}),e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px")}e.width.viz=e.width.value,e.height.viz=e.height.value}},{}],256:[function(){d3plus.draw.enter=function(e){e.dev.value&&d3plus.console.time("creating SVG elements"),e.svg=e.container.value.selectAll("svg#d3plus").data([0]),e.svg.enter().insert("svg","#d3plus_message").attr("id","d3plus").attr("width",e.width.value).attr("height",e.height.value).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xmlns:xlink","http://www.w3.org/1999/xlink"),e.g.bg=e.svg.selectAll("rect#bg").data(["bg"]),e.g.bg.enter().append("rect").attr("id","bg").attr("fill",e.background.value).attr("width",e.width.value).attr("height",e.height.value),e.g.timeline=e.svg.selectAll("g#timeline").data(["timeline"]),e.g.timeline.enter().append("g").attr("id","timeline").attr("transform","translate(0,"+e.height.value+")"),e.g.legend=e.svg.selectAll("g#key").data(["key"]),e.g.legend.enter().append("g").attr("id","key").attr("transform","translate(0,"+e.height.value+")"),e.g.footer=e.svg.selectAll("g#footer").data(["footer"]),e.g.footer.enter().append("g").attr("id","footer").attr("transform","translate(0,"+e.height.value+")"),e.g.clipping=e.svg.selectAll("#clipping").data(["clipping"]),e.g.clipping.enter().append("clipPath").attr("id","clipping").append("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container=e.svg.selectAll("g#container").data(["container"]),e.g.container.enter().append("g").attr("id","container").attr("clip-path","url(#clipping)").attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.g.zoom=e.g.container.selectAll("g#zoom").data(["zoom"]),e.g.zoom.enter().append("g").attr("id","zoom"),e.g.viz=e.g.zoom.selectAll("g#d3plus_viz").data(["d3plus_viz"]),e.g.viz.enter().append("g").attr("id","d3plus_viz"),e.g.overlay=e.g.viz.selectAll("rect#d3plus_overlay").data([{id:"d3plus_overlay"}]),e.g.overlay.enter().append("rect").attr("id","d3plus_overlay").attr("width",e.width.value).attr("height",e.height.value).attr("opacity",0),d3plus.touch?e.g.overlay.on(d3plus.evt.over,e.zoom.touchEvent).on(d3plus.evt.move,e.zoom.touchEvent).on(d3plus.evt.out,e.zoom.touchEvent):e.g.overlay.on(d3plus.evt.move,function(t){t.dragging||(e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",d3plus.prefix()+"grab"):d3.select(this).style("cursor","auto"))}).on(d3plus.evt.up,function(t){e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?(t.dragging=!1,d3.select(this).style("cursor",d3plus.prefix()+"grab")):d3.select(this).style("cursor","auto")}).on(d3plus.evt.down,function(t){e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?(t.dragging=!0,d3.select(this).style("cursor",d3plus.prefix()+"grabbing")):d3.select(this).style("cursor","auto")}),e.g.app=e.g.viz.selectAll("g#app").data(["app"]),e.g.app.enter().append("g").attr("id","app"),e.g.edges=e.g.viz.selectAll("g#edges").data(["edges"]),e.g.edges.enter().append("g").attr("id","edges").attr("opacity",0),e.g.edge_focus=e.g.viz.selectAll("g#focus").data(["focus"]),e.g.edge_focus.enter().append("g").attr("id","focus"),e.g.edge_hover=e.g.viz.selectAll("g#edge_hover").data(["edge_hover"]),e.g.edge_hover.enter().append("g").attr("id","edge_hover").attr("opacity",0),e.g.data=e.g.viz.selectAll("g#data").data(["data"]),e.g.data.enter().append("g").attr("id","data").attr("opacity",0),e.g.data_focus=e.g.viz.selectAll("g#data_focus").data(["data_focus"]),e.g.data_focus.enter().append("g").attr("id","data_focus"),e.g.labels=e.g.viz.selectAll("g#d3plus_labels").data(["d3plus_labels"]),e.g.labels.enter().append("g").attr("id","d3plus_labels"),e.defs=e.svg.selectAll("defs").data(["defs"]),e.defs.enter().append("defs"),e.dev.value&&d3plus.console.timeEnd("creating SVG elements")}},{}],257:[function(e){var t=e("../../core/fetch/text.js");d3plus.draw.errors=function(e){e.dev.value&&d3plus.console.time("checking for errors");var n=["id"],r=e.types[e.type.value].requirements;r&&(r instanceof Array?n=n.concat(e.types[e.type.value].requirements):n.push(r));var a=[];if(n.forEach(function(t){if("string"==typeof t)e[t].value||a.push('"'+t+'"');else if("function"==typeof t){var n=t(e);!n.status&&n.text&&a.push('"'+n.text+'"')}}),a.length>1){var i=e.format.locale.value.error.methods,o=e.format.locale.value.visualization[e.type.value]||e.type.value,l=e.format.locale.value.ui.and;a=d3plus.string.list(a,l),e.internal_error=d3plus.string.format(i,o,a)}else if(1===a.length){var i=e.format.locale.value.error.method,o=e.format.locale.value.visualization[e.type.value]||e.type.value;e.internal_error=d3plus.string.format(i,o,a[0])}if(!e.internal_error&&n.indexOf("edges")>=0&&n.indexOf("focus")>=0){var u=e.edges.connections(e.focus.value[0],e.id.value);if(0==u.length){var s=t(e,e.focus.value[0],e.depth.value),i=e.format.locale.value.error.connections;e.internal_error=d3plus.string.format(i,'"'+s+'"')}}var n=["d3"];e.types[e.type.value].libs&&(n=n.concat(e.types[e.type.value].libs));var a=[];if(n.forEach(function(e){window[e]||a.push('"'+e+'"')}),a.length>1){var i=e.format.locale.value.error.libs,o=e.format.locale.value.visualization[e.type.value],l=e.format.locale.value.ui.and;a=d3plus.string.list(a,l),e.internal_error=d3plus.string.format(i,o,a)}else if(1===a.length){var i=e.format.locale.value.error.lib,o=e.format.locale.value.visualization[e.type.value];e.internal_error=d3plus.string.format(i,o,a[0])}var c=e.types[e.type.value].shapes||["circle"];if(c instanceof Array||(c=[c]),e.shape.value){if(c.indexOf(e.shape.value)<0){var c=e.types[e.type.value].shapes.join('", "'),i=e.format.locale.value.error.accepted,d='"'+e.shape.value+'"',f=e.format.locale.value.method.shape,o=e.format.locale.value.visualization[e.type.value]||e.type.value;d3plus.console.warning(d3plus.string.format(i,d,f,o,'"'+c+'"'),"shape"),e.self.shape(c.length?c[0]:"circle")}}else e.self.shape(c.length?c[0]:"circle");if("modes"in e.types[e.type.value])if(e.type.mode.value){if(e.types[e.type.value].modes.indexOf(e.type.mode.value)<0){var p=e.types[e.type.value].modes.join('", "'),i=e.format.locale.value.error.accepted,h='"'+e.type.mode.value+'"',g=e.format.locale.value.method.mode,o=e.format.locale.value.visualization[e.type.value]||e.type.value;d3plus.console.warning(d3plus.string.format(i,h,g,o,'"'+p+'"')),e.self.type({mode:e.types[e.type.value].modes[0]})}}else e.self.type({mode:e.types[e.type.value].modes[0]});e.dev.value&&d3plus.console.timeEnd("checking for errors")}},{"../../core/fetch/text.js":80}],258:[function(e){var t=e("../../core/method/reset.js");d3plus.draw.finish=function(e){var n=e.zoom.viewport||e.zoom.bounds;e.types[e.type.value].zoom&&e.zoom.value&&n?(e.dev.value&&d3plus.console.time("calculating zoom"),e.draw.first?d3plus.zoom.bounds(e,n,0):(e.focus.changed||e.height.changed||e.width.changed||e.nodes.changed)&&d3plus.zoom.bounds(e,n),e.dev.value&&d3plus.console.timeEnd("calculating zoom")):e.zoom.scale=1;var r=e.zoom.size?e.zoom.size.width:e.width.viz,a=e.zoom.size?e.zoom.size.height:e.height.viz,i=e.zoom.bounds?e.zoom.bounds[0][0]:0,o=e.zoom.bounds?e.zoom.bounds[0][1]:0;e.g.overlay.attr("width",r).attr("height",a).attr("x",i).attr("y",o),e.draw.update?(d3plus.shape.edges(e),(e.draw.timing||!e.types[e.type.value].zoom&&!e.draw.timing)&&(d3plus.shape.labels(e,"data"),e.edges.label&&setTimeout(function(){d3plus.shape.labels(e,"edges")},e.draw.timing+200))):e.types[e.type.value].zoom&&e.zoom.value&&e.draw.timing&&setTimeout(function(){d3plus.zoom.labels(e)},e.draw.timing),e.types[e.type.value].zoom&&e.zoom.value&&e.focus.value.length&&!e.draw.timing&&(e.dev.value&&d3plus.console.time("focus labels"),d3plus.shape.labels(e,"data_focus"),e.edges.label&&setTimeout(function(){d3plus.shape.labels(e,"edge_focus")},e.draw.timing+200),e.dev.value&&d3plus.console.timeEnd("focus labels"));var l=e.types[e.type.value].requirements||[];l instanceof Array||(l=[l]);var u=l.indexOf("data")>=0;e.internal_error||e.data.app&&e.returned.nodes.length||!u||(e.internal_error=e.format.locale.value.error.data);var s=e.type.previous;s&&e.type.value!=s&&e.g.apps[s]&&(e.dev.value&&d3plus.console.time('hiding "'+s+'"'),e.draw.timing?e.g.apps[s].transition().duration(e.draw.timing).attr("opacity",0):e.g.apps[s].attr("opacity",0),e.dev.value&&d3plus.console.timeEnd());var c=u&&0==e.data.app.length||e.internal_error?0:e.focus.value.length&&e.types[e.type.value].zoom&&e.zoom.value?.4:1,d=e.group.attr("opacity");if(c!=d){var f=e.draw.timing;e.group.transition().duration(f).attr("opacity",c),e.g.data.transition().duration(f).attr("opacity",c),e.g.edges.transition().duration(f).attr("opacity",c)}e.internal_error?(e.internal_error=d3plus.string.title(e.internal_error),d3plus.console.warning(e.internal_error),d3plus.ui.message(e,e.internal_error),e.internal_error=null):d3plus.ui.message(e),setTimeout(function(){t(e),e.types[e.type.value].zoom&&e.zoom.value?(e.g.zoom.datum(e).call(e.zoom.behavior.on("zoom",d3plus.zoom.mouse)),e.zoom.scroll.value||e.g.zoom.on("wheel.zoom",null),e.zoom.click.value||e.g.zoom.on("dblclick.zoom",null),e.zoom.pan.value||(e.g.zoom.on("mousemove.zoom",null),e.g.zoom.on("mousedown.zoom",null))):e.g.zoom.call(e.zoom.behavior.on("zoom",null))},e.draw.timing)}},{"../../core/method/reset.js":83}],259:[function(){d3plus.draw.focus=function(t){if(t.g.edge_focus.selectAll("g").remove(),t.g.data_focus.selectAll("g").remove(),t.focus.value.length&&t.types[t.type.value].zoom&&t.zoom.value){t.dev.value&&d3plus.console.time("drawing focus elements");var n=t.g.edges.selectAll("g");if(n.size()>0){n.each(function(e){var n=e[t.edges.source][t.id.value],r=e[t.edges.target][t.id.value];if(n==t.focus.value[0]||r==t.focus.value[0]){var a=t.g.edge_focus.node().appendChild(this.cloneNode(!0));d3.select(a).datum(e).attr("opacity",1).selectAll("line, path").datum(e)}});var r=t.edges.arrows.value;t.g.edge_focus.selectAll("line, path").attr("vector-effect","non-scaling-stroke").style("stroke",t.color.focus).style("stroke-width",function(){return t.edges.size?d3.select(this).style("stroke-width"):2*t.data.stroke.width}).attr("marker-start",function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3plus)var a="_"+e.d3plus.bucket;else var a="";return"source"==n&&r?"url(#d3plus_edge_marker_focus"+a+")":"none"}).attr("marker-end",function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3plus)var a="_"+e.d3plus.bucket;else var a="";return"target"==n&&r?"url(#d3plus_edge_marker_focus"+a+")":"none"}),t.g.edge_focus.selectAll("text").style("fill",t.color.focus)}var a=d3plus.util.uniques(t.edges.connections(t.focus.value[0],t.id.value,!0),t.id.value);a.push(t.focus.value[0]);{var i=[],o=[],l=[0],u=[0];t.g.data.selectAll("g").each(function(n){if(a.indexOf(n[t.id.value])>=0){var r=t.g.data_focus.node().appendChild(this.cloneNode(!0)),r=d3.select(r).datum(n).attr("opacity",1);"coordinates"==t.shape.value?t.zoom.viewport=t.path.bounds(t.zoom.coords[n.d3plus.id]):"d3plus"in n&&("x"in n.d3plus&&i.push(n.d3plus.x),"y"in n.d3plus&&o.push(n.d3plus.y),"r"in n.d3plus?(l.push(n.d3plus.r),u.push(n.d3plus.r)):("width"in n.d3plus&&l.push(n.d3plus.width/2),"height"in n.d3plus&&u.push(n.d3plus.height/2)));for(e in d3plus.evt){var s=d3.select(this).on(d3plus.evt[e]);s&&r.on(d3plus.evt[e],s)}}})}if(i.length&&o.length){var s=d3.extent(i),c=d3.extent(o),d=d3.max(l),f=d3.max(u);t.zoom.viewport=[[s[0]-d,c[0]-f],[s[1]+d,c[1]+f]]}t.g.data_focus.selectAll("path").style("stroke-width",2*t.data.stroke.width),t.dev.value&&d3plus.console.timeEnd("drawing focus elements")}else t.zoom.viewport=!1}},{}],260:[function(e){var t=e("../../core/data/format.js"),n=e("../../core/data/color.js"),r=e("../../core/data/keys.js"),a=e("../../core/data/load.coffee"),i=e("../../core/fetch/data.js"),o=e("../../core/parse/edges.js"),l=e("../../core/parse/nodes.js");d3plus.draw.steps=function(e){var u=[],s=e.type.value,c=e.format.locale.value,d=c.message.ui,f=c.message.draw,p=["data","attrs","coords","nodes","edges"];if(p.forEach(function(t){!e[t].loaded&&e[t].url&&u.push({"function":function(e,n){a(e,t,n)},message:c.message.loading,wait:!0})}),e.draw.update){var h=c.visualization[s]||s,g=e.types[s].setup||!1,v=e.types[s].requirements||[],m=d3plus.string.format(c.message.initializing,h),y=c.message.data;v instanceof Array||(v=[v]),h=h.toLowerCase(),"function"==typeof g&&u.push({"function":function(e){if(e.dev.value){var t="running "+h+" setup";d3plus.console.time(t)}g(e),e.dev.value&&d3plus.console.timeEnd(t)},message:m}),e.container.changed&&u.push({"function":d3plus.draw.enter,message:m}),s in e.g.apps||u.push({"function":function(e){if(e.dev.value){var t="creating "+h+" group";d3plus.console.time(t)}e.g.apps[s]=e.g.app.selectAll("g#"+s).data([s]),e.g.apps[s].enter().append("g").attr("id",s).attr("opacity",0),e.dev.value&&d3plus.console.timeEnd(t)},message:m}),e.data.changed&&u.push({"function":function(e){e.data.cache={},delete e.nodes.restricted,delete e.edges.restricted,r(e,"data")},message:y}),e.attrs.changed&&u.push({"function":function(e){r(e,"attrs")
},message:y}),u.push({"function":function(e){if(e.color.changed&&e.color.value){if(e.color.valueScale=null,e.dev.value){var t="determining color type";d3plus.console.time(t)}var n=e.color.value;d3plus.object.validate(n)&&(n=n[e.id.value]?n[e.id.value]:n[d3.keys(n)[0]]),e.color.type=e.data.keys&&n in e.data.keys?e.data.keys[n]:e.attrs.keys&&n in e.attrs.keys?e.attrs.keys[n]:void 0,e.dev.value&&d3plus.console.timeEnd(t)}else e.color.value||(e.color.type="keys"in e.data?e.data.keys[e.id.value]:!1)},message:y}),v.indexOf("edges")>=0&&e.edges.value&&(!e.edges.linked||e.edges.changed)&&u.push({"function":o,message:y}),v.indexOf("nodes")>=0&&e.edges.value&&(!e.nodes.positions||e.nodes.changed)&&u.push({"function":l,message:y}),(e.data.changed||e.time.changed||e.id.changed)&&u.push({"function":t,message:y}),u.push({"function":function(e){var t=e.time.fixed.value?null:["all"];if(e.dev.value){var n=t?"fetching pool data":"fetching data";d3plus.console.time(n)}e.data.pool=i(e,t),e.dev.value&&d3plus.console.timeEnd(n),t?(e.dev.value&&d3plus.console.time("fetching data for current year"),e.data.app=i(e),e.dev.value&&d3plus.console.timeEnd("fetching data for current year")):e.data.app=e.data.pool},message:y}),u.push({check:function(e){return e.color.value&&"number"===e.color.type&&e.id.nesting.indexOf(e.color.value)<0&&e.data.value&&e.color.value!=e.id.value&&(e.color.changed||e.data.changed||e.depth.changed||e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed))},"function":n,message:y})}return u.push({"function":function(e){if(e.dev.value){var t=e.format.locale.value.message.tooltipReset;d3plus.console.time(t)}e.type.previous&&s!==e.type.previous&&d3plus.tooltip.remove(e.type.previous),d3plus.tooltip.remove(s),e.dev.value&&d3plus.console.timeEnd(t)},message:d}),u.push({"function":d3plus.draw.errors,message:d}),u.push({"function":function(e){if(e.margin.process(),d3plus.ui.titles(e),e.draw.update)d3plus.ui.drawer(e),d3plus.ui.timeline(e),d3plus.ui.legend(e);else{e.dev.value&&d3plus.console.time("calculating margins");var t=e.container.value.select("div#d3plus_drawer").node().offsetHeight||e.container.value.select("div#d3plus_drawer").node().getBoundingClientRect().height,n=e.g.timeline.node().getBBox();n=e.timeline.value?n.height+n.y:0;var r=e.g.legend.node().getBBox();r=e.legend.value?r.height+r.y:0,e.margin.bottom+=t+n+r,e.dev.value&&d3plus.console.timeEnd("calculating margins")}d3plus.ui.history(e),e.height.viz-=e.margin.top+e.margin.bottom,e.width.viz-=e.margin.left+e.margin.right},message:d}),u.push({"function":d3plus.ui.focus,message:d}),u.push({"function":d3plus.draw.update,message:f}),e.draw.update&&u.push({"function":[d3plus.draw.app,d3plus.shape.draw],message:f}),u.push({"function":[d3plus.draw.focus,d3plus.draw.finish],message:f}),u}},{"../../core/data/color.js":71,"../../core/data/format.js":73,"../../core/data/keys.js":74,"../../core/data/load.coffee":75,"../../core/fetch/data.js":79,"../../core/parse/edges.js":84,"../../core/parse/nodes.js":86}],261:[function(){d3plus.draw.update=function(e){e.dev.value&&d3plus.console.time("updating SVG elements"),e.draw.timing?(e.container.value.transition().duration(e.draw.timing).style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value),e.g.bg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value),e.g.clipping.select("rect").transition().duration(e.draw.timing).attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.transition().duration(e.draw.timing).attr("transform","translate("+e.margin.left+","+e.margin.top+")")):(e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.attr("width",e.width.value).attr("height",e.height.value),e.g.bg.attr("width",e.width.value).attr("height",e.height.value),e.g.clipping.select("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.attr("transform","translate("+e.margin.left+","+e.margin.top+")")),e.dev.value&&d3plus.console.timeEnd("updating SVG elements")}},{}],262:[function(e){var t=e("../../core/fetch/text.js");d3plus.shape.area=function(e,n,r){var a=d3.svg.area().x(function(e){return e.d3plus.x}).y0(function(e){return e.d3plus.y0}).y1(function(e){return e.d3plus.y}).interpolate(e.shape.interpolate.value);r.append("path").attr("class","d3plus_data").attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),n.selectAll("path.d3plus_data").data(function(n){if(e.labels.value&&n.values.length>1){var r=[],a=[],i=t(e,n);n.values.forEach(function(e){r.push([e.d3plus.x,e.d3plus.y]),a.push([e.d3plus.x,e.d3plus.y0])}),r=r.concat(a.reverse());var o={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value};if(i.length)var l=d3plus.font.sizes(i[0],o),u=l[0].width/l[0].height;else var u=null;var s=d3plus.geom.largestRect(r,{angle:d3.range(-70,71,1),aspectRatio:u,tolerance:0})[0];if(s){var c={w:Math.floor(s.width),h:Math.floor(s.height),x:Math.floor(s.cx),y:Math.floor(s.cy),angle:-1*s.angle,padding:2,names:i};c.translate=0!==s.angle?{x:c.x,y:c.y}:!1,c.w>=10&&c.h>=10&&(n.d3plus_label=c)}}return[n]}),e.draw.timing?n.selectAll("path.d3plus_data").transition().duration(e.draw.timing).attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e):n.selectAll("path.d3plus_data").attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e)}},{"../../core/fetch/text.js":80}],263:[function(e){var t=e("../../core/fetch/value.js"),n=e("../../core/fetch/color.js");d3plus.shape.color=function(e,r){var a=e.d3plus?e.d3plus.shapeType:r.shape.value;if("line"==r.shape.value)return"circle"==a?n(r,e):"none";if("area"==r.shape.value||"active"==a)return n(r,e);if("temp"==a)return"url(#d3plus_hatch_"+e.d3plus.id+")";if("active"==a)return n(r,e);if(e.d3plus.static)return d3plus.color.lighter(n(r,e),.75);var i=r.active.value?t(r,e,r.active.value):e.d3plus.active,o=r.temp.value?t(r,e,r.temp.value):e.d3plus.temp,l=r.total.value?t(r,e,r.total.value):e.d3plus.total;return!r.active.value&&!r.temp.value||i===!0||i&&l&&i==l&&!o||i&&!l?n(r,e):r.active.spotlight.value?"#eee":d3plus.color.lighter(n(r,e),.75)}},{"../../core/fetch/color.js":78,"../../core/fetch/value.js":81}],264:[function(e){var t=e("../../core/fetch/text.js");d3plus.shape.coordinates=function(e,n,r){var a=d3.geo[e.coords.projection.value]().center(e.coords.center);e.zoom.scale||(e.zoom.scale=1),e.zoom.area=1/e.zoom.scale/e.zoom.scale,e.path=d3.geo.path().projection(a),r.append("path").attr("id",function(e){return e.id}).attr("class","d3plus_data").attr("d",e.path).call(d3plus.shape.style,e),e.draw.timing?n.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(d3plus.shape.style,e):n.selectAll("path.d3plus_data").call(d3plus.shape.style,e);var i=e.old_height!=e.height.viz||e.height.changed||e.old_width!=e.width.viz||e.width.changed;e.old_height=e.height.viz,e.old_width=e.width.viz,e.coords.changed||i||e.coords.mute.changed||e.coords.solo.changed?(e.zoom.bounds=null,e.zoom.coords={},e.zoom.labels={},n.each(function(n){var r=e.path.bounds(n),a=[];n.geometry.coordinates=n.geometry.coordinates.filter(function(t,r){var i=d3plus.util.copy(n);i.geometry.coordinates=[i.geometry.coordinates[r]];var o=e.path.area(i);return o>=e.coords.threshold?(a.push(o),!0):!1}),a.sort(function(e,t){return e-t});var i=d3plus.util.copy(n),o=d3plus.util.copy(n);i.geometry.coordinates=i.geometry.coordinates.filter(function(t,r){var i=d3plus.util.copy(n);i.geometry.coordinates=[i.geometry.coordinates[r]];var l=e.path.area(i);return l==a[a.length-1]&&(o.geometry.coordinates=i.geometry.coordinates),l>=d3.quantile(a,.9)}),e.zoom.coords[n.d3plus.id]=i;var l=o.geometry.coordinates[0];if(l&&"MultiPolygon"===o.geometry.type&&(l=l[0],o.geometry.coordinates[0]=l,o.geometry.type="Polygon"),l){for(var u=e.path(o).split("M")[1].split("Z")[0].split("L"),s=0;s<u.length;s++)u[s]=u[s].split(","),u[s][0]=parseFloat(u[s][0]),u[s][1]=parseFloat(u[s][1]);var c={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value},d=t(e,n);if(d.length&&1===d[0].split(" ").length)var f=d3plus.font.sizes(d[0],c)[0],p=f.width/f.height;else var p=null;var h=d3plus.geom.largestRect(u,{angle:0,aspectRatio:p})[0];if(h){var g={anchor:"middle",valign:"center",group:e.g.labels,h:Math.floor(h.height),w:Math.floor(h.width),x:Math.floor(h.cx),y:Math.floor(h.cy),names:d};e.zoom.labels[n.d3plus.id]=g}else delete e.zoom.labels[n.d3plus.id]}else delete e.zoom.labels[n.d3plus.id];e.zoom.bounds?(e.zoom.bounds[0][0]>r[0][0]&&(e.zoom.bounds[0][0]=r[0][0]),e.zoom.bounds[0][1]>r[0][1]&&(e.zoom.bounds[0][1]=r[0][1]),e.zoom.bounds[1][0]<r[1][0]&&(e.zoom.bounds[1][0]=r[1][0]),e.zoom.bounds[1][1]<r[1][1]&&(e.zoom.bounds[1][1]=r[1][1])):e.zoom.bounds=r})):e.focus.value.length||(e.zoom.viewport=!1)}},{"../../core/fetch/text.js":80}],265:[function(){d3plus.shape.donut=function(e,t,n,r){function a(t,n,r,a){if(!n)var n=0;if("number"!=typeof r)var r=void 0;if("number"!=typeof a)var a=void 0;t.attrTween("d",function(t){if(void 0==r)var o=t.d3plus.r?t.d3plus.r:d3.max([t.d3plus.width,t.d3plus.height]);else var o=r;if(void 0==a)var l=t.d3plus.segments[t.d3plus.shapeType];else var l=a;e.arcs[t.d3plus.shapeType][t.d3plus.id]||(e.arcs[t.d3plus.shapeType][t.d3plus.id]={r:0},e.arcs[t.d3plus.shapeType][t.d3plus.id].a="donut"==t.d3plus.shapeType?2*Math.PI:0);var u=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].r,o+n),s=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].a,l);return function(n){return e.arcs[t.d3plus.shapeType][t.d3plus.id].r=u(n),e.arcs[t.d3plus.shapeType][t.d3plus.id].a=s(n),i(t)}})}e.arcs||(e.arcs={donut:{},active:{},temp:{}});var i=d3.svg.arc().startAngle(0).endAngle(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].a;return n>2*Math.PI?2*Math.PI:n}).innerRadius(function(t){if("donut"!=shape||t.d3plus.static)return 0;var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return n*e.data.donut.size}).outerRadius(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return"donut"!=t.d3plus.shapeType?2*n:n});r.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(a,0,0).each("end",function(t){delete e.arcs[t.d3plus.shapeType][t.d3plus.id]}),t.selectAll("path.d3plus_data").data(function(e){return[e]}).transition().duration(e.draw.timing).call(a).call(d3plus.shape.style,e),n.append("path").attr("class","d3plus_data").transition().duration(0).call(a,0,0).call(d3plus.shape.style,e)}},{}],266:[function(e){var t=e("../../core/fetch/value.js"),n=e("../../core/fetch/color.js"),r=e("../../core/fetch/text.js");d3plus.shape.draw=function(e){function a(n){n.d3plus.id="";for(var r=0;r<=e.depth.value;r++)n.d3plus.id+=t(e,n,e.id.nesting[r])+"_";return n.d3plus.id+=d,e.axes.values.forEach(function(r){"continuous"==e[r].scale.value&&(n.d3plus.id+="_"+t(e,n,e[r].value))}),n.d3plus.id=d3plus.string.strip(n.d3plus.id),n}function i(t,n){var r=e.types[e.type.value].scale;if(n&&r&&r[e.shape.value])var a=r[e.shape.value];else if(n&&r&&"number"==typeof r)var a=r;else var a=1;t.attr("transform",function(e){var t=e.d3plus.x||0,n=e.d3plus.y||0;return["line","area","coordinates"].indexOf(d)<0?"translate("+t+","+n+")scale("+a+")":"scale("+a+")"})}function o(t){if(t&&e.g.edges.selectAll("g").size()>0){e.g.edge_hover.selectAll("*").remove(),e.g.edges.selectAll("g").each(function(n){var r=t[e.id.value],a=n[e.edges.source][e.id.value],i=n[e.edges.target][e.id.value];if(a==r||i==r){var o=e.g.edge_hover.node().appendChild(this.cloneNode(!0));d3.select(o).datum(n).attr("opacity",1).selectAll("line, path").datum(n)}});var n=e.edges.arrows.value;e.g.edge_hover.attr("opacity",0).selectAll("line, path").style("stroke",e.color.primary).style("stroke-width",function(){return e.edges.size?d3.select(this).style("stroke-width"):2*e.data.stroke.width}).attr("marker-start",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"source"==r&&n?"url(#d3plus_edge_marker_highlight"+a+")":"none"}).attr("marker-end",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"target"==r&&n?"url(#d3plus_edge_marker_highlight"+a+")":"none"}),e.g.edge_hover.selectAll("text").style("fill",e.color.primary),e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",1),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",.5)):e.g.edge_hover.attr("opacity",1)}else e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",0).transition().selectAll("*").remove(),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",1)):e.g.edge_hover.selectAll("*").remove()}var l=e.returned.nodes||[],u=e.returned.edges||[];e.draw.timing=l.length<e.data.large&&u.length<e.edges.large?e.timing.transitions:0;var s={area:"area",circle:"rect",donut:"donut",line:"line",square:"rect",coordinates:"coordinates"},c={};l.forEach(function(t){if(t.d3plus)if(t.d3plus.shape){var n=t.d3plus.shape;t.d3plus.shapeType=n}else{var n=s[e.shape.value];t.d3plus.shapeType=n}else var n=s[e.shape.value];c[n]||(c[n]=[]),c[n].push(t)});for(d in s)s[d]in c&&0!==d3.keys(c).length||(e.draw.timing?e.g.data.selectAll("g.d3plus_"+s[d]).transition().duration(e.draw.timing).attr("opacity",0).remove():e.g.data.selectAll("g.d3plus_"+s[d]).remove());for(var d in c){var f=e.g.data.selectAll("g.d3plus_"+d).data(c[d],function(t){if(t.d3plus||(t.d3plus={}),"coordinates"===d)return t.d3plus.id=t.id,t.id;if(!t.d3plus.id)if(t.values)t.values.forEach(function(e){e=a(e),e.d3plus.shapeType="circle"}),t.d3plus.id=t.key;else if(t=a(t),!t.d3plus.segments){t.d3plus.segments={donut:2*Math.PI};var n=e.active.value?t.d3plus[e.active.value]:t.d3plus.active,r=e.temp.value?t.d3plus[e.temp.value]:t.d3plus.temp,i=e.total.value?t.d3plus[e.total.value]:t.d3plus.total;i&&(t.d3plus.segments.active=n?n/i*2*Math.PI:0,t.d3plus.segments.temp=r?r/i*2*Math.PI+t.d3plus.segments.active:0)}return t.d3plus?t.d3plus.id:!1});if(e.draw.timing)var p=f.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();else var p=f.exit().remove();e.draw.timing?f.transition().duration(e.draw.timing).call(i):f.call(i);var h=e.draw.timing?0:1,g=f.enter().append("g").attr("class","d3plus_"+d).attr("opacity",h).call(i);e.draw.timing&&g.transition().duration(e.draw.timing).attr("opacity",1),f.order(),e.dev.value&&d3plus.console.time('drawing "'+d+'" shapes'),d3plus.shape[d](e,f,g,p,i),e.dev.value&&d3plus.console.timeEnd('drawing "'+d+'" shapes'),["rect","donut"].indexOf(d)>=0&&e.types[e.type.value].fill&&(e.dev.value&&d3plus.console.time('filling "'+d+'" shapes'),d3plus.shape.fill(e,f,g,p,i),e.dev.value&&d3plus.console.timeEnd('filling "'+d+'" shapes'))}o(),d3plus.touch?e.g.data.selectAll("g").on(d3plus.evt.over,e.zoom.touchEvent).on(d3plus.evt.move,e.zoom.touchEvent).on(d3plus.evt.out,e.zoom.touchEvent):e.g.data.selectAll("g").on(d3plus.evt.over,function(t){if(!(e.draw.frozen||t.d3plus&&t.d3plus.static)){if(d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).call(i,!0),d3.select(this).selectAll(".d3plus_data").transition().duration(e.timing.mouseevents).attr("opacity",1),e.covered=!1,1!==e.focus.value.length||e.focus.value[0]!=t[e.id.value]){if(t.values&&e.continuous_axis){var n="x"===e.continuous_axis?0:1,r=d3.mouse(e.container.value.node())[n],a=d3plus.util.uniques(t.values,function(t){return t.d3plus[e.continuous_axis]}),l=d3plus.util.closest(a,r);t.d3plus_data=t.values[a.indexOf(l)],t.d3plus=t.values[a.indexOf(l)].d3plus}var u=t.d3plus_data?t.d3plus_data:t;d3plus.tooltip.app({vars:e,data:u})}"function"==typeof e.mouse?e.mouse(t):e.mouse[d3plus.evt.over]&&e.mouse[d3plus.evt.over](t),o(t)}}).on(d3plus.evt.move,function(t){if(!(e.draw.frozen||t.d3plus&&t.d3plus.static)){if(e.covered=!1,t.values||"follow"==e.types[e.type.value].tooltip&&e.focus.value[0]!=t[e.id.value]){if(t.values&&e.continuous_axis){var n="x"===e.continuous_axis?0:1,r=d3.mouse(e.container.value.node())[n],a=d3plus.util.uniques(t.values,function(t){return t.d3plus[e.continuous_axis]}),i=d3plus.util.closest(a,r);t.d3plus_data=t.values[a.indexOf(i)],t.d3plus=t.values[a.indexOf(i)].d3plus}var o=t.d3plus_data?t.d3plus_data:t;d3plus.tooltip.app({vars:e,data:o})}"function"==typeof e.mouse?e.mouse(t):e.mouse[d3plus.evt.move]&&e.mouse[d3plus.evt.move](t)}}).on(d3plus.evt.out,function(t){var n=d3plus.util.child(this,d3.event.toElement);n||e.draw.frozen||t.d3plus&&t.d3plus.static||(d3.select(this).transition().duration(e.timing.mouseevents).call(i),d3.select(this).selectAll(".d3plus_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),e.covered||d3plus.tooltip.remove(e.type.value),"function"==typeof e.mouse?e.mouse(t):e.mouse[d3plus.evt.out]&&e.mouse[d3plus.evt.out](t),o())}),e.g.data.selectAll("g").on(d3plus.evt.click,function(a){if(!(d3.event.defaultPrevented||e.draw.frozen||a.d3plus&&a.d3plus.static)){"function"==typeof e.mouse?e.mouse(a):e.mouse[d3plus.evt.out]?e.mouse[d3plus.evt.out](a):e.mouse[d3plus.evt.click]&&e.mouse[d3plus.evt.click](a);var l=e.zoom.direction(a.d3plus_data||a),u=e.id.solo.value,s=r(e,a)[0],c=d3plus.color.legible(n(e,a)),d=e.title.sub.value||!1,f=e.title.sub.font.color,p=e.title.total.font.color;if(a.d3plus.threshold&&a.d3plus.merged&&e.zoom.value)e.history.states.push(function(){e.self.id({solo:u}).title({sub:{font:{color:f},value:d},total:{font:{color:p}}}).draw()}),e.self.id({solo:d3plus.util.uniques(a.d3plus.merged,e.id.value)}).title({sub:{font:{color:c},value:s},total:{font:{color:c}}}).draw();else if(1===l&&e.zoom.value){var h=t(e,a,e.id.value);e.history.states.push(function(){e.self.depth(e.depth.value-1).id({solo:u}).title({sub:{font:{color:f},value:d},total:{font:{color:p}}}).draw()}),e.self.depth(e.depth.value+1).id({solo:[h]}).title({sub:{font:{color:c},value:s},total:{font:{color:c}}}).draw()}else if(-1===l&&e.zoom.value)e.history.back();else if(e.types[e.type.value].zoom&&e.zoom.value)o(),d3.select(this).transition().duration(e.timing.mouseevents).call(i),d3.select(this).selectAll(".d3plus_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),d3plus.tooltip.remove(e.type.value),e.draw.update=!1,a&&a[e.id.value]!=e.focus.value[0]?e.self.focus(a[e.id.value]).draw():e.self.focus(!1).draw();else if(1!==e.focus.value.length||a[e.id.value]!=e.focus.value[0]){o();var g=a.d3plus_data?a.d3plus_data:a;d3plus.tooltip.app({vars:e,data:g})}}})}},{"../../core/fetch/color.js":78,"../../core/fetch/text.js":80,"../../core/fetch/value.js":81}],267:[function(){d3plus.shape.edges=function(e){function t(t){var n=1==e.edges.opacity?e.edges.opacity:0;t.attr("opacity",n).style("stroke-width",0).style("stroke",e.background.value).style("fill","none")}function n(t){var n=e.edges.arrows.value;t.style("stroke-width",function(t){return e.edges.scale(t[e.edges.size])}).style("stroke",e.edges.color).attr("opacity",e.edges.opacity).attr("marker-start",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"source"==r&&n?"url(#d3plus_edge_marker_default"+a+")":"none"}).attr("marker-end",function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3plus)var a="_"+t.d3plus.bucket;else var a="";return"target"==r&&n?"url(#d3plus_edge_marker_default"+a+")":"none"}).attr("vector-effect","non-scaling-stroke").attr("pointer-events","none")}function r(t){t.attr("x1",function(t){return t[e.edges.source].d3plus.edges[t[e.edges.target][e.id.value]].x}).attr("y1",function(t){return t[e.edges.source].d3plus.edges[t[e.edges.target][e.id.value]].y}).attr("x2",function(t){return t[e.edges.target].d3plus.edges[t[e.edges.source][e.id.value]].x}).attr("y2",function(t){return t[e.edges.target].d3plus.edges[t[e.edges.source][e.id.value]].y})}function a(e){e.attr("d",function(e){return d(e.d3plus.spline)})}function i(t){if(delete t.d3plus_label,e.g.edges.selectAll("line, path").size()<e.edges.large&&e.edges.label&&t[e.edges.label]){if("spline"in t.d3plus)var n=this.getTotalLength(),r=this.getPointAtLength(n/2),a=this.getPointAtLength(n/2-.1*n),i=this.getPointAtLength(n/2+.1*n),o=Math.atan2(i.y-a.y,i.x-a.x),l=o*(180/Math.PI),u=(this.parentNode.getBBox(),.8*n),s=r.x,c=r.y;else var d=(this.getBBox(),t[e.edges.source]),f=t[e.edges.target],p={x:d.d3plus.edges[f[e.id.value]].x,y:d.d3plus.edges[f[e.id.value]].y},h={x:f.d3plus.edges[d[e.id.value]].x,y:f.d3plus.edges[d[e.id.value]].y},g=h.x-p.x,v=h.y-p.y,r={x:h.x-g/2,y:h.y-v/2},o=Math.atan2(v,g),l=o*(180/Math.PI),n=Math.sqrt(g*g+v*v),u=n,s=r.x,c=r.y;u+=2*e.labels.padding;var m=0;e.edges.arrows.value&&(m="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8,m/=e.zoom.behavior.scaleExtent()[1],u-=2*m),(-90>l||l>90)&&(l-=180),u*e.zoom.behavior.scaleExtent()[0]>20&&(t.d3plus_label={x:s,y:c,translate:{x:s,y:c},w:u,h:15+2*e.labels.padding,angle:l,anchor:"middle",valign:"center",color:e.edges.color,resize:!1,names:[e.format.value(t[e.edges.label])],background:1})}}var o=e.returned.edges||[],l=e.zoom.behavior.scaleExtent()[0];if("string"==typeof e.edges.size){var u=d3.extent(o,function(t){return t[e.edges.size]}),s=.5*d3.min(e.returned.nodes||[],function(e){return e.d3plus.r});e.edges.scale=d3.scale.sqrt().domain(u).range([e.edges.width,s*l])}else{var c="number"==typeof e.edges.size?e.edges.size:e.edges.width;e.edges.scale=function(){return c}}var d=d3.svg.line().interpolate(e.edges.interpolate.value),f=e.edges.arrows.value?"string"==typeof e.edges.size?["default_0","default_1","default_2","highlight_0","highlight_1","highlight_2","focus_0","focus_1","focus_2"]:["default","highlight","focus"]:[];if("string"==typeof e.edges.size)for(var p=d3plus.util.buckets(e.edges.scale.range(),4),h=[],g=0;3>g;g++)h.push(p[g+1]+(p[1]-p[0])*(g+2)*2);else var v="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8,h="number"==typeof e.edges.size?e.edges.size/v:v;var m=e.defs.selectAll(".d3plus_edge_marker").data(f,String),y=function(t){t.attr("d",function(t){var n=t.split("_");if(2==n.length&&e.edges.scale){n=parseInt(n[1]);var r=h[n]}else var r=h;return"target"==e.edges.arrows.direction.value?"M 0,-"+r/2+" L "+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2:"M 0,-"+r/2+" L -"+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2}).attr("fill",function(t){var n=t.split("_")[0];return"default"==n?e.edges.color:"focus"==n?e.color.focus:e.color.primary}).attr("transform","scale("+1/l+")")};e.draw.timing?(m.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),m.select("path").transition().duration(e.draw.timing).attr("opacity",1).call(y)):(m.exit().remove(),m.select("path").attr("opacity",1).call(y));var x=e.draw.timing?0:1,b=m.enter().append("marker").attr("id",function(e){return"d3plus_edge_marker_"+e}).attr("class","d3plus_edge_marker").attr("orient","auto").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("path").attr("opacity",x).attr("vector-effect","non-scaling-stroke").call(y);e.draw.timing&&b.transition().duration(e.draw.timing).attr("opacity",1);var w="string"==typeof e.edges.size?d3plus.util.buckets(e.edges.scale.domain(),4):null,_=e.edges.arrows.direction.value,k=o.filter(function(t){if(t.d3plus||(t.d3plus={}),t.d3plus.id="edge_"+t[e.edges.source][e.id.value]+"_"+t[e.edges.target][e.id.value],t.d3plus.spline!==!0){if(w){var n=t[e.edges.size];t.d3plus.bucket=n<w[1]?0:n<w[2]?1:2;var r=.85*h[t.d3plus.bucket]/l}else{delete t.d3plus.bucket;var r=.85*h/l}var a=t[e.edges.source],i=t[e.edges.target];if(!a.d3plus||!i.d3plus)return!1;var o=Math.atan2(a.d3plus.y-i.d3plus.y,a.d3plus.x-i.d3plus.x),u=Math.atan2(i.d3plus.y-a.d3plus.y,i.d3plus.x-a.d3plus.x),s="source"==_&&e.edges.arrows.value?a.d3plus.r+r:a.d3plus.r,c="target"==_&&e.edges.arrows.value?i.d3plus.r+r:i.d3plus.r,d=d3plus.util.offset(o,s,e.shape.value),f=d3plus.util.offset(u,c,e.shape.value);return"edges"in a.d3plus||(a.d3plus.edges={}),a.d3plus.edges[i[e.id.value]]={x:a.d3plus.x-d.x,y:a.d3plus.y-d.y},"edges"in i.d3plus||(i.d3plus.edges={}),i.d3plus.edges[a[e.id.value]]={x:i.d3plus.x-f.x,y:i.d3plus.y-f.y},!0}return!1}),M=e.g.edges.selectAll("g.d3plus_edge_line").data(k,function(e){return e.d3plus.id}),A=o.filter(function(t){if(t.d3plus.spline){if(w){var n=t[e.edges.size];t.d3plus.bucket=n<w[1]?0:n<w[2]?1:2;var r=.85*h[t.d3plus.bucket]/l}else{delete t.d3plus.bucket;var r=.85*h/l}var a=t[e.edges.source],i=t[e.edges.target],o=a.d3plus.edges?a.d3plus.edges[i[e.id.value]]||{}:{},u=i.d3plus.edges?i.d3plus.edges[a[e.id.value]]||{}:{},s=e.edges.arrows.value&&"source"==_?r:0,c=e.edges.arrows.value&&"target"==_?r:0,d=.1,f=a.d3plus.x>i.d3plus.x?1-d:1+d,p=a.d3plus.x>i.d3plus.x?1+d:1-d,g="number"==typeof o.angle?o.angle:Math.atan2(a.d3plus.y-i.d3plus.y,a.d3plus.x-i.d3plus.x)*f,v=d3plus.util.offset(g,a.d3plus.r+s,e.shape.value),m="number"==typeof u.angle?u.angle:Math.atan2(i.d3plus.y-a.d3plus.y,i.d3plus.x-a.d3plus.x)*p,y=d3plus.util.offset(m,i.d3plus.r+c,e.shape.value),x=[a.d3plus.x-v.x,a.d3plus.y-v.y],b=o.offset?d3plus.util.offset(g,o.offset):!1,k=b?[x[0]-b.x,x[1]-b.y]:x,M=[i.d3plus.x-y.x,i.d3plus.y-y.y],A=u.offset?d3plus.util.offset(m,u.offset):!1,z=A?[M[0]-A.x,M[1]-A.y]:M,j=z[0]-k[0],E=z[1]-k[1],S="number"==typeof o.radius?o.radius:Math.sqrt(j*j+E*E)/4,T="number"==typeof u.radius?u.radius:Math.sqrt(j*j+E*E)/4,N=d3plus.util.offset(g,S-a.d3plus.r-2*s),O=d3plus.util.offset(m,T-i.d3plus.r-2*c);t.d3plus.spline=[x,M];var C=Math.abs(Math.atan2(a.d3plus.y-i.d3plus.y,a.d3plus.x-i.d3plus.x)).toFixed(5),F=Math.abs(g).toFixed(5),q=Math.abs(m-Math.PI).toFixed(5);return(F!==q||[F,q].indexOf(C)<0)&&(t.d3plus.spline.splice(1,0,[k[0]-N.x,k[1]-N.y],[z[0]-O.x,z[1]-O.y]),b&&t.d3plus.spline.splice(1,0,k),A&&t.d3plus.spline.splice(t.d3plus.spline.length-1,0,z)),!0}return!1}),z=e.g.edges.selectAll("g.d3plus_edge_path").data(A,function(e){return e.d3plus.id});e.draw.timing?(M.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),z.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),M.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),z.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),M.selectAll("line").data(function(e){return[e]}).transition().duration(e.draw.timing).call(r).call(n).each("end",i),z.selectAll("path").data(function(e){return[e]}).transition().duration(e.draw.timing).call(a).call(n).each("end",i),M.enter().append("g").attr("class","d3plus_edge_line").append("line").call(r).call(t).transition().duration(e.draw.timing).call(n).each("end",i),z.enter().append("g").attr("class","d3plus_edge_path").append("path").call(a).call(t).transition().duration(e.draw.timing).call(n).each("end",i)):(M.exit().remove(),z.exit().remove(),M.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),z.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),M.selectAll("line").data(function(e){return[e]}).call(r).call(n).call(i),z.selectAll("path").data(function(e){return[e]}).call(a).call(n).call(i),M.enter().append("g").attr("class","d3plus_edge_line").append("line").call(r).call(t).call(n).call(i),z.enter().append("g").attr("class","d3plus_edge_path").append("path").call(a).call(t).call(n).call(i))}},{}],268:[function(e){var t=e("../../core/fetch/color.js");d3plus.shape.fill=function(e,n){function r(e){e.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function a(t,n){if(!n)var n=0;t.attr("x",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return-t/2-n/2}).attr("y",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return-t/2-n/2}).attr("width",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return t+n}).attr("height",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return t+n}).attr("rx",function(t){var r=t.d3plus.r?2*t.d3plus.r:t.d3plus.width,a=["circle","donut"].indexOf(e.shape.value)>=0;return a?(r+n)/2:0}).attr("ry",function(t){var r=t.d3plus.r?2*t.d3plus.r:t.d3plus.height,a=["circle","donut"].indexOf(e.shape.value)>=0;return a?(r+n)/2:0}).attr("shape-rendering",function(){return["square"].indexOf(e.shape.value)>=0?e.shape.rendering.value:"auto"})}function i(t,n,r,a){if(!n)var n=0;if("number"!=typeof r)var r=void 0;if("number"!=typeof a)var a=void 0;t.attrTween("d",function(t){if(void 0==r)var i=t.d3plus.r?t.d3plus.r:d3.max([t.d3plus.width,t.d3plus.height]);else var i=r;if(void 0==a)var l=t.d3plus.a[t.d3plus.shapeType];else var l=a;e.arcs[t.d3plus.shapeType][t.d3plus.id]||(e.arcs[t.d3plus.shapeType][t.d3plus.id]={r:0},e.arcs[t.d3plus.shapeType][t.d3plus.id].a="donut"==t.d3plus.shapeType?2*Math.PI:0);var u=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].r,i+n),s=d3.interpolate(e.arcs[t.d3plus.shapeType][t.d3plus.id].a,l);return function(n){return e.arcs[t.d3plus.shapeType][t.d3plus.id].r=u(n),e.arcs[t.d3plus.shapeType][t.d3plus.id].a=s(n),o(t)}})}e.arcs||(e.arcs={donut:{},active:{},temp:{}});var o=d3.svg.arc().startAngle(0).endAngle(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].a;return n>2*Math.PI?2*Math.PI:n}).innerRadius(function(t){if("donut"!=shape||t.d3plus.static)return 0;var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return n*e.data.donut.size}).outerRadius(function(t){var n=e.arcs[t.d3plus.shapeType][t.d3plus.id].r;return"donut"!=t.d3plus.shapeType?2*n:n});n.each(function(n){function o(t){t.attr("stroke",d).attr("stroke-width",1).attr("shape-rendering",e.shape.rendering.value)}var l=e.active.value?n.d3plus[e.active.value]:n.d3plus.active,u=e.temp.value?n.d3plus[e.temp.value]:n.d3plus.temp,s=e.total.value?n.d3plus[e.total.value]:n.d3plus.total,c=d3.select(this),d=t(e,n),f=[],p=[];if(s&&e.types[e.type.value].fill){if(u){var h=d3plus.util.copy(n);h.d3plus.shapeType="temp",f.push(h),p=["temp"]}if(l&&(s>l||u)){var h=d3plus.util.copy(n);h.d3plus.shapeType="active",f.push(h)}}var g=e.defs.selectAll("pattern#d3plus_hatch_"+n.d3plus.id).data(p);e.draw.timing?(g.selectAll("rect").transition().duration(e.draw.timing).style("fill",d),g.selectAll("line").transition().duration(e.draw.timing).style("stroke",d)):(g.selectAll("rect").style("fill",d),g.selectAll("line").style("stroke",d));var v=g.enter().append("pattern").attr("id","d3plus_hatch_"+n.d3plus.id).attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g");v.append("rect").attr("x","0").attr("y","0").attr("width","10").attr("height","10").attr("fill",d).attr("fill-opacity",.25),v.append("line").attr("x1","0").attr("x2","10").attr("y1","0").attr("y2","10").call(o),v.append("line").attr("x1","-1").attr("x2","1").attr("y1","9").attr("y2","11").call(o),v.append("line").attr("x1","9").attr("x2","11").attr("y1","-1").attr("y2","1").call(o);var m=f.length?[n]:[],y=c.selectAll("#d3plus_clip_"+n.d3plus.id).data(m);y.enter().insert("clipPath",".d3plus_mouse").attr("id","d3plus_clip_"+n.d3plus.id).append("rect").attr("class","d3plus_clipping").call(r),e.draw.timing?(y.selectAll("rect").transition().duration(e.draw.timing).call(a),y.exit().transition().delay(e.draw.timing).remove()):(y.selectAll("rect").call(a),y.exit().remove());var x=c.selectAll("path.d3plus_fill").data(f);x.transition().duration(e.draw.timing).call(d3plus.shape.style,e).call(i),x.enter().insert("path","rect.d3plus_mouse").attr("class","d3plus_fill").attr("clip-path","url(#d3plus_clip_"+n.d3plus.id+")").transition().duration(0).call(i,0,void 0,0).call(d3plus.shape.style,e).transition().duration(e.draw.timing).call(i),x.exit().transition().duration(e.draw.timing).call(i,0,void 0,0).remove()})}},{"../../core/fetch/color.js":78}],269:[function(e){var t=e("../../core/fetch/text.js");d3plus.shape.labels=function(e,n){var r=e.zoom.behavior.scaleExtent(),a=e.g[n].selectAll("g"),i=function(t){t.attr("opacity",function(t){if(!t)var t={scale:r[1]};var n=parseFloat(d3.select(this).attr("font-size"),10);return t.visible=n/t.scale*e.zoom.scale>=7,t.visible?1:0
})};if(remove=function(t){e.draw.timing?t.transition().duration(e.draw.timing).attr("opacity",0).remove():t.remove()},style=function(t,n){function a(t){if("circle"===t.shape)return"0px";var n=t.anchor||e.labels.align,a="tspan"===this.tagName.toLowerCase(),i=a?"d3plus_share"==this.parentNode.className.baseVal:"d3plus_share"==this.className.baseVal,o=d3.select(this).node().getComputedTextLength()/r[1];if("middle"==n||i)var l=t.x-o/2;else if("end"==n&&!d3plus.rtl||"start"==n&&d3plus.rtl)var l=t.x+(t.w-t.padding)/2-o;else var l=t.x-(t.w-t.padding)/2;if(a){var u=this.getComputedTextLength()/r[1];"middle"==n?d3plus.rtl?l-=(o-u)/2:l+=(o-u)/2:"end"==n&&(d3plus.rtl?l-=o-u:l+=o-u)}return d3plus.rtl&&(l+=o),l*r[1]}function i(t){if(d3.select(this).select("tspan").empty())return 0;var n=e.labels.align,a=d3.select(this).node().getBBox().height/r[1],i=parseFloat(d3.select(this).style("font-size"),10)/5/r[1];if("d3plus_share"==this.className.baseVal){var o=d3.select(this.parentNode).datum(),l=o.d3plus.r?2*o.d3plus.r:o.d3plus.height;if(l/=r[1],"end"==n)var u=t.y-l/2+i/2;else var u=t.y+l/2-a-i/2}else if("circle"===t.shape||"middle"===n||"center"===t.valign)var u=t.y-a/2-i/2;else if("end"==n)var u=t.y+(t.h-t.padding)/2-a+i/2;else var u=t.y-(t.h-t.padding)/2-i;return u*r[1]}t.attr("font-weight",e.labels.font.weight).attr("font-family",e.labels.font.family.value).style("text-anchor",function(e){return"circle"===e.shape?"middle":"start"}).attr("pointer-events",function(e){return e.mouse?"auto":"none"}).attr("fill",function(t){if(t.color)return t.color;var n=d3plus.shape.color(t.parent,e),r=d3plus.color.text(n),a=t.text?.15:1;return d3plus.color.mix(n,r,.2,a)}).attr("x",a).attr("y",i),n&&t.each(function(t){if(t.resize instanceof Array){t.resize[0],t.resize[1]}if(t.text){if(t.resize instanceof Array)var n=t.resize,r=!0;else var n=[9/t.scale,50*t.scale],r=t.resize;d3plus.textwrap().container(d3.select(this)).height(t.h*t.scale-t.padding).resize(r).size(n).text(e.format.value(100*t.text,"share")+"%").width(t.w*t.scale-t.padding).draw()}else{if("middle"!==e.labels.align&&t.share)var a=t.h-t.share-t.padding;else var a=t.h;if(t.resize instanceof Array)var n=t.resize,r=!0;else var n=[9/t.scale,40*t.scale],r=t.resize;var i=t.shape||"square";d3plus.textwrap().container(d3.select(this)).height(a*t.scale-t.padding).resize(r).size(n).shape(i).text(t.names).width(t.w*t.scale-t.padding).draw()}}).attr("x",a).attr("y",i),t.attr("transform",function(e){var t=e.angle||0,n=e.translate&&e.translate.x?e.translate.x:0,a=e.translate&&e.translate.y?e.translate.y:0;return"rotate("+t+","+n+","+a+")scale("+1/r[1]+")"}).selectAll("tspan").attr("x",a)},"edges"===n||e.labels.value){if(e.dev.value){var o="drawing "+n+" labels";d3plus.console.time(o)}a.each(function(a){function o(t){var n="none"===e.background.value?"#ffffff":e.background.value,a="string"==typeof label.background?label.background:n,i=label.angle||0,o=label.translate?b.x+b.width/2:0,l=label.translate?b.y+b.height/2:0,u="scale("+1/r[1]+")rotate("+i+","+o+","+l+")";t.attr("fill",a).attr(b).attr("transform",u)}var l=a.d3plus&&"label"in a.d3plus&&!a.d3plus.label,u=a.d3plus&&"static"in a.d3plus&&a.d3plus.static;if(label=a.d3plus_label?a.d3plus_label:e.zoom.labels?e.zoom.labels[a.d3plus.id]:null,share=a.d3plus_share,names=label&&label.names?label.names:t(e,a),n=label&&"group"in label?label.group:d3.select(this),share_size=0,fill=e.types[e.type.value].fill,label)if(["line","area"].indexOf(e.shape.value)>=0)var s=!0;else if(a&&"d3plus"in a)var c=e.active.value?a.d3plus[e.active.value]:a.d3plus.active,d=e.temp.value?a.d3plus[e.temp.value]:a.d3plus.temp,f=e.total.value?a.d3plus[e.total.value]:a.d3plus.total,s=!d&&!c||c==f;if(l||!s&&fill||u)delete a.d3plus_label,n.selectAll("text#d3plus_label_"+a.d3plus.id+", rect#d3plus_label_bg_"+a.d3plus.id).call(remove);else{if(share&&a.d3plus.share&&"middle"!=e.labels.align){share.resize=e.labels.resize.value===!1?!1:share&&"resize"in share?share.resize:!0,share.scale=share.resize?r[1]:r[0],share.padding=e.labels.padding/share.scale*2,share.text=a.d3plus.share,share.parent=a;var p=n.selectAll("text#d3plus_share_"+a.d3plus.id).data([share],function(e){return e.w+""+e.h+e.text});e.draw.timing?(p.transition().duration(e.draw.timing/2).call(style),p.enter().append("text").attr("id","d3plus_share_"+a.d3plus.id).attr("class","d3plus_share").attr("opacity",0).call(style,!0).transition().duration(e.draw.timing/2).delay(e.draw.timing/2).attr("opacity",1)):(p.attr("opacity",1).call(style),p.enter().append("text").attr("id","d3plus_share_"+a.d3plus.id).attr("class","d3plus_share").attr("opacity",1).call(style,!0)),share_size=p.node().getBBox().height,p.exit().call(remove)}else n.selectAll("text.d3plus_share").call(remove);if(label){label.resize=e.labels.resize.value===!1?!1:label&&"resize"in label?label.resize:!0,label.scale=label.resize?r[1]:r[0];var h="number"==typeof label.padding?label.padding:e.labels.padding;label.padding=h/label.scale*2}if(label&&label.w*label.scale-label.padding>=20&&label.h*label.scale-label.padding>=10&&names.length){for(var g=e.format.locale.value.ui.and,v=e.format.locale.value.ui.more,m=0;m<names.length;m++)names[m]instanceof Array&&(names[m]=d3plus.string.list(names[m],g,3,v));label.names=names,label.share=share_size,label.parent=a;var p=n.selectAll("text#d3plus_label_"+a.d3plus.id).data([label],function(e){return e?e.w+"_"+e.h+"_"+e.x+"_"+e.y+"_"+e.names.join("_"):!1}),y=label.resize?void 0:e.labels.font.size*label.scale;if(e.draw.timing?(p.transition().duration(e.draw.timing/2).call(style).call(i),p.enter().append("text").attr("font-size",y).attr("id","d3plus_label_"+a.d3plus.id).attr("class","d3plus_label").attr("opacity",0).call(style,!0).transition().duration(e.draw.timing/2).delay(e.draw.timing/2).call(i)):(p.attr("opacity",1).call(style).call(i),p.enter().append("text").attr("font-size",y).attr("id","d3plus_label_"+a.d3plus.id).attr("class","d3plus_label").call(style,!0).call(i)),p.exit().call(remove),0==p.size()||""==p.html())delete a.d3plus_label,n.selectAll("text#d3plus_label_"+a.d3plus.id+", rect#d3plus_label_bg_"+a.d3plus.id).call(remove);else{if(label.background){var x=["background"],b=p.node().getBBox();b.width+=e.labels.padding*r[0],b.height+=e.labels.padding*r[0],b.x-=e.labels.padding*r[0]/2,b.y-=e.labels.padding*r[0]/2}else var x=[],b={};var w=n.selectAll("rect#d3plus_label_bg_"+a.d3plus.id).data(x),_="number"==typeof label.background?label.background:.6;e.draw.timing?(w.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),w.transition().duration(e.draw.timing).attr("opacity",_).call(o),w.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+a.d3plus.id).attr("class","d3plus_label_bg").attr("opacity",0).call(o).transition().duration(e.draw.timing).attr("opacity",_)):(w.exit().remove(),w.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+a.d3plus.id).attr("class","d3plus_label_bg"),w.attr("opacity",_).call(o))}}else delete a.d3plus_label,n.selectAll("text#d3plus_label_"+a.d3plus.id+", rect#d3plus_label_bg_"+a.d3plus.id).call(remove)}}),e.dev.value&&d3plus.console.timeEnd(o)}else{if(e.dev.value){var o="removing "+n+" labels";d3plus.console.time(o)}a.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove),e.g.labels.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove),e.dev.value&&d3plus.console.timeEnd(o)}}},{"../../core/fetch/text.js":80}],270:[function(){d3plus.shape.line=function(e,t){function n(e){e.attr("x",function(e){return e.d3plus.x}).attr("y",function(e){return e.d3plus.y}).attr("width",0).attr("height",0)}function r(e,t){if(!t)var t=0;e.attr("x",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return e.d3plus.x-(n/2+t/2)}).attr("y",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return e.d3plus.y-(n/2+t/2)}).attr("width",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return n+t}).attr("height",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return n+t}).attr("rx",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return(n+t)/2}).attr("ry",function(e){var n=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return(n+t)/2})}var a=d3.svg.line().x(function(e){return e.d3plus.x}).y(function(e){return e.d3plus.y}).interpolate(e.shape.interpolate.value),i=e.data.stroke.width;30>i&&(i=30),t.each(function(t){var o=!1,l=[],u=[],s=d3plus.util.copy(t),c=d3.select(this);s.values=[],t.values.forEach(function(n,r,a){u.push(n);var i=n[e[e.continuous_axis].value],c=e.tickValues[e.continuous_axis].indexOf(i);o===!1&&(o=c),r+o===c?(s.values.push(n),s.key+="_"+l.length):(r>0&&(l.push(s),s=d3plus.util.copy(t),s.values=[]),s.values.push(n),s.key+="_"+l.length,o++),r===a.length-1&&l.push(s)});var d=c.selectAll("path.d3plus_line").data(l,function(e){return e.key}),f=c.selectAll("rect.d3plus_anchor").data(u,function(e){return e.d3plus.id});e.draw.timing?(d.transition().duration(e.draw.timing).attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),d.enter().append("path").attr("class","d3plus_line").attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),f.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(e){return e.d3plus.id}).call(n).call(d3plus.shape.style,e),f.transition().duration(e.draw.timing).call(r).call(d3plus.shape.style,e),f.exit().transition().duration(e.draw.timing).call(n).remove()):(d.enter().append("path").attr("class","d3plus_line"),d.attr("d",function(e){return a(e.values)}).call(d3plus.shape.style,e),f.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(e){return e.d3plus.id}),f.call(r).call(d3plus.shape.style,e));var p=c.selectAll("path.d3plus_mouse").data(l,function(e){return e.key});p.enter().append("path").attr("class","d3plus_mouse").attr("d",function(e){return a(e.values)}).style("stroke","black").style("stroke-width",i).style("fill","none").style("stroke-linecap","round").attr("opacity",0),p.on(d3plus.evt.over,function(){e.draw.frozen||(d3.select(this.parentNode).selectAll("path.d3plus_line").transition().duration(e.timing.mouseevents).style("stroke-width",2*e.data.stroke.width),d3.select(this.parentNode).selectAll("rect").transition().duration(e.timing.mouseevents).style("stroke-width",2*e.data.stroke.width).call(r,2))}).on(d3plus.evt.out,function(){e.draw.frozen||(d3.select(this.parentNode).selectAll("path.d3plus_line").transition().duration(e.timing.mouseevents).style("stroke-width",e.data.stroke.width),d3.select(this.parentNode).selectAll("rect").transition().duration(e.timing.mouseevents).style("stroke-width",e.data.stroke.width).call(r))}),e.draw.timing?p.transition().duration(e.draw.timing).attr("d",function(e){return a(e.values)}).style("stroke-width",i):p.attr("d",function(e){return a(e.values)}).style("stroke-width",i),p.exit().remove()})}},{}],271:[function(){d3plus.shape.rect=function(e,t,n,r){function a(t){if(e.labels.value&&!t.d3plus.label){t.d3plus_label={w:0,h:0,x:0,y:0};var n=t.d3plus.r?2*t.d3plus.r:t.d3plus.width,r=t.d3plus.r?2*t.d3plus.r:t.d3plus.height;t.d3plus_share={w:n,h:d3.max([25,r/3]),x:0,y:0},t.d3plus_label.w=n,t.d3plus_label.h=r,t.d3plus_label.shape="circle"===e.shape.value?"circle":"square"}else t.d3plus.label&&(t.d3plus_label=t.d3plus.label);return[t]}function i(e){e.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function o(t){t.attr("x",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return-t/2}).attr("y",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return-t/2}).attr("width",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return t}).attr("height",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return t}).attr("rx",function(t){var n="circle"==e.shape.value,r=t.d3plus.r?2*t.d3plus.r:t.d3plus.width;return n?(r+2)/2:0}).attr("ry",function(t){var n="circle"==e.shape.value,r=t.d3plus.r?2*t.d3plus.r:t.d3plus.height;return n?(r+2)/2:0}).attr("transform",function(e){return"rotate"in e.d3plus?"rotate("+e.d3plus.rotate+")":""}).attr("shape-rendering",function(t){return"square"!=e.shape.value||"rotate"in t.d3plus?"auto":e.shape.rendering.value})}e.draw.timing?n.append("rect").attr("class","d3plus_data").call(i).call(d3plus.shape.style,e):n.append("rect").attr("class","d3plus_data"),e.draw.timing?t.selectAll("rect.d3plus_data").data(a).transition().duration(e.draw.timing).call(o).call(d3plus.shape.style,e):t.selectAll("rect.d3plus_data").data(a).call(o).call(d3plus.shape.style,e),e.draw.timing&&r.selectAll("rect.d3plus_data").transition().duration(e.draw.timing).call(i)}},{}],272:[function(){d3plus.shape.style=function(e,t){e.attr("fill",function(e){return e.d3plus&&e.d3plus.spline?"none":d3plus.shape.color(e,t)}).style("stroke",function(e){if(e.values)var n=d3plus.shape.color(e.values[0],t);else var n=d3plus.shape.color(e,t);return d3.rgb(n).darker(.5)}).style("stroke-width",t.data.stroke.width).attr("opacity",t.data.opacity).attr("vector-effect","non-scaling-stroke")}},{}],273:[function(e,t){var n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),a=e("../../core/fetch/text.js"),i=function(e){function t(t){t.attr("x",function(e){return e.d3plus.x}).attr("y",function(e){return e.d3plus.y-e.r-e.d3plus.label_height-h}).style("text-anchor","middle").attr("font-weight",e.labels.font.weight).attr("font-family",e.labels.font.family.value).attr("font-size","12px").style("fill",function(t){var n=r(e,t);return d3plus.color.legible(n)}).each(function(t){if(t.r>10&&i>10){var n=a(e,t,t.depth);d3plus.textwrap().container(d3.select(this)).height(i).text(n).width(c-2*h).draw()}}).attr("y",function(e){return e.d3plus.label_height=d3.select(this).node().getBBox().height,e.d3plus.y-e.r-e.d3plus.label_height-h}).selectAll("tspan").attr("x",function(e){return e.d3plus.x})}var i=e.labels.value&&!e.small?50:0;d3plus.array.sort(e.data.app,e.order.value||e.size.value,e.order.sort.value,e.color.value,e);var o=e.data.app.length;if(4>o)var l=o,u=1;else var s=e.width.viz/e.height.viz,l=Math.ceil(Math.sqrt(o*s)),u=Math.ceil(Math.sqrt(o/s));if(o>0)for(;(u-1)*l>=e.data.app.length;)u--;var c=e.width.viz/l,d=e.height.viz/u,f=d3.min(e.data.app,function(t){return e.size.value?n(e,t,e.size.value,null,"min"):0}),p=d3.max(e.data.app,function(t){return e.size.value?n(e,t,e.size.value):0}),h=5,g=20,v=d3.min([c,d])/2-2*h;v-=i;var m=e.size.scale.value.domain([f,p]).rangeRound([g,v]),y=d3.layout.pack().size([c-2*h,d-2*h-i]).value(function(t){return e.size.value?n(e,t,e.size.value):0}).padding(h).radius(function(e){return m(e)}),x=[],b=0;e.data.app.forEach(function(t,n){var r=y.nodes(t),a=c*n%e.width.viz,o=d*b;r.forEach(function(t){t.xoffset=a,t.yoffset=o+i,t.d3plus.static=t.depth<e.depth.value?!0:!1,t.d3plus.label=1==r.length?!1:!0}),x=x.concat(r),(n+1)%l==0&&b++});var w=v/d3.max(x,function(e){return e.r});x.forEach(function(e){e.x=(e.x-c/2)*w+c/2,e.d3plus.x=e.x+e.xoffset,e.y=(e.y-d/2)*w+d/2,e.d3plus.y=e.y+e.yoffset,e.r=e.r*w,e.d3plus.r=e.r}),x.sort(function(e,t){return e.depth-t.depth});var _=x.filter(function(e){return 0==e.depth}),k=e.group.selectAll("text.d3plus_bubble_label").data(_,function(t){return t.d3plus.label_height||(t.d3plus.label_height=0),t[e.id.nesting[t.depth]]});return k.enter().append("text").attr("class","d3plus_bubble_label").call(t).attr("opacity",0),k.transition().duration(e.draw.timing).call(t).attr("opacity",1),k.exit().attr("opacity",0).remove(),x};i.fill=!0,i.requirements=["data"],i.scale=1.05,i.shapes=["circle","donut"],i.tooltip="static",t.exports=i},{"../../core/fetch/color.js":78,"../../core/fetch/text.js":80,"../../core/fetch/value.js":81}],274:[function(e,t){var n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),a=e("../../core/fetch/data.js"),i=function(e){function t(t,n){t.attr("stroke",e.axes.ticks.color).attr("stroke-width",e.axes.ticks.width).attr("shape-rendering",e.shape.rendering.value).style("opacity",function(t){var r="log"==e[n].scale.value&&"1"!=t.toString().charAt(0);return r?.25:1})}function i(t,n){t.attr("x1",function(t){return"x"==n?e.x_scale(t):0}).attr("x2",function(t){return"x"==n?e.x_scale(t):c.width}).attr("y1",function(t){return"y"==n?e.y_scale(t):0}).attr("y2",function(t){return"y"==n?e.y_scale(t):c.height})}function o(e){return"number"==typeof e||"string"==typeof e?null:d3.keys(e)[0]}function l(e){if("number"==typeof e)return e;if("string"==typeof e)return parseFloat(e);var t=e[d3.keys(e)[0]];return"string"==typeof t?parseFloat(t):t}function u(t,n){t.attr("x1",function(e){return"y"==n?0:e.d3plus.x-c.margin.left}).attr("x2",function(e){return"y"==n?-5:e.d3plus.x-c.margin.left}).attr("y1",function(e){return"x"==n?c.height:e.d3plus.y-c.margin.top}).attr("y2",function(e){return"x"==n?c.height+5:e.d3plus.y-c.margin.top}).style("stroke",function(t){return d3plus.color.legible(r(e,t))}).style("stroke-width",e.data.stroke.width).attr("shape-rendering",e.shape.rendering.value)}function s(t){function a(e){e.attr("x2",function(e){var t="x"==e.axis?e.x:e.x-e.r;return t}).attr("y2",function(e){var t="y"==e.axis?e.y:e.y+e.r;return t}).style("stroke-width",0).attr("opacity",0)}var i=d3.event.type==d3plus.evt.click&&(e.tooltip.value.long||e.tooltip.html.value),o=[d3plus.evt.over,d3plus.evt.move].indexOf(d3.event.type)>=0;if(!i&&o&&"area"!=e.shape.value){if(t.data)var t=t.data;var l=[d3plus.util.copy(t.d3plus),d3plus.util.copy(t.d3plus)];l[0].axis="x",l[1].axis="y"}else var l=[];var u=U.selectAll("line.d3plus_axis_label").data(l,function(e){return e.axis+"_"+e.id});u.enter().append("line").attr("class","d3plus_axis_label").call(a).attr("x1",function(e){return"x"==e.axis?e.x:e.x-e.r}).attr("y1",function(e){return"y"==e.axis?e.y:e.y+e.r}).style("stroke",function(){return r(e,t)}).attr("shape-rendering",e.shape.rendering.value),u.transition().duration(e.timing.mouseevents).attr("class","d3plus_axis_label").attr("x2",function(t){return"x"==t.axis?t.x:c.margin.left-e.axes.ticks.size}).attr("y2",function(t){return"y"==t.axis?t.y:c.height+c.margin.top+e.axes.ticks.size}).style("stroke",function(){return d3plus.color.legible(r(e,t))}).style("stroke-width",e.data.stroke.width).attr("opacity",1),u.exit().transition().duration(e.timing.mouseevents).call(a).remove();var s=U.selectAll("text.d3plus_axis_label").data(l,function(e){return e.axis+"_"+e.id});s.enter().append("text").attr("class","d3plus_axis_label").attr("id",function(e){return e.axis+"_"+e.id}).text(function(r){var a=n(e,t.d3plus_data||t,e[r.axis].value);return e.format.value(a,e[r.axis].value)}).attr("x",function(t){return"x"==t.axis?t.x:c.margin.left-5-e.axes.ticks.size}).attr("y",function(t){return"y"==t.axis?t.y:c.height+c.margin.top+5+e.axes.ticks.size}).attr("dy",function(t){return"y"==t.axis?.35*e.axes.ticks.font.size:e.axes.ticks.font.size}).style("text-anchor",function(e){return"y"==e.axis?"end":"middle"}).attr("fill",function(){return d3plus.color.legible(r(e,t))}).attr("font-size",e.axes.ticks.font.size).attr("font-family",e.axes.ticks.font.family.value).attr("font-weight",e.axes.ticks.font.weight).attr("opacity",0),s.transition().duration(e.timing.mouseevents).delay(e.timing.mouseevents).attr("opacity",1),s.exit().transition().duration(e.timing.mouseevents).attr("opacity",0).remove();var d=U.selectAll("rect.d3plus_axis_label").data(l,function(e){return e.axis+"_"+e.id});d.enter().insert("rect","text").attr("class","d3plus_axis_label").attr("x",function(t){var n=d3.select("text#"+t.axis+"_"+t.id).node().getBBox().width,r="x"==t.axis?t.x:c.margin.left-e.axes.ticks.size;return"x"==t.axis?r-n/2-5:r-n-10}).attr("y",function(t){var n=d3.select("text#"+t.axis+"_"+t.id).node().getBBox().height,r="y"==t.axis?t.y:c.height+c.margin.top;return"x"==t.axis?r+e.axes.ticks.size:r-n/2-5}).attr("width",function(e){var t=d3.select("text#"+e.axis+"_"+e.id).node().getBBox();return t.width+10}).attr("height",function(e){var t=d3.select("text#"+e.axis+"_"+e.id).node().getBBox();return t.height+10}).style("stroke",function(){return d3plus.color.legible(r(e,t))}).attr("fill","white").style("stroke-width",e.data.stroke.width).attr("shape-rendering",e.shape.rendering.value).attr("opacity",0),d.transition().duration(e.timing.mouseevents).delay(e.timing.mouseevents).attr("opacity",1),d.exit().transition().duration(e.timing.mouseevents).attr("opacity",0).remove()}if(e.small)var c={margin:{top:0,right:0,bottom:0,left:0}};else var c={margin:{top:10,right:10,bottom:40,left:40}};if(c.width=e.width.viz-c.margin.left-c.margin.right,c.height=e.height.viz-c.margin.top-c.margin.bottom,e.data.app.length){if(e.tickValues||(e.tickValues={}),e.continuous_axis=null,e.opp_axis=null,e.stacked_axis=null,e.axes.values.forEach(function(t){if(e[t].stacked.value&&(e.stacked_axis=t),e.continuous_axis||"continuous"!=e[t].scale.value||(e.continuous_axis=t,e.opp_axis="x"==t?"y":"x"),e.data.changed||e.depth.changed||!e[t+"_range"]||e.time.fixed.value){if(e.dev.value&&d3plus.console.time("determining "+t+"-axis"),"share"==e[t].scale.value)e[t+"_range"]=[0,1],e.tickValues[t]=d3plus.util.buckets([0,1],11),e.stacked_axis=t;else if(e[t].stacked.value){if(e.time.fixed.value)var r=e.data.app;else var r=a(e,["all"]);var i=d3.nest().key(function(t){return t[e.x.value]}).rollup(function(r){return d3.sum(r,function(r){return n(e,r,e[t].value)})}).entries(r);e[t+"_range"]=[0,d3.max(i,function(e){return e.values})]}else if(e[t].domain instanceof Array)e[t+"_range"]=e[t].domain,e.tickValues[t]=d3plus.util.uniques(e.data.app,e[t].value),e.tickValues[t]=e.tickValues[t].filter(function(n){return n>=e[t+"_range"][0]&&n<=e[t+"_range"][1]});else if(e.time.fixed.value)e[t+"_range"]=d3.extent(e.data.app,function(r){return n(e,r,e[t].value)}),e.tickValues[t]=d3plus.util.uniques(e.data.app,e[t].value);else{var o=[];for(id in e.id.nesting)o=o.concat(e.data.grouped[e.id.nesting[id]].all);e[t+"_range"]=d3.extent(o,function(r){return n(e,r,e[t].value)}),e.tickValues[t]=d3plus.util.uniques(a(e,["all"]),e[t].value)}if(e[t+"_range"][0]===e[t+"_range"][1])if(e[t].value===e.time.value){var l=d3plus.util.closest(e.data.time.ticks,e[t+"_range"][0]),u=e.data.time.ticks.indexOf(l);if(u>0)e[t+"_range"][0]=e.data.time.ticks[u-1];else{var s=e.data.time.ticks[u+1]-l;e[t+"_range"][0]=new Date(l.getTime()-s)}if(u<e.data.time.ticks.length-1)e[t+"_range"][1]=e.data.time.ticks[u+1];else{var s=l-e.data.time.ticks[u-1];e[t+"_range"][1]=new Date(l.getTime()+s)}}else e[t+"_range"][0]-=1,e[t+"_range"][1]+=1;"y"==t&&(e.y_range=e.y_range.reverse()),e.dev.value&&d3plus.console.timeEnd("determining "+t+"-axis")}else e[t+"_range"]||(e[t+"_range"]=[-1,1])}),e.axes.mirror.value){var f=e.y_range.concat(e.x_range);e.x_range=d3.extent(f),e.y_range=d3.extent(f).reverse()}var p=e.data.app;if(p){if(e.dev.value&&d3plus.console.time("determining size scale"),e.size.value){if(e.time.fixed.value)var h=d3.extent(e.data.app,function(t){var r=n(e,t,e.size.value);return 0==r?null:r});else{var g=[];for(id in e.id.nesting)g=g.concat(e.data.grouped[e.id.nesting[id]].all);var h=d3.extent(g,function(t){var r=n(e,t,e.size.value);return 0==r?null:r})}h[0]&&h[1]||(h=[0,0])}else var h=[0,0];var v=Math.floor(d3.max([d3.min([c.width,c.height])/15,10])),m=10;if(h[0]==h[1])var m=v;var y=[m,v],x=e.size.scale.value.domain(h).rangeRound(y);e.dev.value&&d3plus.console.timeEnd("determining size scale")}var b={"font-size":e.axes.ticks.font.size,fill:e.axes.ticks.font.color,"font-family":e.axes.ticks.font.family.value,"font-weight":e.axes.ticks.font.weight};e.axes.values.forEach(function(t){var n="x"==t?c.width:c.height;if(["continuous","share"].indexOf(e[t].scale.value)>=0)var r="linear";else var r=e[t].scale.value;if(e[t+"_scale"]=d3.scale[r]().domain(e[t+"_range"]).rangeRound([0,n]),["square","circle","donut"].indexOf(e.shape.value)>=0&&["share"].indexOf(e[t].scale.value)<0){var a=e[t+"_scale"],i=2*x.range()[1],o=a.invert(-i),l=a.invert(n+i);e[t+"_scale"].domain([o,l])}var u="x"==t?"bottom":"left";if(e[t+"_axis"]=d3.svg.axis().tickSize(e.axes.ticks.size).tickPadding(5).orient(u).scale(e[t+"_scale"]).tickFormat(function(n){var r=!0;if(e[t].value==e.time.value&&n%1!=0&&(r=!1),("log"==e[t].scale.value&&"1"==n.toString().charAt(0)||"log"!=e[t].scale.value)&&r)if("share"==e[t].scale.value)var a=100*n+"%";else if(n.constructor===Date)var a=e.data.time.multiFormat(n);else var a=e.format.value(n,e[t].value);else var a=null;return a}),e[t].value===e.time.value){var s=e[t+"_range"];e[t].ticks=e.data.time.ticks.filter(function(e){return e<=s[1]&&e>=s[0]});var d=d3plus.util.closest(e.data.time.ticks,s[0]),f=d3plus.util.closest(e.data.time.ticks,s[1]);e[t].ticks.indexOf(d)<0&&e[t].ticks.unshift(d),e[t].ticks.indexOf(f)<0&&e[t].ticks.push(f)}else e[t].ticks=e.continuous_axis===t?e.tickValues[t]:e[t+"_scale"].ticks();e[t+"_axis"].tickValues(e[t].ticks)})}var w=e.y.ticks.map(function(t){return e.format.value(t,e.y.value)}),_=d3.max(d3plus.font.sizes(w,b),function(e){return e.width})+e.labels.padding;c.margin.left+=_,c.width-=_;var k=e.x.ticks.map(function(t){return e.format.value(t,e.x.value)}),M=d3plus.font.sizes(k,b),A=d3.max(M,function(e){return e.width}),z=d3.max(M,function(e){return e.height}),j=d3.min([c.width/(k.length+1),2*c.margin.left])-2*e.labels.padding;if(j>A){A+=e.labels.padding;var E="middle",S="0ex",T="translate(0,10)"}else{A=z+e.labels.padding,z=d3.max(M,function(e){return e.width});var E="start",S="0.5ex",T="translate(15,10)rotate(70)"}c.height-=z,c.width-=A/2,e.x_scale.rangeRound([0,c.width]),e.y_scale.rangeRound([0,c.height]);var N=e.group.selectAll("g#plane").data(["plane"]);N.enter().append("g").attr("id","plane").attr("transform","translate("+c.margin.left+","+c.margin.top+")");var O=N.selectAll("rect#background").data(["background"]);O.enter().append("rect").attr("id","background").attr("x",0).attr("y",0).attr("width",c.width).attr("height",c.height).attr("stroke-width",1).attr("stroke","#ccc").attr("shape-rendering",e.shape.rendering.value).attr("fill","#fafafa");var C=N.selectAll("path#mirror").data(["mirror"]);C.enter().append("path").attr("id","mirror").attr("fill","#000").attr("fill-opacity",.03).attr("stroke-width",1).attr("stroke","#ccc").attr("stroke-dasharray","10,10").attr("opacity",0);var F=e.group.selectAll("g#axes").data(["axes"]);F.enter().append("g").attr("id","axes");var q=N.selectAll("g#xgrid").data(["xgrid"]);q.enter().append("g").attr("id","xgrid");var P=N.selectAll("g#ygrid").data(["ygrid"]);P.enter().append("g").attr("id","ygrid");var L=N.selectAll("g#xaxis").data(["xaxis"]);L.enter().append("g").attr("id","xaxis").attr("transform","translate(0,"+c.height+")").call(e.x_axis.scale(e.x_scale)).selectAll("g.tick").select("text").attr(b).style("text-anchor",E).attr("dy",S).attr("transform",T);var I=N.selectAll("g#yaxis").data(["yaxis"]);I.enter().append("g").attr("id","yaxis").call(e.y_axis.scale(e.y_scale)).selectAll("g.tick").select("text").attr(b);var V=F.selectAll("text#xlabel").data(e.small?[]:["xlabel"]);V.enter().append("text").attr("id","xlabel").attr("x",e.width.viz/2).attr("y",e.height.viz-10).text(e.format.value(e.x.value)).attr("font-family",e.labels.font.family.value).attr("font-weight",e.labels.font.weight).attr("font-size",e.labels.font.size).attr("fill",e.labels.font.color).style("text-anchor",e.labels.font.align),V.exit().remove();var B=F.selectAll("text#ylabel").data(e.small?[]:["ylabel"]);B.enter().append("text").attr("id","ylabel").attr("y",15).attr("x",-(c.height/2+c.margin.top)).text(e.format.value(e.y.value)).attr("transform","rotate(-90)").attr("font-family",e.labels.font.family.value).attr("font-weight",e.labels.font.weight).attr("font-size",e.labels.font.size).attr("fill",e.labels.font.color).style("text-anchor",e.labels.font.align),B.exit().remove();var U=e.group.selectAll("g#mouseevents").data(["mouseevents"]);U.enter().append("g").attr("id","mouseevents"),N.transition().duration(e.draw.timing).attr("transform","translate("+c.margin.left+","+c.margin.top+")"),O.attr("width",c.width).attr("height",c.height),C.transition().duration(e.draw.timing).attr("opacity",function(){return e.axes.mirror.value?1:0}).attr("d",function(){var e=c.width,t=c.height;return"M "+e+" "+t+" L 0 "+t+" L "+e+" 0 Z"}),I.transition().duration(e.draw.timing).call(e.y_axis.scale(e.y_scale)).selectAll("g.tick").select("text").attr(b),I.selectAll("line").transition().duration(e.draw.timing).call(t,"y"),I.selectAll("path").attr("fill","none"),L.transition().duration(e.draw.timing).attr("transform","translate(0,"+c.height+")").call(e.x_axis.scale(e.x_scale)).selectAll("g.tick").select("text").attr(b).style("text-anchor",E).attr("dy",S).attr("transform",T),L.selectAll("line").transition().duration(e.draw.timing).call(t,"x"),L.selectAll("path").attr("fill","none");var D=P.selectAll("line").data(e.y.ticks);D.enter().append("line").style("opacity",0).call(i,"y").call(t,"y"),D.transition().duration(e.draw.timing).style("opacity",1).call(i,"y").call(t,"y"),D.exit().transition().duration(e.draw.timing).style("opacity",0).remove();var R=q.selectAll("line").data(e.x.ticks);R.enter().append("line").style("opacity",0).call(i,"x").call(t,"x"),R.transition().duration(e.draw.timing).style("opacity",1).call(i,"x").call(t,"x"),R.exit().transition().duration(e.draw.timing).style("opacity",0).remove(),V.text(e.format.value(e.x.value)).attr("x",e.width.viz/2).attr("y",e.height.viz-10).attr("opacity",function(){return 0==e.data.app.length?0:1}),B.text(e.format.value(e.y.value)).attr("y",15).attr("x",-(c.height/2+c.margin.top)).attr("opacity",function(){return 0==e.data.app.length?0:1}),e.axes.values.forEach(function(t){var n=N.selectAll("g.d3plus_"+t+"line").data(e[t].lines,function(e){return"number"==typeof e||"string"==typeof e?e:d3.keys(e)[0]}),r=n.enter().append("g").attr("class","d3plus_"+t+"line"),a="x"==t?"height":"width",i="x"==t?c.height-8+"px":"10px",u="x"==t?10:20;r.append("line").attr(t+"1",0).attr(t+"2",c[a]).attr("stroke","#ccc").attr("stroke-width",3).attr("stroke-dasharray","10,10"),r.append("text").attr("font-size",e.axes.ticks.font.size).attr("fill",e.axes.ticks.font.color).attr("text-align","start").attr(t,i),n.selectAll("line").transition().duration(e.draw.timing).attr(t+"1",function(n){return l(n)?e[t+"_scale"](l(n)):0}).attr(t+"2",function(n){return l(n)?e[t+"_scale"](l(n)):0}).attr("opacity",function(n){var r=l(n)>e[t+"_scale"].domain()[1]&&l(n)<e[t+"_scale"].domain()[0];return null!==l(n)&&r?1:0}),n.selectAll("text").transition().duration(e.draw.timing).text(function(){if(null!==l(d)){var t=e.format.value(l(d),y_name);return o(d)?e.format.value(o(d))+": "+t:t}return null}).attr(t,function(n){return e[t+"_scale"](l(n))+u+"px"})}),["line","area"].indexOf(e.shape.value)>=0&&x.rangeRound([2,2]),e.axis_offset={x:c.margin.left,y:c.margin.top},p.forEach(function(t){t.d3plus.x=e.x_scale(n(e,t,e.x.value)),t.d3plus.x+=e.axis_offset.x,t.d3plus.r=x(n(e,t,e.size.value)),e.stacked_axis||(t.d3plus.y=e.y_scale(n(e,t,e.y.value)),t.d3plus.y+=e.axis_offset.y,"area"==e.shape.value&&(t.d3plus[e.opp_axis+"0"]=e[e.opp_axis+"_scale"].range()[1],t.d3plus[e.opp_axis+"0"]+=e.axis_offset[e.opp_axis]))});var H=e.order.value?e.order.value:e.continuous_axis?e[e.opp_axis].value:e.size.value||e.id.value;if(["line","area"].indexOf(e.shape.value)>=0&&(p=d3.nest().key(function(t){var r=n(e,t,e.id.value),a=t.d3plus.depth?t.d3plus.depth:0;return d3plus.string.strip(r)+"_"+a+"_"+e.shape.value}).rollup(function(t){var n=d3plus.util.uniques(t,e[e.continuous_axis].value),r=!1,a=e[e.continuous_axis].value===e.time.value;return a&&n[0].constructor===Date&&(n=n.map(function(e){return e.getTime()})),e[e.continuous_axis].ticks.forEach(function(i,o,l){var u=a?i.getTime():i;if(n.indexOf(u)<0){var s={};if(s[e[e.continuous_axis].value]=i,s[e.id.value]=t[0][e.id.value],s[e[e.opp_axis].value]=e[e.opp_axis+"_scale"].domain()[1],s.d3plus={},s.d3plus.r=x(x.domain()[0]),s.d3plus[e.continuous_axis]+=e.axis_offset[e.continuous_axis],e.stacked_axis||(s.d3plus[e.opp_axis]=e[e.opp_axis+"_scale"].range()[1],s.d3plus[e.opp_axis]+=e.axis_offset[e.opp_axis],s.d3plus[e.opp_axis+"0"]=s.d3plus[e.opp_axis]),e[e.continuous_axis].zerofill.value||e[e.opp_axis].stacked.value){var c=e[e.continuous_axis+"_scale"](i);
c+=e.axis_offset[e.continuous_axis],s.d3plus[e.continuous_axis]=c,t.push(s)}else if("line"!=e.shape.value){if(!r&&o>0){var c=e[e.continuous_axis+"_scale"](l[o-1]);c+=e.axis_offset[e.continuous_axis],s.d3plus[e.continuous_axis]=c,t.push(s)}if(o<l.length-1){var c=e[e.continuous_axis+"_scale"](l[o+1]);c+=e.axis_offset[e.continuous_axis];var d=d3plus.util.copy(s);d.d3plus[e.continuous_axis]=c,t.push(d)}}r=!0}else r=!1}),t.sort(function(t,n){var r=t.d3plus[e.continuous_axis]-n.d3plus[e.continuous_axis];if(r)return r;var a=t[e[e.continuous_axis].value]-n[e[e.continuous_axis].value];return a}),t}).entries(p),p.forEach(function(t){"d3plus"in t.values[0]&&(t.d3plus||(t.d3plus={}),t.values.forEach(function(e){e.d3plus.merged instanceof Array&&(t.d3plus.merged||(t.d3plus.merged=[]),t.d3plus.merged=t.d3plus.merged.concat(e.d3plus.merged)),e.d3plus.text&&(t.d3plus.text=e.d3plus.text)})),e.id.nesting.forEach(function(n,r){r<=e.depth.value&&!t[n]&&(t[n]=d3plus.util.uniques(t.values,n).filter(function(e){return e&&"undefined"!=e})[0])}),H in t||(t[H]=0,t.values.forEach(function(r){var a=n(e,r,H);a&&("number"==typeof a?t[H]+=a:t[H]=a)}))})),H&&d3plus.array.sort(p,H,"desc"===e.order.sort.value?"asc":"desc",e.color.value||[],e),e.stacked_axis)var Y=d3.layout.stack().values(function(e){return e.values}).x(function(e){return e.d3plus.x}).y(function(t){var r=c.height,a=n(e,t,e.y.value);return r-e.y_scale(a)}).out(function(t,n,r){var a=c.height;"share"==e[e.stacked_axis].scale.value?(t.d3plus.y0=(1-n)*a,t.d3plus.y=t.d3plus.y0-r*a):(t.d3plus.y0=a-n,t.d3plus.y=t.d3plus.y0-r),t.d3plus.y+=c.margin.top,t.d3plus.y0+=c.margin.top}),X="share"==e[e.stacked_axis].scale.value?"expand":"zero",p=Y.offset(X)(p);else if(["area","line"].indexOf(e.shape.value)<0){var G=N.selectAll("g.d3plus_data_ticks").data(p,function(t){return t[e.id.value]+"_"+t.d3plus.depth}),Z=G.enter().append("g").attr("class","d3plus_data_ticks").attr("opacity",0);Z.append("line").attr("class","d3plus_data_y").call(u,"y"),G.selectAll("line.d3plus_data_y").call(u,"y"),Z.append("line").attr("class","d3plus_data_x").call(u,"x"),G.selectAll("line.d3plus_data_x").call(u,"x"),G.transition().duration(e.draw.timing).attr("opacity",1),G.exit().transition().duration(e.draw.timing).attr("opacity",0).remove()}return e.mouse=s,p};i.fill=!0,i.requirements=["data","x","y"],i.scale={circle:1.1,donut:1.1,square:1.1},i.setup=function(e){e.x.value===e.time.value&&e.self.x({scale:"continuous"}),e.y.value===e.time.value&&e.self.y({scale:"continuous"})},i.shapes=["circle","donut","line","square","area"],i.tooltip="static",t.exports=i},{"../../core/fetch/color.js":78,"../../core/fetch/data.js":79,"../../core/fetch/value.js":81}],275:[function(e,t){var n=function(e){topojson.presimplify(e.coords.value);var t=e.coords.value,n=d3.keys(t.objects)[0],r=topojson.feature(t,t.objects[n]),a=r.features,a=a.filter(function(t){return t[e.id.value]=t.id,e.coords.solo.value.length?e.coords.solo.value.indexOf(t.id)>=0:e.coords.mute.value.length?e.coords.mute.value.indexOf(t.id)<0:!0});return a};n.libs=["topojson"],n.nesting=!1,n.requirements=["color","coords"],n.scale=1,n.shapes=["coordinates"],n.tooltip="follow",n.zoom=!0,t.exports=n},{}],276:[function(e,t){var n=e("./chart.js"),r=function(e){return n(e)};r.requirements=["data","x","y"],r.setup=function(e){e.self.x({scale:"continuous"})},r.shapes=["line"],r.tooltip="static",t.exports=r},{"./chart.js":274}],277:[function(e,t){var n=e("../../core/fetch/value.js"),r=function(e){var t=e.nodes.restricted||e.nodes.value,r=e.edges.restricted||e.edges.value,a=d3.extent(t,function(e){return e.x}),i=d3.extent(t,function(e){return e.y}),o=e.size.value?d3.extent(t,function(t){var r=n(e,t,e.size.value);return 0===r?null:r}):[1,1];"undefined"==typeof o[0]&&(o=[1,1]);var l=d3.min(d3plus.util.distances(t)),u=e.size.value?e.nodes.overlap:.4;if(l*=u,e.edges.arrows.value&&(l=.5*l),o[0]===o[1])var s=l;else{var c=a[1]+1.1*l-(a[0]-1.1*l),d=i[1]+1.1*l-(i[0]-1.1*l);if(aspect=c/d,app=e.width.viz/e.height.viz,app>aspect)var f=e.height.viz/d;else var f=e.width.viz/c;var s=.25*l;2>s*f&&(s=2/f)}var p=e.size.scale.value.domain(o).range([s,l]);e.zoom.bounds=[[a[0]-1.1*l,i[0]-1.1*l],[a[1]+1.1*l,i[1]+1.1*l]];var h=[],g={};return t.forEach(function(t){var r=e.data.app.filter(function(n){return n[e.id.value]==t[e.id.value]})[0];if(r)var a=d3plus.object.merge(t,r);else var a=d3plus.util.copy(t);a.d3plus={},a.d3plus.x=t.x,a.d3plus.y=t.y;var i=n(e,a,e.size.value);a.d3plus.r=i?p(i):p.range()[0],g[a[e.id.value]]={x:a.d3plus.x,y:a.d3plus.y,r:a.d3plus.r},h.push(a)}),h.sort(function(e,t){return t.d3plus.r-e.d3plus.r}),r.forEach(function(t){t[e.edges.source].d3plus={};var n=g[t[e.edges.source][e.id.value]];t[e.edges.source].d3plus.r=n.r,t[e.edges.source].d3plus.x=n.x,t[e.edges.source].d3plus.y=n.y,t[e.edges.target].d3plus={};var r=g[t[e.edges.target][e.id.value]];t[e.edges.target].d3plus.r=r.r,t[e.edges.target].d3plus.x=r.x,t[e.edges.target].d3plus.y=r.y}),{nodes:h,edges:r}};r.nesting=!1,r.requirements=["nodes","edges"],r.scale=1.05,r.shapes=["circle","square","donut"],r.tooltip="static",r.zoom=!0,t.exports=r},{"../../core/fetch/value.js":81}],278:[function(e,t){var n,r,a,i=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};r=e("../../network/shortestPath.coffee"),n=e("../../core/fetch/value.js"),a=function(e){var t,r,o,l,u,s,c,d,f,p,h,g,v,m,y,x,b,w,_,k,M,A,z,j,E,S,T,N,O,C,F,q,P,L,I,V,B,U,D,R,H,Y,X,G,Z,W,J,Q,$,K,et,tt,nt,rt,at,it,ot,lt,ut,st,ct,dt,ft;for(c=[],z={},z[e.focus.value[0]]=0,z[e.focus.value[1]]=0,j={all:[[e.focus.value[0]],[e.focus.value[1]]]},it=a.paths,A=R=0,G=it.length;G>R;A=++R)for(M=it[A],c=c.concat(M.edges),g=e.focus.value[0],j[A]=[g],ot=M.edges,s=H=0,Z=ot.length;Z>H;s=++H)u=ot[s],u[e.edges.source]=e.data.app.filter(function(t){return u[e.edges.source][e.id.value]===t[e.id.value]})[0],u[e.edges.target]=e.data.app.filter(function(t){return u[e.edges.target][e.id.value]===t[e.id.value]})[0],b=u[e.edges.source][e.id.value]===g?"target":"source",w=u[e.edges[b]][e.id.value],void 0===z[w]&&(z[w]=A),j[A].push(w),g=w;N=0;for(A in j)if(M=j[A],"all"!==A){for(y=0,d=Y=0,W=M.length;W>Y;d=++Y)if(f=M[d],0!==d&&d!==M.length-1&&z[f]===parseFloat(A)){for(y=1,E=M[d-1],x=M[d+1],S=null,_=null,lt=j.all,r=X=0,J=lt.length;J>X;r=++X)t=lt[r],i.call(t,E)>=0&&(S=r),i.call(t,x)>=0&&(_=r);null!==S&&null===_?S+1===j.all.length-1?j.all.splice(S+1,0,[f]):j.all[S+1].push(f):_-S===1?j.all.splice(_,0,[f]):_-S>1&&j.all[_-1].push(f)}N+=y}for(T=Math.floor(e.height.viz/N),I=[],d=0;N>d;)d%2===0?I.push(d):I.unshift(d),d++;for(p=e.size.value&&!e.small?30:0,L=d3.scale.ordinal().domain(I).range(d3.range(T/2-p,e.height.viz+T/2-p,(e.height.viz-T)/(N-1))),l=j.all.length,o=Math.floor(e.width.viz/l),q=d3.scale.linear().domain([0,l-1]).rangeRound([o/2,e.width.viz-o/2]),m=5,v=.4*d3.min([o,T-p]),C=d3.extent(e.data.app,function(t){var r;return r=n(e,t,e.size.value),r||0}),O=e.size.scale.value.domain(C).rangeRound([m,v]),ut=e.data.app,tt=0,Q=ut.length;Q>tt;tt++){for(k=ut[tt],null==k.d3plus&&(k.d3plus={}),st=j.all,r=nt=0,$=st.length;$>nt;r=++nt)t=st[r],ct=k[e.id.value],i.call(t,ct)>=0&&(k.d3plus.x=q(r));k.d3plus.y=L(z[k[e.id.value]]),e.size.value?(F=n(e,k,e.size.value),k.d3plus.r=F?O(F):m):k.d3plus.r=v,k.d3plus.r<.1*o&&!e.small?k.d3plus.label={x:0,y:k.d3plus.r+2*e.labels.padding,w:.6*o,h:p+v-k.d3plus.r,resize:!1}:delete k.d3plus.label}for(dt=a.paths,A=rt=0,K=dt.length;K>rt;A=++rt)for(M=dt[A],g=e.focus.value[0],ft=M.edges,s=at=0,et=ft.length;et>at;s=++at)u=ft[s],b=u[e.edges.source][e.id.value]===g?"target":"source",h="target"===b?"source":"target",w=u[e.edges[b]][e.id.value],z[g]!==z[w]?(u.d3plus={spline:!0},null==(V=u[e.edges.source]).d3plus&&(V.d3plus={}),null==(B=u[e.edges.source].d3plus).edges&&(B.edges={}),null==(U=u[e.edges.target]).d3plus&&(U.d3plus={}),null==(D=u[e.edges.target].d3plus).edges&&(D.edges={}),P=u[b].d3plus.x-u[h].d3plus.x,u[h].d3plus.edges[u[b][e.id.value]]={angle:Math.PI,radius:o/2},u[b].d3plus.edges[u[h][e.id.value]]={angle:0,radius:o/2,offset:P-o}):delete u.d3plus,g=w;return{nodes:e.data.app,edges:c}},a.filter=function(e,t){var n,i,o,l,u,s,c,d,f,p,h,g,v,m,y,x,b,w,_;for(l=e.edges.filtered||e.edges.value,a.paths=r(l,e.focus.value[0],{target:e.focus.value[1],distance:e.edges.size||void 0,nodeid:e.id.value,startpoint:e.edges.source,endpoint:e.edges.target,K:e.edges.limit.value||5}),a.nodes=[],n=[],w=a.paths,g=0,y=w.length;y>g;g++)for(d=w[g],_=d.edges,v=0,x=_.length;x>v;v++)o=_[v],p=o[e.edges.source],h=o[e.edges.target],n.indexOf(p[e.id.value])<0&&(a.nodes.push(p),n.push(p[e.id.value])),n.indexOf(h[e.id.value])<0&&(a.nodes.push(h),n.push(h[e.id.value]));for(s=d3plus.util.uniques(a.nodes,e.id.value),f=[],m=0,b=s.length;b>m;m++)u=s[m],i=t.filter(function(t){return t[e.id.value]===u}),i[0]?f.push(i[0]):(c={d3plus:{}},c[e.id.value]=u,f.push(c));return f},a.nesting=!1,a.requirements=[function(e){return{status:2===e.focus.value.length,text:e.format.locale.value.method.focus+" x 2"}},"edges"],a.scale=1,a.shapes=["circle","square","donut"],a.tooltip="static",t.exports=a},{"../../core/fetch/value.js":81,"../../network/shortestPath.coffee":196}],279:[function(e,t){var n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),i=function(e){var t=d3.min([e.height.viz,e.width.viz])/2,i=e.small||!e.labels.value?(t-2*e.labels.padding)/2:t/3,o=e.small||!e.labels.value?1.4*i:i,l=2*i,u=[],s=[],c=e.data.app.filter(function(t){return t[e.id.value]===e.focus.value[0]})[0];c||(c={d3plus:{}},c[e.id.value]=e.focus.value[0]),c.d3plus.x=e.width.viz/2,c.d3plus.y=e.height.viz/2,c.d3plus.r=.65*o;var d=[],f=[e.focus.value[0]];e.edges.connections(e.focus.value[0],e.id.value).forEach(function(t){var n=t[e.edges.source][e.id.value]==e.focus.value[0]?t[e.edges.target]:t[e.edges.source],r=e.data.app.filter(function(t){return t[e.id.value]===n[e.id.value]})[0];r||(r={d3plus:{}},r[e.id.value]=n[e.id.value]),r.d3plus.edges=e.edges.connections(r[e.id.value],e.id.value).filter(function(t){return t[e.edges.source][e.id.value]!=e.focus.value[0]&&t[e.edges.target][e.id.value]!=e.focus.value[0]}),r.d3plus.edge=t,f.push(r[e.id.value]),d.push(r)});var p=e.order.value||e.color.value||e.size.value||e.id.value;d.sort(function(t,n){var r=t.d3plus.edges.length-n.d3plus.edges.length;return r?r:d3plus.array.sort([t,n],p,e.order.sort.value,e.color.value||[],e)}),"number"==typeof e.edges.limit.value?d=d.slice(0,e.edges.limit.value):"function"==typeof e.edges.limit.value&&(d=e.edges.limit.value(d));var h=[],g=0;d.forEach(function(t){var n=t[e.id.value];t.d3plus.edges=t.d3plus.edges.filter(function(t){var r=t[e.edges.source][e.id.value],a=t[e.edges.target][e.id.value];return f.indexOf(r)<0&&a==n||f.indexOf(a)<0&&r==n}),g+=t.d3plus.edges.length||1,t.d3plus.edges.forEach(function(t){var r=t[e.edges.source],a=t[e.edges.target],i=a[e.id.value]==n?r:a;f.push(i[e.id.value])})}),d3plus.array.sort(d,p,e.order.sort.value,e.color.value||[],e);var v=0,m=2*Math.PI,y=0;d.forEach(function(t,n){var r=t.d3plus.edges.length||1,i=m/g*r;0==n&&(y=u,v-=i/2);var u=v+i/2;u-=m/4,t.d3plus.radians=u,t.d3plus.x=e.width.viz/2+o*Math.cos(u),t.d3plus.y=e.height.viz/2+o*Math.sin(u),v+=i,t.d3plus.edges.sort(function(n,r){var n=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source],r=r[e.edges.source][e.id.value]==t[e.id.value]?r[e.edges.target]:r[e.edges.source];return d3plus.array.sort([n,r],p,e.order.sort.value,e.color.value||[],e)}),t.d3plus.edges.forEach(function(n,i){var o=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source],s=m/g,c=e.data.app.filter(function(t){return t[e.id.value]===o[e.id.value]})[0];c||(c={d3plus:{}},c[e.id.value]=o[e.id.value]),a=u-s*r/2+s/2+s*i,c.d3plus.radians=a,c.d3plus.x=e.width.viz/2+l*Math.cos(a),c.d3plus.y=e.height.viz/2+l*Math.sin(a),h.push(c)})});var x=d3.min(d3plus.util.distances(d,function(e){return[e.d3plus.x,e.d3plus.y]})),b=d3.min(d3plus.util.distances(h,function(e){return[e.d3plus.x,e.d3plus.y]}));if(x||(x=i/2),b||(b=i/4),8>x/2-4)var w=d3.min([x/2,8]);else var w=x/2-4;if(4>b/2-4)var _=d3.min([b/2,4]);else var _=b/2-4;_>i/10&&(_=i/10),_>w?_=.75*w:w>1.5*_&&(w=1.5*_),w=Math.floor(w),_=Math.floor(_);var k=d3plus.util.uniques(d,e.id.value);k=k.concat(d3plus.util.uniques(h,e.id.value)),k.push(e.focus.value[0]);var M=e.data.app.filter(function(t){return k.indexOf(t[e.id.value])>=0});if(e.size.value){var A=d3.extent(M,function(t){return n(e,t,e.size.value)});A[0]==A[1]&&(A[0]=0);var t=d3.scale.linear().domain(A).rangeRound([3,d3.min([w,_])]),z=n(e,c,e.size.value);c.d3plus.r=t(z)}else{var t=d3.scale.linear().domain([1,2]).rangeRound([w,_]);e.edges.label&&(c.d3plus.r=1.5*t(1))}return h.forEach(function(r){r.d3plus.ring=2;var a=e.size.value?n(e,r,e.size.value):2;r.d3plus.r=t(a)}),d.forEach(function(r){r.d3plus.ring=1;var a=e.size.value?n(e,r,e.size.value):1;r.d3plus.r=t(a)}),s=[c].concat(d).concat(h),d.forEach(function(t){var n=[e.edges.source,e.edges.target],r=t.d3plus.edge;n.forEach(function(t){r[t]=s.filter(function(n){return n[e.id.value]==r[t][e.id.value]})[0]}),delete r.d3plus,u.push(r),e.edges.connections(t[e.id.value],e.id.value).forEach(function(n){var r=n[e.edges.source][e.id.value]==t[e.id.value]?n[e.edges.target]:n[e.edges.source];if(r[e.id.value]!=c[e.id.value]){var a=h.filter(function(t){return t[e.id.value]==r[e.id.value]})[0];if(a);else{a=d.filter(function(t){return t[e.id.value]==r[e.id.value]})[0]}if(a){n.d3plus={spline:!0,translate:{x:e.width.viz/2,y:e.height.viz/2}};var o=[e.edges.source,e.edges.target];o.forEach(function(r,o){n[r]=s.filter(function(t){return t[e.id.value]==n[r][e.id.value]})[0],void 0===n[r].d3plus.edges&&(n[r].d3plus.edges={});var l=0===o?n[e.edges.target][e.id.value]:n[e.edges.source][e.id.value];n[r].d3plus.edges[l]=n[r][e.id.value]==t[e.id.value]?{angle:t.d3plus.radians+Math.PI,radius:i/2}:{angle:a.d3plus.radians,radius:i/2}}),u.push(n)}}})}),s.forEach(function(t){if(!e.small&&e.labels.value)if(t[e.id.value]!=e.focus.value[0]){t.d3plus.rotate=t.d3plus.radians*(180/Math.PI);var n=t.d3plus.rotate,a=i-3*e.labels.padding-t.d3plus.r;if(-90>n||n>90){n-=180;var l=-(t.d3plus.r+a/2+e.labels.padding),u="end"}else var l=t.d3plus.r+a/2+e.labels.padding,u="start";var s=d.indexOf(t)>=0?!0:!1,c=1==t.d3plus.ring?x:b;c+=2*e.labels.padding,t.d3plus.label={x:l,y:0,w:a,h:c,angle:n,anchor:u,valign:"center",color:d3plus.color.legible(r(e,t[e.id.value])),resize:[8,e.labels.font.size],background:s,mouse:!0}}else if(e.size.value||e.edges.label){var c=o-2*t.d3plus.r-2*e.labels.padding;t.d3plus.label={x:0,y:t.d3plus.r+c/2,w:o,h:c,color:d3plus.color.legible(r(e,t[e.id.value])),resize:[10,40],background:!0,mouse:!0}}else delete t.d3plus.rotate,delete t.d3plus.label;else delete t.d3plus.rotate,delete t.d3plus.label}),e.mouse[d3plus.evt.click]=function(t){t[e.id.value]!=e.focus.value[0]&&(d3plus.tooltip.remove(e.type.value),e.self.focus(t[e.id.value]).draw())},{edges:u,nodes:s,data:M}};i.filter=function(e,t){var n=e.edges.connections(e.focus.value[0],e.id.value,!0),r=[];n.forEach(function(t){r=r.concat(e.edges.connections(t[e.id.value],e.id.value,!0))});var a=n.concat(r),i=d3plus.util.uniques(a,e.id.value),o=[];return i.forEach(function(n){var r=t.filter(function(t){return t[e.id.value]==n})[0];if(r)o.push(r);else{var a={d3plus:{}};a[e.id.value]=n,o.push(a)}}),o},i.nesting=!1,i.scale=1,i.shapes=["circle","square","donut"],i.requirements=["edges","focus"],i.tooltip="static",t.exports=i},{"../../core/fetch/color.js":78,"../../core/fetch/value.js":81}],280:[function(e,t){var n=e("./chart.js"),r=function(e){return n(e)};r.fill=!0,r.requirements=["data","x","y"],r.scale=n.scale,r.setup=n.setup,r.shapes=["circle","square","donut"],r.tooltip="static",t.exports=r},{"./chart.js":274}],281:[function(e,t){var n=e("./chart.js"),r=e("../../core/data/threshold.js"),a=function(e){return n(e)};a.filter=function(e,t){return r(e,t,e.x.value)},a.requirements=["data","x","y"],a.setup=function(e){e.self.x({scale:"continuous",zerofill:!0}).y({stacked:!0});var t=e.y,n=e.size;!t.value&&n.value||n.changed&&n.previous===t.value?e.self.y(n.value):(!n.value&&t.value||t.changed&&t.previous===n.value)&&e.self.size(t.value)},a.shapes=["area"],a.threshold=function(e){return 20/e.height.viz},a.tooltip="static",t.exports=a},{"../../core/data/threshold.js":77,"./chart.js":274}],282:[function(e,t){var n=e("../../core/data/threshold.js"),r=e("../../core/fetch/value.js"),a=function(e){var t=d3.nest();e.id.nesting.forEach(function(n,a){a<e.depth.value&&t.key(function(t){return r(e,t.d3plus,n)})});var n=[];e.data.app.forEach(function(t){var a=r(e,t,e.size.value);a&&"number"==typeof a&&n.push({d3plus:t,id:t[e.id.value],value:r(e,t,e.size.value)})}),t=t.entries(n);var a=d3.layout.treemap().mode(e.type.mode.value).round(!0).size([e.width.viz,e.height.viz]).children(function(e){return e.values}).padding(1).sort(function(e,t){var n=e.value-t.value;return 0===n?e.id<t.id:n}).nodes({name:"root",values:t}).filter(function(e){return!e.values&&e.area});if(a.length){for(var i=a[0];i.parent;)i=i.parent;var o=[];a.forEach(function(e){e.d3plus.d3plus=d3plus.object.merge(e.d3plus.d3plus,{x:e.x+e.dx/2,y:e.y+e.dy/2,width:e.dx,height:e.dy,share:e.value/i.value}),o.push(e.d3plus)})}return o};a.filter=function(e,t){return n(e,t)},a.modes=["squarify","slice","dice","slice-dice"],a.requirements=["data","size"],a.shapes=["square"],a.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},a.tooltip="follow",t.exports=a},{"../../core/data/threshold.js":77,"../../core/fetch/value.js":81}],283:[function(){d3plus.ui.drawer=function(e){var t=e.ui.value&&e.ui.value.length,n=e.ui.position.value;e.dev.value&&t&&d3plus.console.time("drawing custom UI elements");var r=e.container.value.selectAll("div#d3plus_drawer").data(["d3plus_drawer"]);r.enter().append("div").attr("id","d3plus_drawer");var a={};e.ui.position.accepted.forEach(function(t){a[t]=t==n?e.margin.bottom+"px":"auto"}),r.style("text-align",e.ui.align.value).style("position","absolute").style("width",e.width.value-2*e.ui.padding+"px").style("height","auto").style(a);var i=r.selectAll("div.d3plus_drawer_ui").data(t?e.ui.value:[],function(e){return e.method||!1});i.enter().append("div").attr("class","d3plus_drawer_ui").style("padding",e.ui.padding+"px").style("display","inline-block").each(function(t){var n=d3.select(this);t.form=d3plus.form().container(n).focus(e[t.method].value,function(n){n[0]!==e[t.method].value&&e.self[t.method](n[0]).draw()}).id("id").text("text").type("auto")}),i.each(function(t){var n=[],r=e.format.locale.value.method[t.method]||t.method;t.value.forEach(function(t){var r={id:t,text:e.format.value(t)};n.push(r)});var a=d3plus.util.copy(e.ui.font);a.secondary=e.ui.font,t.form.data(n).font(a).format(e.format.locale.language).title(e.format.value(r)).ui({align:e.ui.align.value,padding:e.ui.padding,margin:0}).width(t.width||!1).draw()}),i.exit().remove();var o=r.node().offsetHeight||r.node().getBoundingClientRect().height;o&&(e.margin[n]+=o),e.dev.value&&t&&d3plus.console.timeEnd("drawing custom UI elements")}},{}],284:[function(e){var t=e("../../core/fetch/value.js");d3plus.ui.focus=function(e){if(!e.internal_error&&1===e.focus.value.length&&e.focus.value.length&&!e.small&&e.focus.tooltip.value){e.dev.value&&d3plus.console.time("drawing focus tooltip");var n=e.data.pool.filter(function(n){return t(e,n,e.id.value)==e.focus.value[0]});n.length>=1?n=n[0]:(n={},n[e.id.value]=e.focus.value[0]);var r=e.labels.padding;d3plus.tooltip.app({anchor:"top left",arrow:!1,data:n,length:"long",fullscreen:!1,id:e.type.value+"_focus",maxheight:e.height.viz-2*r,mouseevents:!0,offset:0,vars:e,x:e.width.value-e.margin.right-r,y:e.margin.top+r,width:e.tooltip.large}),d3.select("div#d3plus_tooltip_id_"+e.type.value+"_focus").empty()||(e.width.viz-=e.tooltip.large+2*r),e.dev.value&&d3plus.console.timeEnd("drawing focus tooltip")}else d3plus.tooltip.remove(e.type.value+"_focus")}},{"../../core/fetch/value.js":81}],285:[function(){d3plus.ui.history=function(e){function t(t){t.style("position","absolute").style("left",e.ui.padding+"px").style("top",e.margin.top/2-r/2+"px").style("color",a).style("font-family",i).style("font-weight",o).style("font-size",r+"px").style("z-index",2e3)}if(!e.small&&e.history.states.length>0){e.dev.value&&d3plus.console.time("drawing back button");var n=e.container.value.selectAll("div#d3plus_back_button").data(["d3plus_back_button"]),r=e.title.value?e.title.font.size:e.title.sub.font.size,a=e.title.sub.value?e.title.sub.font.color:e.title.font.color,i=e.title.sub.value?e.title.sub.font.family.value:e.title.font.family.value,o=e.title.sub.value?e.title.sub.font.weight:e.title.font.weight,l=e.title.sub.value?e.title.sub.padding:e.title.padding,u=r+2*l;e.margin.top<u&&(e.margin.top=u);{n.enter().append("div").attr("id","d3plus_back_button").style("opacity",0).call(t).html(function(){if(d3plus.font.awesome)var t="<span style='font-family:FontAwesome;margin-right:5px;'>&#xf104</span>";else var t="&laquo; ";return t+e.format.value(e.format.locale.value.ui.back)})}n.on(d3plus.evt.over,function(){!e.small&&e.history.states.length>0&&d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("color",d3plus.color.lighter(a,.25))}).on(d3plus.evt.out,function(){!e.small&&e.history.states.length>0&&d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("color",a)}).on(d3plus.evt.click,function(){e.history.back()}).transition().duration(e.draw.timing).style("opacity",1).call(t),e.dev.value&&d3plus.console.timeEnd("drawing back button")}else e.container.value.selectAll("div#d3plus_back_button").transition().duration(e.draw.timing).style("opacity",0).remove()}},{}],286:[function(e){var t=e("../../core/data/nest.js"),n=e("../../core/fetch/value.js"),r=e("../../core/fetch/color.js"),a=e("../../core/fetch/text.js");d3plus.ui.legend=function(e){function i(t){t.attr("transform",function(t,n){var r=b+n*(e.ui.padding+u);return"translate("+r+","+e.ui.padding+")"})}function o(t){t.attr("width",u).attr("height",u).attr("fill",function(t){d3.select(this.parentNode).selectAll("text").remove();var i="depth"in t.d3plus?t.d3plus.depth:e.depth.value,o=e.id.nesting[i],l=n(e,t,e.icon.value,o),s=r(e,t,o);if(l&&"null"!==l){var d=d3plus.string.strip(l+"_"+s),f=e.icon.style.value,p=e.defs.selectAll("pattern#"+d).data([d]);if("string"==typeof f)var h=e.icon.style.value;else if(d3plus.object.validate(f)&&f[o])var h=f[o];else var h="default";var s="knockout"==h?s:"none";p.select("rect").transition().duration(e.draw.timing).attr("fill",s).attr("width",u).attr("height",u),p.select("image").transition().duration(e.draw.timing).attr("width",u).attr("height",u);var g=p.enter().append("pattern").attr("id",d).attr("width",u).attr("height",u);return g.append("rect").attr("fill",s).attr("width",u).attr("height",u),g.append("image").attr("xlink:href",l).attr("width",u).attr("height",u).each(function(){0==l.indexOf("/")||l.indexOf(window.location.hostname)>=0?d3plus.util.dataurl(l,function(e){p.select("image").attr("xlink:href",e)}):p.select("image").attr("xlink:href",l)}),"url(#"+d+")"}var v=d3.select(this.parentNode).append("text");return v.attr("font-size",e.legend.font.size).attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).style("text-anchor","start").attr("fill",d3plus.color.text(s)).attr("x",0).attr("y",0).each(function(t){var r=e.id.nesting.indexOf(j),i=r>=0?a(e,t,r):[e.format.value(n(e,t,c,j))];1===i.length&&i[0].length&&d3plus.textwrap().container(d3.select(this)).height(u-2*e.ui.padding).resize(e.labels.resize.value).text(i[0]).width(u-2*e.ui.padding).draw()}).attr("y",function(){var e=this.getBBox().height,t=parseFloat(d3.select(this).style("font-size"),10)/5;return u/2-e/2-t/2}).selectAll("tspan").attr("x",function(){var e=this.getComputedTextLength();return u/2-e/2}),v.select("tspan").empty()&&v.remove(),s})}var l=!0,u=0,s=e.color.value,c=e.color.value||"d3plus_color";if(!e.internal_error&&s&&!e.small&&e.legend.value)if(e.color.valueScale)if(e.color.valueScale){e.dev.value&&d3plus.console.time("drawing color scale"),e.g.legend.selectAll("g.d3plus_color").transition().duration(e.draw.timing).attr("opacity",0).remove();var d=e.color.valueScale.domain(),f=e.color.valueScale.range();d.length<=2&&(d=d3plus.util.buckets(d,6));var p=e.g.legend.selectAll("g.d3plus_scale").data(["scale"]);p.enter().append("g").attr("class","d3plus_scale").attr("opacity",0);var h=p.selectAll("#d3plus_legend_heatmap").data(["heatmap"]);h.enter().append("linearGradient").attr("id","d3plus_legend_heatmap").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");var g=h.selectAll("stop").data(d3.range(0,f.length));g.enter().append("stop").attr("stop-opacity",1),g.attr("offset",function(e){return Math.round(e/(f.length-1)*100)+"%"}).attr("stop-color",function(e){return f[e]}),g.exit().remove();var v=p.selectAll("rect#gradient").data(["gradient"]);v.enter().append("rect").attr("id","gradient").attr("x",function(){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",e.ui.padding).attr("width",0).attr("height",e.legend.gradient.height).attr("stroke",e.legend.font.color).attr("stroke-width",1).style("fill","url(#d3plus_legend_heatmap)");var m=p.selectAll("text.d3plus_tick").data(d3.range(0,d.length));m.enter().append("text").attr("class","d3plus_tick").attr("x",function(){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",function(){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding});var y=0;m.order().attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).attr("font-size",e.legend.font.size).style("text-anchor",e.legend.font.align).attr("fill",e.legend.font.color).text(function(t){return e.format.value(d[t],s)}).attr("y",function(){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding}).each(function(){var e=this.offsetWidth;e>y&&(y=e)}),y+=2*e.labels.padding;var x=y*(d.length-1);if(x+y<e.width.value){if(x+y<e.width.value/2&&(x=e.width.value/2,y=x/d.length,x-=y),"start"==e.legend.align)var b=e.ui.padding;else if("end"==e.legend.align)var b=e.width.value-e.ui.padding-x;else var b=e.width.value/2-x/2;m.transition().duration(e.draw.timing).attr("x",function(e){return b+y*e}),m.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();var w=p.selectAll("rect.d3plus_tick").data(d3.range(0,d.length));w.enter().append("rect").attr("class","d3plus_tick").attr("x",function(){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0}).attr("y",e.ui.padding).attr("width",0).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),w.transition().duration(e.draw.timing).attr("x",function(e){var t=0==e?1:0;return b+y*e-t}).attr("y",e.ui.padding).attr("width",1).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),w.exit().transition().duration(e.draw.timing).attr("width",0).remove(),v.transition().duration(e.draw.timing).attr("x",function(){return"middle"==e.legend.align?e.width.value/2-x/2:"end"==e.legend.align?e.width.value-x-e.ui.padding:e.ui.padding}).attr("y",e.ui.padding).attr("width",x).attr("height",e.legend.gradient.height),p.transition().duration(e.draw.timing).attr("opacity",1),e.dev.value&&d3plus.console.timeEnd("drawing color scale")}else l=!1}else l=!1;else{if(e.dev.value&&d3plus.console.time("grouping data by colors"),e.nodes.value&&e.types[e.type.value].requirements.indexOf("nodes")>=0){var _=e.nodes.restriced||e.nodes.value;if(e.data.app.length)for(var k=0;k<_.length;k++){var M=e.data.app.filter(function(t){return t[e.id.value]===_[k][e.id.value]});M.length&&(_[k]=d3plus.object.merge(_[k],M[0]))}}else var _=e.data.app;var A=function(t){return r(e,t,j)},z=0,j=e.id.value;if(e.id.nesting.indexOf(c)>=0)z=e.id.nesting.indexOf(e.color.value),j=e.id.nesting[e.id.nesting.indexOf(c)];else for(var k=0;k<=e.depth.value;k++){z=k,j=e.id.nesting[k];var E=d3plus.util.uniques(_,function(t){return n(e,t,j)}),S=d3plus.util.uniques(_,A);if(E.length===S.length&&S.length>1)break}var f=t(e,_,[A],[]);e.dev.value&&d3plus.console.timeEnd("grouping data by color");var T=e.width.value;u=e.legend.size;var x=u*f.length+e.ui.padding*(f.length+1);if(u instanceof Array){e.dev.value&&d3plus.console.time("calculating legend size");for(var k=u[1];k>=u[0];k--)if(x=k*f.length+e.ui.padding*(f.length+1),T>=x){u=k;break}e.dev.value&&d3plus.console.timeEnd("calculating legend size")}else"number"!=typeof u&&u!==!1&&(u=30);if(x>T||1==f.length)l=!1;else{x-=2*e.ui.padding,e.dev.value&&d3plus.console.time("sorting legend");var N=e[e.legend.order.value].value;if(d3plus.array.sort(f,N,e.legend.order.sort.value,c,e),e.dev.value&&d3plus.console.timeEnd("sorting legend"),e.dev.value&&d3plus.console.time("drawing legend"),"start"==e.legend.align)var b=e.ui.padding;else if("end"==e.legend.align)var b=T-e.ui.padding-x;else var b=T/2-x/2;e.g.legend.selectAll("g.d3plus_scale").transition().duration(e.draw.timing).attr("opacity",0).remove();var O=e.g.legend.selectAll("g.d3plus_color").data(f,function(t){var a=r(e,t,j),i=n(e,t,c);return a+i}),C=O.enter().append("g").attr("class","d3plus_color").attr("opacity",0).call(i);C.append("rect").attr("class","d3plus_color").call(o),d3plus.touch||O.on(d3plus.evt.over,function(t,r){d3.select(this).style("cursor","pointer");var i=b+r*(e.ui.padding+u),o=d3.transform(d3.select(this.parentNode).attr("transform")).translate[1];i+=u/2,o+=e.ui.padding+u/2;var l=e.id.nesting.indexOf(j),s=l>=0?a(e,t,l)[0]:e.format.value(n(e,t,c,j));d3plus.tooltip.app({data:t,footer:!1,vars:e,x:i,y:o,title:s,offset:.4*u})}).on(d3plus.evt.out,function(){d3plus.tooltip.remove(e.type.value)}),O.order().transition().duration(e.draw.timing).attr("opacity",1).call(i),O.selectAll("rect.d3plus_color").transition().duration(e.draw.timing).call(o),O.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.dev.value&&d3plus.console.timeEnd("drawing legend")}}else l=!1;if(e.legend.value&&s&&l){if(e.dev.value&&d3plus.console.time("positioning legend"),u)var F=u+e.ui.padding;else var q=e.g.legend.node().getBBox(),F=q.height+q.y-e.ui.padding;0===e.margin.bottom&&(e.margin.bottom+=e.ui.padding),e.margin.bottom+=F,e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+(e.height.value-e.margin.bottom)+")"),e.dev.value&&d3plus.console.timeEnd("positioning legend")}else e.dev.value&&d3plus.console.time("hiding legend"),e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+e.height.value+")"),e.dev.value&&d3plus.console.timeEnd("hiding legend")}},{"../../core/data/nest.js":76,"../../core/fetch/color.js":78,"../../core/fetch/text.js":80,"../../core/fetch/value.js":81}],287:[function(){d3plus.ui.message=function(e,t){function n(t){t.style(a).style("position","absolute").style("background",o).style("text-align","center").style("left",function(){return"center"==i?"50%":"0px"}).style("width",function(){return"center"==i?"auto":e.width.value+"px"}).style("margin-left",function(){var t=e.width.value-e.width.viz;return"center"==i?-(this.offsetWidth/2+t/2)+"px":"0px"}).style("top",function(){return"center"==i?"50%":"top"==i?"0px":"auto"}).style("bottom",function(){return"bottom"==i?"0px":"auto"}).style("margin-top",function(){if("large"==r){var e=this.offsetHeight||this.getBoundingClientRect().height;return-e/2+"px"}return"0px"})}var t=e.messages.value?t:null,r=t==e.internal_error?"large":e.messages.style;if("large"==r)var a=e.messages,i="center";else{if(e.footer.value)var a=e.footer;else if(e.title.value)var a=e.title;else if(e.title.sub.value)var a=e.title.sub;else if(e.title.total.value)var a=e.title.total;else var a=e.title.sub;var i=a.position}var a={color:a.font.color,"font-family":a.font.family.value,"font-weight":a.font.weight,"font-size":a.font.size+"px",padding:a.padding+"px"},o="none"!=e.background.value?e.background.value:"white";
e.g.message=e.container.value.selectAll("div#d3plus_message").data(["message"]),e.g.message.enter().append("div").attr("id","d3plus_message").attr("opacity",0);var l=t?1:0,u=t?t:e.g.message.text(),s=t?"inline-block":"none";e.g.message.text(u).style("opacity",l).style("display",s).call(n)}},{}],288:[function(){d3plus.ui.timeline=function(e){if((!e.internal_error||!e.data.missing)&&!e.small&&e.data.time&&e.data.time.values.length>1&&e.timeline.value){var t=[];e.data.time.values.forEach(function(e){t.push(new Date(e))}),e.dev.value&&d3plus.console.time("drawing timeline");var n=e.time.format.value||e.data.time.format,r=e.time.format.value||e.data.time.multiFormat;if(e.time.value==e.x.value&&"continuous"==e.x.scale.value||e.time.value==e.y.value&&"continuous"==e.y.scale.value)var a=2;else var a=1;if(e.time.solo.value.length){for(var i=d3.extent(e.time.solo.value),o=0;o<i.length;o++)if(i[o].constructor!==Date){var l=new Date(i[o].toString());l.setTime(l.getTime()+60*l.getTimezoneOffset()*1e3),i[o]=l}}else var i=d3.extent(t);var u=t[0],s=new Date(i[0]),c=new Date(i[1]);t=e.data.time.ticks;var d=t.slice(),l=new Date(u);l["set"+e.data.time.stepType](l["get"+e.data.time.stepType]()+t.length),d.push(l),c["set"+e.data.time.stepType](c["get"+e.data.time.stepType]()+1),s=d3plus.util.closest(d,s),c=d3plus.util.closest(d,c);for(var f=d.slice(0),o=0;o<f.length;o++)f[o]=f[o].getTime();var p=f.indexOf(s.getTime()),h=f.indexOf(c.getTime()),g=function(){if(null!==d3.event.sourceEvent){j=q.extent();var e=d3plus.util.closest(d,j[0]),n=d3plus.util.closest(d,j[1]);if(e===n&&(p=f.indexOf(e.getTime()),e<j[0]||0===p?n=d[p+1]:e=d[p-1]),p=f.indexOf(e.getTime()),h=f.indexOf(n.getTime()),h-p>=a)var r=[e,n];else if(p+a<=t.length)var r=[e,d[p+a]];else{for(var r=[e],i=1;a>=i;i++)p+i<=t.length?r.push(d[p+i]):r.unshift(d[p-(p+i-t.length)]);r=[r[0],r[r.length-1]]}j=r,C.attr("fill",E),d3.select(this).call(q.extent(r))}},v=function(){if(null!==d3.event.sourceEvent){if(e.time.solo.value.length)var n=d3.extent(e.time.solo.value),r=f.indexOf(d3plus.util.closest(d,n[0]).getTime()),a=f.indexOf(d3plus.util.closest(d,n[1]).getTime())+1,i=r!==p||a!==h;else var i=h-p!==t.length;if(i){if(h-p==t.length)var o=[];else var o=d3.range(p,h).map(function(n){var r=e.data.time.dataSteps.indexOf(n);return r>=0?e.data.time.values[r]:t[n]});e.self.time({solo:o}).draw()}}},m={"font-weight":e.ui.font.weight,"font-family":e.ui.font.family.value,"font-size":e.ui.font.size,"text-anchor":"middle"},y=function(e,a){return 0===a||a===t.length-1?n(e):r(e)},x=d3plus.font.sizes(t.map(y),m),b=x.map(function(e){return e.width}),w=d3.max(b),_=d3.max(x.map(function(e){return e.height})),k=w+2*e.ui.padding,M=_+2*e.ui.padding;timeline_width=k*t.length,available_width=e.width.value-2*e.ui.padding,tickStep=1,textRotate=0,timeline_width>available_width&&(k=_+2*e.ui.padding,M=w+2*e.ui.padding,timeline_width=k*t.length,textRotate=90),M=d3.max([M,e.timeline.height.value]);var A=k;if(timeline_width>available_width&&(timeline_width=available_width,A=k-2*e.ui.padding,k=timeline_width/t.length,A>k))for(tickStep=Math.ceil(A/(timeline_width/t.length));tickStep<t.length-1&&(t.length-1)%tickStep!=0;tickStep++);if("start"==e.timeline.align)var z=e.ui.padding;else if("end"==e.timeline.align)var z=e.width.value-e.ui.padding-timeline_width;else var z=e.width.value/2-timeline_width/2;var j=[s,c],E=function(t){if(t>=j[0]&&t<j[1])var n=1,r=d3plus.color.text(e.ui.color.primary.value);else var n=.5,r=d3plus.color.text(e.ui.color.secondary.value);var r=d3.rgb(r);return"rgba("+r.r+","+r.g+","+r.b+","+n+")"},S=e.g.timeline.selectAll("rect.d3plus_timeline_background").data(["background"]);S.enter().append("rect").attr("class","d3plus_timeline_background").attr("shape-rendering","crispEdges").attr("width",timeline_width+2).attr("height",M+2).attr("fill",e.ui.color.secondary.value).attr("x",z-1).attr("y",e.ui.padding),S.transition().duration(e.draw.timing).attr("width",timeline_width+2).attr("height",M+2).attr("fill",e.ui.color.secondary.value).attr("x",z-1).attr("y",e.ui.padding);var T=e.g.timeline.selectAll("g#ticks").data(["ticks"]);T.enter().append("g").attr("id","ticks").attr("transform","translate("+e.width.value/2+","+e.ui.padding+")");var N=e.g.timeline.selectAll("g#brush").data(["brush"]);N.enter().append("g").attr("id","brush");var O=e.g.timeline.selectAll("g#labels").data(["labels"]);O.enter().append("g").attr("id","labels");var C=O.selectAll("text").data(t,function(e,t){return t});C.enter().append("text").attr("y",0).attr("dy","0.5ex").attr("x",0),C.order().attr(m).text(function(a,i){if(0===i||i===t.length-1)return n(a);{var o=(i-1)%tickStep===0,l=(i+1)%tickStep===0,u=e.data.time.dataSteps.indexOf(i)>=0;b[i-1]/2+b[i]+b[i+1]/2+4*e.ui.padding<2*k}return i%tickStep===0||!o&&!l&&u&&3*k>A?r(a):""}).attr("opacity",function(t,n){return e.data.time.dataSteps.indexOf(n)>=0?1:.4}).attr("fill",E).attr("transform",function(t,n){var r=z+k*n+k/2,a=M/2+e.ui.padding+1;return"translate("+Math.round(r)+","+Math.round(a)+")rotate("+textRotate+")"}),C.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();var F=d3.time.scale().domain(d3.extent(d)).rangeRound([0,timeline_width]),q=d3.svg.brush().x(F).extent(j).on("brush",g).on("brushend",v);if(T.attr("transform","translate("+z+","+e.ui.padding+")").transition().duration(e.draw.timing).call(d3.svg.axis().scale(F).orient("top").ticks(function(){return d}).tickFormat("").tickSize(-M).tickPadding(0)).selectAll("path").attr("fill","none"),T.selectAll("line").attr("stroke",e.timeline.tick).attr("stroke-width",1).attr("shape-rendering","crispEdges"),N.attr("transform","translate("+z+","+(e.ui.padding+1)+")").attr("opacity",1).call(q),C.attr("pointer-events","none"),N.selectAll("rect.background").attr("fill","none").style("visibility","visible").attr("height",M).attr("shape-rendering","crispEdges").on(d3plus.evt.move,function(){var t=e.timeline.hover.value;["grab","grabbing"].indexOf(t)>=0&&(t=d3plus.prefix()+t),d3.select(this).style("cursor",t)}),N.selectAll("rect.extent").attr("height",M).attr("fill",e.ui.color.primary.value).attr("shape-rendering","crispEdges").on(d3plus.evt.move,function(){var t=e.timeline.hover.value;["grab","grabbing"].indexOf(t)>=0&&(t=d3plus.prefix()+t),d3.select(this).style("cursor",t)}),e.timeline.handles.value){var P=N.selectAll("g.resize").selectAll("rect.d3plus_handle").data(["d3plus_handle"]);P.enter().insert("rect","rect").attr("class","d3plus_handle"),P.attr("fill",e.timeline.handles.color).attr("transform",function(){var t="resize e"===this.parentNode.className.baseVal?-e.timeline.handles.size:0;return"translate("+t+",0)"}).attr("width",e.timeline.handles.size).style("visibility","visible").attr("shape-rendering","crispEdges").attr("opacity",e.timeline.handles.opacity).on(d3plus.evt.over,function(){d3.select(this).select("rect").transition().duration(e.timing.mouseevents).attr("fill",e.timeline.handles.hover)}).on(d3plus.evt.out,function(){d3.select(this).select("rect").transition().duration(e.timing.mouseevents).attr("fill",e.timeline.handles.color)}),N.selectAll("g.resize").selectAll("rect").attr("height",M)}else N.selectAll("g.resize").remove();0===e.margin.bottom&&(e.margin.bottom+=e.ui.padding);var L=e.g.timeline.node().getBBox();e.margin.bottom+=L.height+L.y,e.g.timeline.transition().duration(e.draw.timing).attr("transform","translate(0,"+Math.round(e.height.value-e.margin.bottom-e.ui.padding/2)+")"),e.margin.bottom+=e.ui.padding,e.dev.value&&d3plus.console.time("drawing timeline")}else e.g.timeline.transition().duration(e.draw.timing).attr("transform","translate(0,"+e.height.value+")")}},{}],289:[function(e){var t=e("../../core/fetch/value.js");d3plus.ui.titles=function(e){function n(t){t.style("text-anchor",function(e){var t=e.style.font.align;return"center"==t?"middle":"left"==t&&!d3plus.rtl||"right"==t&&d3plus.rtl?"start":"left"==t&&d3plus.rtl||"right"==t&&!d3plus.rtl?"end":void 0}).attr("x",function(t){var n=t.style.font.align;return"center"==n?e.width.value/2:"left"==n&&!d3plus.rtl||"right"==n&&d3plus.rtl?e.padding:"left"==n&&d3plus.rtl||"right"==n&&!d3plus.rtl?e.width.value-e.padding:void 0}).attr("y",0)}function r(t){t.attr("font-size",function(e){return e.style.font.size}).attr("fill",function(t){return t.link?e.links.font.color:t.style.font.color}).attr("font-family",function(t){return t.link?e.links.font.family.value:t.style.font.family.value}).attr("font-weight",function(t){return t.link?e.links.font.weight:t.style.font.weight}).style("text-decoration",function(t){return t.link?e.links.font.decoration.value:t.style.font.decoration.value}).style("text-transform",function(t){return t.link?e.links.font.transform.value:t.style.font.transform.value})}var a=e.size.value?e.size.value:"number"===e.color.type?e.color.value:!1;if(e.data.app&&e.title.total.value&&!e.small)if(a){if(e.dev.value&&d3plus.console.time("calculating total value"),e.focus.value.length){var i=e.data.app.filter(function(t){return t[e.id.value]==e.focus.value[0]});i=d3.sum(i,function(n){return t(e,n,a)})}else var i=d3.sum(e.data.pool,function(n){return t(e,n,a)});if(0===i&&(i=!1),"number"==typeof i){var o="";if(e.data.mute.length||e.data.solo.length||e.focus.value.length){var l=d3.sum(e.data.value,function(n){if(e.time.solo.value.length>0)var r=e.time.solo.value.indexOf(t(e,n,e.time.value))>=0;else if(e.time.mute.value.length>0)var r=e.time.solo.value.indexOf(t(e,n,e.time.value))<0;else var r=!0;return r?t(e,n,a):void 0});if(l>i)var o=i/l*100,u=e.format.value(l,e.size.value),o=" ("+e.format.value(o,"share")+"% of "+u+")"}i=e.format.value(i,e.size.value);var s=e.title.total.value,c=s.prefix||e.format.value(e.format.locale.value.ui.total)+": ";i=c+i,s.suffix?i+=s.suffix:null,i+=o}e.dev.value&&d3plus.console.timeEnd("calculating total value")}else var i=!1;else var i=!1;var d=[];e.footer.value&&d.push({link:e.footer.link,style:e.footer,type:"footer",value:e.footer.value}),e.small||(e.title.value&&d.push({link:e.title.link,style:e.title,type:"title",value:e.title.value}),e.title.sub.value&&d.push({link:e.title.sub.link,style:e.title.sub,type:"sub",value:e.title.sub.value}),e.title.total.value&&i&&d.push({link:e.title.total.link,style:e.title.total,type:"total",value:i})),e.dev.value&&d3plus.console.time("drawing titles");var f=e.svg.selectAll("g.d3plus_title").data(d,function(e){return e.type}),p=e.title.width||e.width.value;f.enter().append("g").attr("class","d3plus_title").attr("opacity",0).attr("transform",function(t){var n="top"==t.style.position?0:e.height.value;return"translate(0,"+n+")"}).append("text").call(n).call(r),f.each(function(t){d3plus.textwrap().container(d3.select(this).select("text")).height(e.height.value/8).size(!1).text(t.value).width(p).draw(),t.y=e.margin[t.style.position],e.margin[t.style.position]+=this.getBBox().height+2*t.style.padding}).on(d3plus.evt.over,function(t){t.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","pointer").select("text").attr("fill",e.links.hover.color).attr("font-family",e.links.hover.family.value).attr("font-weight",e.links.hover.weight).style("text-decoration",e.links.hover.decoration.value).style("text-transform",e.links.hover.transform.value)}).on(d3plus.evt.out,function(t){t.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","auto").select("text").call(r)}).on(d3plus.evt.click,function(e){if(e.link){var t="/"!=e.link.charAt(0)?"_blank":"_self";window.open(e.link,t)}}).transition().duration(e.draw.timing).attr("opacity",1).attr("transform",function(t){var n=t.style.position,r="top"==n?0+t.y:e.height.value-t.y;return"bottom"==n?r-=this.getBBox().height+t.style.padding:r+=t.style.padding,"translate(0,"+r+")"}).select("text").call(n).call(r),f.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.margin.top>0&&(e.margin.top+=e.title.padding),e.margin.bottom>0&&(e.margin.bottom+=e.title.padding);var h=e.title.height;h&&e.margin[e.title.position]<h&&(e.margin[e.title.position]=h),e.dev.value&&d3plus.console.timeEnd("drawing titles")}},{"../../core/fetch/value.js":81}],290:[function(e){d3plus.viz=function(){var t={g:{apps:{}},types:{bubbles:e("./types/bubbles.js"),chart:e("./types/chart.js"),geo_map:e("./types/geo_map.js"),line:e("./types/line.js"),network:e("./types/network.js"),paths:e("./types/paths.coffee"),rings:e("./types/rings.js"),scatter:e("./types/scatter.js"),stacked:e("./types/stacked.js"),tree_map:e("./types/tree_map.js")},shell:"viz"};t.self=function(e){return e.each(function(){function e(){u=l.shift();var e=t.g.message&&a===u.message,n="check"in u?u.check:!0;if("function"==typeof n&&(n=n(t)),n)if(!e&&t.draw.update){t.dev.value&&(a!==!1&&d3plus.console.groupEnd(),d3plus.console.groupCollapsed(u.message)),a="string"==typeof t.messages.value?t.messages.value:u.message;var r="string"==typeof t.messages.value?t.messages.value:t.format.value(u.message);d3plus.ui.message(t,r),setTimeout(c,10)}else c();else"otherwise"in u?setTimeout(function(){c("otherwise")},10):s()}t.draw.frozen=!0,t.internal_error=null,d3plus.draw.container(t),"timing"in t.draw||(t.draw.timing=t.timing.transitions);var n=t.width.value<=t.width.small,r=t.height.value<=t.height.small;t.small=n||r;var a=!1;if(t.error.value){var i=t.draw.timing;t.group.transition().duration(i).attr("opacity",0),t.g.data.transition().duration(i).attr("opacity",0),t.g.edges.transition().duration(i).attr("opacity",0),t.messages.style="large";var o=t.error.value===!0?t.format.value(t.format.locale.value.ui.error):t.error.value;a=o,d3plus.ui.message(t,o)}else{var l=d3plus.draw.steps(t),u=!1;t.container.value.style("cursor","wait"),t.messages.style=t.group&&"1"===t.group.attr("opacity")?"small":"large";var s=function(){l.length?e():(t.methodGroup=!1,t.dev.value&&(d3plus.console.timeEnd("total draw time"),d3plus.console.groupEnd(),d3plus.console.log("\n")),t.container.value.style("cursor","auto"))},c=function(e){var e=e||"function";u[e]instanceof Array?u[e].forEach(function(e){e(t,s)}):"function"==typeof u[e]&&u[e](t,s),u.wait||s()};e()}}),t.self};var n=["active","aggs","attrs","axes","color","container","coords","csv","data","depth","descs","dev","draw","edges","error","focus","footer","format","height","history","icon","id","labels","legend","margin","messages","nodes","order","shape","size","style","temp","text","time","timeline","title","tooltip","total","type","ui","width","x","y","zoom"],r=["axes","background","color","coords","data","edges","font","footer","height","labels","legend","links","messages","nodes","shape","timeline","timing","title","tooltip","ui","width "];return d3plus.method(t,n,r),t.self}},{"./types/bubbles.js":273,"./types/chart.js":274,"./types/geo_map.js":275,"./types/line.js":276,"./types/network.js":277,"./types/paths.coffee":278,"./types/rings.js":279,"./types/scatter.js":280,"./types/stacked.js":281,"./types/tree_map.js":282}],291:[function(){d3plus.zoom.bounds=function(e,t,n){if(!t)var t=e.zoom.bounds;if("number"!=typeof n)var n=e.timing.transitions;e.zoom.size={height:t[1][1]-t[0][1],width:t[1][0]-t[0][0]};var r=e.coords.fit.value;if("auto"==r||e.types[e.type.value].requirements.indexOf("coords")<0)var a=d3.max([e.zoom.size.width/e.width.viz,e.zoom.size.height/e.height.viz]);else var a=e.zoom.size[r]/e["app_"+r];var i=d3.min([e.width.viz,e.height.viz]),o=(i-2*e.coords.padding)/i/a,l=e.zoom.behavior.scaleExtent();(l[0]==l[1]||t==e.zoom.bounds)&&e.zoom.behavior.scaleExtent([o,16*o]);var u=e.zoom.behavior.scaleExtent()[1];o>u&&(o=u),e.zoom.scale=o;var s=[];s[0]=e.width.viz/2-e.zoom.size.width*o/2-t[0][0]*o,s[1]=e.height.viz/2-e.zoom.size.height*o/2-t[0][1]*o,e.zoom.translate=s,e.zoom.behavior.translate(s).scale(o),e.zoom.size={height:e.zoom.bounds[1][1]-e.zoom.bounds[0][1],width:e.zoom.bounds[1][0]-e.zoom.bounds[0][0]},d3plus.zoom.transform(e,n)}},{}],292:[function(){d3plus.zoom.controls=function(){if(d3.select("#d3plus.utilsts.zoom_controls").remove(),!vars.small){var e=vars.container.value.append("div").attr("id","d3plus.utilsts.zoom_controls").style("top",vars.margin.top+5+"px");e.append("div").attr("id","zoom_in").attr("unselectable","on").on(d3plus.evt.click,function(){vars.zoom("in")}).text("+"),e.append("div").attr("id","zoom_out").attr("unselectable","on").on(d3plus.evt.click,function(){vars.zoom("out")}).text("-"),e.append("div").attr("id","zoom_reset").attr("unselectable","on").on(d3plus.evt.click,function(){vars.zoom("reset"),vars.draw.update()}).html("&#8634;")}}},{}],293:[function(){d3plus.zoom.labels=function(e){var t=e.zoom.behavior.scaleExtent()[1];e.dev.value&&d3plus.console.time("determining label visibility"),e.draw.timing?e.g.viz.selectAll("text.d3plus_label").transition().duration(e.draw.timing).attr("opacity",function(n){if(!n)var n={scale:t};var r=parseFloat(d3.select(this).attr("font-size"),10);return n.visible=r/n.scale*e.zoom.scale>=7,n.visible?1:0}):e.g.viz.selectAll("text.d3plus_label").attr("opacity",function(n){if(!n)var n={scale:t};var r=parseFloat(d3.select(this).attr("font-size"),10);return n.visible=r/n.scale*e.zoom.scale>=7,n.visible?1:0}),e.dev.value&&d3plus.console.timeEnd("determining label visibility")}},{}],294:[function(){d3plus.zoom.mouse=function(e){var t=d3.event.translate,n=d3.event.scale,r=e.zoom.bounds,a=(e.width.viz-e.zoom.size.width*n)/2,i=a>0?a:0,o=a>0?e.width.viz-a:e.width.viz,l=(e.height.viz-e.zoom.size.height*n)/2,u=l>0?l:0,s=l>0?e.height.viz-l:e.height.viz;if(t[0]+r[0][0]*n>i?t[0]=-r[0][0]*n+i:t[0]+r[1][0]*n<o&&(t[0]=o-r[1][0]*n),t[1]+r[0][1]*n>u?t[1]=-r[0][1]*n+u:t[1]+r[1][1]*n<s&&(t[1]=s-r[1][1]*n),e.zoom.behavior.translate(t).scale(n),e.zoom.translate=t,e.zoom.scale=n,"wheel"==d3.event.sourceEvent.type){var c=e.draw.timing?100:250;clearTimeout(e.zoom.wheel),e.zoom.wheel=setTimeout(function(){d3plus.zoom.labels(e)},c)}else d3plus.zoom.labels(e);"dblclick"===d3.event.sourceEvent.type?d3plus.zoom.transform(e,e.timing.transitions):d3plus.zoom.transform(e,0)}},{}],295:[function(){d3plus.zoom.transform=function(e,t){if("number"!=typeof t)var t=e.timing.transitions;var n=e.zoom.translate,r=e.zoom.scale;t?e.g.viz.transition().duration(t).attr("transform","translate("+n+")scale("+r+")"):e.g.viz.attr("transform","translate("+n+")scale("+r+")")}},{}]},{},[126,127,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,117,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,118,119,120,121,122,123,124,125,128,129,130,131,140,132,133,134,135,136,137,138,139,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,228,229,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,238,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,290,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,291,292,293,294,295]);